(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var jt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function co(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function n(){var i=!1;try{i=this instanceof n}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Fn={},xa,Pf;function K1(){return Pf||(Pf=1,xa=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),xa}var Ia={},Lr={},Uf;function Cn(){if(Uf)return Lr;Uf=1;let t;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Lr.getSymbolSize=function(n){if(!n)throw new Error('"version" cannot be null or undefined');if(n<1||n>40)throw new Error('"version" should be in range from 1 to 40');return n*4+17},Lr.getSymbolTotalCodewords=function(n){return e[n]},Lr.getBCHDigit=function(r){let n=0;for(;r!==0;)n++,r>>>=1;return n},Lr.setToSJISFunction=function(n){if(typeof n!="function")throw new Error('"toSJISFunc" is not a valid function.');t=n},Lr.isKanjiModeEnabled=function(){return typeof t<"u"},Lr.toSJIS=function(n){return t(n)},Lr}var Aa={},Lf;function xl(){return Lf||(Lf=1,(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+r)}}t.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},t.from=function(n,i){if(t.isValid(n))return n;try{return e(n)}catch{return i}}})(Aa)),Aa}var Ta,Mf;function W1(){if(Mf)return Ta;Mf=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(e){const r=Math.floor(e/8);return(this.buffer[r]>>>7-e%8&1)===1},put:function(e,r){for(let n=0;n<r;n++)this.putBit((e>>>r-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),e&&(this.buffer[r]|=128>>>this.length%8),this.length++}},Ta=t,Ta}var Oa,$f;function G1(){if($f)return Oa;$f=1;function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return t.prototype.set=function(e,r,n,i){const s=e*this.size+r;this.data[s]=n,i&&(this.reservedBit[s]=!0)},t.prototype.get=function(e,r){return this.data[e*this.size+r]},t.prototype.xor=function(e,r,n){this.data[e*this.size+r]^=n},t.prototype.isReserved=function(e,r){return this.reservedBit[e*this.size+r]},Oa=t,Oa}var Ca={},Ff;function Y1(){return Ff||(Ff=1,(function(t){const e=Cn().getSymbolSize;t.getRowColCoords=function(n){if(n===1)return[];const i=Math.floor(n/7)+2,s=e(n),o=s===145?26:Math.ceil((s-13)/(2*i-2))*2,a=[s-7];for(let c=1;c<i-1;c++)a[c]=a[c-1]-o;return a.push(6),a.reverse()},t.getPositions=function(n){const i=[],s=t.getRowColCoords(n),o=s.length;for(let a=0;a<o;a++)for(let c=0;c<o;c++)a===0&&c===0||a===0&&c===o-1||a===o-1&&c===0||i.push([s[a],s[c]]);return i}})(Ca)),Ca}var Ra={},kf;function X1(){if(kf)return Ra;kf=1;const t=Cn().getSymbolSize,e=7;return Ra.getPositions=function(n){const i=t(n);return[[0,0],[i-e,0],[0,i-e]]},Ra}var Da={},qf;function Z1(){return qf||(qf=1,(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},t.from=function(i){return t.isValid(i)?parseInt(i,10):void 0},t.getPenaltyN1=function(i){const s=i.size;let o=0,a=0,c=0,u=null,l=null;for(let f=0;f<s;f++){a=c=0,u=l=null;for(let p=0;p<s;p++){let d=i.get(f,p);d===u?a++:(a>=5&&(o+=e.N1+(a-5)),u=d,a=1),d=i.get(p,f),d===l?c++:(c>=5&&(o+=e.N1+(c-5)),l=d,c=1)}a>=5&&(o+=e.N1+(a-5)),c>=5&&(o+=e.N1+(c-5))}return o},t.getPenaltyN2=function(i){const s=i.size;let o=0;for(let a=0;a<s-1;a++)for(let c=0;c<s-1;c++){const u=i.get(a,c)+i.get(a,c+1)+i.get(a+1,c)+i.get(a+1,c+1);(u===4||u===0)&&o++}return o*e.N2},t.getPenaltyN3=function(i){const s=i.size;let o=0,a=0,c=0;for(let u=0;u<s;u++){a=c=0;for(let l=0;l<s;l++)a=a<<1&2047|i.get(u,l),l>=10&&(a===1488||a===93)&&o++,c=c<<1&2047|i.get(l,u),l>=10&&(c===1488||c===93)&&o++}return o*e.N3},t.getPenaltyN4=function(i){let s=0;const o=i.data.length;for(let c=0;c<o;c++)s+=i.data[c];return Math.abs(Math.ceil(s*100/o/5)-10)*e.N4};function r(n,i,s){switch(n){case t.Patterns.PATTERN000:return(i+s)%2===0;case t.Patterns.PATTERN001:return i%2===0;case t.Patterns.PATTERN010:return s%3===0;case t.Patterns.PATTERN011:return(i+s)%3===0;case t.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(s/3))%2===0;case t.Patterns.PATTERN101:return i*s%2+i*s%3===0;case t.Patterns.PATTERN110:return(i*s%2+i*s%3)%2===0;case t.Patterns.PATTERN111:return(i*s%3+(i+s)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}t.applyMask=function(i,s){const o=s.size;for(let a=0;a<o;a++)for(let c=0;c<o;c++)s.isReserved(c,a)||s.xor(c,a,r(i,c,a))},t.getBestMask=function(i,s){const o=Object.keys(t.Patterns).length;let a=0,c=1/0;for(let u=0;u<o;u++){s(u),t.applyMask(u,i);const l=t.getPenaltyN1(i)+t.getPenaltyN2(i)+t.getPenaltyN3(i)+t.getPenaltyN4(i);t.applyMask(u,i),l<c&&(c=l,a=u)}return a}})(Da)),Da}var hs={},jf;function Bg(){if(jf)return hs;jf=1;const t=xl(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],r=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return hs.getBlocksCount=function(i,s){switch(s){case t.L:return e[(i-1)*4+0];case t.M:return e[(i-1)*4+1];case t.Q:return e[(i-1)*4+2];case t.H:return e[(i-1)*4+3];default:return}},hs.getTotalCodewordsCount=function(i,s){switch(s){case t.L:return r[(i-1)*4+0];case t.M:return r[(i-1)*4+1];case t.Q:return r[(i-1)*4+2];case t.H:return r[(i-1)*4+3];default:return}},hs}var Ba={},hi={},zf;function J1(){if(zf)return hi;zf=1;const t=new Uint8Array(512),e=new Uint8Array(256);return(function(){let n=1;for(let i=0;i<255;i++)t[i]=n,e[n]=i,n<<=1,n&256&&(n^=285);for(let i=255;i<512;i++)t[i]=t[i-255]})(),hi.log=function(n){if(n<1)throw new Error("log("+n+")");return e[n]},hi.exp=function(n){return t[n]},hi.mul=function(n,i){return n===0||i===0?0:t[e[n]+e[i]]},hi}var Vf;function Q1(){return Vf||(Vf=1,(function(t){const e=J1();t.mul=function(n,i){const s=new Uint8Array(n.length+i.length-1);for(let o=0;o<n.length;o++)for(let a=0;a<i.length;a++)s[o+a]^=e.mul(n[o],i[a]);return s},t.mod=function(n,i){let s=new Uint8Array(n);for(;s.length-i.length>=0;){const o=s[0];for(let c=0;c<i.length;c++)s[c]^=e.mul(i[c],o);let a=0;for(;a<s.length&&s[a]===0;)a++;s=s.slice(a)}return s},t.generateECPolynomial=function(n){let i=new Uint8Array([1]);for(let s=0;s<n;s++)i=t.mul(i,new Uint8Array([1,e.exp(s)]));return i}})(Ba)),Ba}var Na,Hf;function eb(){if(Hf)return Na;Hf=1;const t=Q1();function e(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(n){this.degree=n,this.genPoly=t.generateECPolynomial(this.degree)},e.prototype.encode=function(n){if(!this.genPoly)throw new Error("Encoder not initialized");const i=new Uint8Array(n.length+this.degree);i.set(n);const s=t.mod(i,this.genPoly),o=this.degree-s.length;if(o>0){const a=new Uint8Array(this.degree);return a.set(s,o),a}return s},Na=e,Na}var Pa={},Ua={},La={},Kf;function Ng(){return Kf||(Kf=1,La.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),La}var sr={},Wf;function Pg(){if(Wf)return sr;Wf=1;const t="[0-9]+",e="[A-Z $%*+\\-./:]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const n="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+`)(?:.|[\r
]))+`;sr.KANJI=new RegExp(r,"g"),sr.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),sr.BYTE=new RegExp(n,"g"),sr.NUMERIC=new RegExp(t,"g"),sr.ALPHANUMERIC=new RegExp(e,"g");const i=new RegExp("^"+r+"$"),s=new RegExp("^"+t+"$"),o=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return sr.testKanji=function(c){return i.test(c)},sr.testNumeric=function(c){return s.test(c)},sr.testAlphanumeric=function(c){return o.test(c)},sr}var Gf;function Rn(){return Gf||(Gf=1,(function(t){const e=Ng(),r=Pg();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(s,o){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?s.ccBits[0]:o<27?s.ccBits[1]:s.ccBits[2]},t.getBestModeForData=function(s){return r.testNumeric(s)?t.NUMERIC:r.testAlphanumeric(s)?t.ALPHANUMERIC:r.testKanji(s)?t.KANJI:t.BYTE},t.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},t.isValid=function(s){return s&&s.bit&&s.ccBits};function n(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+i)}}t.from=function(s,o){if(t.isValid(s))return s;try{return n(s)}catch{return o}}})(Ua)),Ua}var Yf;function tb(){return Yf||(Yf=1,(function(t){const e=Cn(),r=Bg(),n=xl(),i=Rn(),s=Ng(),o=7973,a=e.getBCHDigit(o);function c(p,d,h){for(let g=1;g<=40;g++)if(d<=t.getCapacity(g,h,p))return g}function u(p,d){return i.getCharCountIndicator(p,d)+4}function l(p,d){let h=0;return p.forEach(function(g){const m=u(g.mode,d);h+=m+g.getBitsLength()}),h}function f(p,d){for(let h=1;h<=40;h++)if(l(p,h)<=t.getCapacity(h,d,i.MIXED))return h}t.from=function(d,h){return s.isValid(d)?parseInt(d,10):h},t.getCapacity=function(d,h,g){if(!s.isValid(d))throw new Error("Invalid QR Code version");typeof g>"u"&&(g=i.BYTE);const m=e.getSymbolTotalCodewords(d),y=r.getTotalCodewordsCount(d,h),S=(m-y)*8;if(g===i.MIXED)return S;const b=S-u(g,d);switch(g){case i.NUMERIC:return Math.floor(b/10*3);case i.ALPHANUMERIC:return Math.floor(b/11*2);case i.KANJI:return Math.floor(b/13);case i.BYTE:default:return Math.floor(b/8)}},t.getBestVersionForData=function(d,h){let g;const m=n.from(h,n.M);if(Array.isArray(d)){if(d.length>1)return f(d,m);if(d.length===0)return 1;g=d[0]}else g=d;return c(g.mode,g.getLength(),m)},t.getEncodedBits=function(d){if(!s.isValid(d)||d<7)throw new Error("Invalid QR Code version");let h=d<<12;for(;e.getBCHDigit(h)-a>=0;)h^=o<<e.getBCHDigit(h)-a;return d<<12|h}})(Pa)),Pa}var Ma={},Xf;function rb(){if(Xf)return Ma;Xf=1;const t=Cn(),e=1335,r=21522,n=t.getBCHDigit(e);return Ma.getEncodedBits=function(s,o){const a=s.bit<<3|o;let c=a<<10;for(;t.getBCHDigit(c)-n>=0;)c^=e<<t.getBCHDigit(c)-n;return(a<<10|c)^r},Ma}var $a={},Fa,Zf;function nb(){if(Zf)return Fa;Zf=1;const t=Rn();function e(r){this.mode=t.NUMERIC,this.data=r.toString()}return e.getBitsLength=function(n){return 10*Math.floor(n/3)+(n%3?n%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(n){let i,s,o;for(i=0;i+3<=this.data.length;i+=3)s=this.data.substr(i,3),o=parseInt(s,10),n.put(o,10);const a=this.data.length-i;a>0&&(s=this.data.substr(i),o=parseInt(s,10),n.put(o,a*3+1))},Fa=e,Fa}var ka,Jf;function ib(){if(Jf)return ka;Jf=1;const t=Rn(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function r(n){this.mode=t.ALPHANUMERIC,this.data=n}return r.getBitsLength=function(i){return 11*Math.floor(i/2)+6*(i%2)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(i){let s;for(s=0;s+2<=this.data.length;s+=2){let o=e.indexOf(this.data[s])*45;o+=e.indexOf(this.data[s+1]),i.put(o,11)}this.data.length%2&&i.put(e.indexOf(this.data[s]),6)},ka=r,ka}var qa,Qf;function sb(){if(Qf)return qa;Qf=1;const t=Rn();function e(r){this.mode=t.BYTE,typeof r=="string"?this.data=new TextEncoder().encode(r):this.data=new Uint8Array(r)}return e.getBitsLength=function(n){return n*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(r){for(let n=0,i=this.data.length;n<i;n++)r.put(this.data[n],8)},qa=e,qa}var ja,eh;function ob(){if(eh)return ja;eh=1;const t=Rn(),e=Cn();function r(n){this.mode=t.KANJI,this.data=n}return r.getBitsLength=function(i){return i*13},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(n){let i;for(i=0;i<this.data.length;i++){let s=e.toSJIS(this.data[i]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[i]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),n.put(s,13)}},ja=r,ja}var za={exports:{}},th;function ab(){return th||(th=1,(function(t){var e={single_source_shortest_paths:function(r,n,i){var s={},o={};o[n]=0;var a=e.PriorityQueue.make();a.push(n,0);for(var c,u,l,f,p,d,h,g,m;!a.empty();){c=a.pop(),u=c.value,f=c.cost,p=r[u]||{};for(l in p)p.hasOwnProperty(l)&&(d=p[l],h=f+d,g=o[l],m=typeof o[l]>"u",(m||g>h)&&(o[l]=h,a.push(l,h),s[l]=u))}if(typeof i<"u"&&typeof o[i]>"u"){var y=["Could not find a path from ",n," to ",i,"."].join("");throw new Error(y)}return s},extract_shortest_path_from_predecessor_list:function(r,n){for(var i=[],s=n;s;)i.push(s),r[s],s=r[s];return i.reverse(),i},find_path:function(r,n,i){var s=e.single_source_shortest_paths(r,n,i);return e.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(r){var n=e.PriorityQueue,i={},s;r=r||{};for(s in n)n.hasOwnProperty(s)&&(i[s]=n[s]);return i.queue=[],i.sorter=r.sorter||n.default_sorter,i},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var i={value:r,cost:n};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(za)),za.exports}var rh;function cb(){return rh||(rh=1,(function(t){const e=Rn(),r=nb(),n=ib(),i=sb(),s=ob(),o=Pg(),a=Cn(),c=ab();function u(y){return unescape(encodeURIComponent(y)).length}function l(y,S,b){const x=[];let I;for(;(I=y.exec(b))!==null;)x.push({data:I[0],index:I.index,mode:S,length:I[0].length});return x}function f(y){const S=l(o.NUMERIC,e.NUMERIC,y),b=l(o.ALPHANUMERIC,e.ALPHANUMERIC,y);let x,I;return a.isKanjiModeEnabled()?(x=l(o.BYTE,e.BYTE,y),I=l(o.KANJI,e.KANJI,y)):(x=l(o.BYTE_KANJI,e.BYTE,y),I=[]),S.concat(b,x,I).sort(function(B,P){return B.index-P.index}).map(function(B){return{data:B.data,mode:B.mode,length:B.length}})}function p(y,S){switch(S){case e.NUMERIC:return r.getBitsLength(y);case e.ALPHANUMERIC:return n.getBitsLength(y);case e.KANJI:return s.getBitsLength(y);case e.BYTE:return i.getBitsLength(y)}}function d(y){return y.reduce(function(S,b){const x=S.length-1>=0?S[S.length-1]:null;return x&&x.mode===b.mode?(S[S.length-1].data+=b.data,S):(S.push(b),S)},[])}function h(y){const S=[];for(let b=0;b<y.length;b++){const x=y[b];switch(x.mode){case e.NUMERIC:S.push([x,{data:x.data,mode:e.ALPHANUMERIC,length:x.length},{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.ALPHANUMERIC:S.push([x,{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.KANJI:S.push([x,{data:x.data,mode:e.BYTE,length:u(x.data)}]);break;case e.BYTE:S.push([{data:x.data,mode:e.BYTE,length:u(x.data)}])}}return S}function g(y,S){const b={},x={start:{}};let I=["start"];for(let A=0;A<y.length;A++){const B=y[A],P=[];for(let N=0;N<B.length;N++){const $=B[N],G=""+A+N;P.push(G),b[G]={node:$,lastCount:0},x[G]={};for(let q=0;q<I.length;q++){const L=I[q];b[L]&&b[L].node.mode===$.mode?(x[L][G]=p(b[L].lastCount+$.length,$.mode)-p(b[L].lastCount,$.mode),b[L].lastCount+=$.length):(b[L]&&(b[L].lastCount=$.length),x[L][G]=p($.length,$.mode)+4+e.getCharCountIndicator($.mode,S))}}I=P}for(let A=0;A<I.length;A++)x[I[A]].end=0;return{map:x,table:b}}function m(y,S){let b;const x=e.getBestModeForData(y);if(b=e.from(S,x),b!==e.BYTE&&b.bit<x.bit)throw new Error('"'+y+'" cannot be encoded with mode '+e.toString(b)+`.
 Suggested mode is: `+e.toString(x));switch(b===e.KANJI&&!a.isKanjiModeEnabled()&&(b=e.BYTE),b){case e.NUMERIC:return new r(y);case e.ALPHANUMERIC:return new n(y);case e.KANJI:return new s(y);case e.BYTE:return new i(y)}}t.fromArray=function(S){return S.reduce(function(b,x){return typeof x=="string"?b.push(m(x,null)):x.data&&b.push(m(x.data,x.mode)),b},[])},t.fromString=function(S,b){const x=f(S,a.isKanjiModeEnabled()),I=h(x),A=g(I,b),B=c.find_path(A.map,"start","end"),P=[];for(let N=1;N<B.length-1;N++)P.push(A.table[B[N]].node);return t.fromArray(d(P))},t.rawSplit=function(S){return t.fromArray(f(S,a.isKanjiModeEnabled()))}})($a)),$a}var nh;function ub(){if(nh)return Ia;nh=1;const t=Cn(),e=xl(),r=W1(),n=G1(),i=Y1(),s=X1(),o=Z1(),a=Bg(),c=eb(),u=tb(),l=rb(),f=Rn(),p=cb();function d(A,B){const P=A.size,N=s.getPositions(B);for(let $=0;$<N.length;$++){const G=N[$][0],q=N[$][1];for(let L=-1;L<=7;L++)if(!(G+L<=-1||P<=G+L))for(let j=-1;j<=7;j++)q+j<=-1||P<=q+j||(L>=0&&L<=6&&(j===0||j===6)||j>=0&&j<=6&&(L===0||L===6)||L>=2&&L<=4&&j>=2&&j<=4?A.set(G+L,q+j,!0,!0):A.set(G+L,q+j,!1,!0))}}function h(A){const B=A.size;for(let P=8;P<B-8;P++){const N=P%2===0;A.set(P,6,N,!0),A.set(6,P,N,!0)}}function g(A,B){const P=i.getPositions(B);for(let N=0;N<P.length;N++){const $=P[N][0],G=P[N][1];for(let q=-2;q<=2;q++)for(let L=-2;L<=2;L++)q===-2||q===2||L===-2||L===2||q===0&&L===0?A.set($+q,G+L,!0,!0):A.set($+q,G+L,!1,!0)}}function m(A,B){const P=A.size,N=u.getEncodedBits(B);let $,G,q;for(let L=0;L<18;L++)$=Math.floor(L/3),G=L%3+P-8-3,q=(N>>L&1)===1,A.set($,G,q,!0),A.set(G,$,q,!0)}function y(A,B,P){const N=A.size,$=l.getEncodedBits(B,P);let G,q;for(G=0;G<15;G++)q=($>>G&1)===1,G<6?A.set(G,8,q,!0):G<8?A.set(G+1,8,q,!0):A.set(N-15+G,8,q,!0),G<8?A.set(8,N-G-1,q,!0):G<9?A.set(8,15-G-1+1,q,!0):A.set(8,15-G-1,q,!0);A.set(N-8,8,1,!0)}function S(A,B){const P=A.size;let N=-1,$=P-1,G=7,q=0;for(let L=P-1;L>0;L-=2)for(L===6&&L--;;){for(let j=0;j<2;j++)if(!A.isReserved($,L-j)){let T=!1;q<B.length&&(T=(B[q]>>>G&1)===1),A.set($,L-j,T),G--,G===-1&&(q++,G=7)}if($+=N,$<0||P<=$){$-=N,N=-N;break}}}function b(A,B,P){const N=new r;P.forEach(function(j){N.put(j.mode.bit,4),N.put(j.getLength(),f.getCharCountIndicator(j.mode,A)),j.write(N)});const $=t.getSymbolTotalCodewords(A),G=a.getTotalCodewordsCount(A,B),q=($-G)*8;for(N.getLengthInBits()+4<=q&&N.put(0,4);N.getLengthInBits()%8!==0;)N.putBit(0);const L=(q-N.getLengthInBits())/8;for(let j=0;j<L;j++)N.put(j%2?17:236,8);return x(N,A,B)}function x(A,B,P){const N=t.getSymbolTotalCodewords(B),$=a.getTotalCodewordsCount(B,P),G=N-$,q=a.getBlocksCount(B,P),L=N%q,j=q-L,T=Math.floor(N/q),D=Math.floor(G/q),F=D+1,K=T-D,k=new c(K);let X=0;const ee=new Array(q),te=new Array(q);let le=0;const z=new Uint8Array(A.buffer);for(let oe=0;oe<q;oe++){const C=oe<j?D:F;ee[oe]=z.slice(X,X+C),te[oe]=k.encode(ee[oe]),X+=C,le=Math.max(le,C)}const ce=new Uint8Array(N);let W=0,V,re;for(V=0;V<le;V++)for(re=0;re<q;re++)V<ee[re].length&&(ce[W++]=ee[re][V]);for(V=0;V<K;V++)for(re=0;re<q;re++)ce[W++]=te[re][V];return ce}function I(A,B,P,N){let $;if(Array.isArray(A))$=p.fromArray(A);else if(typeof A=="string"){let T=B;if(!T){const D=p.rawSplit(A);T=u.getBestVersionForData(D,P)}$=p.fromString(A,T||40)}else throw new Error("Invalid data");const G=u.getBestVersionForData($,P);if(!G)throw new Error("The amount of data is too big to be stored in a QR Code");if(!B)B=G;else if(B<G)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+G+`.
`);const q=b(B,P,$),L=t.getSymbolSize(B),j=new n(L);return d(j,B),h(j),g(j,B),y(j,P,0),B>=7&&m(j,B),S(j,q),isNaN(N)&&(N=o.getBestMask(j,y.bind(null,j,P))),o.applyMask(N,j),y(j,P,N),{modules:j,version:B,errorCorrectionLevel:P,maskPattern:N,segments:$}}return Ia.create=function(B,P){if(typeof B>"u"||B==="")throw new Error("No input text");let N=e.M,$,G;return typeof P<"u"&&(N=e.from(P.errorCorrectionLevel,e.M),$=u.from(P.version),G=o.from(P.maskPattern),P.toSJISFunc&&t.setToSJISFunction(P.toSJISFunc)),I(B,$,N,G)},Ia}var Va={},Ha={},ih;function Ug(){return ih||(ih=1,(function(t){function e(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(s){return[s,s]}))),n.length===6&&n.push("F","F");const i=parseInt(n.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+n.slice(0,6).join("")}}t.getOptions=function(n){n||(n={}),n.color||(n.color={});const i=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,s=n.width&&n.width>=21?n.width:void 0,o=n.scale||4;return{width:s,scale:s?4:o,margin:i,color:{dark:e(n.color.dark||"#000000ff"),light:e(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},t.getScale=function(n,i){return i.width&&i.width>=n+i.margin*2?i.width/(n+i.margin*2):i.scale},t.getImageWidth=function(n,i){const s=t.getScale(n,i);return Math.floor((n+i.margin*2)*s)},t.qrToImageData=function(n,i,s){const o=i.modules.size,a=i.modules.data,c=t.getScale(o,s),u=Math.floor((o+s.margin*2)*c),l=s.margin*c,f=[s.color.light,s.color.dark];for(let p=0;p<u;p++)for(let d=0;d<u;d++){let h=(p*u+d)*4,g=s.color.light;if(p>=l&&d>=l&&p<u-l&&d<u-l){const m=Math.floor((p-l)/c),y=Math.floor((d-l)/c);g=f[a[m*o+y]?1:0]}n[h++]=g.r,n[h++]=g.g,n[h++]=g.b,n[h]=g.a}}})(Ha)),Ha}var sh;function lb(){return sh||(sh=1,(function(t){const e=Ug();function r(i,s,o){i.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(s,o,a){let c=a,u=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(u=n()),c=e.getOptions(c);const l=e.getImageWidth(s.modules.size,c),f=u.getContext("2d"),p=f.createImageData(l,l);return e.qrToImageData(p.data,s,c),r(f,u,l),f.putImageData(p,0,0),u},t.renderToDataURL=function(s,o,a){let c=a;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const u=t.render(s,o,c),l=c.type||"image/png",f=c.rendererOpts||{};return u.toDataURL(l,f.quality)}})(Va)),Va}var Ka={},oh;function fb(){if(oh)return Ka;oh=1;const t=Ug();function e(i,s){const o=i.a/255,a=s+'="'+i.hex+'"';return o<1?a+" "+s+'-opacity="'+o.toFixed(2).slice(1)+'"':a}function r(i,s,o){let a=i+s;return typeof o<"u"&&(a+=" "+o),a}function n(i,s,o){let a="",c=0,u=!1,l=0;for(let f=0;f<i.length;f++){const p=Math.floor(f%s),d=Math.floor(f/s);!p&&!u&&(u=!0),i[f]?(l++,f>0&&p>0&&i[f-1]||(a+=u?r("M",p+o,.5+d+o):r("m",c,0),c=0,u=!1),p+1<s&&i[f+1]||(a+=r("h",l),l=0)):c++}return a}return Ka.render=function(s,o,a){const c=t.getOptions(o),u=s.modules.size,l=s.modules.data,f=u+c.margin*2,p=c.color.light.a?"<path "+e(c.color.light,"fill")+' d="M0 0h'+f+"v"+f+'H0z"/>':"",d="<path "+e(c.color.dark,"stroke")+' d="'+n(l,u,c.margin)+'"/>',h='viewBox="0 0 '+f+" "+f+'"',m='<svg xmlns="http://www.w3.org/2000/svg" '+(c.width?'width="'+c.width+'" height="'+c.width+'" ':"")+h+' shape-rendering="crispEdges">'+p+d+`</svg>
`;return typeof a=="function"&&a(null,m),m},Ka}var ah;function hb(){if(ah)return Fn;ah=1;const t=K1(),e=ub(),r=lb(),n=fb();function i(s,o,a,c,u){const l=[].slice.call(arguments,1),f=l.length,p=typeof l[f-1]=="function";if(!p&&!t())throw new Error("Callback required as last argument");if(p){if(f<2)throw new Error("Too few arguments provided");f===2?(u=a,a=o,o=c=void 0):f===3&&(o.getContext&&typeof u>"u"?(u=c,c=void 0):(u=c,c=a,a=o,o=void 0))}else{if(f<1)throw new Error("Too few arguments provided");return f===1?(a=o,o=c=void 0):f===2&&!o.getContext&&(c=a,a=o,o=void 0),new Promise(function(d,h){try{const g=e.create(a,c);d(s(g,o,c))}catch(g){h(g)}})}try{const d=e.create(a,c);u(null,s(d,o,c))}catch(d){u(d)}}return Fn.create=e.create,Fn.toCanvas=i.bind(null,r.render),Fn.toDataURL=i.bind(null,r.renderToDataURL),Fn.toString=i.bind(null,function(s,o,a){return n.render(s,a)}),Fn}var db=hb();const pb=Sl(db);var cn={},un={},ln={},pt={},Wa,ch;function gb(){if(ch)return Wa;ch=1;for(var t="qpzry9x8gf2tvdw0s3jn54khce6mua7l",e={},r=0;r<t.length;r++){var n=t.charAt(r);if(e[n]!==void 0)throw new TypeError(n+" is ambiguous");e[n]=r}function i(g){var m=g>>25;return(g&33554431)<<5^-(m>>0&1)&996825010^-(m>>1&1)&642813549^-(m>>2&1)&513874426^-(m>>3&1)&1027748829^-(m>>4&1)&705979059}function s(g){for(var m=1,y=0;y<g.length;++y){var S=g.charCodeAt(y);if(S<33||S>126)return"Invalid prefix ("+g+")";m=i(m)^S>>5}for(m=i(m),y=0;y<g.length;++y){var b=g.charCodeAt(y);m=i(m)^b&31}return m}function o(g,m,y){if(y=y||90,g.length+7+m.length>y)throw new TypeError("Exceeds length limit");g=g.toLowerCase();var S=s(g);if(typeof S=="string")throw new Error(S);for(var b=g+"1",x=0;x<m.length;++x){var I=m[x];if(I>>5!==0)throw new Error("Non 5-bit word");S=i(S)^I,b+=t.charAt(I)}for(x=0;x<6;++x)S=i(S);for(S^=1,x=0;x<6;++x){var A=S>>(5-x)*5&31;b+=t.charAt(A)}return b}function a(g,m){if(m=m||90,g.length<8)return g+" too short";if(g.length>m)return"Exceeds length limit";var y=g.toLowerCase(),S=g.toUpperCase();if(g!==y&&g!==S)return"Mixed-case string "+g;g=y;var b=g.lastIndexOf("1");if(b===-1)return"No separator character for "+g;if(b===0)return"Missing prefix for "+g;var x=g.slice(0,b),I=g.slice(b+1);if(I.length<6)return"Data too short";var A=s(x);if(typeof A=="string")return A;for(var B=[],P=0;P<I.length;++P){var N=I.charAt(P),$=e[N];if($===void 0)return"Unknown character "+N;A=i(A)^$,!(P+6>=I.length)&&B.push($)}return A!==1?"Invalid checksum for "+g:{prefix:x,words:B}}function c(){var g=a.apply(null,arguments);if(typeof g=="object")return g}function u(g){var m=a.apply(null,arguments);if(typeof m=="object")return m;throw new Error(m)}function l(g,m,y,S){for(var b=0,x=0,I=(1<<y)-1,A=[],B=0;B<g.length;++B)for(b=b<<m|g[B],x+=m;x>=y;)x-=y,A.push(b>>x&I);if(S)x>0&&A.push(b<<y-x&I);else{if(x>=m)return"Excess padding";if(b<<y-x&I)return"Non-zero padding"}return A}function f(g){var m=l(g,8,5,!0);if(Array.isArray(m))return m}function p(g){var m=l(g,8,5,!0);if(Array.isArray(m))return m;throw new Error(m)}function d(g){var m=l(g,5,8,!1);if(Array.isArray(m))return m}function h(g){var m=l(g,5,8,!1);if(Array.isArray(m))return m;throw new Error(m)}return Wa={decodeUnsafe:c,decode:u,encode:o,toWordsUnsafe:f,toWords:p,fromWordsUnsafe:d,fromWords:h},Wa}var Ns={exports:{}},yb=Ns.exports,uh;function uo(){return uh||(uh=1,(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,l=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,d=1e9;function h(A){var B,P,N,$=z.prototype={constructor:z,toString:null,valueOf:null},G=new z(1),q=20,L=4,j=-7,T=21,D=-1e7,F=1e7,K=!1,k=1,X=0,ee={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},te="0123456789abcdefghijklmnopqrstuvwxyz",le=!0;function z(C,_){var v,R,U,Y,J,H,Q,ie,ne=this;if(!(ne instanceof z))return new z(C,_);if(_==null){if(C&&C._isBigNumber===!0){ne.s=C.s,!C.c||C.e>F?ne.c=ne.e=null:C.e<D?ne.c=[ne.e=0]:(ne.e=C.e,ne.c=C.c.slice());return}if((H=typeof C=="number")&&C*0==0){if(ne.s=1/C<0?(C=-C,-1):1,C===~~C){for(Y=0,J=C;J>=10;J/=10,Y++);Y>F?ne.c=ne.e=null:(ne.e=Y,ne.c=[C]);return}ie=String(C)}else{if(!n.test(ie=String(C)))return N(ne,ie,H);ne.s=ie.charCodeAt(0)==45?(ie=ie.slice(1),-1):1}(Y=ie.indexOf("."))>-1&&(ie=ie.replace(".","")),(J=ie.search(/e/i))>0?(Y<0&&(Y=J),Y+=+ie.slice(J+1),ie=ie.substring(0,J)):Y<0&&(Y=ie.length)}else{if(S(_,2,te.length,"Base"),_==10&&le)return ne=new z(C),re(ne,q+ne.e+1,L);if(ie=String(C),H=typeof C=="number"){if(C*0!=0)return N(ne,ie,H,_);if(ne.s=1/C<0?(ie=ie.slice(1),-1):1,z.DEBUG&&ie.replace(/^0\.0*|\./,"").length>15)throw Error(a+C)}else ne.s=ie.charCodeAt(0)===45?(ie=ie.slice(1),-1):1;for(v=te.slice(0,_),Y=J=0,Q=ie.length;J<Q;J++)if(v.indexOf(R=ie.charAt(J))<0){if(R=="."){if(J>Y){Y=Q;continue}}else if(!U&&(ie==ie.toUpperCase()&&(ie=ie.toLowerCase())||ie==ie.toLowerCase()&&(ie=ie.toUpperCase()))){U=!0,J=-1,Y=0;continue}return N(ne,String(C),H,_)}H=!1,ie=P(ie,_,10,ne.s),(Y=ie.indexOf("."))>-1?ie=ie.replace(".",""):Y=ie.length}for(J=0;ie.charCodeAt(J)===48;J++);for(Q=ie.length;ie.charCodeAt(--Q)===48;);if(ie=ie.slice(J,++Q)){if(Q-=J,H&&z.DEBUG&&Q>15&&(C>l||C!==s(C)))throw Error(a+ne.s*C);if((Y=Y-J-1)>F)ne.c=ne.e=null;else if(Y<D)ne.c=[ne.e=0];else{if(ne.e=Y,ne.c=[],J=(Y+1)%u,Y<0&&(J+=u),J<Q){for(J&&ne.c.push(+ie.slice(0,J)),Q-=u;J<Q;)ne.c.push(+ie.slice(J,J+=u));J=u-(ie=ie.slice(J)).length}else J-=Q;for(;J--;ie+="0");ne.c.push(+ie)}}else ne.c=[ne.e=0]}z.clone=h,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(C){var _,v;if(C!=null)if(typeof C=="object"){if(C.hasOwnProperty(_="DECIMAL_PLACES")&&(v=C[_],S(v,0,d,_),q=v),C.hasOwnProperty(_="ROUNDING_MODE")&&(v=C[_],S(v,0,8,_),L=v),C.hasOwnProperty(_="EXPONENTIAL_AT")&&(v=C[_],v&&v.pop?(S(v[0],-d,0,_),S(v[1],0,d,_),j=v[0],T=v[1]):(S(v,-d,d,_),j=-(T=v<0?-v:v))),C.hasOwnProperty(_="RANGE"))if(v=C[_],v&&v.pop)S(v[0],-d,-1,_),S(v[1],1,d,_),D=v[0],F=v[1];else if(S(v,-d,d,_),v)D=-(F=v<0?-v:v);else throw Error(o+_+" cannot be zero: "+v);if(C.hasOwnProperty(_="CRYPTO"))if(v=C[_],v===!!v)if(v)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))K=v;else throw K=!v,Error(o+"crypto unavailable");else K=v;else throw Error(o+_+" not true or false: "+v);if(C.hasOwnProperty(_="MODULO_MODE")&&(v=C[_],S(v,0,9,_),k=v),C.hasOwnProperty(_="POW_PRECISION")&&(v=C[_],S(v,0,d,_),X=v),C.hasOwnProperty(_="FORMAT"))if(v=C[_],typeof v=="object")ee=v;else throw Error(o+_+" not an object: "+v);if(C.hasOwnProperty(_="ALPHABET"))if(v=C[_],typeof v=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(v))le=v.slice(0,10)=="0123456789",te=v;else throw Error(o+_+" invalid: "+v)}else throw Error(o+"Object expected: "+C);return{DECIMAL_PLACES:q,ROUNDING_MODE:L,EXPONENTIAL_AT:[j,T],RANGE:[D,F],CRYPTO:K,MODULO_MODE:k,POW_PRECISION:X,FORMAT:ee,ALPHABET:te}},z.isBigNumber=function(C){if(!C||C._isBigNumber!==!0)return!1;if(!z.DEBUG)return!0;var _,v,R=C.c,U=C.e,Y=C.s;e:if({}.toString.call(R)=="[object Array]"){if((Y===1||Y===-1)&&U>=-d&&U<=d&&U===s(U)){if(R[0]===0){if(U===0&&R.length===1)return!0;break e}if(_=(U+1)%u,_<1&&(_+=u),String(R[0]).length==_){for(_=0;_<R.length;_++)if(v=R[_],v<0||v>=c||v!==s(v))break e;if(v!==0)return!0}}}else if(R===null&&U===null&&(Y===null||Y===1||Y===-1))return!0;throw Error(o+"Invalid BigNumber: "+C)},z.maximum=z.max=function(){return W(arguments,-1)},z.minimum=z.min=function(){return W(arguments,1)},z.random=(function(){var C=9007199254740992,_=Math.random()*C&2097151?function(){return s(Math.random()*C)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(v){var R,U,Y,J,H,Q=0,ie=[],ne=new z(G);if(v==null?v=q:S(v,0,d),J=i(v/u),K)if(crypto.getRandomValues){for(R=crypto.getRandomValues(new Uint32Array(J*=2));Q<J;)H=R[Q]*131072+(R[Q+1]>>>11),H>=9e15?(U=crypto.getRandomValues(new Uint32Array(2)),R[Q]=U[0],R[Q+1]=U[1]):(ie.push(H%1e14),Q+=2);Q=J/2}else if(crypto.randomBytes){for(R=crypto.randomBytes(J*=7);Q<J;)H=(R[Q]&31)*281474976710656+R[Q+1]*1099511627776+R[Q+2]*4294967296+R[Q+3]*16777216+(R[Q+4]<<16)+(R[Q+5]<<8)+R[Q+6],H>=9e15?crypto.randomBytes(7).copy(R,Q):(ie.push(H%1e14),Q+=7);Q=J/7}else throw K=!1,Error(o+"crypto unavailable");if(!K)for(;Q<J;)H=_(),H<9e15&&(ie[Q++]=H%1e14);for(J=ie[--Q],v%=u,J&&v&&(H=f[u-v],ie[Q]=s(J/H)*H);ie[Q]===0;ie.pop(),Q--);if(Q<0)ie=[Y=0];else{for(Y=-1;ie[0]===0;ie.splice(0,1),Y-=u);for(Q=1,H=ie[0];H>=10;H/=10,Q++);Q<u&&(Y-=u-Q)}return ne.e=Y,ne.c=ie,ne}})(),z.sum=function(){for(var C=1,_=arguments,v=new z(_[0]);C<_.length;)v=v.plus(_[C++]);return v},P=(function(){var C="0123456789";function _(v,R,U,Y){for(var J,H=[0],Q,ie=0,ne=v.length;ie<ne;){for(Q=H.length;Q--;H[Q]*=R);for(H[0]+=Y.indexOf(v.charAt(ie++)),J=0;J<H.length;J++)H[J]>U-1&&(H[J+1]==null&&(H[J+1]=0),H[J+1]+=H[J]/U|0,H[J]%=U)}return H.reverse()}return function(v,R,U,Y,J){var H,Q,ie,ne,ue,ge,we,ve,Se=v.indexOf("."),Oe=q,O=L;for(Se>=0&&(ne=X,X=0,v=v.replace(".",""),ve=new z(R),ge=ve.pow(v.length-Se),X=ne,ve.c=_(I(m(ge.c),ge.e,"0"),10,U,C),ve.e=ve.c.length),we=_(v,R,U,J?(H=te,C):(H=C,te)),ie=ne=we.length;we[--ne]==0;we.pop());if(!we[0])return H.charAt(0);if(Se<0?--ie:(ge.c=we,ge.e=ie,ge.s=Y,ge=B(ge,ve,Oe,O,U),we=ge.c,ue=ge.r,ie=ge.e),Q=ie+Oe+1,Se=we[Q],ne=U/2,ue=ue||Q<0||we[Q+1]!=null,ue=O<4?(Se!=null||ue)&&(O==0||O==(ge.s<0?3:2)):Se>ne||Se==ne&&(O==4||ue||O==6&&we[Q-1]&1||O==(ge.s<0?8:7)),Q<1||!we[0])v=ue?I(H.charAt(1),-Oe,H.charAt(0)):H.charAt(0);else{if(we.length=Q,ue)for(--U;++we[--Q]>U;)we[Q]=0,Q||(++ie,we=[1].concat(we));for(ne=we.length;!we[--ne];);for(Se=0,v="";Se<=ne;v+=H.charAt(we[Se++]));v=I(v,ie,H.charAt(0))}return v}})(),B=(function(){function C(R,U,Y){var J,H,Q,ie,ne=0,ue=R.length,ge=U%p,we=U/p|0;for(R=R.slice();ue--;)Q=R[ue]%p,ie=R[ue]/p|0,J=we*Q+ie*ge,H=ge*Q+J%p*p+ne,ne=(H/Y|0)+(J/p|0)+we*ie,R[ue]=H%Y;return ne&&(R=[ne].concat(R)),R}function _(R,U,Y,J){var H,Q;if(Y!=J)Q=Y>J?1:-1;else for(H=Q=0;H<Y;H++)if(R[H]!=U[H]){Q=R[H]>U[H]?1:-1;break}return Q}function v(R,U,Y,J){for(var H=0;Y--;)R[Y]-=H,H=R[Y]<U[Y]?1:0,R[Y]=H*J+R[Y]-U[Y];for(;!R[0]&&R.length>1;R.splice(0,1));}return function(R,U,Y,J,H){var Q,ie,ne,ue,ge,we,ve,Se,Oe,O,w,E,M,Z,se,ae,Ee,Ie=R.s==U.s?1:-1,_e=R.c,be=U.c;if(!_e||!_e[0]||!be||!be[0])return new z(!R.s||!U.s||(_e?be&&_e[0]==be[0]:!be)?NaN:_e&&_e[0]==0||!be?Ie*0:Ie/0);for(Se=new z(Ie),Oe=Se.c=[],ie=R.e-U.e,Ie=Y+ie+1,H||(H=c,ie=g(R.e/u)-g(U.e/u),Ie=Ie/u|0),ne=0;be[ne]==(_e[ne]||0);ne++);if(be[ne]>(_e[ne]||0)&&ie--,Ie<0)Oe.push(1),ue=!0;else{for(Z=_e.length,ae=be.length,ne=0,Ie+=2,ge=s(H/(be[0]+1)),ge>1&&(be=C(be,ge,H),_e=C(_e,ge,H),ae=be.length,Z=_e.length),M=ae,O=_e.slice(0,ae),w=O.length;w<ae;O[w++]=0);Ee=be.slice(),Ee=[0].concat(Ee),se=be[0],be[1]>=H/2&&se++;do{if(ge=0,Q=_(be,O,ae,w),Q<0){if(E=O[0],ae!=w&&(E=E*H+(O[1]||0)),ge=s(E/se),ge>1)for(ge>=H&&(ge=H-1),we=C(be,ge,H),ve=we.length,w=O.length;_(we,O,ve,w)==1;)ge--,v(we,ae<ve?Ee:be,ve,H),ve=we.length,Q=1;else ge==0&&(Q=ge=1),we=be.slice(),ve=we.length;if(ve<w&&(we=[0].concat(we)),v(O,we,w,H),w=O.length,Q==-1)for(;_(be,O,ae,w)<1;)ge++,v(O,ae<w?Ee:be,w,H),w=O.length}else Q===0&&(ge++,O=[0]);Oe[ne++]=ge,O[0]?O[w++]=_e[M]||0:(O=[_e[M]],w=1)}while((M++<Z||O[0]!=null)&&Ie--);ue=O[0]!=null,Oe[0]||Oe.splice(0,1)}if(H==c){for(ne=1,Ie=Oe[0];Ie>=10;Ie/=10,ne++);re(Se,Y+(Se.e=ne+ie*u-1)+1,J,ue)}else Se.e=ie,Se.r=+ue;return Se}})();function ce(C,_,v,R){var U,Y,J,H,Q;if(v==null?v=L:S(v,0,8),!C.c)return C.toString();if(U=C.c[0],J=C.e,_==null)Q=m(C.c),Q=R==1||R==2&&(J<=j||J>=T)?x(Q,J):I(Q,J,"0");else if(C=re(new z(C),_,v),Y=C.e,Q=m(C.c),H=Q.length,R==1||R==2&&(_<=Y||Y<=j)){for(;H<_;Q+="0",H++);Q=x(Q,Y)}else if(_-=J+(R===2&&Y>J),Q=I(Q,Y,"0"),Y+1>H){if(--_>0)for(Q+=".";_--;Q+="0");}else if(_+=Y-H,_>0)for(Y+1==H&&(Q+=".");_--;Q+="0");return C.s<0&&U?"-"+Q:Q}function W(C,_){for(var v,R,U=1,Y=new z(C[0]);U<C.length;U++)R=new z(C[U]),(!R.s||(v=y(Y,R))===_||v===0&&Y.s===_)&&(Y=R);return Y}function V(C,_,v){for(var R=1,U=_.length;!_[--U];_.pop());for(U=_[0];U>=10;U/=10,R++);return(v=R+v*u-1)>F?C.c=C.e=null:v<D?C.c=[C.e=0]:(C.e=v,C.c=_),C}N=(function(){var C=/^(-?)0([xbo])(?=\w[\w.]*$)/i,_=/^([^.]+)\.$/,v=/^\.([^.]+)$/,R=/^-?(Infinity|NaN)$/,U=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Y,J,H,Q){var ie,ne=H?J:J.replace(U,"");if(R.test(ne))Y.s=isNaN(ne)?null:ne<0?-1:1;else{if(!H&&(ne=ne.replace(C,function(ue,ge,we){return ie=(we=we.toLowerCase())=="x"?16:we=="b"?2:8,!Q||Q==ie?ge:ue}),Q&&(ie=Q,ne=ne.replace(_,"$1").replace(v,"0.$1")),J!=ne))return new z(ne,ie);if(z.DEBUG)throw Error(o+"Not a"+(Q?" base "+Q:"")+" number: "+J);Y.s=null}Y.c=Y.e=null}})();function re(C,_,v,R){var U,Y,J,H,Q,ie,ne,ue=C.c,ge=f;if(ue){e:{for(U=1,H=ue[0];H>=10;H/=10,U++);if(Y=_-U,Y<0)Y+=u,J=_,Q=ue[ie=0],ne=s(Q/ge[U-J-1]%10);else if(ie=i((Y+1)/u),ie>=ue.length)if(R){for(;ue.length<=ie;ue.push(0));Q=ne=0,U=1,Y%=u,J=Y-u+1}else break e;else{for(Q=H=ue[ie],U=1;H>=10;H/=10,U++);Y%=u,J=Y-u+U,ne=J<0?0:s(Q/ge[U-J-1]%10)}if(R=R||_<0||ue[ie+1]!=null||(J<0?Q:Q%ge[U-J-1]),R=v<4?(ne||R)&&(v==0||v==(C.s<0?3:2)):ne>5||ne==5&&(v==4||R||v==6&&(Y>0?J>0?Q/ge[U-J]:0:ue[ie-1])%10&1||v==(C.s<0?8:7)),_<1||!ue[0])return ue.length=0,R?(_-=C.e+1,ue[0]=ge[(u-_%u)%u],C.e=-_||0):ue[0]=C.e=0,C;if(Y==0?(ue.length=ie,H=1,ie--):(ue.length=ie+1,H=ge[u-Y],ue[ie]=J>0?s(Q/ge[U-J]%ge[J])*H:0),R)for(;;)if(ie==0){for(Y=1,J=ue[0];J>=10;J/=10,Y++);for(J=ue[0]+=H,H=1;J>=10;J/=10,H++);Y!=H&&(C.e++,ue[0]==c&&(ue[0]=1));break}else{if(ue[ie]+=H,ue[ie]!=c)break;ue[ie--]=0,H=1}for(Y=ue.length;ue[--Y]===0;ue.pop());}C.e>F?C.c=C.e=null:C.e<D&&(C.c=[C.e=0])}return C}function oe(C){var _,v=C.e;return v===null?C.toString():(_=m(C.c),_=v<=j||v>=T?x(_,v):I(_,v,"0"),C.s<0?"-"+_:_)}return $.absoluteValue=$.abs=function(){var C=new z(this);return C.s<0&&(C.s=1),C},$.comparedTo=function(C,_){return y(this,new z(C,_))},$.decimalPlaces=$.dp=function(C,_){var v,R,U,Y=this;if(C!=null)return S(C,0,d),_==null?_=L:S(_,0,8),re(new z(Y),C+Y.e+1,_);if(!(v=Y.c))return null;if(R=((U=v.length-1)-g(this.e/u))*u,U=v[U])for(;U%10==0;U/=10,R--);return R<0&&(R=0),R},$.dividedBy=$.div=function(C,_){return B(this,new z(C,_),q,L)},$.dividedToIntegerBy=$.idiv=function(C,_){return B(this,new z(C,_),0,1)},$.exponentiatedBy=$.pow=function(C,_){var v,R,U,Y,J,H,Q,ie,ne,ue=this;if(C=new z(C),C.c&&!C.isInteger())throw Error(o+"Exponent not an integer: "+oe(C));if(_!=null&&(_=new z(_)),H=C.e>14,!ue.c||!ue.c[0]||ue.c[0]==1&&!ue.e&&ue.c.length==1||!C.c||!C.c[0])return ne=new z(Math.pow(+oe(ue),H?C.s*(2-b(C)):+oe(C))),_?ne.mod(_):ne;if(Q=C.s<0,_){if(_.c?!_.c[0]:!_.s)return new z(NaN);R=!Q&&ue.isInteger()&&_.isInteger(),R&&(ue=ue.mod(_))}else{if(C.e>9&&(ue.e>0||ue.e<-1||(ue.e==0?ue.c[0]>1||H&&ue.c[1]>=24e7:ue.c[0]<8e13||H&&ue.c[0]<=9999975e7)))return Y=ue.s<0&&b(C)?-0:0,ue.e>-1&&(Y=1/Y),new z(Q?1/Y:Y);X&&(Y=i(X/u+2))}for(H?(v=new z(.5),Q&&(C.s=1),ie=b(C)):(U=Math.abs(+oe(C)),ie=U%2),ne=new z(G);;){if(ie){if(ne=ne.times(ue),!ne.c)break;Y?ne.c.length>Y&&(ne.c.length=Y):R&&(ne=ne.mod(_))}if(U){if(U=s(U/2),U===0)break;ie=U%2}else if(C=C.times(v),re(C,C.e+1,1),C.e>14)ie=b(C);else{if(U=+oe(C),U===0)break;ie=U%2}ue=ue.times(ue),Y?ue.c&&ue.c.length>Y&&(ue.c.length=Y):R&&(ue=ue.mod(_))}return R?ne:(Q&&(ne=G.div(ne)),_?ne.mod(_):Y?re(ne,X,L,J):ne)},$.integerValue=function(C){var _=new z(this);return C==null?C=L:S(C,0,8),re(_,_.e+1,C)},$.isEqualTo=$.eq=function(C,_){return y(this,new z(C,_))===0},$.isFinite=function(){return!!this.c},$.isGreaterThan=$.gt=function(C,_){return y(this,new z(C,_))>0},$.isGreaterThanOrEqualTo=$.gte=function(C,_){return(_=y(this,new z(C,_)))===1||_===0},$.isInteger=function(){return!!this.c&&g(this.e/u)>this.c.length-2},$.isLessThan=$.lt=function(C,_){return y(this,new z(C,_))<0},$.isLessThanOrEqualTo=$.lte=function(C,_){return(_=y(this,new z(C,_)))===-1||_===0},$.isNaN=function(){return!this.s},$.isNegative=function(){return this.s<0},$.isPositive=function(){return this.s>0},$.isZero=function(){return!!this.c&&this.c[0]==0},$.minus=function(C,_){var v,R,U,Y,J=this,H=J.s;if(C=new z(C,_),_=C.s,!H||!_)return new z(NaN);if(H!=_)return C.s=-_,J.plus(C);var Q=J.e/u,ie=C.e/u,ne=J.c,ue=C.c;if(!Q||!ie){if(!ne||!ue)return ne?(C.s=-_,C):new z(ue?J:NaN);if(!ne[0]||!ue[0])return ue[0]?(C.s=-_,C):new z(ne[0]?J:L==3?-0:0)}if(Q=g(Q),ie=g(ie),ne=ne.slice(),H=Q-ie){for((Y=H<0)?(H=-H,U=ne):(ie=Q,U=ue),U.reverse(),_=H;_--;U.push(0));U.reverse()}else for(R=(Y=(H=ne.length)<(_=ue.length))?H:_,H=_=0;_<R;_++)if(ne[_]!=ue[_]){Y=ne[_]<ue[_];break}if(Y&&(U=ne,ne=ue,ue=U,C.s=-C.s),_=(R=ue.length)-(v=ne.length),_>0)for(;_--;ne[v++]=0);for(_=c-1;R>H;){if(ne[--R]<ue[R]){for(v=R;v&&!ne[--v];ne[v]=_);--ne[v],ne[R]+=c}ne[R]-=ue[R]}for(;ne[0]==0;ne.splice(0,1),--ie);return ne[0]?V(C,ne,ie):(C.s=L==3?-1:1,C.c=[C.e=0],C)},$.modulo=$.mod=function(C,_){var v,R,U=this;return C=new z(C,_),!U.c||!C.s||C.c&&!C.c[0]?new z(NaN):!C.c||U.c&&!U.c[0]?new z(U):(k==9?(R=C.s,C.s=1,v=B(U,C,0,3),C.s=R,v.s*=R):v=B(U,C,0,k),C=U.minus(v.times(C)),!C.c[0]&&k==1&&(C.s=U.s),C)},$.multipliedBy=$.times=function(C,_){var v,R,U,Y,J,H,Q,ie,ne,ue,ge,we,ve,Se,Oe,O=this,w=O.c,E=(C=new z(C,_)).c;if(!w||!E||!w[0]||!E[0])return!O.s||!C.s||w&&!w[0]&&!E||E&&!E[0]&&!w?C.c=C.e=C.s=null:(C.s*=O.s,!w||!E?C.c=C.e=null:(C.c=[0],C.e=0)),C;for(R=g(O.e/u)+g(C.e/u),C.s*=O.s,Q=w.length,ue=E.length,Q<ue&&(ve=w,w=E,E=ve,U=Q,Q=ue,ue=U),U=Q+ue,ve=[];U--;ve.push(0));for(Se=c,Oe=p,U=ue;--U>=0;){for(v=0,ge=E[U]%Oe,we=E[U]/Oe|0,J=Q,Y=U+J;Y>U;)ie=w[--J]%Oe,ne=w[J]/Oe|0,H=we*ie+ne*ge,ie=ge*ie+H%Oe*Oe+ve[Y]+v,v=(ie/Se|0)+(H/Oe|0)+we*ne,ve[Y--]=ie%Se;ve[Y]=v}return v?++R:ve.splice(0,1),V(C,ve,R)},$.negated=function(){var C=new z(this);return C.s=-C.s||null,C},$.plus=function(C,_){var v,R=this,U=R.s;if(C=new z(C,_),_=C.s,!U||!_)return new z(NaN);if(U!=_)return C.s=-_,R.minus(C);var Y=R.e/u,J=C.e/u,H=R.c,Q=C.c;if(!Y||!J){if(!H||!Q)return new z(U/0);if(!H[0]||!Q[0])return Q[0]?C:new z(H[0]?R:U*0)}if(Y=g(Y),J=g(J),H=H.slice(),U=Y-J){for(U>0?(J=Y,v=Q):(U=-U,v=H),v.reverse();U--;v.push(0));v.reverse()}for(U=H.length,_=Q.length,U-_<0&&(v=Q,Q=H,H=v,_=U),U=0;_;)U=(H[--_]=H[_]+Q[_]+U)/c|0,H[_]=c===H[_]?0:H[_]%c;return U&&(H=[U].concat(H),++J),V(C,H,J)},$.precision=$.sd=function(C,_){var v,R,U,Y=this;if(C!=null&&C!==!!C)return S(C,1,d),_==null?_=L:S(_,0,8),re(new z(Y),C,_);if(!(v=Y.c))return null;if(U=v.length-1,R=U*u+1,U=v[U]){for(;U%10==0;U/=10,R--);for(U=v[0];U>=10;U/=10,R++);}return C&&Y.e+1>R&&(R=Y.e+1),R},$.shiftedBy=function(C){return S(C,-l,l),this.times("1e"+C)},$.squareRoot=$.sqrt=function(){var C,_,v,R,U,Y=this,J=Y.c,H=Y.s,Q=Y.e,ie=q+4,ne=new z("0.5");if(H!==1||!J||!J[0])return new z(!H||H<0&&(!J||J[0])?NaN:J?Y:1/0);if(H=Math.sqrt(+oe(Y)),H==0||H==1/0?(_=m(J),(_.length+Q)%2==0&&(_+="0"),H=Math.sqrt(+_),Q=g((Q+1)/2)-(Q<0||Q%2),H==1/0?_="5e"+Q:(_=H.toExponential(),_=_.slice(0,_.indexOf("e")+1)+Q),v=new z(_)):v=new z(H+""),v.c[0]){for(Q=v.e,H=Q+ie,H<3&&(H=0);;)if(U=v,v=ne.times(U.plus(B(Y,U,ie,1))),m(U.c).slice(0,H)===(_=m(v.c)).slice(0,H))if(v.e<Q&&--H,_=_.slice(H-3,H+1),_=="9999"||!R&&_=="4999"){if(!R&&(re(U,U.e+q+2,0),U.times(U).eq(Y))){v=U;break}ie+=4,H+=4,R=1}else{(!+_||!+_.slice(1)&&_.charAt(0)=="5")&&(re(v,v.e+q+2,1),C=!v.times(v).eq(Y));break}}return re(v,v.e+q+1,L,C)},$.toExponential=function(C,_){return C!=null&&(S(C,0,d),C++),ce(this,C,_,1)},$.toFixed=function(C,_){return C!=null&&(S(C,0,d),C=C+this.e+1),ce(this,C,_)},$.toFormat=function(C,_,v){var R,U=this;if(v==null)C!=null&&_&&typeof _=="object"?(v=_,_=null):C&&typeof C=="object"?(v=C,C=_=null):v=ee;else if(typeof v!="object")throw Error(o+"Argument not an object: "+v);if(R=U.toFixed(C,_),U.c){var Y,J=R.split("."),H=+v.groupSize,Q=+v.secondaryGroupSize,ie=v.groupSeparator||"",ne=J[0],ue=J[1],ge=U.s<0,we=ge?ne.slice(1):ne,ve=we.length;if(Q&&(Y=H,H=Q,Q=Y,ve-=Y),H>0&&ve>0){for(Y=ve%H||H,ne=we.substr(0,Y);Y<ve;Y+=H)ne+=ie+we.substr(Y,H);Q>0&&(ne+=ie+we.slice(Y)),ge&&(ne="-"+ne)}R=ue?ne+(v.decimalSeparator||"")+((Q=+v.fractionGroupSize)?ue.replace(new RegExp("\\d{"+Q+"}\\B","g"),"$&"+(v.fractionGroupSeparator||"")):ue):ne}return(v.prefix||"")+R+(v.suffix||"")},$.toFraction=function(C){var _,v,R,U,Y,J,H,Q,ie,ne,ue,ge,we=this,ve=we.c;if(C!=null&&(H=new z(C),!H.isInteger()&&(H.c||H.s!==1)||H.lt(G)))throw Error(o+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+oe(H));if(!ve)return new z(we);for(_=new z(G),ie=v=new z(G),R=Q=new z(G),ge=m(ve),Y=_.e=ge.length-we.e-1,_.c[0]=f[(J=Y%u)<0?u+J:J],C=!C||H.comparedTo(_)>0?Y>0?_:ie:H,J=F,F=1/0,H=new z(ge),Q.c[0]=0;ne=B(H,_,0,1),U=v.plus(ne.times(R)),U.comparedTo(C)!=1;)v=R,R=U,ie=Q.plus(ne.times(U=ie)),Q=U,_=H.minus(ne.times(U=_)),H=U;return U=B(C.minus(v),R,0,1),Q=Q.plus(U.times(ie)),v=v.plus(U.times(R)),Q.s=ie.s=we.s,Y=Y*2,ue=B(ie,R,Y,L).minus(we).abs().comparedTo(B(Q,v,Y,L).minus(we).abs())<1?[ie,R]:[Q,v],F=J,ue},$.toNumber=function(){return+oe(this)},$.toPrecision=function(C,_){return C!=null&&S(C,1,d),ce(this,C,_,2)},$.toString=function(C){var _,v=this,R=v.s,U=v.e;return U===null?R?(_="Infinity",R<0&&(_="-"+_)):_="NaN":(C==null?_=U<=j||U>=T?x(m(v.c),U):I(m(v.c),U,"0"):C===10&&le?(v=re(new z(v),q+U+1,L),_=I(m(v.c),v.e,"0")):(S(C,2,te.length,"Base"),_=P(I(m(v.c),U,"0"),10,C,R,!0)),R<0&&v.c[0]&&(_="-"+_)),_},$.valueOf=$.toJSON=function(){return oe(this)},$._isBigNumber=!0,A!=null&&z.set(A),z}function g(A){var B=A|0;return A>0||A===B?B:B-1}function m(A){for(var B,P,N=1,$=A.length,G=A[0]+"";N<$;){for(B=A[N++]+"",P=u-B.length;P--;B="0"+B);G+=B}for($=G.length;G.charCodeAt(--$)===48;);return G.slice(0,$+1||1)}function y(A,B){var P,N,$=A.c,G=B.c,q=A.s,L=B.s,j=A.e,T=B.e;if(!q||!L)return null;if(P=$&&!$[0],N=G&&!G[0],P||N)return P?N?0:-L:q;if(q!=L)return q;if(P=q<0,N=j==T,!$||!G)return N?0:!$^P?1:-1;if(!N)return j>T^P?1:-1;for(L=(j=$.length)<(T=G.length)?j:T,q=0;q<L;q++)if($[q]!=G[q])return $[q]>G[q]^P?1:-1;return j==T?0:j>T^P?1:-1}function S(A,B,P,N){if(A<B||A>P||A!==s(A))throw Error(o+(N||"Argument")+(typeof A=="number"?A<B||A>P?" out of range: ":" not an integer: ":" not a primitive number: ")+String(A))}function b(A){var B=A.c.length-1;return g(A.e/u)==B&&A.c[B]%2!=0}function x(A,B){return(A.length>1?A.charAt(0)+"."+A.slice(1):A)+(B<0?"e":"e+")+B}function I(A,B,P){var N,$;if(B<0){for($=P+".";++B;$+=P);A=$+A}else if(N=A.length,++B>N){for($=P,B-=N;--B;$+=P);A+=$}else B<N&&(A=A.slice(0,B)+"."+A.slice(B));return A}r=h(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(yb)})(Ns)),Ns.exports}var Kt={},qe={},Me={},lh;function pu(){if(lh)return Me;lh=1;var t=Me&&Me.__createBinding||(Object.create?(function(d,h,g,m){m===void 0&&(m=g),Object.defineProperty(d,m,{enumerable:!0,get:function(){return h[g]}})}):(function(d,h,g,m){m===void 0&&(m=g),d[m]=h[g]})),e=Me&&Me.__setModuleDefault||(Object.create?(function(d,h){Object.defineProperty(d,"default",{enumerable:!0,value:h})}):function(d,h){d.default=h}),r=Me&&Me.__importStar||function(d){if(d&&d.__esModule)return d;var h={};if(d!=null)for(var g in d)g!=="default"&&Object.prototype.hasOwnProperty.call(d,g)&&t(h,d,g);return e(h,d),h},n=Me&&Me.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(Me,"__esModule",{value:!0}),Me.bigIntToHex=Me.byteArrayToHex=Me.boolToHex=Me.utf8ToHex=Me.zeroPadStringIfOddLength=Me.isPaddedHex=Me.numberToPaddedHex=void 0;const i=n(uo()),s=r(Lg());function o(d){let h;typeof d=="bigint"||typeof d=="number"?h=d:h=new i.default(d);const g=h.toString(16);return c(g)}Me.numberToPaddedHex=o;function a(d){d=d||"";let h=Buffer.from(d,"hex").toString("hex");return d.toUpperCase()==h.toUpperCase()}Me.isPaddedHex=a;function c(d){return d=d||"",d.length%2==1?"0"+d:d}Me.zeroPadStringIfOddLength=c;function u(d){const h=Buffer.from(d).toString("hex");return c(h)}Me.utf8ToHex=u;function l(d){return u(d.toString())}Me.boolToHex=l;function f(d){const h=Buffer.from(d).toString("hex");return c(h)}Me.byteArrayToHex=f;function p(d){return d==0?"":s.getHexMagnitudeOfBigInt(d)}return Me.bigIntToHex=p,Me}var fh;function Lg(){if(fh)return qe;fh=1;var t=qe&&qe.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(qe,"__esModule",{value:!0}),qe.prependByteToBuffer=qe.flipBufferBitsInPlace=qe.getHexMagnitudeOfBigInt=qe.bigIntToBuffer=qe.bufferToBigInt=qe.cloneBuffer=qe.isMsbZero=qe.isMsbOne=void 0;const e=t(uo()),r=pu();function n(f,p=0){return f[p]>>7==1}qe.isMsbOne=n;function i(f,p=0){return!n(f,p)}qe.isMsbZero=i;function s(f){let p=Buffer.alloc(f.length);return f.copy(p),p}qe.cloneBuffer=s;function o(f){let p=f.toString("hex");return new e.default(`0x${p}`,16)}qe.bufferToBigInt=o;function a(f){let p=c(f);return Buffer.from(p,"hex")}qe.bigIntToBuffer=a;function c(f){return f=new e.default(f),f?(f.isNegative()&&(f=f.multipliedBy(new e.default(-1))),r.numberToPaddedHex(f)):""}qe.getHexMagnitudeOfBigInt=c;function u(f){for(let p=0;p<f.length;p++)f[p]=~f[p]}qe.flipBufferBitsInPlace=u;function l(f,p){return Buffer.concat([Buffer.from([p]),f])}return qe.prependByteToBuffer=l,qe}var hh;function wb(){return hh||(hh=1,(function(t){var e=Kt&&Kt.__createBinding||(Object.create?(function(d,h,g,m){m===void 0&&(m=g),Object.defineProperty(d,m,{enumerable:!0,get:function(){return h[g]}})}):(function(d,h,g,m){m===void 0&&(m=g),d[m]=h[g]})),r=Kt&&Kt.__setModuleDefault||(Object.create?(function(d,h){Object.defineProperty(d,"default",{enumerable:!0,value:h})}):function(d,h){d.default=h}),n=Kt&&Kt.__importStar||function(d){if(d&&d.__esModule)return d;var h={};if(d!=null)for(var g in d)g!=="default"&&Object.prototype.hasOwnProperty.call(d,g)&&e(h,d,g);return r(h,d),h},i=Kt&&Kt.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(t,"__esModule",{value:!0}),t.bufferToHex=t.utf8ToHex=t.bigIntToHex=t.bigIntToBuffer=t.bufferToBigInt=t.stringToBuffer=void 0;const s=i(uo()),o=n(Lg()),a=n(pu());function c(d){return Buffer.from(d)}t.stringToBuffer=c;function u(d){return d.length==0?new s.default(0):o.bufferToBigInt(d)}t.bufferToBigInt=u;function l(d){return d==0?Buffer.from([]):o.bigIntToBuffer(d)}t.bigIntToBuffer=l;var f=pu();Object.defineProperty(t,"bigIntToHex",{enumerable:!0,get:function(){return f.bigIntToHex}}),Object.defineProperty(t,"utf8ToHex",{enumerable:!0,get:function(){return f.utf8ToHex}});function p(d){const h=d.toString("hex");return a.zeroPadStringIfOddLength(h)}t.bufferToHex=p})(Kt)),Kt}var di={},dh;function mb(){if(dh)return di;dh=1,Object.defineProperty(di,"__esModule",{value:!0}),di.LibraryConfig=void 0;class t{}return di.LibraryConfig=t,t.DefaultAddressHrp="erd",di}var me={},ph;function Mg(){return ph||(ph=1,Object.defineProperty(me,"__esModule",{value:!0}),me.EXTRA_GAS_LIMIT_FOR_RELAYED_TRANSACTIONS=me.EXTRA_GAS_LIMIT_FOR_GUARDED_TRANSACTIONS=me.EGLD_IDENTIFIER_FOR_MULTI_ESDTNFT_TRANSFER=me.UNKNOWN_SIGNER=me.SDK_JS_SIGNER=me.METACHAIN_ID=me.WasmVirtualMachine=me.CURRENT_NUMBER_OF_SHARDS_WITHOUT_META=me.HEX_TRANSACTION_HASH_LENGTH=me.MESSAGE_PREFIX=me.DEFAULT_MESSAGE_VERSION=me.STAKING_SMART_CONTRACT_ADDRESS_HEX=me.GOVERNANCE_CONTRACT_ADDRESS_HEX=me.ESDT_CONTRACT_ADDRESS_HEX=me.DELEGATION_MANAGER_SC_ADDRESS_HEX=me.CONTRACT_DEPLOY_ADDRESS_HEX=me.VM_TYPE_WASM_VM=me.ARGUMENTS_SEPARATOR=me.ESDT_TRANSFER_VALUE=me.MULTI_ESDTNFT_TRANSFER_FUNCTION_NAME=me.ESDTNFT_TRANSFER_FUNCTION_NAME=me.ESDT_TRANSFER_FUNCTION_NAME=me.ESDT_TRANSFER_GAS_LIMIT=me.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS=me.TRANSACTION_VERSION_DEFAULT=me.TRANSACTION_OPTIONS_TX_GUARDED=me.TRANSACTION_OPTIONS_TX_HASH_SIGN=me.TRANSACTION_OPTIONS_DEFAULT=me.TRANSACTION_MIN_GAS_PRICE=void 0,me.TRANSACTION_MIN_GAS_PRICE=1e9,me.TRANSACTION_OPTIONS_DEFAULT=0,me.TRANSACTION_OPTIONS_TX_HASH_SIGN=1,me.TRANSACTION_OPTIONS_TX_GUARDED=2,me.TRANSACTION_VERSION_DEFAULT=2,me.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS=2,me.ESDT_TRANSFER_GAS_LIMIT=5e5,me.ESDT_TRANSFER_FUNCTION_NAME="ESDTTransfer",me.ESDTNFT_TRANSFER_FUNCTION_NAME="ESDTNFTTransfer",me.MULTI_ESDTNFT_TRANSFER_FUNCTION_NAME="MultiESDTNFTTransfer",me.ESDT_TRANSFER_VALUE="0",me.ARGUMENTS_SEPARATOR="@",me.VM_TYPE_WASM_VM=new Uint8Array([5,0]),me.CONTRACT_DEPLOY_ADDRESS_HEX="0000000000000000000000000000000000000000000000000000000000000000",me.DELEGATION_MANAGER_SC_ADDRESS_HEX="000000000000000000010000000000000000000000000000000000000004ffff",me.ESDT_CONTRACT_ADDRESS_HEX="000000000000000000010000000000000000000000000000000000000002ffff",me.GOVERNANCE_CONTRACT_ADDRESS_HEX="000000000000000000010000000000000000000000000000000000000003ffff",me.STAKING_SMART_CONTRACT_ADDRESS_HEX="000000000000000000010000000000000000000000000000000000000001ffff",me.DEFAULT_MESSAGE_VERSION=1,me.MESSAGE_PREFIX=`Elrond Signed Message:
`,me.HEX_TRANSACTION_HASH_LENGTH=64,me.CURRENT_NUMBER_OF_SHARDS_WITHOUT_META=3,me.WasmVirtualMachine="0500",me.METACHAIN_ID=4294967295,me.SDK_JS_SIGNER="sdk-js",me.UNKNOWN_SIGNER="unknown",me.EGLD_IDENTIFIER_FOR_MULTI_ESDTNFT_TRANSFER="EGLD-000000",me.EXTRA_GAS_LIMIT_FOR_GUARDED_TRANSACTIONS=5e4,me.EXTRA_GAS_LIMIT_FOR_RELAYED_TRANSACTIONS=5e4),me}var he={},gh;function bb(){if(gh)return he;gh=1,Object.defineProperty(he,"__esModule",{value:!0}),he.ErrEstimateTransactionCost=he.ErrGasLimitCannotBeEstimated=he.ExpectedAccountConditionNotReachedError=he.ErrInvalidNetworkProviderKind=he.ErrContractQuery=he.ErrNetworkProvider=he.ErrBadAddress=he.ErrSignerCannotSign=he.ErrBadPEM=he.ErrBadMnemonicEntropy=he.ErrWrongMnemonic=he.ErrSmartContractQuery=he.ErrParseTransactionOutcome=he.ErrInvalidInnerTransaction=he.ErrBadUsage=he.ErrInvalidTokenIdentifier=he.ErrIsCompletedFieldIsMissingOnTransaction=he.ErrNotImplemented=he.ErrContractInteraction=he.ErrCodec=he.ErrCannotParseTransactionOutcome=he.ErrCannotParseContractResults=he.ErrMissingFieldOnEnum=he.ErrMissingFieldOnStruct=he.ErrTypingSystem=he.ErrMock=he.ErrContractHasNoAddress=he.ErrContract=he.ErrExpectedTransactionEventsNotFound=he.ErrExpectedTransactionStatusNotReached=he.ErrTransactionWatcherTimeout=he.ErrAsyncTimerAborted=he.ErrAsyncTimerAlreadyRunning=he.ErrInvalidFunctionName=he.ErrSignatureCannotCreate=he.ErrTransactionOptionsInvalid=he.ErrTransactionVersionInvalid=he.ErrNonceInvalid=he.ErrNotEnoughGas=he.ErrAddressEmpty=he.ErrAddressBadHrp=he.ErrAddressCannotCreate=he.ErrUnexpectedCondition=he.ErrInvariantFailed=he.ErrBadType=he.ErrUnsupportedOperation=he.ErrInvalidArgument=he.Err=void 0;class t extends Error{constructor(R,U){super(R),this.inner=void 0,this.inner=U}summary(){const R=[];R.push({name:this.name,message:this.message});let U=this.inner;for(;U;)R.push({name:U.name,message:U.message}),U=U.inner;return R}}he.Err=t;class e extends t{constructor(R,U){super(`Invalid argument: ${R}`,U)}}he.ErrInvalidArgument=e;class r extends t{constructor(R,U="not specified"){super(`Operation "${R}" not supported. Reason: ${U}`)}}he.ErrUnsupportedOperation=r;class n extends t{constructor(R,U,Y){super(`Bad type of "${R}": ${Y}. Expected type: ${U}`)}}he.ErrBadType=n;class i extends t{constructor(R){super(`Invariant failed: [${R}]`)}}he.ErrInvariantFailed=i;class s extends t{constructor(R){super(`Unexpected condition: [${R}]`)}}he.ErrUnexpectedCondition=s;class o extends t{constructor(R,U){const Y=`Cannot create address from: ${R}`;super(Y,U)}}he.ErrAddressCannotCreate=o;class a extends t{constructor(R,U){super(`Wrong address HRP. Expected: ${R}, got ${U}`)}}he.ErrAddressBadHrp=a;class c extends t{constructor(){super("Address is empty")}}he.ErrAddressEmpty=c;class u extends t{constructor(R){super(`Not enough gas provided: ${R}`)}}he.ErrNotEnoughGas=u;class l extends t{constructor(R){super(`Invalid nonce: ${R}`)}}he.ErrNonceInvalid=l;class f extends t{constructor(R){super(`Invalid transaction version: ${R}`)}}he.ErrTransactionVersionInvalid=f;class p extends t{constructor(R){super(`Invalid transaction options: ${R}`)}}he.ErrTransactionOptionsInvalid=p;class d extends t{constructor(R,U){const Y=`Cannot create signature from: ${R}`;super(Y,U)}}he.ErrSignatureCannotCreate=d;class h extends t{constructor(){super("Invalid function name")}}he.ErrInvalidFunctionName=h;class g extends t{constructor(){super("Async timer already running")}}he.ErrAsyncTimerAlreadyRunning=g;class m extends t{constructor(){super("Async timer aborted")}}he.ErrAsyncTimerAborted=m;class y extends t{constructor(){super("TransactionWatcher has timed out")}}he.ErrTransactionWatcherTimeout=y;class S extends t{constructor(){super("Expected transaction status not reached")}}he.ErrExpectedTransactionStatusNotReached=S;class b extends t{constructor(){super("Expected transaction events not found")}}he.ErrExpectedTransactionEventsNotFound=b;class x extends t{constructor(R){super(R)}}he.ErrContract=x;class I extends x{constructor(){super(`
The smart contract has no address set. Make sure you provide the address in the constructor, or call setAddress() appropriately.
If you need to recompute the address of the contract, make use of SmartContract.computeAddress() (static method).
`)}}he.ErrContractHasNoAddress=I;class A extends t{constructor(R){super(R)}}he.ErrMock=A;class B extends t{constructor(R){super(R)}}he.ErrTypingSystem=B;class P extends t{constructor(R,U){super(`field ${R} does not exist on struct ${U}`)}}he.ErrMissingFieldOnStruct=P;class N extends t{constructor(R,U){super(`field ${R} does not exist on enum ${U}`)}}he.ErrMissingFieldOnEnum=N;class $ extends t{constructor(R){super(`cannot parse contract results: ${R}`)}}he.ErrCannotParseContractResults=$;class G extends t{constructor(R,U){super(`cannot parse outcome of transaction ${R}: ${U}`)}}he.ErrCannotParseTransactionOutcome=G;class q extends t{constructor(R){super(R)}}he.ErrCodec=q;class L extends t{constructor(R){super(R)}}he.ErrContractInteraction=L;class j extends t{constructor(){super("Method not yet implemented")}}he.ErrNotImplemented=j;class T extends t{constructor(){super("The transaction watcher requires the `isCompleted` property to be defined on the transaction object. Perhaps you've used the sdk-network-provider's `ProxyNetworkProvider.getTransaction()` and in that case you should also pass `withProcessStatus=true`.")}}he.ErrIsCompletedFieldIsMissingOnTransaction=T;class D extends t{constructor(R){super(R)}}he.ErrInvalidTokenIdentifier=D;class F extends t{constructor(R){super(R)}}he.ErrBadUsage=F;class K extends t{constructor(R){super(R)}}he.ErrInvalidInnerTransaction=K;class k extends t{constructor(R){super(R)}}he.ErrParseTransactionOutcome=k;class X extends t{constructor(R,U){super(U),this.returnCode=R}}he.ErrSmartContractQuery=X;class ee extends t{constructor(){super("Wrong mnemonic format")}}he.ErrWrongMnemonic=ee;class te extends t{constructor(R){super("Bad mnemonic entropy",R)}}he.ErrBadMnemonicEntropy=te;class le extends t{constructor(R){super(R?`Bad PEM: ${R}`:"Bad PEM")}}he.ErrBadPEM=le;class z extends t{constructor(R){super("Cannot sign",R)}}he.ErrSignerCannotSign=z;class ce extends t{constructor(R,U){super(`Bad address: ${R}`,U)}}he.ErrBadAddress=ce;class W extends t{constructor(R,U,Y){const J=`Request error on url [${R}]: [${U}]`;super(J,Y)}}he.ErrNetworkProvider=W;class V extends t{constructor(R){super(R.message.replace("executeQuery:",""))}}he.ErrContractQuery=V;class re extends t{constructor(){super("Invalid network provider kind. Choose between `api` and `proxy`.")}}he.ErrInvalidNetworkProviderKind=re;class oe extends t{constructor(){super("The expected account condition was not reached.")}}he.ExpectedAccountConditionNotReachedError=oe;class C extends t{constructor(R){super(`Failed to estimate gas limit: [${R}]`,R)}}he.ErrGasLimitCannotBeEstimated=C;class _ extends t{constructor(R){super(R)}}return he.ErrEstimateTransactionCost=_,he}var ds={exports:{}},ps={exports:{}},yh;function Il(){if(yh)return ps.exports;yh=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(I,A,B){return Function.prototype.apply.call(I,A,B)},r;t&&typeof t.ownKeys=="function"?r=t.ownKeys:Object.getOwnPropertySymbols?r=function(I){return Object.getOwnPropertyNames(I).concat(Object.getOwnPropertySymbols(I))}:r=function(I){return Object.getOwnPropertyNames(I)};function n(x){console&&console.warn&&console.warn(x)}var i=Number.isNaN||function(I){return I!==I};function s(){s.init.call(this)}ps.exports=s,ps.exports.once=y,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(x){if(typeof x!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof x)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(x){if(typeof x!="number"||x<0||i(x))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+x+".");o=x}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(I){if(typeof I!="number"||I<0||i(I))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+I+".");return this._maxListeners=I,this};function c(x){return x._maxListeners===void 0?s.defaultMaxListeners:x._maxListeners}s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(I){for(var A=[],B=1;B<arguments.length;B++)A.push(arguments[B]);var P=I==="error",N=this._events;if(N!==void 0)P=P&&N.error===void 0;else if(!P)return!1;if(P){var $;if(A.length>0&&($=A[0]),$ instanceof Error)throw $;var G=new Error("Unhandled error."+($?" ("+$.message+")":""));throw G.context=$,G}var q=N[I];if(q===void 0)return!1;if(typeof q=="function")e(q,this,A);else for(var L=q.length,j=h(q,L),B=0;B<L;++B)e(j[B],this,A);return!0};function u(x,I,A,B){var P,N,$;if(a(A),N=x._events,N===void 0?(N=x._events=Object.create(null),x._eventsCount=0):(N.newListener!==void 0&&(x.emit("newListener",I,A.listener?A.listener:A),N=x._events),$=N[I]),$===void 0)$=N[I]=A,++x._eventsCount;else if(typeof $=="function"?$=N[I]=B?[A,$]:[$,A]:B?$.unshift(A):$.push(A),P=c(x),P>0&&$.length>P&&!$.warned){$.warned=!0;var G=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");G.name="MaxListenersExceededWarning",G.emitter=x,G.type=I,G.count=$.length,n(G)}return x}s.prototype.addListener=function(I,A){return u(this,I,A,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(I,A){return u(this,I,A,!0)};function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(x,I,A){var B={fired:!1,wrapFn:void 0,target:x,type:I,listener:A},P=l.bind(B);return P.listener=A,B.wrapFn=P,P}s.prototype.once=function(I,A){return a(A),this.on(I,f(this,I,A)),this},s.prototype.prependOnceListener=function(I,A){return a(A),this.prependListener(I,f(this,I,A)),this},s.prototype.removeListener=function(I,A){var B,P,N,$,G;if(a(A),P=this._events,P===void 0)return this;if(B=P[I],B===void 0)return this;if(B===A||B.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete P[I],P.removeListener&&this.emit("removeListener",I,B.listener||A));else if(typeof B!="function"){for(N=-1,$=B.length-1;$>=0;$--)if(B[$]===A||B[$].listener===A){G=B[$].listener,N=$;break}if(N<0)return this;N===0?B.shift():g(B,N),B.length===1&&(P[I]=B[0]),P.removeListener!==void 0&&this.emit("removeListener",I,G||A)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(I){var A,B,P;if(B=this._events,B===void 0)return this;if(B.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):B[I]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete B[I]),this;if(arguments.length===0){var N=Object.keys(B),$;for(P=0;P<N.length;++P)$=N[P],$!=="removeListener"&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=B[I],typeof A=="function")this.removeListener(I,A);else if(A!==void 0)for(P=A.length-1;P>=0;P--)this.removeListener(I,A[P]);return this};function p(x,I,A){var B=x._events;if(B===void 0)return[];var P=B[I];return P===void 0?[]:typeof P=="function"?A?[P.listener||P]:[P]:A?m(P):h(P,P.length)}s.prototype.listeners=function(I){return p(this,I,!0)},s.prototype.rawListeners=function(I){return p(this,I,!1)},s.listenerCount=function(x,I){return typeof x.listenerCount=="function"?x.listenerCount(I):d.call(x,I)},s.prototype.listenerCount=d;function d(x){var I=this._events;if(I!==void 0){var A=I[x];if(typeof A=="function")return 1;if(A!==void 0)return A.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function h(x,I){for(var A=new Array(I),B=0;B<I;++B)A[B]=x[B];return A}function g(x,I){for(;I+1<x.length;I++)x[I]=x[I+1];x.pop()}function m(x){for(var I=new Array(x.length),A=0;A<I.length;++A)I[A]=x[A].listener||x[A];return I}function y(x,I){return new Promise(function(A,B){function P($){x.removeListener(I,N),B($)}function N(){typeof x.removeListener=="function"&&x.removeListener("error",P),A([].slice.call(arguments))}b(x,I,N,{once:!0}),I!=="error"&&S(x,P,{once:!0})})}function S(x,I,A){typeof x.on=="function"&&b(x,"error",I,A)}function b(x,I,A,B){if(typeof x.on=="function")B.once?x.once(I,A):x.on(I,A);else if(typeof x.addEventListener=="function")x.addEventListener(I,function P(N){B.once&&x.removeEventListener(I,P),A(N)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof x)}return ps.exports}var Ga,wh;function $g(){return wh||(wh=1,Ga=Il().EventEmitter),Ga}var Ya={},pi={},mh;function Eb(){if(mh)return pi;mh=1,pi.byteLength=a,pi.toByteArray=u,pi.fromByteArray=p;for(var t=[],e=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,s=n.length;i<s;++i)t[i]=n[i],e[n.charCodeAt(i)]=i;e[45]=62,e[95]=63;function o(d){var h=d.length;if(h%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=d.indexOf("=");g===-1&&(g=h);var m=g===h?0:4-g%4;return[g,m]}function a(d){var h=o(d),g=h[0],m=h[1];return(g+m)*3/4-m}function c(d,h,g){return(h+g)*3/4-g}function u(d){var h,g=o(d),m=g[0],y=g[1],S=new r(c(d,m,y)),b=0,x=y>0?m-4:m,I;for(I=0;I<x;I+=4)h=e[d.charCodeAt(I)]<<18|e[d.charCodeAt(I+1)]<<12|e[d.charCodeAt(I+2)]<<6|e[d.charCodeAt(I+3)],S[b++]=h>>16&255,S[b++]=h>>8&255,S[b++]=h&255;return y===2&&(h=e[d.charCodeAt(I)]<<2|e[d.charCodeAt(I+1)]>>4,S[b++]=h&255),y===1&&(h=e[d.charCodeAt(I)]<<10|e[d.charCodeAt(I+1)]<<4|e[d.charCodeAt(I+2)]>>2,S[b++]=h>>8&255,S[b++]=h&255),S}function l(d){return t[d>>18&63]+t[d>>12&63]+t[d>>6&63]+t[d&63]}function f(d,h,g){for(var m,y=[],S=h;S<g;S+=3)m=(d[S]<<16&16711680)+(d[S+1]<<8&65280)+(d[S+2]&255),y.push(l(m));return y.join("")}function p(d){for(var h,g=d.length,m=g%3,y=[],S=16383,b=0,x=g-m;b<x;b+=S)y.push(f(d,b,b+S>x?x:b+S));return m===1?(h=d[g-1],y.push(t[h>>2]+t[h<<4&63]+"==")):m===2&&(h=(d[g-2]<<8)+d[g-1],y.push(t[h>>10]+t[h>>4&63]+t[h<<2&63]+"=")),y.join("")}return pi}var gs={};var bh;function vb(){return bh||(bh=1,gs.read=function(t,e,r,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,u=c>>1,l=-7,f=r?i-1:0,p=r?-1:1,d=t[e+f];for(f+=p,s=d&(1<<-l)-1,d>>=-l,l+=a;l>0;s=s*256+t[e+f],f+=p,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=n;l>0;o=o*256+t[e+f],f+=p,l-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-u}return(d?-1:1)*o*Math.pow(2,s-n)},gs.write=function(t,e,r,n,i,s){var o,a,c,u=s*8-i-1,l=(1<<u)-1,f=l>>1,p=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,h=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+f>=1?e+=p/c:e+=p*Math.pow(2,1-f),e*c>=2&&(o++,c/=2),o+f>=l?(a=0,o=l):o+f>=1?(a=(e*c-1)*Math.pow(2,i),o=o+f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[r+d]=a&255,d+=h,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[r+d]=o&255,d+=h,o/=256,u-=8);t[r+d-h]|=g*128}),gs}var Eh;function lo(){return Eh||(Eh=1,(function(t){const e=Eb(),r=vb(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=S,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const O=new Uint8Array(1),w={foo:function(){return 42}};return Object.setPrototypeOf(w,Uint8Array.prototype),Object.setPrototypeOf(O,w),O.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(O){if(O>i)throw new RangeError('The value "'+O+'" is invalid for option "size"');const w=new Uint8Array(O);return Object.setPrototypeOf(w,a.prototype),w}function a(O,w,E){if(typeof O=="number"){if(typeof w=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(O)}return c(O,w,E)}a.poolSize=8192;function c(O,w,E){if(typeof O=="string")return p(O,w);if(ArrayBuffer.isView(O))return h(O);if(O==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O);if(ge(O,ArrayBuffer)||O&&ge(O.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ge(O,SharedArrayBuffer)||O&&ge(O.buffer,SharedArrayBuffer)))return g(O,w,E);if(typeof O=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const M=O.valueOf&&O.valueOf();if(M!=null&&M!==O)return a.from(M,w,E);const Z=m(O);if(Z)return Z;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof O[Symbol.toPrimitive]=="function")return a.from(O[Symbol.toPrimitive]("string"),w,E);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O)}a.from=function(O,w,E){return c(O,w,E)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function u(O){if(typeof O!="number")throw new TypeError('"size" argument must be of type number');if(O<0)throw new RangeError('The value "'+O+'" is invalid for option "size"')}function l(O,w,E){return u(O),O<=0?o(O):w!==void 0?typeof E=="string"?o(O).fill(w,E):o(O).fill(w):o(O)}a.alloc=function(O,w,E){return l(O,w,E)};function f(O){return u(O),o(O<0?0:y(O)|0)}a.allocUnsafe=function(O){return f(O)},a.allocUnsafeSlow=function(O){return f(O)};function p(O,w){if((typeof w!="string"||w==="")&&(w="utf8"),!a.isEncoding(w))throw new TypeError("Unknown encoding: "+w);const E=b(O,w)|0;let M=o(E);const Z=M.write(O,w);return Z!==E&&(M=M.slice(0,Z)),M}function d(O){const w=O.length<0?0:y(O.length)|0,E=o(w);for(let M=0;M<w;M+=1)E[M]=O[M]&255;return E}function h(O){if(ge(O,Uint8Array)){const w=new Uint8Array(O);return g(w.buffer,w.byteOffset,w.byteLength)}return d(O)}function g(O,w,E){if(w<0||O.byteLength<w)throw new RangeError('"offset" is outside of buffer bounds');if(O.byteLength<w+(E||0))throw new RangeError('"length" is outside of buffer bounds');let M;return w===void 0&&E===void 0?M=new Uint8Array(O):E===void 0?M=new Uint8Array(O,w):M=new Uint8Array(O,w,E),Object.setPrototypeOf(M,a.prototype),M}function m(O){if(a.isBuffer(O)){const w=y(O.length)|0,E=o(w);return E.length===0||O.copy(E,0,0,w),E}if(O.length!==void 0)return typeof O.length!="number"||we(O.length)?o(0):d(O);if(O.type==="Buffer"&&Array.isArray(O.data))return d(O.data)}function y(O){if(O>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return O|0}function S(O){return+O!=O&&(O=0),a.alloc(+O)}a.isBuffer=function(w){return w!=null&&w._isBuffer===!0&&w!==a.prototype},a.compare=function(w,E){if(ge(w,Uint8Array)&&(w=a.from(w,w.offset,w.byteLength)),ge(E,Uint8Array)&&(E=a.from(E,E.offset,E.byteLength)),!a.isBuffer(w)||!a.isBuffer(E))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(w===E)return 0;let M=w.length,Z=E.length;for(let se=0,ae=Math.min(M,Z);se<ae;++se)if(w[se]!==E[se]){M=w[se],Z=E[se];break}return M<Z?-1:Z<M?1:0},a.isEncoding=function(w){switch(String(w).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(w,E){if(!Array.isArray(w))throw new TypeError('"list" argument must be an Array of Buffers');if(w.length===0)return a.alloc(0);let M;if(E===void 0)for(E=0,M=0;M<w.length;++M)E+=w[M].length;const Z=a.allocUnsafe(E);let se=0;for(M=0;M<w.length;++M){let ae=w[M];if(ge(ae,Uint8Array))se+ae.length>Z.length?(a.isBuffer(ae)||(ae=a.from(ae)),ae.copy(Z,se)):Uint8Array.prototype.set.call(Z,ae,se);else if(a.isBuffer(ae))ae.copy(Z,se);else throw new TypeError('"list" argument must be an Array of Buffers');se+=ae.length}return Z};function b(O,w){if(a.isBuffer(O))return O.length;if(ArrayBuffer.isView(O)||ge(O,ArrayBuffer))return O.byteLength;if(typeof O!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof O);const E=O.length,M=arguments.length>2&&arguments[2]===!0;if(!M&&E===0)return 0;let Z=!1;for(;;)switch(w){case"ascii":case"latin1":case"binary":return E;case"utf8":case"utf-8":return H(O).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E*2;case"hex":return E>>>1;case"base64":return ne(O).length;default:if(Z)return M?-1:H(O).length;w=(""+w).toLowerCase(),Z=!0}}a.byteLength=b;function x(O,w,E){let M=!1;if((w===void 0||w<0)&&(w=0),w>this.length||((E===void 0||E>this.length)&&(E=this.length),E<=0)||(E>>>=0,w>>>=0,E<=w))return"";for(O||(O="utf8");;)switch(O){case"hex":return k(this,w,E);case"utf8":case"utf-8":return j(this,w,E);case"ascii":return F(this,w,E);case"latin1":case"binary":return K(this,w,E);case"base64":return L(this,w,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,w,E);default:if(M)throw new TypeError("Unknown encoding: "+O);O=(O+"").toLowerCase(),M=!0}}a.prototype._isBuffer=!0;function I(O,w,E){const M=O[w];O[w]=O[E],O[E]=M}a.prototype.swap16=function(){const w=this.length;if(w%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let E=0;E<w;E+=2)I(this,E,E+1);return this},a.prototype.swap32=function(){const w=this.length;if(w%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let E=0;E<w;E+=4)I(this,E,E+3),I(this,E+1,E+2);return this},a.prototype.swap64=function(){const w=this.length;if(w%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let E=0;E<w;E+=8)I(this,E,E+7),I(this,E+1,E+6),I(this,E+2,E+5),I(this,E+3,E+4);return this},a.prototype.toString=function(){const w=this.length;return w===0?"":arguments.length===0?j(this,0,w):x.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(w){if(!a.isBuffer(w))throw new TypeError("Argument must be a Buffer");return this===w?!0:a.compare(this,w)===0},a.prototype.inspect=function(){let w="";const E=t.INSPECT_MAX_BYTES;return w=this.toString("hex",0,E).replace(/(.{2})/g,"$1 ").trim(),this.length>E&&(w+=" ... "),"<Buffer "+w+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(w,E,M,Z,se){if(ge(w,Uint8Array)&&(w=a.from(w,w.offset,w.byteLength)),!a.isBuffer(w))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof w);if(E===void 0&&(E=0),M===void 0&&(M=w?w.length:0),Z===void 0&&(Z=0),se===void 0&&(se=this.length),E<0||M>w.length||Z<0||se>this.length)throw new RangeError("out of range index");if(Z>=se&&E>=M)return 0;if(Z>=se)return-1;if(E>=M)return 1;if(E>>>=0,M>>>=0,Z>>>=0,se>>>=0,this===w)return 0;let ae=se-Z,Ee=M-E;const Ie=Math.min(ae,Ee),_e=this.slice(Z,se),be=w.slice(E,M);for(let De=0;De<Ie;++De)if(_e[De]!==be[De]){ae=_e[De],Ee=be[De];break}return ae<Ee?-1:Ee<ae?1:0};function A(O,w,E,M,Z){if(O.length===0)return-1;if(typeof E=="string"?(M=E,E=0):E>2147483647?E=2147483647:E<-2147483648&&(E=-2147483648),E=+E,we(E)&&(E=Z?0:O.length-1),E<0&&(E=O.length+E),E>=O.length){if(Z)return-1;E=O.length-1}else if(E<0)if(Z)E=0;else return-1;if(typeof w=="string"&&(w=a.from(w,M)),a.isBuffer(w))return w.length===0?-1:B(O,w,E,M,Z);if(typeof w=="number")return w=w&255,typeof Uint8Array.prototype.indexOf=="function"?Z?Uint8Array.prototype.indexOf.call(O,w,E):Uint8Array.prototype.lastIndexOf.call(O,w,E):B(O,[w],E,M,Z);throw new TypeError("val must be string, number or Buffer")}function B(O,w,E,M,Z){let se=1,ae=O.length,Ee=w.length;if(M!==void 0&&(M=String(M).toLowerCase(),M==="ucs2"||M==="ucs-2"||M==="utf16le"||M==="utf-16le")){if(O.length<2||w.length<2)return-1;se=2,ae/=2,Ee/=2,E/=2}function Ie(be,De){return se===1?be[De]:be.readUInt16BE(De*se)}let _e;if(Z){let be=-1;for(_e=E;_e<ae;_e++)if(Ie(O,_e)===Ie(w,be===-1?0:_e-be)){if(be===-1&&(be=_e),_e-be+1===Ee)return be*se}else be!==-1&&(_e-=_e-be),be=-1}else for(E+Ee>ae&&(E=ae-Ee),_e=E;_e>=0;_e--){let be=!0;for(let De=0;De<Ee;De++)if(Ie(O,_e+De)!==Ie(w,De)){be=!1;break}if(be)return _e}return-1}a.prototype.includes=function(w,E,M){return this.indexOf(w,E,M)!==-1},a.prototype.indexOf=function(w,E,M){return A(this,w,E,M,!0)},a.prototype.lastIndexOf=function(w,E,M){return A(this,w,E,M,!1)};function P(O,w,E,M){E=Number(E)||0;const Z=O.length-E;M?(M=Number(M),M>Z&&(M=Z)):M=Z;const se=w.length;M>se/2&&(M=se/2);let ae;for(ae=0;ae<M;++ae){const Ee=parseInt(w.substr(ae*2,2),16);if(we(Ee))return ae;O[E+ae]=Ee}return ae}function N(O,w,E,M){return ue(H(w,O.length-E),O,E,M)}function $(O,w,E,M){return ue(Q(w),O,E,M)}function G(O,w,E,M){return ue(ne(w),O,E,M)}function q(O,w,E,M){return ue(ie(w,O.length-E),O,E,M)}a.prototype.write=function(w,E,M,Z){if(E===void 0)Z="utf8",M=this.length,E=0;else if(M===void 0&&typeof E=="string")Z=E,M=this.length,E=0;else if(isFinite(E))E=E>>>0,isFinite(M)?(M=M>>>0,Z===void 0&&(Z="utf8")):(Z=M,M=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const se=this.length-E;if((M===void 0||M>se)&&(M=se),w.length>0&&(M<0||E<0)||E>this.length)throw new RangeError("Attempt to write outside buffer bounds");Z||(Z="utf8");let ae=!1;for(;;)switch(Z){case"hex":return P(this,w,E,M);case"utf8":case"utf-8":return N(this,w,E,M);case"ascii":case"latin1":case"binary":return $(this,w,E,M);case"base64":return G(this,w,E,M);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,w,E,M);default:if(ae)throw new TypeError("Unknown encoding: "+Z);Z=(""+Z).toLowerCase(),ae=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(O,w,E){return w===0&&E===O.length?e.fromByteArray(O):e.fromByteArray(O.slice(w,E))}function j(O,w,E){E=Math.min(O.length,E);const M=[];let Z=w;for(;Z<E;){const se=O[Z];let ae=null,Ee=se>239?4:se>223?3:se>191?2:1;if(Z+Ee<=E){let Ie,_e,be,De;switch(Ee){case 1:se<128&&(ae=se);break;case 2:Ie=O[Z+1],(Ie&192)===128&&(De=(se&31)<<6|Ie&63,De>127&&(ae=De));break;case 3:Ie=O[Z+1],_e=O[Z+2],(Ie&192)===128&&(_e&192)===128&&(De=(se&15)<<12|(Ie&63)<<6|_e&63,De>2047&&(De<55296||De>57343)&&(ae=De));break;case 4:Ie=O[Z+1],_e=O[Z+2],be=O[Z+3],(Ie&192)===128&&(_e&192)===128&&(be&192)===128&&(De=(se&15)<<18|(Ie&63)<<12|(_e&63)<<6|be&63,De>65535&&De<1114112&&(ae=De))}}ae===null?(ae=65533,Ee=1):ae>65535&&(ae-=65536,M.push(ae>>>10&1023|55296),ae=56320|ae&1023),M.push(ae),Z+=Ee}return D(M)}const T=4096;function D(O){const w=O.length;if(w<=T)return String.fromCharCode.apply(String,O);let E="",M=0;for(;M<w;)E+=String.fromCharCode.apply(String,O.slice(M,M+=T));return E}function F(O,w,E){let M="";E=Math.min(O.length,E);for(let Z=w;Z<E;++Z)M+=String.fromCharCode(O[Z]&127);return M}function K(O,w,E){let M="";E=Math.min(O.length,E);for(let Z=w;Z<E;++Z)M+=String.fromCharCode(O[Z]);return M}function k(O,w,E){const M=O.length;(!w||w<0)&&(w=0),(!E||E<0||E>M)&&(E=M);let Z="";for(let se=w;se<E;++se)Z+=ve[O[se]];return Z}function X(O,w,E){const M=O.slice(w,E);let Z="";for(let se=0;se<M.length-1;se+=2)Z+=String.fromCharCode(M[se]+M[se+1]*256);return Z}a.prototype.slice=function(w,E){const M=this.length;w=~~w,E=E===void 0?M:~~E,w<0?(w+=M,w<0&&(w=0)):w>M&&(w=M),E<0?(E+=M,E<0&&(E=0)):E>M&&(E=M),E<w&&(E=w);const Z=this.subarray(w,E);return Object.setPrototypeOf(Z,a.prototype),Z};function ee(O,w,E){if(O%1!==0||O<0)throw new RangeError("offset is not uint");if(O+w>E)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(w,E,M){w=w>>>0,E=E>>>0,M||ee(w,E,this.length);let Z=this[w],se=1,ae=0;for(;++ae<E&&(se*=256);)Z+=this[w+ae]*se;return Z},a.prototype.readUintBE=a.prototype.readUIntBE=function(w,E,M){w=w>>>0,E=E>>>0,M||ee(w,E,this.length);let Z=this[w+--E],se=1;for(;E>0&&(se*=256);)Z+=this[w+--E]*se;return Z},a.prototype.readUint8=a.prototype.readUInt8=function(w,E){return w=w>>>0,E||ee(w,1,this.length),this[w]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(w,E){return w=w>>>0,E||ee(w,2,this.length),this[w]|this[w+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(w,E){return w=w>>>0,E||ee(w,2,this.length),this[w]<<8|this[w+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(w,E){return w=w>>>0,E||ee(w,4,this.length),(this[w]|this[w+1]<<8|this[w+2]<<16)+this[w+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(w,E){return w=w>>>0,E||ee(w,4,this.length),this[w]*16777216+(this[w+1]<<16|this[w+2]<<8|this[w+3])},a.prototype.readBigUInt64LE=Se(function(w){w=w>>>0,R(w,"offset");const E=this[w],M=this[w+7];(E===void 0||M===void 0)&&U(w,this.length-8);const Z=E+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24,se=this[++w]+this[++w]*2**8+this[++w]*2**16+M*2**24;return BigInt(Z)+(BigInt(se)<<BigInt(32))}),a.prototype.readBigUInt64BE=Se(function(w){w=w>>>0,R(w,"offset");const E=this[w],M=this[w+7];(E===void 0||M===void 0)&&U(w,this.length-8);const Z=E*2**24+this[++w]*2**16+this[++w]*2**8+this[++w],se=this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+M;return(BigInt(Z)<<BigInt(32))+BigInt(se)}),a.prototype.readIntLE=function(w,E,M){w=w>>>0,E=E>>>0,M||ee(w,E,this.length);let Z=this[w],se=1,ae=0;for(;++ae<E&&(se*=256);)Z+=this[w+ae]*se;return se*=128,Z>=se&&(Z-=Math.pow(2,8*E)),Z},a.prototype.readIntBE=function(w,E,M){w=w>>>0,E=E>>>0,M||ee(w,E,this.length);let Z=E,se=1,ae=this[w+--Z];for(;Z>0&&(se*=256);)ae+=this[w+--Z]*se;return se*=128,ae>=se&&(ae-=Math.pow(2,8*E)),ae},a.prototype.readInt8=function(w,E){return w=w>>>0,E||ee(w,1,this.length),this[w]&128?(255-this[w]+1)*-1:this[w]},a.prototype.readInt16LE=function(w,E){w=w>>>0,E||ee(w,2,this.length);const M=this[w]|this[w+1]<<8;return M&32768?M|4294901760:M},a.prototype.readInt16BE=function(w,E){w=w>>>0,E||ee(w,2,this.length);const M=this[w+1]|this[w]<<8;return M&32768?M|4294901760:M},a.prototype.readInt32LE=function(w,E){return w=w>>>0,E||ee(w,4,this.length),this[w]|this[w+1]<<8|this[w+2]<<16|this[w+3]<<24},a.prototype.readInt32BE=function(w,E){return w=w>>>0,E||ee(w,4,this.length),this[w]<<24|this[w+1]<<16|this[w+2]<<8|this[w+3]},a.prototype.readBigInt64LE=Se(function(w){w=w>>>0,R(w,"offset");const E=this[w],M=this[w+7];(E===void 0||M===void 0)&&U(w,this.length-8);const Z=this[w+4]+this[w+5]*2**8+this[w+6]*2**16+(M<<24);return(BigInt(Z)<<BigInt(32))+BigInt(E+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24)}),a.prototype.readBigInt64BE=Se(function(w){w=w>>>0,R(w,"offset");const E=this[w],M=this[w+7];(E===void 0||M===void 0)&&U(w,this.length-8);const Z=(E<<24)+this[++w]*2**16+this[++w]*2**8+this[++w];return(BigInt(Z)<<BigInt(32))+BigInt(this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+M)}),a.prototype.readFloatLE=function(w,E){return w=w>>>0,E||ee(w,4,this.length),r.read(this,w,!0,23,4)},a.prototype.readFloatBE=function(w,E){return w=w>>>0,E||ee(w,4,this.length),r.read(this,w,!1,23,4)},a.prototype.readDoubleLE=function(w,E){return w=w>>>0,E||ee(w,8,this.length),r.read(this,w,!0,52,8)},a.prototype.readDoubleBE=function(w,E){return w=w>>>0,E||ee(w,8,this.length),r.read(this,w,!1,52,8)};function te(O,w,E,M,Z,se){if(!a.isBuffer(O))throw new TypeError('"buffer" argument must be a Buffer instance');if(w>Z||w<se)throw new RangeError('"value" argument is out of bounds');if(E+M>O.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(w,E,M,Z){if(w=+w,E=E>>>0,M=M>>>0,!Z){const Ee=Math.pow(2,8*M)-1;te(this,w,E,M,Ee,0)}let se=1,ae=0;for(this[E]=w&255;++ae<M&&(se*=256);)this[E+ae]=w/se&255;return E+M},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(w,E,M,Z){if(w=+w,E=E>>>0,M=M>>>0,!Z){const Ee=Math.pow(2,8*M)-1;te(this,w,E,M,Ee,0)}let se=M-1,ae=1;for(this[E+se]=w&255;--se>=0&&(ae*=256);)this[E+se]=w/ae&255;return E+M},a.prototype.writeUint8=a.prototype.writeUInt8=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,1,255,0),this[E]=w&255,E+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,2,65535,0),this[E]=w&255,this[E+1]=w>>>8,E+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,2,65535,0),this[E]=w>>>8,this[E+1]=w&255,E+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,4,4294967295,0),this[E+3]=w>>>24,this[E+2]=w>>>16,this[E+1]=w>>>8,this[E]=w&255,E+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,4,4294967295,0),this[E]=w>>>24,this[E+1]=w>>>16,this[E+2]=w>>>8,this[E+3]=w&255,E+4};function le(O,w,E,M,Z){v(w,M,Z,O,E,7);let se=Number(w&BigInt(4294967295));O[E++]=se,se=se>>8,O[E++]=se,se=se>>8,O[E++]=se,se=se>>8,O[E++]=se;let ae=Number(w>>BigInt(32)&BigInt(4294967295));return O[E++]=ae,ae=ae>>8,O[E++]=ae,ae=ae>>8,O[E++]=ae,ae=ae>>8,O[E++]=ae,E}function z(O,w,E,M,Z){v(w,M,Z,O,E,7);let se=Number(w&BigInt(4294967295));O[E+7]=se,se=se>>8,O[E+6]=se,se=se>>8,O[E+5]=se,se=se>>8,O[E+4]=se;let ae=Number(w>>BigInt(32)&BigInt(4294967295));return O[E+3]=ae,ae=ae>>8,O[E+2]=ae,ae=ae>>8,O[E+1]=ae,ae=ae>>8,O[E]=ae,E+8}a.prototype.writeBigUInt64LE=Se(function(w,E=0){return le(this,w,E,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Se(function(w,E=0){return z(this,w,E,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(w,E,M,Z){if(w=+w,E=E>>>0,!Z){const Ie=Math.pow(2,8*M-1);te(this,w,E,M,Ie-1,-Ie)}let se=0,ae=1,Ee=0;for(this[E]=w&255;++se<M&&(ae*=256);)w<0&&Ee===0&&this[E+se-1]!==0&&(Ee=1),this[E+se]=(w/ae>>0)-Ee&255;return E+M},a.prototype.writeIntBE=function(w,E,M,Z){if(w=+w,E=E>>>0,!Z){const Ie=Math.pow(2,8*M-1);te(this,w,E,M,Ie-1,-Ie)}let se=M-1,ae=1,Ee=0;for(this[E+se]=w&255;--se>=0&&(ae*=256);)w<0&&Ee===0&&this[E+se+1]!==0&&(Ee=1),this[E+se]=(w/ae>>0)-Ee&255;return E+M},a.prototype.writeInt8=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,1,127,-128),w<0&&(w=255+w+1),this[E]=w&255,E+1},a.prototype.writeInt16LE=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,2,32767,-32768),this[E]=w&255,this[E+1]=w>>>8,E+2},a.prototype.writeInt16BE=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,2,32767,-32768),this[E]=w>>>8,this[E+1]=w&255,E+2},a.prototype.writeInt32LE=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,4,2147483647,-2147483648),this[E]=w&255,this[E+1]=w>>>8,this[E+2]=w>>>16,this[E+3]=w>>>24,E+4},a.prototype.writeInt32BE=function(w,E,M){return w=+w,E=E>>>0,M||te(this,w,E,4,2147483647,-2147483648),w<0&&(w=4294967295+w+1),this[E]=w>>>24,this[E+1]=w>>>16,this[E+2]=w>>>8,this[E+3]=w&255,E+4},a.prototype.writeBigInt64LE=Se(function(w,E=0){return le(this,w,E,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Se(function(w,E=0){return z(this,w,E,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ce(O,w,E,M,Z,se){if(E+M>O.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("Index out of range")}function W(O,w,E,M,Z){return w=+w,E=E>>>0,Z||ce(O,w,E,4),r.write(O,w,E,M,23,4),E+4}a.prototype.writeFloatLE=function(w,E,M){return W(this,w,E,!0,M)},a.prototype.writeFloatBE=function(w,E,M){return W(this,w,E,!1,M)};function V(O,w,E,M,Z){return w=+w,E=E>>>0,Z||ce(O,w,E,8),r.write(O,w,E,M,52,8),E+8}a.prototype.writeDoubleLE=function(w,E,M){return V(this,w,E,!0,M)},a.prototype.writeDoubleBE=function(w,E,M){return V(this,w,E,!1,M)},a.prototype.copy=function(w,E,M,Z){if(!a.isBuffer(w))throw new TypeError("argument should be a Buffer");if(M||(M=0),!Z&&Z!==0&&(Z=this.length),E>=w.length&&(E=w.length),E||(E=0),Z>0&&Z<M&&(Z=M),Z===M||w.length===0||this.length===0)return 0;if(E<0)throw new RangeError("targetStart out of bounds");if(M<0||M>=this.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("sourceEnd out of bounds");Z>this.length&&(Z=this.length),w.length-E<Z-M&&(Z=w.length-E+M);const se=Z-M;return this===w&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(E,M,Z):Uint8Array.prototype.set.call(w,this.subarray(M,Z),E),se},a.prototype.fill=function(w,E,M,Z){if(typeof w=="string"){if(typeof E=="string"?(Z=E,E=0,M=this.length):typeof M=="string"&&(Z=M,M=this.length),Z!==void 0&&typeof Z!="string")throw new TypeError("encoding must be a string");if(typeof Z=="string"&&!a.isEncoding(Z))throw new TypeError("Unknown encoding: "+Z);if(w.length===1){const ae=w.charCodeAt(0);(Z==="utf8"&&ae<128||Z==="latin1")&&(w=ae)}}else typeof w=="number"?w=w&255:typeof w=="boolean"&&(w=Number(w));if(E<0||this.length<E||this.length<M)throw new RangeError("Out of range index");if(M<=E)return this;E=E>>>0,M=M===void 0?this.length:M>>>0,w||(w=0);let se;if(typeof w=="number")for(se=E;se<M;++se)this[se]=w;else{const ae=a.isBuffer(w)?w:a.from(w,Z),Ee=ae.length;if(Ee===0)throw new TypeError('The value "'+w+'" is invalid for argument "value"');for(se=0;se<M-E;++se)this[se+E]=ae[se%Ee]}return this};const re={};function oe(O,w,E){re[O]=class extends E{constructor(){super(),Object.defineProperty(this,"message",{value:w.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${O}]`,this.stack,delete this.name}get code(){return O}set code(Z){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Z,writable:!0})}toString(){return`${this.name} [${O}]: ${this.message}`}}}oe("ERR_BUFFER_OUT_OF_BOUNDS",function(O){return O?`${O} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),oe("ERR_INVALID_ARG_TYPE",function(O,w){return`The "${O}" argument must be of type number. Received type ${typeof w}`},TypeError),oe("ERR_OUT_OF_RANGE",function(O,w,E){let M=`The value of "${O}" is out of range.`,Z=E;return Number.isInteger(E)&&Math.abs(E)>2**32?Z=C(String(E)):typeof E=="bigint"&&(Z=String(E),(E>BigInt(2)**BigInt(32)||E<-(BigInt(2)**BigInt(32)))&&(Z=C(Z)),Z+="n"),M+=` It must be ${w}. Received ${Z}`,M},RangeError);function C(O){let w="",E=O.length;const M=O[0]==="-"?1:0;for(;E>=M+4;E-=3)w=`_${O.slice(E-3,E)}${w}`;return`${O.slice(0,E)}${w}`}function _(O,w,E){R(w,"offset"),(O[w]===void 0||O[w+E]===void 0)&&U(w,O.length-(E+1))}function v(O,w,E,M,Z,se){if(O>E||O<w){const ae=typeof w=="bigint"?"n":"";let Ee;throw w===0||w===BigInt(0)?Ee=`>= 0${ae} and < 2${ae} ** ${(se+1)*8}${ae}`:Ee=`>= -(2${ae} ** ${(se+1)*8-1}${ae}) and < 2 ** ${(se+1)*8-1}${ae}`,new re.ERR_OUT_OF_RANGE("value",Ee,O)}_(M,Z,se)}function R(O,w){if(typeof O!="number")throw new re.ERR_INVALID_ARG_TYPE(w,"number",O)}function U(O,w,E){throw Math.floor(O)!==O?(R(O,E),new re.ERR_OUT_OF_RANGE("offset","an integer",O)):w<0?new re.ERR_BUFFER_OUT_OF_BOUNDS:new re.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${w}`,O)}const Y=/[^+/0-9A-Za-z-_]/g;function J(O){if(O=O.split("=")[0],O=O.trim().replace(Y,""),O.length<2)return"";for(;O.length%4!==0;)O=O+"=";return O}function H(O,w){w=w||1/0;let E;const M=O.length;let Z=null;const se=[];for(let ae=0;ae<M;++ae){if(E=O.charCodeAt(ae),E>55295&&E<57344){if(!Z){if(E>56319){(w-=3)>-1&&se.push(239,191,189);continue}else if(ae+1===M){(w-=3)>-1&&se.push(239,191,189);continue}Z=E;continue}if(E<56320){(w-=3)>-1&&se.push(239,191,189),Z=E;continue}E=(Z-55296<<10|E-56320)+65536}else Z&&(w-=3)>-1&&se.push(239,191,189);if(Z=null,E<128){if((w-=1)<0)break;se.push(E)}else if(E<2048){if((w-=2)<0)break;se.push(E>>6|192,E&63|128)}else if(E<65536){if((w-=3)<0)break;se.push(E>>12|224,E>>6&63|128,E&63|128)}else if(E<1114112){if((w-=4)<0)break;se.push(E>>18|240,E>>12&63|128,E>>6&63|128,E&63|128)}else throw new Error("Invalid code point")}return se}function Q(O){const w=[];for(let E=0;E<O.length;++E)w.push(O.charCodeAt(E)&255);return w}function ie(O,w){let E,M,Z;const se=[];for(let ae=0;ae<O.length&&!((w-=2)<0);++ae)E=O.charCodeAt(ae),M=E>>8,Z=E%256,se.push(Z),se.push(M);return se}function ne(O){return e.toByteArray(J(O))}function ue(O,w,E,M){let Z;for(Z=0;Z<M&&!(Z+E>=w.length||Z>=O.length);++Z)w[Z+E]=O[Z];return Z}function ge(O,w){return O instanceof w||O!=null&&O.constructor!=null&&O.constructor.name!=null&&O.constructor.name===w.name}function we(O){return O!==O}const ve=(function(){const O="0123456789abcdef",w=new Array(256);for(let E=0;E<16;++E){const M=E*16;for(let Z=0;Z<16;++Z)w[M+Z]=O[E]+O[Z]}return w})();function Se(O){return typeof BigInt>"u"?Oe:O}function Oe(){throw new Error("BigInt not supported")}})(Ya)),Ya}const _b={},Sb=Object.freeze(Object.defineProperty({__proto__:null,default:_b},Symbol.toStringTag,{value:"Module"})),Fg=co(Sb);var Xa,vh;function xb(){if(vh)return Xa;vh=1;function t(h,g){var m=Object.keys(h);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(h);g&&(y=y.filter(function(S){return Object.getOwnPropertyDescriptor(h,S).enumerable})),m.push.apply(m,y)}return m}function e(h){for(var g=1;g<arguments.length;g++){var m=arguments[g]!=null?arguments[g]:{};g%2?t(Object(m),!0).forEach(function(y){r(h,y,m[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(m)):t(Object(m)).forEach(function(y){Object.defineProperty(h,y,Object.getOwnPropertyDescriptor(m,y))})}return h}function r(h,g,m){return g=o(g),g in h?Object.defineProperty(h,g,{value:m,enumerable:!0,configurable:!0,writable:!0}):h[g]=m,h}function n(h,g){if(!(h instanceof g))throw new TypeError("Cannot call a class as a function")}function i(h,g){for(var m=0;m<g.length;m++){var y=g[m];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(h,o(y.key),y)}}function s(h,g,m){return g&&i(h.prototype,g),Object.defineProperty(h,"prototype",{writable:!1}),h}function o(h){var g=a(h,"string");return typeof g=="symbol"?g:String(g)}function a(h,g){if(typeof h!="object"||h===null)return h;var m=h[Symbol.toPrimitive];if(m!==void 0){var y=m.call(h,g);if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(h)}var c=lo(),u=c.Buffer,l=Fg,f=l.inspect,p=f&&f.custom||"inspect";function d(h,g,m){u.prototype.copy.call(h,g,m)}return Xa=(function(){function h(){n(this,h),this.head=null,this.tail=null,this.length=0}return s(h,[{key:"push",value:function(m){var y={data:m,next:null};this.length>0?this.tail.next=y:this.head=y,this.tail=y,++this.length}},{key:"unshift",value:function(m){var y={data:m,next:this.head};this.length===0&&(this.tail=y),this.head=y,++this.length}},{key:"shift",value:function(){if(this.length!==0){var m=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,m}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(m){if(this.length===0)return"";for(var y=this.head,S=""+y.data;y=y.next;)S+=m+y.data;return S}},{key:"concat",value:function(m){if(this.length===0)return u.alloc(0);for(var y=u.allocUnsafe(m>>>0),S=this.head,b=0;S;)d(S.data,y,b),b+=S.data.length,S=S.next;return y}},{key:"consume",value:function(m,y){var S;return m<this.head.data.length?(S=this.head.data.slice(0,m),this.head.data=this.head.data.slice(m)):m===this.head.data.length?S=this.shift():S=y?this._getString(m):this._getBuffer(m),S}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(m){var y=this.head,S=1,b=y.data;for(m-=b.length;y=y.next;){var x=y.data,I=m>x.length?x.length:m;if(I===x.length?b+=x:b+=x.slice(0,m),m-=I,m===0){I===x.length?(++S,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=x.slice(I));break}++S}return this.length-=S,b}},{key:"_getBuffer",value:function(m){var y=u.allocUnsafe(m),S=this.head,b=1;for(S.data.copy(y),m-=S.data.length;S=S.next;){var x=S.data,I=m>x.length?x.length:m;if(x.copy(y,y.length-m,0,I),m-=I,m===0){I===x.length?(++b,S.next?this.head=S.next:this.head=this.tail=null):(this.head=S,S.data=x.slice(I));break}++b}return this.length-=b,y}},{key:p,value:function(m,y){return f(this,e(e({},y),{},{depth:0,customInspect:!1}))}}]),h})(),Xa}var Za,_h;function kg(){if(_h)return Za;_h=1;function t(o,a){var c=this,u=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return u||l?(a?a(o):o&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(i,this,o)):process.nextTick(i,this,o)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(o||null,function(f){!a&&f?c._writableState?c._writableState.errorEmitted?process.nextTick(r,c):(c._writableState.errorEmitted=!0,process.nextTick(e,c,f)):process.nextTick(e,c,f):a?(process.nextTick(r,c),a(f)):process.nextTick(r,c)}),this)}function e(o,a){i(o,a),r(o)}function r(o){o._writableState&&!o._writableState.emitClose||o._readableState&&!o._readableState.emitClose||o.emit("close")}function n(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function i(o,a){o.emit("error",a)}function s(o,a){var c=o._readableState,u=o._writableState;c&&c.autoDestroy||u&&u.autoDestroy?o.destroy(a):o.emit("error",a)}return Za={destroy:t,undestroy:n,errorOrDestroy:s},Za}var Ja={},Sh;function ci(){if(Sh)return Ja;Sh=1;function t(a,c){a.prototype=Object.create(c.prototype),a.prototype.constructor=a,a.__proto__=c}var e={};function r(a,c,u){u||(u=Error);function l(p,d,h){return typeof c=="string"?c:c(p,d,h)}var f=(function(p){t(d,p);function d(h,g,m){return p.call(this,l(h,g,m))||this}return d})(u);f.prototype.name=u.name,f.prototype.code=a,e[a]=f}function n(a,c){if(Array.isArray(a)){var u=a.length;return a=a.map(function(l){return String(l)}),u>2?"one of ".concat(c," ").concat(a.slice(0,u-1).join(", "),", or ")+a[u-1]:u===2?"one of ".concat(c," ").concat(a[0]," or ").concat(a[1]):"of ".concat(c," ").concat(a[0])}else return"of ".concat(c," ").concat(String(a))}function i(a,c,u){return a.substr(0,c.length)===c}function s(a,c,u){return(u===void 0||u>a.length)&&(u=a.length),a.substring(u-c.length,u)===c}function o(a,c,u){return typeof u!="number"&&(u=0),u+c.length>a.length?!1:a.indexOf(c,u)!==-1}return r("ERR_INVALID_OPT_VALUE",function(a,c){return'The value "'+c+'" is invalid for option "'+a+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(a,c,u){var l;typeof c=="string"&&i(c,"not ")?(l="must not be",c=c.replace(/^not /,"")):l="must be";var f;if(s(a," argument"))f="The ".concat(a," ").concat(l," ").concat(n(c,"type"));else{var p=o(a,".")?"property":"argument";f='The "'.concat(a,'" ').concat(p," ").concat(l," ").concat(n(c,"type"))}return f+=". Received type ".concat(typeof u),f},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Ja.codes=e,Ja}var Qa,xh;function qg(){if(xh)return Qa;xh=1;var t=ci().codes.ERR_INVALID_OPT_VALUE;function e(n,i,s){return n.highWaterMark!=null?n.highWaterMark:i?n[s]:null}function r(n,i,s,o){var a=e(i,o,s);if(a!=null){if(!(isFinite(a)&&Math.floor(a)===a)||a<0){var c=o?s:"highWaterMark";throw new t(c,a)}return Math.floor(a)}return n.objectMode?16:16*1024}return Qa={getHighWaterMark:r},Qa}var ys={exports:{}},Ih;function es(){return Ih||(Ih=1,typeof Object.create=="function"?ys.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ys.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}),ys.exports}var ec,Ah;function Ib(){if(Ah)return ec;Ah=1,ec=t;function t(r,n){if(e("noDeprecation"))return r;var i=!1;function s(){if(!i){if(e("throwDeprecation"))throw new Error(n);e("traceDeprecation")?console.trace(n):console.warn(n),i=!0}return r.apply(this,arguments)}return s}function e(r){try{if(!jt.localStorage)return!1}catch{return!1}var n=jt.localStorage[r];return n==null?!1:String(n).toLowerCase()==="true"}return ec}var tc,Th;function jg(){if(Th)return tc;Th=1,tc=P;function t(W){var V=this;this.next=null,this.entry=null,this.finish=function(){ce(V,W)}}var e;P.WritableState=A;var r={deprecate:Ib()},n=$g(),i=lo().Buffer,s=(typeof jt<"u"?jt:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function o(W){return i.from(W)}function a(W){return i.isBuffer(W)||W instanceof s}var c=kg(),u=qg(),l=u.getHighWaterMark,f=ci().codes,p=f.ERR_INVALID_ARG_TYPE,d=f.ERR_METHOD_NOT_IMPLEMENTED,h=f.ERR_MULTIPLE_CALLBACK,g=f.ERR_STREAM_CANNOT_PIPE,m=f.ERR_STREAM_DESTROYED,y=f.ERR_STREAM_NULL_VALUES,S=f.ERR_STREAM_WRITE_AFTER_END,b=f.ERR_UNKNOWN_ENCODING,x=c.errorOrDestroy;es()(P,n);function I(){}function A(W,V,re){e=e||ei(),W=W||{},typeof re!="boolean"&&(re=V instanceof e),this.objectMode=!!W.objectMode,re&&(this.objectMode=this.objectMode||!!W.writableObjectMode),this.highWaterMark=l(this,W,"writableHighWaterMark",re),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var oe=W.decodeStrings===!1;this.decodeStrings=!oe,this.defaultEncoding=W.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(C){D(V,C)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=W.emitClose!==!1,this.autoDestroy=!!W.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}A.prototype.getBuffer=function(){for(var V=this.bufferedRequest,re=[];V;)re.push(V),V=V.next;return re},(function(){try{Object.defineProperty(A.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var B;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(B=Function.prototype[Symbol.hasInstance],Object.defineProperty(P,Symbol.hasInstance,{value:function(V){return B.call(this,V)?!0:this!==P?!1:V&&V._writableState instanceof A}})):B=function(V){return V instanceof this};function P(W){e=e||ei();var V=this instanceof e;if(!V&&!B.call(P,this))return new P(W);this._writableState=new A(W,this,V),this.writable=!0,W&&(typeof W.write=="function"&&(this._write=W.write),typeof W.writev=="function"&&(this._writev=W.writev),typeof W.destroy=="function"&&(this._destroy=W.destroy),typeof W.final=="function"&&(this._final=W.final)),n.call(this)}P.prototype.pipe=function(){x(this,new g)};function N(W,V){var re=new S;x(W,re),process.nextTick(V,re)}function $(W,V,re,oe){var C;return re===null?C=new y:typeof re!="string"&&!V.objectMode&&(C=new p("chunk",["string","Buffer"],re)),C?(x(W,C),process.nextTick(oe,C),!1):!0}P.prototype.write=function(W,V,re){var oe=this._writableState,C=!1,_=!oe.objectMode&&a(W);return _&&!i.isBuffer(W)&&(W=o(W)),typeof V=="function"&&(re=V,V=null),_?V="buffer":V||(V=oe.defaultEncoding),typeof re!="function"&&(re=I),oe.ending?N(this,re):(_||$(this,oe,W,re))&&(oe.pendingcb++,C=q(this,oe,_,W,V,re)),C},P.prototype.cork=function(){this._writableState.corked++},P.prototype.uncork=function(){var W=this._writableState;W.corked&&(W.corked--,!W.writing&&!W.corked&&!W.bufferProcessing&&W.bufferedRequest&&k(this,W))},P.prototype.setDefaultEncoding=function(V){if(typeof V=="string"&&(V=V.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((V+"").toLowerCase())>-1))throw new b(V);return this._writableState.defaultEncoding=V,this},Object.defineProperty(P.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function G(W,V,re){return!W.objectMode&&W.decodeStrings!==!1&&typeof V=="string"&&(V=i.from(V,re)),V}Object.defineProperty(P.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function q(W,V,re,oe,C,_){if(!re){var v=G(V,oe,C);oe!==v&&(re=!0,C="buffer",oe=v)}var R=V.objectMode?1:oe.length;V.length+=R;var U=V.length<V.highWaterMark;if(U||(V.needDrain=!0),V.writing||V.corked){var Y=V.lastBufferedRequest;V.lastBufferedRequest={chunk:oe,encoding:C,isBuf:re,callback:_,next:null},Y?Y.next=V.lastBufferedRequest:V.bufferedRequest=V.lastBufferedRequest,V.bufferedRequestCount+=1}else L(W,V,!1,R,oe,C,_);return U}function L(W,V,re,oe,C,_,v){V.writelen=oe,V.writecb=v,V.writing=!0,V.sync=!0,V.destroyed?V.onwrite(new m("write")):re?W._writev(C,V.onwrite):W._write(C,_,V.onwrite),V.sync=!1}function j(W,V,re,oe,C){--V.pendingcb,re?(process.nextTick(C,oe),process.nextTick(le,W,V),W._writableState.errorEmitted=!0,x(W,oe)):(C(oe),W._writableState.errorEmitted=!0,x(W,oe),le(W,V))}function T(W){W.writing=!1,W.writecb=null,W.length-=W.writelen,W.writelen=0}function D(W,V){var re=W._writableState,oe=re.sync,C=re.writecb;if(typeof C!="function")throw new h;if(T(re),V)j(W,re,oe,V,C);else{var _=X(re)||W.destroyed;!_&&!re.corked&&!re.bufferProcessing&&re.bufferedRequest&&k(W,re),oe?process.nextTick(F,W,re,_,C):F(W,re,_,C)}}function F(W,V,re,oe){re||K(W,V),V.pendingcb--,oe(),le(W,V)}function K(W,V){V.length===0&&V.needDrain&&(V.needDrain=!1,W.emit("drain"))}function k(W,V){V.bufferProcessing=!0;var re=V.bufferedRequest;if(W._writev&&re&&re.next){var oe=V.bufferedRequestCount,C=new Array(oe),_=V.corkedRequestsFree;_.entry=re;for(var v=0,R=!0;re;)C[v]=re,re.isBuf||(R=!1),re=re.next,v+=1;C.allBuffers=R,L(W,V,!0,V.length,C,"",_.finish),V.pendingcb++,V.lastBufferedRequest=null,_.next?(V.corkedRequestsFree=_.next,_.next=null):V.corkedRequestsFree=new t(V),V.bufferedRequestCount=0}else{for(;re;){var U=re.chunk,Y=re.encoding,J=re.callback,H=V.objectMode?1:U.length;if(L(W,V,!1,H,U,Y,J),re=re.next,V.bufferedRequestCount--,V.writing)break}re===null&&(V.lastBufferedRequest=null)}V.bufferedRequest=re,V.bufferProcessing=!1}P.prototype._write=function(W,V,re){re(new d("_write()"))},P.prototype._writev=null,P.prototype.end=function(W,V,re){var oe=this._writableState;return typeof W=="function"?(re=W,W=null,V=null):typeof V=="function"&&(re=V,V=null),W!=null&&this.write(W,V),oe.corked&&(oe.corked=1,this.uncork()),oe.ending||z(this,oe,re),this},Object.defineProperty(P.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function X(W){return W.ending&&W.length===0&&W.bufferedRequest===null&&!W.finished&&!W.writing}function ee(W,V){W._final(function(re){V.pendingcb--,re&&x(W,re),V.prefinished=!0,W.emit("prefinish"),le(W,V)})}function te(W,V){!V.prefinished&&!V.finalCalled&&(typeof W._final=="function"&&!V.destroyed?(V.pendingcb++,V.finalCalled=!0,process.nextTick(ee,W,V)):(V.prefinished=!0,W.emit("prefinish")))}function le(W,V){var re=X(V);if(re&&(te(W,V),V.pendingcb===0&&(V.finished=!0,W.emit("finish"),V.autoDestroy))){var oe=W._readableState;(!oe||oe.autoDestroy&&oe.endEmitted)&&W.destroy()}return re}function z(W,V,re){V.ending=!0,le(W,V),re&&(V.finished?process.nextTick(re):W.once("finish",re)),V.ended=!0,W.writable=!1}function ce(W,V,re){var oe=W.entry;for(W.entry=null;oe;){var C=oe.callback;V.pendingcb--,C(re),oe=oe.next}V.corkedRequestsFree.next=W}return Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(V){this._writableState&&(this._writableState.destroyed=V)}}),P.prototype.destroy=c.destroy,P.prototype._undestroy=c.undestroy,P.prototype._destroy=function(W,V){V(W)},tc}var rc,Oh;function ei(){if(Oh)return rc;Oh=1;var t=Object.keys||function(u){var l=[];for(var f in u)l.push(f);return l};rc=o;var e=zg(),r=jg();es()(o,e);for(var n=t(r.prototype),i=0;i<n.length;i++){var s=n[i];o.prototype[s]||(o.prototype[s]=r.prototype[s])}function o(u){if(!(this instanceof o))return new o(u);e.call(this,u),r.call(this,u),this.allowHalfOpen=!0,u&&(u.readable===!1&&(this.readable=!1),u.writable===!1&&(this.writable=!1),u.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",a)))}Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function a(){this._writableState.ended||process.nextTick(c,this)}function c(u){u.end()}return Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(l){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=l,this._writableState.destroyed=l)}}),rc}var nc={},ws={exports:{}};var Ch;function Ab(){return Ch||(Ch=1,(function(t,e){var r=lo(),n=r.Buffer;function i(o,a){for(var c in o)a[c]=o[c]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(i(r,e),e.Buffer=s);function s(o,a,c){return n(o,a,c)}s.prototype=Object.create(n.prototype),i(n,s),s.from=function(o,a,c){if(typeof o=="number")throw new TypeError("Argument must not be a number");return n(o,a,c)},s.alloc=function(o,a,c){if(typeof o!="number")throw new TypeError("Argument must be a number");var u=n(o);return a!==void 0?typeof c=="string"?u.fill(a,c):u.fill(a):u.fill(0),u},s.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return n(o)},s.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(o)}})(ws,ws.exports)),ws.exports}var Rh;function Dh(){if(Rh)return nc;Rh=1;var t=Ab().Buffer,e=t.isEncoding||function(y){switch(y=""+y,y&&y.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(y){if(!y)return"utf8";for(var S;;)switch(y){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return y;default:if(S)return;y=(""+y).toLowerCase(),S=!0}}function n(y){var S=r(y);if(typeof S!="string"&&(t.isEncoding===e||!e(y)))throw new Error("Unknown encoding: "+y);return S||y}nc.StringDecoder=i;function i(y){this.encoding=n(y);var S;switch(this.encoding){case"utf16le":this.text=f,this.end=p,S=4;break;case"utf8":this.fillLast=c,S=4;break;case"base64":this.text=d,this.end=h,S=3;break;default:this.write=g,this.end=m;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(S)}i.prototype.write=function(y){if(y.length===0)return"";var S,b;if(this.lastNeed){if(S=this.fillLast(y),S===void 0)return"";b=this.lastNeed,this.lastNeed=0}else b=0;return b<y.length?S?S+this.text(y,b):this.text(y,b):S||""},i.prototype.end=l,i.prototype.text=u,i.prototype.fillLast=function(y){if(this.lastNeed<=y.length)return y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,y.length),this.lastNeed-=y.length};function s(y){return y<=127?0:y>>5===6?2:y>>4===14?3:y>>3===30?4:y>>6===2?-1:-2}function o(y,S,b){var x=S.length-1;if(x<b)return 0;var I=s(S[x]);return I>=0?(I>0&&(y.lastNeed=I-1),I):--x<b||I===-2?0:(I=s(S[x]),I>=0?(I>0&&(y.lastNeed=I-2),I):--x<b||I===-2?0:(I=s(S[x]),I>=0?(I>0&&(I===2?I=0:y.lastNeed=I-3),I):0))}function a(y,S,b){if((S[0]&192)!==128)return y.lastNeed=0,"ï¿½";if(y.lastNeed>1&&S.length>1){if((S[1]&192)!==128)return y.lastNeed=1,"ï¿½";if(y.lastNeed>2&&S.length>2&&(S[2]&192)!==128)return y.lastNeed=2,"ï¿½"}}function c(y){var S=this.lastTotal-this.lastNeed,b=a(this,y);if(b!==void 0)return b;if(this.lastNeed<=y.length)return y.copy(this.lastChar,S,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,S,0,y.length),this.lastNeed-=y.length}function u(y,S){var b=o(this,y,S);if(!this.lastNeed)return y.toString("utf8",S);this.lastTotal=b;var x=y.length-(b-this.lastNeed);return y.copy(this.lastChar,0,x),y.toString("utf8",S,x)}function l(y){var S=y&&y.length?this.write(y):"";return this.lastNeed?S+"ï¿½":S}function f(y,S){if((y.length-S)%2===0){var b=y.toString("utf16le",S);if(b){var x=b.charCodeAt(b.length-1);if(x>=55296&&x<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1],b.slice(0,-1)}return b}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=y[y.length-1],y.toString("utf16le",S,y.length-1)}function p(y){var S=y&&y.length?this.write(y):"";if(this.lastNeed){var b=this.lastTotal-this.lastNeed;return S+this.lastChar.toString("utf16le",0,b)}return S}function d(y,S){var b=(y.length-S)%3;return b===0?y.toString("base64",S):(this.lastNeed=3-b,this.lastTotal=3,b===1?this.lastChar[0]=y[y.length-1]:(this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1]),y.toString("base64",S,y.length-b))}function h(y){var S=y&&y.length?this.write(y):"";return this.lastNeed?S+this.lastChar.toString("base64",0,3-this.lastNeed):S}function g(y){return y.toString(this.encoding)}function m(y){return y&&y.length?this.write(y):""}return nc}var ic,Bh;function Al(){if(Bh)return ic;Bh=1;var t=ci().codes.ERR_STREAM_PREMATURE_CLOSE;function e(s){var o=!1;return function(){if(!o){o=!0;for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];s.apply(this,c)}}}function r(){}function n(s){return s.setHeader&&typeof s.abort=="function"}function i(s,o,a){if(typeof o=="function")return i(s,null,o);o||(o={}),a=e(a||r);var c=o.readable||o.readable!==!1&&s.readable,u=o.writable||o.writable!==!1&&s.writable,l=function(){s.writable||p()},f=s._writableState&&s._writableState.finished,p=function(){u=!1,f=!0,c||a.call(s)},d=s._readableState&&s._readableState.endEmitted,h=function(){c=!1,d=!0,u||a.call(s)},g=function(b){a.call(s,b)},m=function(){var b;if(c&&!d)return(!s._readableState||!s._readableState.ended)&&(b=new t),a.call(s,b);if(u&&!f)return(!s._writableState||!s._writableState.ended)&&(b=new t),a.call(s,b)},y=function(){s.req.on("finish",p)};return n(s)?(s.on("complete",p),s.on("abort",m),s.req?y():s.on("request",y)):u&&!s._writableState&&(s.on("end",l),s.on("close",l)),s.on("end",h),s.on("finish",p),o.error!==!1&&s.on("error",g),s.on("close",m),function(){s.removeListener("complete",p),s.removeListener("abort",m),s.removeListener("request",y),s.req&&s.req.removeListener("finish",p),s.removeListener("end",l),s.removeListener("close",l),s.removeListener("finish",p),s.removeListener("end",h),s.removeListener("error",g),s.removeListener("close",m)}}return ic=i,ic}var sc,Nh;function Tb(){if(Nh)return sc;Nh=1;var t;function e(b,x,I){return x=r(x),x in b?Object.defineProperty(b,x,{value:I,enumerable:!0,configurable:!0,writable:!0}):b[x]=I,b}function r(b){var x=n(b,"string");return typeof x=="symbol"?x:String(x)}function n(b,x){if(typeof b!="object"||b===null)return b;var I=b[Symbol.toPrimitive];if(I!==void 0){var A=I.call(b,x);if(typeof A!="object")return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(b)}var i=Al(),s=Symbol("lastResolve"),o=Symbol("lastReject"),a=Symbol("error"),c=Symbol("ended"),u=Symbol("lastPromise"),l=Symbol("handlePromise"),f=Symbol("stream");function p(b,x){return{value:b,done:x}}function d(b){var x=b[s];if(x!==null){var I=b[f].read();I!==null&&(b[u]=null,b[s]=null,b[o]=null,x(p(I,!1)))}}function h(b){process.nextTick(d,b)}function g(b,x){return function(I,A){b.then(function(){if(x[c]){I(p(void 0,!0));return}x[l](I,A)},A)}}var m=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((t={get stream(){return this[f]},next:function(){var x=this,I=this[a];if(I!==null)return Promise.reject(I);if(this[c])return Promise.resolve(p(void 0,!0));if(this[f].destroyed)return new Promise(function(N,$){process.nextTick(function(){x[a]?$(x[a]):N(p(void 0,!0))})});var A=this[u],B;if(A)B=new Promise(g(A,this));else{var P=this[f].read();if(P!==null)return Promise.resolve(p(P,!1));B=new Promise(this[l])}return this[u]=B,B}},e(t,Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var x=this;return new Promise(function(I,A){x[f].destroy(null,function(B){if(B){A(B);return}I(p(void 0,!0))})})}),t),m),S=function(x){var I,A=Object.create(y,(I={},e(I,f,{value:x,writable:!0}),e(I,s,{value:null,writable:!0}),e(I,o,{value:null,writable:!0}),e(I,a,{value:null,writable:!0}),e(I,c,{value:x._readableState.endEmitted,writable:!0}),e(I,l,{value:function(P,N){var $=A[f].read();$?(A[u]=null,A[s]=null,A[o]=null,P(p($,!1))):(A[s]=P,A[o]=N)},writable:!0}),I));return A[u]=null,i(x,function(B){if(B&&B.code!=="ERR_STREAM_PREMATURE_CLOSE"){var P=A[o];P!==null&&(A[u]=null,A[s]=null,A[o]=null,P(B)),A[a]=B;return}var N=A[s];N!==null&&(A[u]=null,A[s]=null,A[o]=null,N(p(void 0,!0))),A[c]=!0}),x.on("readable",h.bind(null,A)),A};return sc=S,sc}var oc,Ph;function Ob(){return Ph||(Ph=1,oc=function(){throw new Error("Readable.from is not available in the browser")}),oc}var ac,Uh;function zg(){if(Uh)return ac;Uh=1,ac=N;var t;N.ReadableState=P,Il().EventEmitter;var e=function(v,R){return v.listeners(R).length},r=$g(),n=lo().Buffer,i=(typeof jt<"u"?jt:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function s(_){return n.from(_)}function o(_){return n.isBuffer(_)||_ instanceof i}var a=Fg,c;a&&a.debuglog?c=a.debuglog("stream"):c=function(){};var u=xb(),l=kg(),f=qg(),p=f.getHighWaterMark,d=ci().codes,h=d.ERR_INVALID_ARG_TYPE,g=d.ERR_STREAM_PUSH_AFTER_EOF,m=d.ERR_METHOD_NOT_IMPLEMENTED,y=d.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,S,b,x;es()(N,r);var I=l.errorOrDestroy,A=["error","close","destroy","pause","resume"];function B(_,v,R){if(typeof _.prependListener=="function")return _.prependListener(v,R);!_._events||!_._events[v]?_.on(v,R):Array.isArray(_._events[v])?_._events[v].unshift(R):_._events[v]=[R,_._events[v]]}function P(_,v,R){t=t||ei(),_=_||{},typeof R!="boolean"&&(R=v instanceof t),this.objectMode=!!_.objectMode,R&&(this.objectMode=this.objectMode||!!_.readableObjectMode),this.highWaterMark=p(this,_,"readableHighWaterMark",R),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=_.emitClose!==!1,this.autoDestroy=!!_.autoDestroy,this.destroyed=!1,this.defaultEncoding=_.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,_.encoding&&(S||(S=Dh().StringDecoder),this.decoder=new S(_.encoding),this.encoding=_.encoding)}function N(_){if(t=t||ei(),!(this instanceof N))return new N(_);var v=this instanceof t;this._readableState=new P(_,this,v),this.readable=!0,_&&(typeof _.read=="function"&&(this._read=_.read),typeof _.destroy=="function"&&(this._destroy=_.destroy)),r.call(this)}Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(v){this._readableState&&(this._readableState.destroyed=v)}}),N.prototype.destroy=l.destroy,N.prototype._undestroy=l.undestroy,N.prototype._destroy=function(_,v){v(_)},N.prototype.push=function(_,v){var R=this._readableState,U;return R.objectMode?U=!0:typeof _=="string"&&(v=v||R.defaultEncoding,v!==R.encoding&&(_=n.from(_,v),v=""),U=!0),$(this,_,v,!1,U)},N.prototype.unshift=function(_){return $(this,_,null,!0,!1)};function $(_,v,R,U,Y){c("readableAddChunk",v);var J=_._readableState;if(v===null)J.reading=!1,D(_,J);else{var H;if(Y||(H=q(J,v)),H)I(_,H);else if(J.objectMode||v&&v.length>0)if(typeof v!="string"&&!J.objectMode&&Object.getPrototypeOf(v)!==n.prototype&&(v=s(v)),U)J.endEmitted?I(_,new y):G(_,J,v,!0);else if(J.ended)I(_,new g);else{if(J.destroyed)return!1;J.reading=!1,J.decoder&&!R?(v=J.decoder.write(v),J.objectMode||v.length!==0?G(_,J,v,!1):k(_,J)):G(_,J,v,!1)}else U||(J.reading=!1,k(_,J))}return!J.ended&&(J.length<J.highWaterMark||J.length===0)}function G(_,v,R,U){v.flowing&&v.length===0&&!v.sync?(v.awaitDrain=0,_.emit("data",R)):(v.length+=v.objectMode?1:R.length,U?v.buffer.unshift(R):v.buffer.push(R),v.needReadable&&F(_)),k(_,v)}function q(_,v){var R;return!o(v)&&typeof v!="string"&&v!==void 0&&!_.objectMode&&(R=new h("chunk",["string","Buffer","Uint8Array"],v)),R}N.prototype.isPaused=function(){return this._readableState.flowing===!1},N.prototype.setEncoding=function(_){S||(S=Dh().StringDecoder);var v=new S(_);this._readableState.decoder=v,this._readableState.encoding=this._readableState.decoder.encoding;for(var R=this._readableState.buffer.head,U="";R!==null;)U+=v.write(R.data),R=R.next;return this._readableState.buffer.clear(),U!==""&&this._readableState.buffer.push(U),this._readableState.length=U.length,this};var L=1073741824;function j(_){return _>=L?_=L:(_--,_|=_>>>1,_|=_>>>2,_|=_>>>4,_|=_>>>8,_|=_>>>16,_++),_}function T(_,v){return _<=0||v.length===0&&v.ended?0:v.objectMode?1:_!==_?v.flowing&&v.length?v.buffer.head.data.length:v.length:(_>v.highWaterMark&&(v.highWaterMark=j(_)),_<=v.length?_:v.ended?v.length:(v.needReadable=!0,0))}N.prototype.read=function(_){c("read",_),_=parseInt(_,10);var v=this._readableState,R=_;if(_!==0&&(v.emittedReadable=!1),_===0&&v.needReadable&&((v.highWaterMark!==0?v.length>=v.highWaterMark:v.length>0)||v.ended))return c("read: emitReadable",v.length,v.ended),v.length===0&&v.ended?re(this):F(this),null;if(_=T(_,v),_===0&&v.ended)return v.length===0&&re(this),null;var U=v.needReadable;c("need readable",U),(v.length===0||v.length-_<v.highWaterMark)&&(U=!0,c("length less than watermark",U)),v.ended||v.reading?(U=!1,c("reading or ended",U)):U&&(c("do read"),v.reading=!0,v.sync=!0,v.length===0&&(v.needReadable=!0),this._read(v.highWaterMark),v.sync=!1,v.reading||(_=T(R,v)));var Y;return _>0?Y=V(_,v):Y=null,Y===null?(v.needReadable=v.length<=v.highWaterMark,_=0):(v.length-=_,v.awaitDrain=0),v.length===0&&(v.ended||(v.needReadable=!0),R!==_&&v.ended&&re(this)),Y!==null&&this.emit("data",Y),Y};function D(_,v){if(c("onEofChunk"),!v.ended){if(v.decoder){var R=v.decoder.end();R&&R.length&&(v.buffer.push(R),v.length+=v.objectMode?1:R.length)}v.ended=!0,v.sync?F(_):(v.needReadable=!1,v.emittedReadable||(v.emittedReadable=!0,K(_)))}}function F(_){var v=_._readableState;c("emitReadable",v.needReadable,v.emittedReadable),v.needReadable=!1,v.emittedReadable||(c("emitReadable",v.flowing),v.emittedReadable=!0,process.nextTick(K,_))}function K(_){var v=_._readableState;c("emitReadable_",v.destroyed,v.length,v.ended),!v.destroyed&&(v.length||v.ended)&&(_.emit("readable"),v.emittedReadable=!1),v.needReadable=!v.flowing&&!v.ended&&v.length<=v.highWaterMark,W(_)}function k(_,v){v.readingMore||(v.readingMore=!0,process.nextTick(X,_,v))}function X(_,v){for(;!v.reading&&!v.ended&&(v.length<v.highWaterMark||v.flowing&&v.length===0);){var R=v.length;if(c("maybeReadMore read 0"),_.read(0),R===v.length)break}v.readingMore=!1}N.prototype._read=function(_){I(this,new m("_read()"))},N.prototype.pipe=function(_,v){var R=this,U=this._readableState;switch(U.pipesCount){case 0:U.pipes=_;break;case 1:U.pipes=[U.pipes,_];break;default:U.pipes.push(_);break}U.pipesCount+=1,c("pipe count=%d opts=%j",U.pipesCount,v);var Y=(!v||v.end!==!1)&&_!==process.stdout&&_!==process.stderr,J=Y?Q:Oe;U.endEmitted?process.nextTick(J):R.once("end",J),_.on("unpipe",H);function H(O,w){c("onunpipe"),O===R&&w&&w.hasUnpiped===!1&&(w.hasUnpiped=!0,ue())}function Q(){c("onend"),_.end()}var ie=ee(R);_.on("drain",ie);var ne=!1;function ue(){c("cleanup"),_.removeListener("close",ve),_.removeListener("finish",Se),_.removeListener("drain",ie),_.removeListener("error",we),_.removeListener("unpipe",H),R.removeListener("end",Q),R.removeListener("end",Oe),R.removeListener("data",ge),ne=!0,U.awaitDrain&&(!_._writableState||_._writableState.needDrain)&&ie()}R.on("data",ge);function ge(O){c("ondata");var w=_.write(O);c("dest.write",w),w===!1&&((U.pipesCount===1&&U.pipes===_||U.pipesCount>1&&C(U.pipes,_)!==-1)&&!ne&&(c("false write response, pause",U.awaitDrain),U.awaitDrain++),R.pause())}function we(O){c("onerror",O),Oe(),_.removeListener("error",we),e(_,"error")===0&&I(_,O)}B(_,"error",we);function ve(){_.removeListener("finish",Se),Oe()}_.once("close",ve);function Se(){c("onfinish"),_.removeListener("close",ve),Oe()}_.once("finish",Se);function Oe(){c("unpipe"),R.unpipe(_)}return _.emit("pipe",R),U.flowing||(c("pipe resume"),R.resume()),_};function ee(_){return function(){var R=_._readableState;c("pipeOnDrain",R.awaitDrain),R.awaitDrain&&R.awaitDrain--,R.awaitDrain===0&&e(_,"data")&&(R.flowing=!0,W(_))}}N.prototype.unpipe=function(_){var v=this._readableState,R={hasUnpiped:!1};if(v.pipesCount===0)return this;if(v.pipesCount===1)return _&&_!==v.pipes?this:(_||(_=v.pipes),v.pipes=null,v.pipesCount=0,v.flowing=!1,_&&_.emit("unpipe",this,R),this);if(!_){var U=v.pipes,Y=v.pipesCount;v.pipes=null,v.pipesCount=0,v.flowing=!1;for(var J=0;J<Y;J++)U[J].emit("unpipe",this,{hasUnpiped:!1});return this}var H=C(v.pipes,_);return H===-1?this:(v.pipes.splice(H,1),v.pipesCount-=1,v.pipesCount===1&&(v.pipes=v.pipes[0]),_.emit("unpipe",this,R),this)},N.prototype.on=function(_,v){var R=r.prototype.on.call(this,_,v),U=this._readableState;return _==="data"?(U.readableListening=this.listenerCount("readable")>0,U.flowing!==!1&&this.resume()):_==="readable"&&!U.endEmitted&&!U.readableListening&&(U.readableListening=U.needReadable=!0,U.flowing=!1,U.emittedReadable=!1,c("on readable",U.length,U.reading),U.length?F(this):U.reading||process.nextTick(le,this)),R},N.prototype.addListener=N.prototype.on,N.prototype.removeListener=function(_,v){var R=r.prototype.removeListener.call(this,_,v);return _==="readable"&&process.nextTick(te,this),R},N.prototype.removeAllListeners=function(_){var v=r.prototype.removeAllListeners.apply(this,arguments);return(_==="readable"||_===void 0)&&process.nextTick(te,this),v};function te(_){var v=_._readableState;v.readableListening=_.listenerCount("readable")>0,v.resumeScheduled&&!v.paused?v.flowing=!0:_.listenerCount("data")>0&&_.resume()}function le(_){c("readable nexttick read 0"),_.read(0)}N.prototype.resume=function(){var _=this._readableState;return _.flowing||(c("resume"),_.flowing=!_.readableListening,z(this,_)),_.paused=!1,this};function z(_,v){v.resumeScheduled||(v.resumeScheduled=!0,process.nextTick(ce,_,v))}function ce(_,v){c("resume",v.reading),v.reading||_.read(0),v.resumeScheduled=!1,_.emit("resume"),W(_),v.flowing&&!v.reading&&_.read(0)}N.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function W(_){var v=_._readableState;for(c("flow",v.flowing);v.flowing&&_.read()!==null;);}N.prototype.wrap=function(_){var v=this,R=this._readableState,U=!1;_.on("end",function(){if(c("wrapped end"),R.decoder&&!R.ended){var H=R.decoder.end();H&&H.length&&v.push(H)}v.push(null)}),_.on("data",function(H){if(c("wrapped data"),R.decoder&&(H=R.decoder.write(H)),!(R.objectMode&&H==null)&&!(!R.objectMode&&(!H||!H.length))){var Q=v.push(H);Q||(U=!0,_.pause())}});for(var Y in _)this[Y]===void 0&&typeof _[Y]=="function"&&(this[Y]=(function(Q){return function(){return _[Q].apply(_,arguments)}})(Y));for(var J=0;J<A.length;J++)_.on(A[J],this.emit.bind(this,A[J]));return this._read=function(H){c("wrapped _read",H),U&&(U=!1,_.resume())},this},typeof Symbol=="function"&&(N.prototype[Symbol.asyncIterator]=function(){return b===void 0&&(b=Tb()),b(this)}),Object.defineProperty(N.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(N.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(N.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(v){this._readableState&&(this._readableState.flowing=v)}}),N._fromList=V,Object.defineProperty(N.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function V(_,v){if(v.length===0)return null;var R;return v.objectMode?R=v.buffer.shift():!_||_>=v.length?(v.decoder?R=v.buffer.join(""):v.buffer.length===1?R=v.buffer.first():R=v.buffer.concat(v.length),v.buffer.clear()):R=v.buffer.consume(_,v.decoder),R}function re(_){var v=_._readableState;c("endReadable",v.endEmitted),v.endEmitted||(v.ended=!0,process.nextTick(oe,v,_))}function oe(_,v){if(c("endReadableNT",_.endEmitted,_.length),!_.endEmitted&&_.length===0&&(_.endEmitted=!0,v.readable=!1,v.emit("end"),_.autoDestroy)){var R=v._writableState;(!R||R.autoDestroy&&R.finished)&&v.destroy()}}typeof Symbol=="function"&&(N.from=function(_,v){return x===void 0&&(x=Ob()),x(N,_,v)});function C(_,v){for(var R=0,U=_.length;R<U;R++)if(_[R]===v)return R;return-1}return ac}var cc,Lh;function Vg(){if(Lh)return cc;Lh=1,cc=a;var t=ci().codes,e=t.ERR_METHOD_NOT_IMPLEMENTED,r=t.ERR_MULTIPLE_CALLBACK,n=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=t.ERR_TRANSFORM_WITH_LENGTH_0,s=ei();es()(a,s);function o(l,f){var p=this._transformState;p.transforming=!1;var d=p.writecb;if(d===null)return this.emit("error",new r);p.writechunk=null,p.writecb=null,f!=null&&this.push(f),d(l);var h=this._readableState;h.reading=!1,(h.needReadable||h.length<h.highWaterMark)&&this._read(h.highWaterMark)}function a(l){if(!(this instanceof a))return new a(l);s.call(this,l),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,l&&(typeof l.transform=="function"&&(this._transform=l.transform),typeof l.flush=="function"&&(this._flush=l.flush)),this.on("prefinish",c)}function c(){var l=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(f,p){u(l,f,p)}):u(this,null,null)}a.prototype.push=function(l,f){return this._transformState.needTransform=!1,s.prototype.push.call(this,l,f)},a.prototype._transform=function(l,f,p){p(new e("_transform()"))},a.prototype._write=function(l,f,p){var d=this._transformState;if(d.writecb=p,d.writechunk=l,d.writeencoding=f,!d.transforming){var h=this._readableState;(d.needTransform||h.needReadable||h.length<h.highWaterMark)&&this._read(h.highWaterMark)}},a.prototype._read=function(l){var f=this._transformState;f.writechunk!==null&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},a.prototype._destroy=function(l,f){s.prototype._destroy.call(this,l,function(p){f(p)})};function u(l,f,p){if(f)return l.emit("error",f);if(p!=null&&l.push(p),l._writableState.length)throw new i;if(l._transformState.transforming)throw new n;return l.push(null)}return cc}var uc,Mh;function Cb(){if(Mh)return uc;Mh=1,uc=e;var t=Vg();es()(e,t);function e(r){if(!(this instanceof e))return new e(r);t.call(this,r)}return e.prototype._transform=function(r,n,i){i(null,r)},uc}var lc,$h;function Rb(){if($h)return lc;$h=1;var t;function e(p){var d=!1;return function(){d||(d=!0,p.apply(void 0,arguments))}}var r=ci().codes,n=r.ERR_MISSING_ARGS,i=r.ERR_STREAM_DESTROYED;function s(p){if(p)throw p}function o(p){return p.setHeader&&typeof p.abort=="function"}function a(p,d,h,g){g=e(g);var m=!1;p.on("close",function(){m=!0}),t===void 0&&(t=Al()),t(p,{readable:d,writable:h},function(S){if(S)return g(S);m=!0,g()});var y=!1;return function(S){if(!m&&!y){if(y=!0,o(p))return p.abort();if(typeof p.destroy=="function")return p.destroy();g(S||new i("pipe"))}}}function c(p){p()}function u(p,d){return p.pipe(d)}function l(p){return!p.length||typeof p[p.length-1]!="function"?s:p.pop()}function f(){for(var p=arguments.length,d=new Array(p),h=0;h<p;h++)d[h]=arguments[h];var g=l(d);if(Array.isArray(d[0])&&(d=d[0]),d.length<2)throw new n("streams");var m,y=d.map(function(S,b){var x=b<d.length-1,I=b>0;return a(S,x,I,function(A){m||(m=A),A&&y.forEach(c),!x&&(y.forEach(c),g(m))})});return d.reduce(u)}return lc=f,lc}var Fh;function Hg(){return Fh||(Fh=1,(function(t,e){e=t.exports=zg(),e.Stream=e,e.Readable=e,e.Writable=jg(),e.Duplex=ei(),e.Transform=Vg(),e.PassThrough=Cb(),e.finished=Al(),e.pipeline=Rb()})(ds,ds.exports)),ds.exports}var fc,kh;function Db(){if(kh)return fc;kh=1;const{Transform:t}=Hg();return fc=e=>class Kg extends t{constructor(n,i,s,o,a){super(a),this._rate=n,this._capacity=i,this._delimitedSuffix=s,this._hashBitLength=o,this._options=a,this._state=new e,this._state.initialize(n,i),this._finalized=!1}_transform(n,i,s){let o=null;try{this.update(n,i)}catch(a){o=a}s(o)}_flush(n){let i=null;try{this.push(this.digest())}catch(s){i=s}n(i)}update(n,i){if(!Buffer.isBuffer(n)&&typeof n!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");return Buffer.isBuffer(n)||(n=Buffer.from(n,i)),this._state.absorb(n),this}digest(n){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);let i=this._state.squeeze(this._hashBitLength/8);return n!==void 0&&(i=i.toString(n)),this._resetState(),i}_resetState(){return this._state.initialize(this._rate,this._capacity),this}_clone(){const n=new Kg(this._rate,this._capacity,this._delimitedSuffix,this._hashBitLength,this._options);return this._state.copy(n._state),n._finalized=this._finalized,n}},fc}var hc,qh;function Bb(){if(qh)return hc;qh=1;const{Transform:t}=Hg();return hc=e=>class Wg extends t{constructor(n,i,s,o){super(o),this._rate=n,this._capacity=i,this._delimitedSuffix=s,this._options=o,this._state=new e,this._state.initialize(n,i),this._finalized=!1}_transform(n,i,s){let o=null;try{this.update(n,i)}catch(a){o=a}s(o)}_flush(){}_read(n){this.push(this.squeeze(n))}update(n,i){if(!Buffer.isBuffer(n)&&typeof n!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Squeeze already called");return Buffer.isBuffer(n)||(n=Buffer.from(n,i)),this._state.absorb(n),this}squeeze(n,i){this._finalized||(this._finalized=!0,this._state.absorbLastFewBits(this._delimitedSuffix));let s=this._state.squeeze(n);return i!==void 0&&(s=s.toString(i)),s}_resetState(){return this._state.initialize(this._rate,this._capacity),this}_clone(){const n=new Wg(this._rate,this._capacity,this._delimitedSuffix,this._options);return this._state.copy(n._state),n._finalized=this._finalized,n}},hc}var dc,jh;function Nb(){if(jh)return dc;jh=1;const t=Db(),e=Bb();return dc=function(r){const n=t(r),i=e(r);return function(s,o){switch(typeof s=="string"?s.toLowerCase():s){case"keccak224":return new n(1152,448,null,224,o);case"keccak256":return new n(1088,512,null,256,o);case"keccak384":return new n(832,768,null,384,o);case"keccak512":return new n(576,1024,null,512,o);case"sha3-224":return new n(1152,448,6,224,o);case"sha3-256":return new n(1088,512,6,256,o);case"sha3-384":return new n(832,768,6,384,o);case"sha3-512":return new n(576,1024,6,512,o);case"shake128":return new i(1344,256,31,o);case"shake256":return new i(1088,512,31,o);default:throw new Error("Invald algorithm: "+s)}}},dc}var pc={},zh;function Pb(){if(zh)return pc;zh=1;const t=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];return pc.p1600=function(e){for(let r=0;r<24;++r){const n=e[0]^e[10]^e[20]^e[30]^e[40],i=e[1]^e[11]^e[21]^e[31]^e[41],s=e[2]^e[12]^e[22]^e[32]^e[42],o=e[3]^e[13]^e[23]^e[33]^e[43],a=e[4]^e[14]^e[24]^e[34]^e[44],c=e[5]^e[15]^e[25]^e[35]^e[45],u=e[6]^e[16]^e[26]^e[36]^e[46],l=e[7]^e[17]^e[27]^e[37]^e[47],f=e[8]^e[18]^e[28]^e[38]^e[48],p=e[9]^e[19]^e[29]^e[39]^e[49];let d=f^(s<<1|o>>>31),h=p^(o<<1|s>>>31);const g=e[0]^d,m=e[1]^h,y=e[10]^d,S=e[11]^h,b=e[20]^d,x=e[21]^h,I=e[30]^d,A=e[31]^h,B=e[40]^d,P=e[41]^h;d=n^(a<<1|c>>>31),h=i^(c<<1|a>>>31);const N=e[2]^d,$=e[3]^h,G=e[12]^d,q=e[13]^h,L=e[22]^d,j=e[23]^h,T=e[32]^d,D=e[33]^h,F=e[42]^d,K=e[43]^h;d=s^(u<<1|l>>>31),h=o^(l<<1|u>>>31);const k=e[4]^d,X=e[5]^h,ee=e[14]^d,te=e[15]^h,le=e[24]^d,z=e[25]^h,ce=e[34]^d,W=e[35]^h,V=e[44]^d,re=e[45]^h;d=a^(f<<1|p>>>31),h=c^(p<<1|f>>>31);const oe=e[6]^d,C=e[7]^h,_=e[16]^d,v=e[17]^h,R=e[26]^d,U=e[27]^h,Y=e[36]^d,J=e[37]^h,H=e[46]^d,Q=e[47]^h;d=u^(n<<1|i>>>31),h=l^(i<<1|n>>>31);const ie=e[8]^d,ne=e[9]^h,ue=e[18]^d,ge=e[19]^h,we=e[28]^d,ve=e[29]^h,Se=e[38]^d,Oe=e[39]^h,O=e[48]^d,w=e[49]^h,E=g,M=m,Z=S<<4|y>>>28,se=y<<4|S>>>28,ae=b<<3|x>>>29,Ee=x<<3|b>>>29,Ie=A<<9|I>>>23,_e=I<<9|A>>>23,be=B<<18|P>>>14,De=P<<18|B>>>14,$o=N<<1|$>>>31,Fo=$<<1|N>>>31,ko=q<<12|G>>>20,qo=G<<12|q>>>20,jo=L<<10|j>>>22,zo=j<<10|L>>>22,Vo=D<<13|T>>>19,Ho=T<<13|D>>>19,Ko=F<<2|K>>>30,Wo=K<<2|F>>>30,Go=X<<30|k>>>2,Yo=k<<30|X>>>2,Xo=ee<<6|te>>>26,Zo=te<<6|ee>>>26,Jo=z<<11|le>>>21,Qo=le<<11|z>>>21,ea=ce<<15|W>>>17,ta=W<<15|ce>>>17,ra=re<<29|V>>>3,na=V<<29|re>>>3,ia=oe<<28|C>>>4,sa=C<<28|oe>>>4,oa=v<<23|_>>>9,aa=_<<23|v>>>9,ca=R<<25|U>>>7,ua=U<<25|R>>>7,la=Y<<21|J>>>11,fa=J<<21|Y>>>11,ha=Q<<24|H>>>8,da=H<<24|Q>>>8,pa=ie<<27|ne>>>5,ga=ne<<27|ie>>>5,ya=ue<<20|ge>>>12,wa=ge<<20|ue>>>12,ma=ve<<7|we>>>25,ba=we<<7|ve>>>25,Ea=Se<<8|Oe>>>24,va=Oe<<8|Se>>>24,_a=O<<14|w>>>18,Sa=w<<14|O>>>18;e[0]=E^~ko&Jo,e[1]=M^~qo&Qo,e[10]=ia^~ya&ae,e[11]=sa^~wa&Ee,e[20]=$o^~Xo&ca,e[21]=Fo^~Zo&ua,e[30]=pa^~Z&jo,e[31]=ga^~se&zo,e[40]=Go^~oa&ma,e[41]=Yo^~aa&ba,e[2]=ko^~Jo&la,e[3]=qo^~Qo&fa,e[12]=ya^~ae&Vo,e[13]=wa^~Ee&Ho,e[22]=Xo^~ca&Ea,e[23]=Zo^~ua&va,e[32]=Z^~jo&ea,e[33]=se^~zo&ta,e[42]=oa^~ma&Ie,e[43]=aa^~ba&_e,e[4]=Jo^~la&_a,e[5]=Qo^~fa&Sa,e[14]=ae^~Vo&ra,e[15]=Ee^~Ho&na,e[24]=ca^~Ea&be,e[25]=ua^~va&De,e[34]=jo^~ea&ha,e[35]=zo^~ta&da,e[44]=ma^~Ie&Ko,e[45]=ba^~_e&Wo,e[6]=la^~_a&E,e[7]=fa^~Sa&M,e[16]=Vo^~ra&ia,e[17]=Ho^~na&sa,e[26]=Ea^~be&$o,e[27]=va^~De&Fo,e[36]=ea^~ha&pa,e[37]=ta^~da&ga,e[46]=Ie^~Ko&Go,e[47]=_e^~Wo&Yo,e[8]=_a^~E&ko,e[9]=Sa^~M&qo,e[18]=ra^~ia&ya,e[19]=na^~sa&wa,e[28]=be^~$o&Xo,e[29]=De^~Fo&Zo,e[38]=ha^~pa&Z,e[39]=da^~ga&se,e[48]=Ko^~Go&oa,e[49]=Wo^~Yo&aa,e[0]^=t[r*2],e[1]^=t[r*2+1]}},pc}var gc,Vh;function Ub(){if(Vh)return gc;Vh=1;const t=Pb();function e(){this.state=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.blockSize=null,this.count=0,this.squeezing=!1}return e.prototype.initialize=function(r,n){for(let i=0;i<50;++i)this.state[i]=0;this.blockSize=r/8,this.count=0,this.squeezing=!1},e.prototype.absorb=function(r){for(let n=0;n<r.length;++n)this.state[~~(this.count/4)]^=r[n]<<8*(this.count%4),this.count+=1,this.count===this.blockSize&&(t.p1600(this.state),this.count=0)},e.prototype.absorbLastFewBits=function(r){this.state[~~(this.count/4)]^=r<<8*(this.count%4),(r&128)!==0&&this.count===this.blockSize-1&&t.p1600(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<8*((this.blockSize-1)%4),t.p1600(this.state),this.count=0,this.squeezing=!0},e.prototype.squeeze=function(r){this.squeezing||this.absorbLastFewBits(1);const n=Buffer.alloc(r);for(let i=0;i<r;++i)n[i]=this.state[~~(this.count/4)]>>>8*(this.count%4)&255,this.count+=1,this.count===this.blockSize&&(t.p1600(this.state),this.count=0);return n},e.prototype.copy=function(r){for(let n=0;n<50;++n)r.state[n]=this.state[n];r.blockSize=this.blockSize,r.count=this.count,r.squeezing=this.squeezing},gc=e,gc}var yc,Hh;function Gg(){return Hh||(Hh=1,yc=Nb()(Ub())),yc}var Kh;function Tl(){if(Kh)return pt;Kh=1;var t=pt&&pt.__createBinding||(Object.create?(function(m,y,S,b){b===void 0&&(b=S),Object.defineProperty(m,b,{enumerable:!0,get:function(){return y[S]}})}):(function(m,y,S,b){b===void 0&&(b=S),m[b]=y[S]})),e=pt&&pt.__setModuleDefault||(Object.create?(function(m,y){Object.defineProperty(m,"default",{enumerable:!0,value:y})}):function(m,y){m.default=y}),r=pt&&pt.__importStar||function(m){if(m&&m.__esModule)return m;var y={};if(m!=null)for(var S in m)S!=="default"&&Object.prototype.hasOwnProperty.call(m,S)&&t(y,m,S);return e(y,m),y},n=pt&&pt.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(pt,"__esModule",{value:!0}),pt.AddressComputer=pt.Address=void 0;const i=r(gb()),s=n(uo()),o=wb(),a=mb(),c=Mg(),u=r(bb()),l=Gg(),f=32,p="0".repeat(16);class d{constructor(y,S){if(!y){this.publicKey=Buffer.from([]),this.hrp=S||a.LibraryConfig.DefaultAddressHrp;return}if(ArrayBuffer.isView(y)){if(y.length!=f)throw new u.ErrAddressCannotCreate(y);this.publicKey=Buffer.from(y),this.hrp=S||a.LibraryConfig.DefaultAddressHrp;return}if(y instanceof d){if(S)throw new u.ErrInvalidArgument("this variant of the Address constructor does not accept the 'hrp' argument");this.publicKey=y.publicKey,this.hrp=y.hrp;return}if(typeof y=="string"){if(d.isValidHex(y)){this.publicKey=Buffer.from(y,"hex"),this.hrp=S||a.LibraryConfig.DefaultAddressHrp;return}if(S)throw new u.ErrInvalidArgument("this variant of the Address constructor does not accept the 'hrp' argument");const{hrp:b,pubkey:x}=g({value:y,allowCustomHrp:!1});this.publicKey=x,this.hrp=b;return}throw new u.ErrAddressCannotCreate(y)}static newFromBech32(y){const{hrp:S,pubkey:b}=g({value:y,allowCustomHrp:!0});return new d(b,S)}static newFromHex(y,S){if(!d.isValidHex(y))throw new u.ErrAddressCannotCreate(y);return new d(Buffer.from(y,"hex"),S)}toHex(){return this.isEmpty()?"":this.publicKey.toString("hex")}toBech32(){if(this.isEmpty())return"";let y=i.toWords(this.getPublicKey());return i.encode(this.hrp,y)}getPublicKey(){return this.publicKey}getHrp(){return this.hrp}static empty(){return new d("")}static isValid(y){const S=i.decodeUnsafe(y),b=S?.prefix,x=S?Buffer.from(i.fromWords(S.words)):void 0;return!(b!==a.LibraryConfig.DefaultAddressHrp||x?.length!==f)}static isValidHex(y){return Buffer.from(y,"hex").length==f}isEmpty(){return this.publicKey.length==0}equals(y){return y?this.publicKey.toString()==y.publicKey.toString():!1}toString(){return this.toBech32()}toJSON(){return{bech32:this.toBech32(),pubkey:this.toHex()}}static Zero(){return new d("0".repeat(64))}isSmartContract(){return this.toHex().startsWith(p)}}pt.Address=d;class h{constructor(y){this.numberOfShardsWithoutMeta=y||c.CURRENT_NUMBER_OF_SHARDS_WITHOUT_META}computeContractAddress(y,S){const b=Buffer.alloc(8,0),x=y.getPublicKey(),I=x.slice(30),A=Buffer.alloc(8),B=new s.default(S.toString()),P=o.bigIntToBuffer(B);A.write(P.reverse().toString("hex"),"hex");const N=Buffer.concat([x,A]),$=l("keccak256").update(N).digest(),G=Buffer.from(c.WasmVirtualMachine,"hex"),q=Buffer.concat([b,G,$.slice(10,30),I]);return new d(q)}getShardOfAddress(y){return this.getShardOfPubkey(y.getPublicKey(),this.numberOfShardsWithoutMeta)}getShardOfPubkey(y,S){const b=parseInt("11",2),x=parseInt("01",2),I=y[31];if(this.isPubkeyOfMetachain(y))return c.METACHAIN_ID;let A=I&b;return A>S-1&&(A=I&x),A}isPubkeyOfMetachain(y){const S=Buffer.from([0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),b=Buffer.from(y).slice(0,S.length);return!!(S.equals(b)||Buffer.alloc(32).equals(Buffer.from(y)))}}pt.AddressComputer=h;function g(m){const y=m.value,S=m.allowCustomHrp;let b,x;try{const I=i.decode(y);b=I.prefix,x=Buffer.from(i.fromWords(I.words))}catch(I){throw new u.ErrAddressCannotCreate(y,I)}if(!S&&b!=a.LibraryConfig.DefaultAddressHrp)throw new u.ErrAddressBadHrp(a.LibraryConfig.DefaultAddressHrp,b);return{hrp:b,pubkey:x}}return pt}var Wh;function Lb(){if(Wh)return ln;Wh=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.MessageComputer=ln.Message=void 0;const t=Tl(),e=Mg(),r=Gg();class n{constructor(o){this.data=o.data,this.signature=o.signature,this.address=o.address,this.version=o.version||e.DEFAULT_MESSAGE_VERSION,this.signer=o.signer||e.SDK_JS_SIGNER}}ln.Message=n;class i{constructor(){}computeBytesForSigning(o){const a=Buffer.from(o.data.length.toString()),c=Buffer.concat([a,o.data]);let u=Buffer.concat([Buffer.from(e.MESSAGE_PREFIX),c]);return r("keccak256").update(u).digest()}computeBytesForVerifying(o){return this.computeBytesForSigning(o)}packMessage(o){return{message:Buffer.from(o.data).toString("hex"),signature:o.signature?Buffer.from(o.signature).toString("hex"):"",address:o.address?o.address.toBech32():"",version:o.version,signer:o.signer}}unpackMessage(o){const a=this.trimHexPrefix(o.message),c=Buffer.from(a,"hex"),u=this.trimHexPrefix(o.signature||""),l=Buffer.from(u,"hex");let f;o.address&&(f=t.Address.newFromBech32(o.address));const p=o.version||e.DEFAULT_MESSAGE_VERSION,d=o.signer||e.UNKNOWN_SIGNER;return new n({data:c,signature:l,address:f,version:p,signer:d})}trimHexPrefix(o){return o.startsWith("0x")||o.startsWith("0X")?o.slice(2):o}}return ln.MessageComputer=i,ln}var ir=Il();const Yg=Sl(ir);var wc={};var gu=function(t,e){return gu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},gu(t,e)};function Mb(t,e){gu(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var yu=function(){return yu=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},yu.apply(this,arguments)};function $b(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Fb(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function kb(t,e){return function(r,n){e(r,n,t)}}function qb(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function jb(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(f){o(f)}}function c(l){try{u(n.throw(l))}catch(f){o(f)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(t,e||[])).next())})}function zb(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(l){u=[6,l],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Vb(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Hb(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function wu(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xg(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Kb(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Xg(arguments[e]));return t}function Wb(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Vi(t){return this instanceof Vi?(this.v=t,this):new Vi(t)}function Gb(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(p){n[p]&&(i[p]=function(d){return new Promise(function(h,g){s.push([p,d,h,g])>1||a(p,d)})})}function a(p,d){try{c(n[p](d))}catch(h){f(s[0][3],h)}}function c(p){p.value instanceof Vi?Promise.resolve(p.value.v).then(u,l):f(s[0][2],p)}function u(p){a("next",p)}function l(p){a("throw",p)}function f(p,d){p(d),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Yb(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Vi(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Xb(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof wu=="function"?wu(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}function Zb(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Jb(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Qb(t){return t&&t.__esModule?t:{default:t}}function eE(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function tE(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const rE=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return yu},__asyncDelegator:Yb,__asyncGenerator:Gb,__asyncValues:Xb,__await:Vi,__awaiter:jb,__classPrivateFieldGet:eE,__classPrivateFieldSet:tE,__createBinding:Vb,__decorate:Fb,__exportStar:Hb,__extends:Mb,__generator:zb,__importDefault:Qb,__importStar:Jb,__makeTemplateObject:Zb,__metadata:qb,__param:kb,__read:Xg,__rest:$b,__spread:Kb,__spreadArrays:Wb,__values:wu},Symbol.toStringTag,{value:"Module"})),ts=co(rE);var mc={},gi={},Gh;function nE(){if(Gh)return gi;Gh=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return gi.delay=t,gi}var fn={},bc={},hn={},Yh;function iE(){return Yh||(Yh=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.ONE_THOUSAND=hn.ONE_HUNDRED=void 0,hn.ONE_HUNDRED=100,hn.ONE_THOUSAND=1e3),hn}var Ec={},Xh;function sE(){return Xh||(Xh=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365})(Ec)),Ec}var Zh;function Zg(){return Zh||(Zh=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ts;e.__exportStar(iE(),t),e.__exportStar(sE(),t)})(bc)),bc}var Jh;function oE(){if(Jh)return fn;Jh=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.fromMiliseconds=fn.toMiliseconds=void 0;const t=Zg();function e(n){return n*t.ONE_THOUSAND}fn.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return fn.fromMiliseconds=r,fn}var Qh;function aE(){return Qh||(Qh=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ts;e.__exportStar(nE(),t),e.__exportStar(oE(),t)})(mc)),mc}var kn={},ed;function cE(){if(ed)return kn;ed=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return kn.Watch=t,kn.default=t,kn}var vc={},yi={},td;function uE(){if(td)return yi;td=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.IWatch=void 0;class t{}return yi.IWatch=t,yi}var rd;function lE(){return rd||(rd=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),ts.__exportStar(uE(),t)})(vc)),vc}var nd;function fE(){return nd||(nd=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ts;e.__exportStar(aE(),t),e.__exportStar(cE(),t),e.__exportStar(lE(),t),e.__exportStar(Zg(),t)})(wc)),wc}var pe=fE();class Dn{}let hE=class extends Dn{constructor(e){super()}};const id=pe.FIVE_SECONDS,Bn={pulse:"heartbeat_pulse"};let dE=class Jg extends hE{constructor(e){super(e),this.events=new ir.EventEmitter,this.interval=id,this.interval=e?.interval||id}static async init(e){const r=new Jg(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),pe.toMiliseconds(this.interval))}pulse(){this.events.emit(Bn.pulse)}};const pE=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,gE=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,yE=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function wE(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){mE(t);return}return e}function mE(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function ms(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const r=t.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!yE.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(pE.test(t)||gE.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,wE)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}function bE(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Je(t,...e){try{return bE(t(...e))}catch(r){return Promise.reject(r)}}function EE(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function vE(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Ps(t){if(EE(t))return String(t);if(vE(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Ps(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const mu="base64:";function _E(t){return typeof t=="string"?t:mu+IE(t)}function SE(t){return typeof t!="string"||!t.startsWith(mu)?t:xE(t.slice(mu.length))}function xE(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function IE(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function St(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function AE(...t){return St(t.join(":"))}function bs(t){return t=St(t),t?t+":":""}function TE(t,e){if(e===void 0)return!0;let r=0,n=t.indexOf(":");for(;n>-1;)r++,n=t.indexOf(":",n+1);return r<=e}function OE(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const CE="memory",RE=()=>{const t=new Map;return{name:CE,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function DE(t={}){const e={mounts:{"":t.driver||RE()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=u=>{for(const l of e.mountpoints)if(u.startsWith(l))return{base:l,relativeKey:u.slice(l.length),driver:e.mounts[l]};return{base:"",relativeKey:u,driver:e.mounts[""]}},n=(u,l)=>e.mountpoints.filter(f=>f.startsWith(u)||l&&u.startsWith(f)).map(f=>({relativeBase:u.length>f.length?u.slice(f.length):void 0,mountpoint:f,driver:e.mounts[f]})),i=(u,l)=>{if(e.watching){l=St(l);for(const f of e.watchListeners)f(u,l)}},s=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await sd(e.mounts[u],i,u)}},o=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},a=(u,l,f)=>{const p=new Map,d=h=>{let g=p.get(h.base);return g||(g={driver:h.driver,base:h.base,items:[]},p.set(h.base,g)),g};for(const h of u){const g=typeof h=="string",m=St(g?h:h.key),y=g?void 0:h.value,S=g||!h.options?l:{...l,...h.options},b=r(m);d(b).items.push({key:m,value:y,relativeKey:b.relativeKey,options:S})}return Promise.all([...p.values()].map(h=>f(h))).then(h=>h.flat())},c={hasItem(u,l={}){u=St(u);const{relativeKey:f,driver:p}=r(u);return Je(p.hasItem,f,l)},getItem(u,l={}){u=St(u);const{relativeKey:f,driver:p}=r(u);return Je(p.getItem,f,l).then(d=>ms(d))},getItems(u,l={}){return a(u,l,f=>f.driver.getItems?Je(f.driver.getItems,f.items.map(p=>({key:p.relativeKey,options:p.options})),l).then(p=>p.map(d=>({key:AE(f.base,d.key),value:ms(d.value)}))):Promise.all(f.items.map(p=>Je(f.driver.getItem,p.relativeKey,p.options).then(d=>({key:p.key,value:ms(d)})))))},getItemRaw(u,l={}){u=St(u);const{relativeKey:f,driver:p}=r(u);return p.getItemRaw?Je(p.getItemRaw,f,l):Je(p.getItem,f,l).then(d=>SE(d))},async setItem(u,l,f={}){if(l===void 0)return c.removeItem(u);u=St(u);const{relativeKey:p,driver:d}=r(u);d.setItem&&(await Je(d.setItem,p,Ps(l),f),d.watch||i("update",u))},async setItems(u,l){await a(u,l,async f=>{if(f.driver.setItems)return Je(f.driver.setItems,f.items.map(p=>({key:p.relativeKey,value:Ps(p.value),options:p.options})),l);f.driver.setItem&&await Promise.all(f.items.map(p=>Je(f.driver.setItem,p.relativeKey,Ps(p.value),p.options)))})},async setItemRaw(u,l,f={}){if(l===void 0)return c.removeItem(u,f);u=St(u);const{relativeKey:p,driver:d}=r(u);if(d.setItemRaw)await Je(d.setItemRaw,p,l,f);else if(d.setItem)await Je(d.setItem,p,_E(l),f);else return;d.watch||i("update",u)},async removeItem(u,l={}){typeof l=="boolean"&&(l={removeMeta:l}),u=St(u);const{relativeKey:f,driver:p}=r(u);p.removeItem&&(await Je(p.removeItem,f,l),(l.removeMeta||l.removeMata)&&await Je(p.removeItem,f+"$",l),p.watch||i("remove",u))},async getMeta(u,l={}){typeof l=="boolean"&&(l={nativeOnly:l}),u=St(u);const{relativeKey:f,driver:p}=r(u),d=Object.create(null);if(p.getMeta&&Object.assign(d,await Je(p.getMeta,f,l)),!l.nativeOnly){const h=await Je(p.getItem,f+"$",l).then(g=>ms(g));h&&typeof h=="object"&&(typeof h.atime=="string"&&(h.atime=new Date(h.atime)),typeof h.mtime=="string"&&(h.mtime=new Date(h.mtime)),Object.assign(d,h))}return d},setMeta(u,l,f={}){return this.setItem(u+"$",l,f)},removeMeta(u,l={}){return this.removeItem(u+"$",l)},async getKeys(u,l={}){u=bs(u);const f=n(u,!0);let p=[];const d=[];let h=!0;for(const m of f){m.driver.flags?.maxDepth||(h=!1);const y=await Je(m.driver.getKeys,m.relativeBase,l);for(const S of y){const b=m.mountpoint+St(S);p.some(x=>b.startsWith(x))||d.push(b)}p=[m.mountpoint,...p.filter(S=>!S.startsWith(m.mountpoint))]}const g=l.maxDepth!==void 0&&!h;return d.filter(m=>(!g||TE(m,l.maxDepth))&&OE(m,u))},async clear(u,l={}){u=bs(u),await Promise.all(n(u,!1).map(async f=>{if(f.driver.clear)return Je(f.driver.clear,f.relativeBase,l);if(f.driver.removeItem){const p=await f.driver.getKeys(f.relativeBase||"",l);return Promise.all(p.map(d=>f.driver.removeItem(d,l)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>od(u)))},async watch(u){return await s(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(l=>l!==u),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(u,l){if(u=bs(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((f,p)=>p.length-f.length)),e.mounts[u]=l,e.watching&&Promise.resolve(sd(l,i,u)).then(f=>{e.unwatch[u]=f}).catch(console.error),c},async unmount(u,l=!0){u=bs(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&(e.unwatch[u]?.(),delete e.unwatch[u]),l&&await od(e.mounts[u]),e.mountpoints=e.mountpoints.filter(f=>f!==u),delete e.mounts[u])},getMount(u=""){u=St(u)+":";const l=r(u);return{driver:l.driver,base:l.base}},getMounts(u="",l={}){return u=St(u),n(u,l.parents).map(p=>({driver:p.driver,base:p.mountpoint}))},keys:(u,l={})=>c.getKeys(u,l),get:(u,l={})=>c.getItem(u,l),set:(u,l,f={})=>c.setItem(u,l,f),has:(u,l={})=>c.hasItem(u,l),del:(u,l={})=>c.removeItem(u,l),remove:(u,l={})=>c.removeItem(u,l)};return c}function sd(t,e,r){return t.watch?t.watch((n,i)=>e(n,r+i)):()=>{}}async function od(t){typeof t.dispose=="function"&&await Je(t.dispose)}function Nn(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function Qg(t,e){let r;const n=()=>{if(r)return r;const i=indexedDB.open(t);return i.onupgradeneeded=()=>i.result.createObjectStore(e),r=Nn(i),r.then(s=>{s.onclose=()=>r=void 0},()=>{}),r};return(i,s)=>n().then(o=>s(o.transaction(e,i).objectStore(e)))}let _c;function rs(){return _c||(_c=Qg("keyval-store","keyval")),_c}function ad(t,e=rs()){return e("readonly",r=>Nn(r.get(t)))}function BE(t,e,r=rs()){return r("readwrite",n=>(n.put(e,t),Nn(n.transaction)))}function NE(t,e=rs()){return e("readwrite",r=>(r.delete(t),Nn(r.transaction)))}function PE(t=rs()){return t("readwrite",e=>(e.clear(),Nn(e.transaction)))}function UE(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Nn(t.transaction)}function LE(t=rs()){return t("readonly",e=>{if(e.getAllKeys)return Nn(e.getAllKeys());const r=[];return UE(e,n=>r.push(n.key)).then(()=>r)})}const ME=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),$E=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function ti(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return $E(t)}catch{return t}}function An(t){return typeof t=="string"?t:ME(t)||""}const FE="idb-keyval";var kE=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=i=>e+i;let n;return t.dbName&&t.storeName&&(n=Qg(t.dbName,t.storeName)),{name:FE,options:t,async hasItem(i){return!(typeof await ad(r(i),n)>"u")},async getItem(i){return await ad(r(i),n)??null},setItem(i,s){return BE(r(i),s,n)},removeItem(i){return NE(r(i),n)},getKeys(){return LE(n)},clear(){return PE(n)}}};const qE="WALLET_CONNECT_V2_INDEXED_DB",jE="keyvaluestorage";let zE=class{constructor(){this.indexedDb=DE({driver:kE({dbName:qE,storeName:jE})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,An(r))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Sc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Us={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Sc<"u"&&Sc.localStorage?Us.exports=Sc.localStorage:typeof window<"u"&&window.localStorage?Us.exports=window.localStorage:Us.exports=new e})();function VE(t){var e;return[t[0],ti((e=t[1])!=null?e:"")]}let HE=class{constructor(){this.localStorage=Us.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(VE)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return ti(r)}async setItem(e,r){this.localStorage.setItem(e,An(r))}async removeItem(e){this.localStorage.removeItem(e)}};const KE="wc_storage_version",cd=1,WE=async(t,e,r)=>{const n=KE,i=await e.getItem(n);if(i&&i>=cd){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const u=await t.getItem(a);await e.setItem(a,u),o.push(a)}}await e.setItem(n,cd),r(e),GE(t,o)},GE=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};let YE=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new HE;this.storage=e;try{const r=new zE;WE(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}};var wi={exports:{}},xc,ud;function XE(){if(ud)return xc;ud=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}xc=e;function e(r,n,i){var s=i&&i.stringify||t,o=1;if(typeof r=="object"&&r!==null){var a=n.length+o;if(a===1)return r;var c=new Array(a);c[0]=s(r);for(var u=1;u<a;u++)c[u]=s(n[u]);return c.join(" ")}if(typeof r!="string")return r;var l=n.length;if(l===0)return r;for(var f="",p=1-o,d=-1,h=r&&r.length||0,g=0;g<h;){if(r.charCodeAt(g)===37&&g+1<h){switch(d=d>-1?d:0,r.charCodeAt(g+1)){case 100:case 102:if(p>=l||n[p]==null)break;d<g&&(f+=r.slice(d,g)),f+=Number(n[p]),d=g+2,g++;break;case 105:if(p>=l||n[p]==null)break;d<g&&(f+=r.slice(d,g)),f+=Math.floor(Number(n[p])),d=g+2,g++;break;case 79:case 111:case 106:if(p>=l||n[p]===void 0)break;d<g&&(f+=r.slice(d,g));var m=typeof n[p];if(m==="string"){f+="'"+n[p]+"'",d=g+2,g++;break}if(m==="function"){f+=n[p].name||"<anonymous>",d=g+2,g++;break}f+=s(n[p]),d=g+2,g++;break;case 115:if(p>=l)break;d<g&&(f+=r.slice(d,g)),f+=String(n[p]),d=g+2,g++;break;case 37:d<g&&(f+=r.slice(d,g)),f+="%",d=g+2,g++,p--;break}++p}++g}return d===-1?r:(d<h&&(f+=r.slice(d)),f)}return xc}var ld;function ZE(){if(ld)return wi.exports;ld=1;const t=XE();wi.exports=l;const e=j().console||{},r={mapHttpRequest:B,mapHttpResponse:B,wrapRequestSerializer:P,wrapResponseSerializer:P,wrapErrorSerializer:P,req:B,res:B,err:I,errWithCause:I};function n(T,D){return T==="silent"?1/0:D.levels.values[T]}const i=Symbol("pino.logFuncs"),s=Symbol("pino.hierarchy"),o={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function a(T,D){const F={logger:D,parent:T[s]};D[s]=F}function c(T,D,F){const K={};D.forEach(k=>{K[k]=F[k]?F[k]:e[k]||e[o[k]||"log"]||N}),T[i]=K}function u(T,D){return Array.isArray(T)?T.filter(function(K){return K!=="!stdSerializers.err"}):T===!0?Object.keys(D):!1}function l(T){T=T||{},T.browser=T.browser||{};const D=T.browser.transmit;if(D&&typeof D.send!="function")throw Error("pino: transmit option must have a send function");const F=T.browser.write||e;T.browser.write&&(T.browser.asObject=!0);const K=T.serializers||{},k=u(T.browser.serialize,K);let X=T.browser.serialize;Array.isArray(T.browser.serialize)&&T.browser.serialize.indexOf("!stdSerializers.err")>-1&&(X=!1);const ee=Object.keys(T.customLevels||{}),te=["error","fatal","warn","info","debug","trace"].concat(ee);typeof F=="function"&&te.forEach(function(C){F[C]=F}),(T.enabled===!1||T.browser.disabled)&&(T.level="silent");const le=T.level||"info",z=Object.create(F);z.log||(z.log=N),c(z,te,F),a({},z),Object.defineProperty(z,"levelVal",{get:W}),Object.defineProperty(z,"level",{get:V,set:re});const ce={transmit:D,serialize:k,asObject:T.browser.asObject,asObjectBindingsOnly:T.browser.asObjectBindingsOnly,formatters:T.browser.formatters,levels:te,timestamp:A(T),messageKey:T.messageKey||"msg",onChild:T.onChild||N};z.levels=f(T),z.level=le,z.isLevelEnabled=function(C){return this.levels.values[C]?this.levels.values[C]>=this.levels.values[this.level]:!1},z.setMaxListeners=z.getMaxListeners=z.emit=z.addListener=z.on=z.prependListener=z.once=z.prependOnceListener=z.removeListener=z.removeAllListeners=z.listeners=z.listenerCount=z.eventNames=z.write=z.flush=N,z.serializers=K,z._serialize=k,z._stdErrSerialize=X,z.child=function(...C){return oe.call(this,ce,...C)},D&&(z._logEvent=x());function W(){return n(this.level,this)}function V(){return this._level}function re(C){if(C!=="silent"&&!this.levels.values[C])throw Error("unknown level "+C);this._level=C,h(this,ce,z,"error"),h(this,ce,z,"fatal"),h(this,ce,z,"warn"),h(this,ce,z,"info"),h(this,ce,z,"debug"),h(this,ce,z,"trace"),ee.forEach(_=>{h(this,ce,z,_)})}function oe(C,_,v){if(!_)throw new Error("missing bindings for child Pino");v=v||{},k&&_.serializers&&(v.serializers=_.serializers);const R=v.serializers;if(k&&R){var U=Object.assign({},K,R),Y=T.browser.serialize===!0?Object.keys(U):k;delete _.serializers,S([_],Y,U,this._stdErrSerialize)}function J(Q){this._childLevel=(Q._childLevel|0)+1,this.bindings=_,U&&(this.serializers=U,this._serialize=Y),D&&(this._logEvent=x([].concat(Q._logEvent.bindings,_)))}J.prototype=this;const H=new J(this);return a(this,H),H.child=function(...Q){return oe.call(this,C,...Q)},H.level=v.level||this.level,C.onChild(H),H}return z}function f(T){const D=T.customLevels||{},F=Object.assign({},l.levels.values,D),K=Object.assign({},l.levels.labels,p(D));return{values:F,labels:K}}function p(T){const D={};return Object.keys(T).forEach(function(F){D[T[F]]=F}),D}l.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},l.stdSerializers=r,l.stdTimeFunctions=Object.assign({},{nullTime:$,epochTime:G,unixTime:q,isoTime:L});function d(T){const D=[];T.bindings&&D.push(T.bindings);let F=T[s];for(;F.parent;)F=F.parent,F.logger.bindings&&D.push(F.logger.bindings);return D.reverse()}function h(T,D,F,K){if(Object.defineProperty(T,K,{value:n(T.level,F)>n(K,F)?N:F[i][K],writable:!0,enumerable:!0,configurable:!0}),T[K]===N){if(!D.transmit)return;const X=D.transmit.level||T.level,ee=n(X,F);if(n(K,F)<ee)return}T[K]=m(T,D,F,K);const k=d(T);k.length!==0&&(T[K]=g(k,T[K]))}function g(T,D){return function(){return D.apply(this,[...T,...arguments])}}function m(T,D,F,K){return(function(k){return function(){const ee=D.timestamp(),te=new Array(arguments.length),le=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var z=0;z<te.length;z++)te[z]=arguments[z];var ce=!1;if(D.serialize&&(S(te,this._serialize,this.serializers,this._stdErrSerialize),ce=!0),D.asObject||D.formatters?k.call(le,...y(this,K,te,ee,D)):k.apply(le,te),D.transmit){const W=D.transmit.level||T._level,V=n(W,F),re=n(K,F);if(re<V)return;b(this,{ts:ee,methodLevel:K,methodValue:re,transmitValue:F.levels.values[D.transmit.level||T._level],send:D.transmit.send,val:n(T._level,F)},te,ce)}}})(T[i][K])}function y(T,D,F,K,k){const{level:X,log:ee=W=>W}=k.formatters||{},te=F.slice();let le=te[0];const z={};let ce=(T._childLevel|0)+1;if(ce<1&&(ce=1),K&&(z.time=K),X){const W=X(D,T.levels.values[D]);Object.assign(z,W)}else z.level=T.levels.values[D];if(k.asObjectBindingsOnly){if(le!==null&&typeof le=="object")for(;ce--&&typeof te[0]=="object";)Object.assign(z,te.shift());return[ee(z),...te]}else{if(le!==null&&typeof le=="object"){for(;ce--&&typeof te[0]=="object";)Object.assign(z,te.shift());le=te.length?t(te.shift(),te):void 0}else typeof le=="string"&&(le=t(te.shift(),te));return le!==void 0&&(z[k.messageKey]=le),[ee(z)]}}function S(T,D,F,K){for(const k in T)if(K&&T[k]instanceof Error)T[k]=l.stdSerializers.err(T[k]);else if(typeof T[k]=="object"&&!Array.isArray(T[k])&&D)for(const X in T[k])D.indexOf(X)>-1&&X in F&&(T[k][X]=F[X](T[k][X]))}function b(T,D,F,K=!1){const k=D.send,X=D.ts,ee=D.methodLevel,te=D.methodValue,le=D.val,z=T._logEvent.bindings;K||S(F,T._serialize||Object.keys(T.serializers),T.serializers,T._stdErrSerialize===void 0?!0:T._stdErrSerialize),T._logEvent.ts=X,T._logEvent.messages=F.filter(function(ce){return z.indexOf(ce)===-1}),T._logEvent.level.label=ee,T._logEvent.level.value=te,k(ee,T._logEvent,le),T._logEvent=x(z)}function x(T){return{ts:0,messages:[],bindings:T||[],level:{label:"",value:0}}}function I(T){const D={type:T.constructor.name,msg:T.message,stack:T.stack};for(const F in T)D[F]===void 0&&(D[F]=T[F]);return D}function A(T){return typeof T.timestamp=="function"?T.timestamp:T.timestamp===!1?$:G}function B(){return{}}function P(T){return T}function N(){}function $(){return!1}function G(){return Date.now()}function q(){return Math.round(Date.now()/1e3)}function L(){return new Date(Date.now()).toISOString()}function j(){function T(D){return typeof D<"u"&&D}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return T(self)||T(window)||T(this)||{}}}return wi.exports.default=l,wi.exports.pino=l,wi.exports}var Wn=ZE();const e0=Sl(Wn),JE={level:"info"},fo="custom_context",Ol=1e3*1024;var QE=Object.defineProperty,ev=(t,e,r)=>e in t?QE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Zr=(t,e,r)=>ev(t,typeof e!="symbol"?e+"":e,r);let tv=class{constructor(e){Zr(this,"nodeValue"),Zr(this,"sizeInBytes"),Zr(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},fd=class{constructor(e){Zr(this,"lengthInNodes"),Zr(this,"sizeInBytes"),Zr(this,"head"),Zr(this,"tail"),Zr(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new tv(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}};var rv=Object.defineProperty,nv=(t,e,r)=>e in t?rv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Es=(t,e,r)=>nv(t,typeof e!="symbol"?e+"":e,r);class t0{constructor(e,r=Ol){Es(this,"logs"),Es(this,"level"),Es(this,"levelValue"),Es(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Wn.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new fd(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Wn.levels.values.error?console.error(e):r===Wn.levels.values.warn?console.warn(e):r===Wn.levels.values.debug?console.debug(e):r===Wn.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(An({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new fd(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(An({extraMetadata:e})),new Blob(r,{type:"application/json"})}}var iv=Object.defineProperty,sv=(t,e,r)=>e in t?iv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ov=(t,e,r)=>sv(t,e+"",r);class av{constructor(e,r=Ol){ov(this,"baseChunkLogger"),this.baseChunkLogger=new t0(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}}var cv=Object.defineProperty,uv=(t,e,r)=>e in t?cv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lv=(t,e,r)=>uv(t,e+"",r);let fv=class{constructor(e,r=Ol){lv(this,"baseChunkLogger"),this.baseChunkLogger=new t0(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var hv=Object.defineProperty,dv=Object.defineProperties,pv=Object.getOwnPropertyDescriptors,hd=Object.getOwnPropertySymbols,gv=Object.prototype.hasOwnProperty,yv=Object.prototype.propertyIsEnumerable,dd=(t,e,r)=>e in t?hv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ks=(t,e)=>{for(var r in e||(e={}))gv.call(e,r)&&dd(t,r,e[r]);if(hd)for(var r of hd(e))yv.call(e,r)&&dd(t,r,e[r]);return t},qs=(t,e)=>dv(t,pv(e));function wv(t){return qs(ks({},t),{level:t?.level||JE.level})}function mv(t,e,r=fo){return t[r]=e,t}function Ct(t,e=fo){return t[e]||""}function bv(t,e,r=fo){const n=Ct(t,r);return n.trim()?`${n}/${e}`:e}function Ut(t,e,r=fo){const n=bv(t,e,r),i=t.child({context:n});return mv(i,n,r)}function Ev(t){var e,r;const n=new av((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:e0(qs(ks({},t.opts),{level:"trace",browser:qs(ks({},(r=t.opts)==null?void 0:r.browser),{write:i=>n.write(i)})})),chunkLoggerController:n}}function vv(t){var e;const r=new fv((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:e0(qs(ks({},t.opts),{level:"trace"}),r),chunkLoggerController:r}}function r0(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Ev(t):vv(t)}var _v=Object.defineProperty,Sv=(t,e,r)=>e in t?_v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pd=(t,e,r)=>Sv(t,typeof e!="symbol"?e+"":e,r);let xv=class extends Dn{constructor(e){super(),this.opts=e,pd(this,"protocol","wc"),pd(this,"version",2)}};var Iv=Object.defineProperty,Av=(t,e,r)=>e in t?Iv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tv=(t,e,r)=>Av(t,e+"",r);class Ov extends Dn{constructor(e,r){super(),this.core=e,this.logger=r,Tv(this,"records",new Map)}}class Cv{constructor(e,r){this.logger=e,this.core=r}}class Rv extends Dn{constructor(e,r){super(),this.relayer=e,this.logger=r}}let Dv=class extends Dn{constructor(e){super()}},Bv=class{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}},Nv=class extends Dn{constructor(e,r){super(),this.relayer=e,this.logger=r}},Pv=class extends Dn{constructor(e,r){super(),this.core=e,this.logger=r}},Uv=class{constructor(e,r,n){this.core=e,this.logger=r,this.store=n}},Lv=class{constructor(e,r){this.projectId=e,this.logger=r}},Mv=class{constructor(e,r,n){this.core=e,this.logger=r,this.telemetryEnabled=n}};var $v=Object.defineProperty,Fv=(t,e,r)=>e in t?$v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,gd=(t,e,r)=>Fv(t,typeof e!="symbol"?e+"":e,r);let kv=class{constructor(e){this.opts=e,gd(this,"protocol","wc"),gd(this,"version",2)}},qv=class{constructor(e){this.client=e}};function jv(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function n0(t,...e){if(!jv(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function yd(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function zv(t,e){n0(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const qn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const Ic=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function Vv(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function i0(t){return typeof t=="string"&&(t=Vv(t)),n0(t),t}let Hv=class{clone(){return this._cloneInto()}};function Kv(t){const e=n=>t().update(i0(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function s0(t=32){if(qn&&typeof qn.getRandomValues=="function")return qn.getRandomValues(new Uint8Array(t));if(qn&&typeof qn.randomBytes=="function")return qn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function Wv(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}let Gv=class extends Hv{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ic(this.buffer)}update(e){yd(this);const{view:r,buffer:n,blockLen:i}=this;e=i0(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=Ic(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){yd(this),zv(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let f=o;f<i;f++)r[f]=0;Wv(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=Ic(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)a.setUint32(4*f,l[f],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}};const vs=BigInt(2**32-1),bu=BigInt(32);function o0(t,e=!1){return e?{h:Number(t&vs),l:Number(t>>bu&vs)}:{h:Number(t>>bu&vs)|0,l:Number(t&vs)|0}}function Yv(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=o0(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const Xv=(t,e)=>BigInt(t>>>0)<<bu|BigInt(e>>>0),Zv=(t,e,r)=>t>>>r,Jv=(t,e,r)=>t<<32-r|e>>>r,Qv=(t,e,r)=>t>>>r|e<<32-r,e2=(t,e,r)=>t<<32-r|e>>>r,t2=(t,e,r)=>t<<64-r|e>>>r-32,r2=(t,e,r)=>t>>>r-32|e<<64-r,n2=(t,e)=>e,i2=(t,e)=>t,s2=(t,e,r)=>t<<r|e>>>32-r,o2=(t,e,r)=>e<<r|t>>>32-r,a2=(t,e,r)=>e<<r-32|t>>>64-r,c2=(t,e,r)=>t<<r-32|e>>>64-r;function u2(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}const l2=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),f2=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,h2=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),d2=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,p2=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),g2=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,xe={fromBig:o0,split:Yv,toBig:Xv,shrSH:Zv,shrSL:Jv,rotrSH:Qv,rotrSL:e2,rotrBH:t2,rotrBL:r2,rotr32H:n2,rotr32L:i2,rotlSH:s2,rotlSL:o2,rotlBH:a2,rotlBL:c2,add:u2,add3L:l2,add3H:f2,add4L:h2,add4H:d2,add5H:g2,add5L:p2},[y2,w2]=xe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Mr=new Uint32Array(80),$r=new Uint32Array(80);let m2=class extends Gv{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:f,Fl:p,Gh:d,Gl:h,Hh:g,Hl:m}=this;return[e,r,n,i,s,o,a,c,u,l,f,p,d,h,g,m]}set(e,r,n,i,s,o,a,c,u,l,f,p,d,h,g,m){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=f|0,this.Fl=p|0,this.Gh=d|0,this.Gl=h|0,this.Hh=g|0,this.Hl=m|0}process(e,r){for(let b=0;b<16;b++,r+=4)Mr[b]=e.getUint32(r),$r[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){const x=Mr[b-15]|0,I=$r[b-15]|0,A=xe.rotrSH(x,I,1)^xe.rotrSH(x,I,8)^xe.shrSH(x,I,7),B=xe.rotrSL(x,I,1)^xe.rotrSL(x,I,8)^xe.shrSL(x,I,7),P=Mr[b-2]|0,N=$r[b-2]|0,$=xe.rotrSH(P,N,19)^xe.rotrBH(P,N,61)^xe.shrSH(P,N,6),G=xe.rotrSL(P,N,19)^xe.rotrBL(P,N,61)^xe.shrSL(P,N,6),q=xe.add4L(B,G,$r[b-7],$r[b-16]),L=xe.add4H(q,A,$,Mr[b-7],Mr[b-16]);Mr[b]=L|0,$r[b]=q|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:f,El:p,Fh:d,Fl:h,Gh:g,Gl:m,Hh:y,Hl:S}=this;for(let b=0;b<80;b++){const x=xe.rotrSH(f,p,14)^xe.rotrSH(f,p,18)^xe.rotrBH(f,p,41),I=xe.rotrSL(f,p,14)^xe.rotrSL(f,p,18)^xe.rotrBL(f,p,41),A=f&d^~f&g,B=p&h^~p&m,P=xe.add5L(S,I,B,w2[b],$r[b]),N=xe.add5H(P,y,x,A,y2[b],Mr[b]),$=P|0,G=xe.rotrSH(n,i,28)^xe.rotrBH(n,i,34)^xe.rotrBH(n,i,39),q=xe.rotrSL(n,i,28)^xe.rotrBL(n,i,34)^xe.rotrBL(n,i,39),L=n&s^n&a^s&a,j=i&o^i&c^o&c;y=g|0,S=m|0,g=d|0,m=h|0,d=f|0,h=p|0,{h:f,l:p}=xe.add(u|0,l|0,N|0,$|0),u=a|0,l=c|0,a=s|0,c=o|0,s=n|0,o=i|0;const T=xe.add3L($,q,j);n=xe.add3H(T,N,G,L),i=T|0}({h:n,l:i}=xe.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=xe.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=xe.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=xe.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:f,l:p}=xe.add(this.Eh|0,this.El|0,f|0,p|0),{h:d,l:h}=xe.add(this.Fh|0,this.Fl|0,d|0,h|0),{h:g,l:m}=xe.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:y,l:S}=xe.add(this.Hh|0,this.Hl|0,y|0,S|0),this.set(n,i,s,o,a,c,u,l,f,p,d,h,g,m,y,S)}roundClean(){Mr.fill(0),$r.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const b2=Kv(()=>new m2);const Cl=BigInt(0),a0=BigInt(1),E2=BigInt(2);function Rl(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Dl(t){if(!Rl(t))throw new Error("Uint8Array expected")}function Ac(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const v2=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Bl(t){Dl(t);let e="";for(let r=0;r<t.length;r++)e+=v2[t[r]];return e}function c0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Cl:BigInt("0x"+t)}const wr={_0:48,_9:57,A:65,F:70,a:97,f:102};function wd(t){if(t>=wr._0&&t<=wr._9)return t-wr._0;if(t>=wr.A&&t<=wr.F)return t-(wr.A-10);if(t>=wr.a&&t<=wr.f)return t-(wr.a-10)}function u0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=wd(t.charCodeAt(s)),a=wd(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function _2(t){return c0(Bl(t))}function Ls(t){return Dl(t),c0(Bl(Uint8Array.from(t).reverse()))}function l0(t,e){return u0(t.toString(16).padStart(e*2,"0"))}function Eu(t,e){return l0(t,e).reverse()}function mr(t,e,r){let n;if(typeof e=="string")try{n=u0(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Rl(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function md(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Dl(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}const Tc=t=>typeof t=="bigint"&&Cl<=t;function S2(t,e,r){return Tc(t)&&Tc(e)&&Tc(r)&&e<=t&&t<r}function mi(t,e,r,n){if(!S2(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function x2(t){let e;for(e=0;t>Cl;t>>=a0,e+=1);return e}const I2=t=>(E2<<BigInt(t-1))-a0,A2={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Rl(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Nl(t,e,r={}){const n=(i,s,o)=>{const a=A2[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}function bd(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}const tt=BigInt(0),Ve=BigInt(1),wn=BigInt(2),T2=BigInt(3),vu=BigInt(4),Ed=BigInt(5),vd=BigInt(8);function Ye(t,e){const r=t%e;return r>=tt?r:e+r}function O2(t,e,r){if(e<tt)throw new Error("invalid exponent, negatives unsupported");if(r<=tt)throw new Error("invalid modulus");if(r===Ve)return tt;let n=Ve;for(;e>tt;)e&Ve&&(n=n*t%r),t=t*t%r,e>>=Ve;return n}function or(t,e,r){let n=t;for(;e-- >tt;)n*=n,n%=r;return n}function _d(t,e){if(t===tt)throw new Error("invert: expected non-zero number");if(e<=tt)throw new Error("invert: expected positive modulus, got "+e);let r=Ye(t,e),n=e,i=tt,s=Ve;for(;r!==tt;){const o=n/r,a=n%r,c=i-s*o;n=r,r=a,i=s,s=c}if(n!==Ve)throw new Error("invert: does not exist");return Ye(i,e)}function C2(t){const e=(t-Ve)/wn;let r,n,i;for(r=t-Ve,n=0;r%wn===tt;r/=wn,n++);for(i=wn;i<t&&O2(i,e,t)!==t-Ve;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+Ve)/vu;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const s=(r+Ve)/wn;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,i),r),l=o.pow(a,s),f=o.pow(a,r);for(;!o.eql(f,o.ONE);){if(o.eql(f,o.ZERO))return o.ZERO;let p=1;for(let h=o.sqr(f);p<c&&!o.eql(h,o.ONE);p++)h=o.sqr(h);const d=o.pow(u,Ve<<BigInt(c-p-1));u=o.sqr(d),l=o.mul(l,d),f=o.mul(f,u),c=p}return l}}function R2(t){if(t%vu===T2){const e=(t+Ve)/vu;return function(r,n){const i=r.pow(n,e);if(!r.eql(r.sqr(i),n))throw new Error("Cannot find square root");return i}}if(t%vd===Ed){const e=(t-Ed)/vd;return function(r,n){const i=r.mul(n,wn),s=r.pow(i,e),o=r.mul(n,s),a=r.mul(r.mul(o,wn),s),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),n))throw new Error("Cannot find square root");return c}}return C2(t)}const D2=(t,e)=>(Ye(t,e)&Ve)===Ve,B2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function N2(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=B2.reduce((n,i)=>(n[i]="function",n),e);return Nl(t,r)}function P2(t,e,r){if(r<tt)throw new Error("invalid exponent, negatives unsupported");if(r===tt)return t.ONE;if(r===Ve)return e;let n=t.ONE,i=e;for(;r>tt;)r&Ve&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Ve;return n}function U2(t,e){const r=new Array(e.length),n=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),i),r}function f0(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function h0(t,e,r=!1,n={}){if(t<=tt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=f0(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:I2(i),ZERO:tt,ONE:Ve,create:c=>Ye(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return tt<=c&&c<t},is0:c=>c===tt,isOdd:c=>(c&Ve)===Ve,neg:c=>Ye(-c,t),eql:(c,u)=>c===u,sqr:c=>Ye(c*c,t),add:(c,u)=>Ye(c+u,t),sub:(c,u)=>Ye(c-u,t),mul:(c,u)=>Ye(c*u,t),pow:(c,u)=>P2(a,c,u),div:(c,u)=>Ye(c*_d(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>_d(c,t),sqrt:n.sqrt||(c=>(o||(o=R2(t)),o(a,c))),invertBatch:c=>U2(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>r?Eu(c,s):l0(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Ls(c):_2(c)}});return Object.freeze(a)}const Sd=BigInt(0),_s=BigInt(1);function Oc(t,e){const r=e.negate();return t?r:e}function d0(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Cc(t,e){d0(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function L2(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function M2(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Rc=new WeakMap,p0=new WeakMap;function Dc(t){return p0.get(t)||1}function $2(t,e){return{constTimeNegate:Oc,hasPrecomputes(r){return Dc(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>Sd;)n&_s&&(i=i.add(s)),s=s.double(),n>>=_s;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=Cc(n,e),o=[];let a=r,c=a;for(let u=0;u<i;u++){c=a,o.push(c);for(let l=1;l<s;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,i){const{windows:s,windowSize:o}=Cc(r,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**r-1),l=2**r,f=BigInt(r);for(let p=0;p<s;p++){const d=p*o;let h=Number(i&u);i>>=f,h>o&&(h-=l,i+=_s);const g=d,m=d+Math.abs(h)-1,y=p%2!==0,S=h<0;h===0?c=c.add(Oc(y,n[g])):a=a.add(Oc(S,n[m]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:o,windowSize:a}=Cc(r,e),c=BigInt(2**r-1),u=2**r,l=BigInt(r);for(let f=0;f<o;f++){const p=f*a;if(i===Sd)break;let d=Number(i&c);if(i>>=l,d>a&&(d-=u,i+=_s),d===0)continue;let h=n[p+Math.abs(d)-1];d<0&&(h=h.negate()),s=s.add(h)}return s},getPrecomputes(r,n,i){let s=Rc.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&Rc.set(n,i(s))),s},wNAFCached(r,n,i){const s=Dc(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const o=Dc(r);return o===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,i),n,s)},setWindowSize(r,n){d0(n,e),p0.set(r,n),Rc.delete(r)}}}function F2(t,e,r,n){if(L2(r,t),M2(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=x2(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),u=Math.floor((e.BITS-1)/o)*o;let l=i;for(let f=u;f>=0;f-=o){c.fill(i);for(let d=0;d<n.length;d++){const h=n[d],g=Number(h>>BigInt(f)&BigInt(a));c[g]=c[g].add(r[d])}let p=i;for(let d=c.length-1,h=i;d>0;d--)h=h.add(c[d]),p=p.add(h);if(l=l.add(p),f!==0)for(let d=0;d<o;d++)l=l.double()}return l}function k2(t){return N2(t.Fp),Nl(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...f0(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Wt=BigInt(0),vt=BigInt(1),Ss=BigInt(2),q2=BigInt(8),j2={zip215:!0};function z2(t){const e=k2(t);return Nl(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function V2(t){const e=z2(t),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=e,u=Ss<<BigInt(a*8)-vt,l=r.create,f=h0(e.n,e.nBitLength),p=e.uvRatio||((T,D)=>{try{return{isValid:!0,value:r.sqrt(T*r.inv(D))}}catch{return{isValid:!1,value:Wt}}}),d=e.adjustScalarBytes||(T=>T),h=e.domain||((T,D,F)=>{if(Ac("phflag",F),D.length||F)throw new Error("Contexts/pre-hash are not supported");return T});function g(T,D){mi("coordinate "+T,D,Wt,u)}function m(T){if(!(T instanceof b))throw new Error("ExtendedPoint expected")}const y=bd((T,D)=>{const{ex:F,ey:K,ez:k}=T,X=T.is0();D==null&&(D=X?q2:r.inv(k));const ee=l(F*D),te=l(K*D),le=l(k*D);if(X)return{x:Wt,y:vt};if(le!==vt)throw new Error("invZ was invalid");return{x:ee,y:te}}),S=bd(T=>{const{a:D,d:F}=e;if(T.is0())throw new Error("bad point: ZERO");const{ex:K,ey:k,ez:X,et:ee}=T,te=l(K*K),le=l(k*k),z=l(X*X),ce=l(z*z),W=l(te*D),V=l(z*l(W+le)),re=l(ce+l(F*l(te*le)));if(V!==re)throw new Error("bad point: equation left != right (1)");const oe=l(K*k),C=l(X*ee);if(oe!==C)throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(D,F,K,k){this.ex=D,this.ey=F,this.ez=K,this.et=k,g("x",D),g("y",F),g("z",K),g("t",k),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(D){if(D instanceof b)throw new Error("extended point not allowed");const{x:F,y:K}=D||{};return g("x",F),g("y",K),new b(F,K,vt,l(F*K))}static normalizeZ(D){const F=r.invertBatch(D.map(K=>K.ez));return D.map((K,k)=>K.toAffine(F[k])).map(b.fromAffine)}static msm(D,F){return F2(b,f,D,F)}_setWindowSize(D){A.setWindowSize(this,D)}assertValidity(){S(this)}equals(D){m(D);const{ex:F,ey:K,ez:k}=this,{ex:X,ey:ee,ez:te}=D,le=l(F*te),z=l(X*k),ce=l(K*te),W=l(ee*k);return le===z&&ce===W}is0(){return this.equals(b.ZERO)}negate(){return new b(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:D}=e,{ex:F,ey:K,ez:k}=this,X=l(F*F),ee=l(K*K),te=l(Ss*l(k*k)),le=l(D*X),z=F+K,ce=l(l(z*z)-X-ee),W=le+ee,V=W-te,re=le-ee,oe=l(ce*V),C=l(W*re),_=l(ce*re),v=l(V*W);return new b(oe,C,v,_)}add(D){m(D);const{a:F,d:K}=e,{ex:k,ey:X,ez:ee,et:te}=this,{ex:le,ey:z,ez:ce,et:W}=D;if(F===BigInt(-1)){const ie=l((X-k)*(z+le)),ne=l((X+k)*(z-le)),ue=l(ne-ie);if(ue===Wt)return this.double();const ge=l(ee*Ss*W),we=l(te*Ss*ce),ve=we+ge,Se=ne+ie,Oe=we-ge,O=l(ve*ue),w=l(Se*Oe),E=l(ve*Oe),M=l(ue*Se);return new b(O,w,M,E)}const V=l(k*le),re=l(X*z),oe=l(te*K*W),C=l(ee*ce),_=l((k+X)*(le+z)-V-re),v=C-oe,R=C+oe,U=l(re-F*V),Y=l(_*v),J=l(R*U),H=l(_*U),Q=l(v*R);return new b(Y,J,Q,H)}subtract(D){return this.add(D.negate())}wNAF(D){return A.wNAFCached(this,D,b.normalizeZ)}multiply(D){const F=D;mi("scalar",F,vt,n);const{p:K,f:k}=this.wNAF(F);return b.normalizeZ([K,k])[0]}multiplyUnsafe(D,F=b.ZERO){const K=D;return mi("scalar",K,Wt,n),K===Wt?I:this.is0()||K===vt?this:A.wNAFCachedUnsafe(this,K,b.normalizeZ,F)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return A.unsafeLadder(this,n).is0()}toAffine(D){return y(this,D)}clearCofactor(){const{h:D}=e;return D===vt?this:this.multiplyUnsafe(D)}static fromHex(D,F=!1){const{d:K,a:k}=e,X=r.BYTES;D=mr("pointHex",D,X),Ac("zip215",F);const ee=D.slice(),te=D[X-1];ee[X-1]=te&-129;const le=Ls(ee),z=F?u:r.ORDER;mi("pointHex.y",le,Wt,z);const ce=l(le*le),W=l(ce-vt),V=l(K*ce-k);let{isValid:re,value:oe}=p(W,V);if(!re)throw new Error("Point.fromHex: invalid y coordinate");const C=(oe&vt)===vt,_=(te&128)!==0;if(!F&&oe===Wt&&_)throw new Error("Point.fromHex: x=0 and x_0=1");return _!==C&&(oe=l(-oe)),b.fromAffine({x:oe,y:le})}static fromPrivateKey(D){return N(D).point}toRawBytes(){const{x:D,y:F}=this.toAffine(),K=Eu(F,r.BYTES);return K[K.length-1]|=D&vt?128:0,K}toHex(){return Bl(this.toRawBytes())}}b.BASE=new b(e.Gx,e.Gy,vt,l(e.Gx*e.Gy)),b.ZERO=new b(Wt,vt,vt,Wt);const{BASE:x,ZERO:I}=b,A=$2(b,a*8);function B(T){return Ye(T,n)}function P(T){return B(Ls(T))}function N(T){const D=r.BYTES;T=mr("private key",T,D);const F=mr("hashed private key",s(T),2*D),K=d(F.slice(0,D)),k=F.slice(D,2*D),X=P(K),ee=x.multiply(X),te=ee.toRawBytes();return{head:K,prefix:k,scalar:X,point:ee,pointBytes:te}}function $(T){return N(T).pointBytes}function G(T=new Uint8Array,...D){const F=md(...D);return P(s(h(F,mr("context",T),!!i)))}function q(T,D,F={}){T=mr("message",T),i&&(T=i(T));const{prefix:K,scalar:k,pointBytes:X}=N(D),ee=G(F.context,K,T),te=x.multiply(ee).toRawBytes(),le=G(F.context,te,X,T),z=B(ee+le*k);mi("signature.s",z,Wt,n);const ce=md(te,Eu(z,r.BYTES));return mr("result",ce,r.BYTES*2)}const L=j2;function j(T,D,F,K=L){const{context:k,zip215:X}=K,ee=r.BYTES;T=mr("signature",T,2*ee),D=mr("message",D),F=mr("publicKey",F,ee),X!==void 0&&Ac("zip215",X),i&&(D=i(D));const te=Ls(T.slice(ee,2*ee));let le,z,ce;try{le=b.fromHex(F,X),z=b.fromHex(T.slice(0,ee),X),ce=x.multiplyUnsafe(te)}catch{return!1}if(!X&&le.isSmallOrder())return!1;const W=G(k,z.toRawBytes(),le.toRawBytes(),D);return z.add(le.multiplyUnsafe(W)).subtract(ce).clearCofactor().equals(b.ZERO)}return x._setWindowSize(8),{CURVE:e,getPublicKey:$,sign:q,verify:j,ExtendedPoint:b,utils:{getExtendedPublicKey:N,randomPrivateKey:()=>o(r.BYTES),precompute(T=8,D=b.BASE){return D._setWindowSize(T),D.multiply(BigInt(3)),D}}}}BigInt(0),BigInt(1);const Pl=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),xd=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const H2=BigInt(1),Id=BigInt(2);BigInt(3);const K2=BigInt(5),W2=BigInt(8);function G2(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=Pl,o=t*t%s*t%s,a=or(o,Id,s)*o%s,c=or(a,H2,s)*t%s,u=or(c,K2,s)*c%s,l=or(u,e,s)*u%s,f=or(l,r,s)*l%s,p=or(f,n,s)*f%s,d=or(p,i,s)*p%s,h=or(d,i,s)*p%s,g=or(h,e,s)*u%s;return{pow_p_5_8:or(g,Id,s)*t%s,b2:o}}function Y2(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function X2(t,e){const r=Pl,n=Ye(e*e*e,r),i=Ye(n*n*e,r),s=G2(t*i).pow_p_5_8;let o=Ye(t*n*s,r);const a=Ye(e*o*o,r),c=o,u=Ye(o*xd,r),l=a===t,f=a===Ye(-t,r),p=a===Ye(-t*xd,r);return l&&(o=c),(f||p)&&(o=u),D2(o,r)&&(o=Ye(-o,r)),{isValid:l||f,value:o}}const Z2=h0(Pl,void 0,!0),J2={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Z2,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:W2,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:b2,randomBytes:s0,adjustScalarBytes:Y2,uvRatio:X2},g0=V2(J2),Q2="EdDSA",e_="JWT",js=".",ho="base64url",y0="utf8",w0="utf8",t_=":",r_="did",n_="key",Ad="base58btc",i_="z",s_="K36",o_=32;function Ul(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function m0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ul(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function b0(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=m0(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return Ul(r)}function a_(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function f(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var g=0,m=0,y=0,S=h.length;y!==S&&h[y]===0;)y++,g++;for(var b=(S-y)*l+1>>>0,x=new Uint8Array(b);y!==S;){for(var I=h[y],A=0,B=b-1;(I!==0||A<m)&&B!==-1;B--,A++)I+=256*x[B]>>>0,x[B]=I%a>>>0,I=I/a>>>0;if(I!==0)throw new Error("Non-zero carry");m=A,y++}for(var P=b-m;P!==b&&x[P]===0;)P++;for(var N=c.repeat(g);P<b;++P)N+=t.charAt(x[P]);return N}function p(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var g=0;if(h[g]!==" "){for(var m=0,y=0;h[g]===c;)m++,g++;for(var S=(h.length-g)*u+1>>>0,b=new Uint8Array(S);h[g];){var x=r[h.charCodeAt(g)];if(x===255)return;for(var I=0,A=S-1;(x!==0||I<y)&&A!==-1;A--,I++)x+=a*b[A]>>>0,b[A]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=I,g++}if(h[g]!==" "){for(var B=S-y;B!==S&&b[B]===0;)B++;for(var P=new Uint8Array(m+(S-B)),N=m;B!==S;)P[N++]=b[B++];return P}}}function d(h){var g=p(h);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:p,decode:d}}var c_=a_,u_=c_;const E0=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},l_=t=>new TextEncoder().encode(t),f_=t=>new TextDecoder().decode(t);let h_=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},d_=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return v0(this,e)}},p_=class{constructor(e){this.decoders=e}or(e){return v0(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const v0=(t,e)=>new p_({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let g_=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new h_(e,r,n),this.decoder=new d_(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const po=({name:t,prefix:e,encode:r,decode:n})=>new g_(t,e,r,n),ns=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=u_(r,e);return po({prefix:t,name:e,encode:n,decode:s=>E0(i(s))})},y_=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let l=0;l<s;++l){const f=i[t[l]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},w_=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},it=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>po({prefix:e,name:t,encode(i){return w_(i,n,r)},decode(i){return y_(i,n,r,t)}}),m_=po({prefix:"\0",name:"identity",encode:t=>f_(t),decode:t=>l_(t)});var b_=Object.freeze({__proto__:null,identity:m_});const E_=it({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var v_=Object.freeze({__proto__:null,base2:E_});const __=it({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var S_=Object.freeze({__proto__:null,base8:__});const x_=ns({prefix:"9",name:"base10",alphabet:"0123456789"});var I_=Object.freeze({__proto__:null,base10:x_});const A_=it({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),T_=it({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var O_=Object.freeze({__proto__:null,base16:A_,base16upper:T_});const C_=it({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),R_=it({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),D_=it({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),B_=it({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),N_=it({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),P_=it({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),U_=it({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),L_=it({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),M_=it({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var $_=Object.freeze({__proto__:null,base32:C_,base32upper:R_,base32pad:D_,base32padupper:B_,base32hex:N_,base32hexupper:P_,base32hexpad:U_,base32hexpadupper:L_,base32z:M_});const F_=ns({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),k_=ns({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var q_=Object.freeze({__proto__:null,base36:F_,base36upper:k_});const j_=ns({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),z_=ns({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var V_=Object.freeze({__proto__:null,base58btc:j_,base58flickr:z_});const H_=it({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),K_=it({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),W_=it({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),G_=it({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Y_=Object.freeze({__proto__:null,base64:H_,base64pad:K_,base64url:W_,base64urlpad:G_});const _0=Array.from("ððªâð°ðððððððððððððâð»ð¥ð¾ð¿ðâ¤ðð¤£ðððð­ðððððð¥ð¥°ðððð¢ð¤ðððªðâºðð¤ððððð¹ð¤¦ððââ¨ð¤·ð±ðð¸ððððððððð¤©ððð¤ðð¯ððð¶ðð¤­â£ððððªðð¥ððð©ð¡ð¤ªðð¥³ð¥ð¤¤ððð³âððð´ðð¬ððð·ð»ðâ­âð¥ºððð¤ð¦âð£ððâ¹ððð âððºðð»ððððð¹ð£ð«ðððµð¤ðð´ð¤ð¼ð«â½ð¤âðð¤«ðð®ðð»ðð¶ðð²ð¿ð§¡ðâ¡ððââðð°ð¤¨ð¶ð¤ð¶ð°ðð¢ð¤ðð¨ð¨ð¤¬âððºð¤ððð±ðð¶ð¥´â¶â¡âðð¸â¬ð¨ðð¦ð·ðºâ ðððµðð¤²ð¤ ð¤§ððµðð§ð¾ððð¤ðð¤¯ð·âð§ð¯ððð¤ððâð´ð£ð¸ððð¥ð¤¢ðð¡ð©ðð¸ð»ð¤ð¤®ð¼ð¥µð©ððð¼ðð£ð¥"),X_=_0.reduce((t,e,r)=>(t[r]=e,t),[]),Z_=_0.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function J_(t){return t.reduce((e,r)=>(e+=X_[r],e),"")}function Q_(t){const e=[];for(const r of t){const n=Z_[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const eS=po({prefix:"ð",name:"base256emoji",encode:J_,decode:Q_});var tS=Object.freeze({__proto__:null,base256emoji:eS}),rS=S0,Td=128,nS=-128,iS=Math.pow(2,31);function S0(t,e,r){e=e||[],r=r||0;for(var n=r;t>=iS;)e[r++]=t&255|Td,t/=128;for(;t&nS;)e[r++]=t&255|Td,t>>>=7;return e[r]=t|0,S0.bytes=r-n+1,e}var sS=_u,oS=128,Od=127;function _u(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw _u.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Od)<<i:(o&Od)*Math.pow(2,i),i+=7}while(o>=oS);return _u.bytes=s-n,r}var aS=Math.pow(2,7),cS=Math.pow(2,14),uS=Math.pow(2,21),lS=Math.pow(2,28),fS=Math.pow(2,35),hS=Math.pow(2,42),dS=Math.pow(2,49),pS=Math.pow(2,56),gS=Math.pow(2,63),yS=function(t){return t<aS?1:t<cS?2:t<uS?3:t<lS?4:t<fS?5:t<hS?6:t<dS?7:t<pS?8:t<gS?9:10},wS={encode:rS,decode:sS,encodingLength:yS},x0=wS;const Cd=(t,e,r=0)=>(x0.encode(t,e,r),e),Rd=t=>x0.encodingLength(t),Su=(t,e)=>{const r=e.byteLength,n=Rd(t),i=n+Rd(r),s=new Uint8Array(i+r);return Cd(t,s,0),Cd(r,s,n),s.set(e,i),new mS(t,r,e,s)};let mS=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};const I0=({name:t,code:e,encode:r})=>new bS(t,e,r);let bS=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Su(this.code,r):r.then(n=>Su(this.code,n))}else throw Error("Unknown type, must be binary type")}};const A0=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),ES=I0({name:"sha2-256",code:18,encode:A0("SHA-256")}),vS=I0({name:"sha2-512",code:19,encode:A0("SHA-512")});var _S=Object.freeze({__proto__:null,sha256:ES,sha512:vS});const T0=0,SS="identity",O0=E0,xS=t=>Su(T0,O0(t)),IS={code:T0,name:SS,encode:O0,digest:xS};var AS=Object.freeze({__proto__:null,identity:IS});new TextEncoder,new TextDecoder;const Dd={...b_,...v_,...S_,...I_,...O_,...$_,...q_,...V_,...Y_,...tS};({..._S,...AS});function C0(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Bd=C0("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Bc=C0("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=m0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),R0={utf8:Bd,"utf-8":Bd,hex:Dd.base16,latin1:Bc,ascii:Bc,binary:Bc,...Dd};function go(t,e="utf8"){const r=R0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ui(t,e="utf8"){const r=R0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ul(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Nd(t){return ti(go(ui(t,ho),y0))}function zs(t){return go(ui(An(t),y0),ho)}function D0(t){const e=ui(s_,Ad),r=i_+go(b0([e,t]),Ad);return[r_,n_,r].join(t_)}function TS(t){return go(t,ho)}function OS(t){return ui(t,ho)}function CS(t){return ui([zs(t.header),zs(t.payload)].join(js),w0)}function RS(t){return[zs(t.header),zs(t.payload),TS(t.signature)].join(js)}function xu(t){const e=t.split(js),r=Nd(e[0]),n=Nd(e[1]),i=OS(e[2]),s=ui(e.slice(0,2).join(js),w0);return{header:r,payload:n,signature:i,data:s}}function Pd(t=s0(o_)){const e=g0.getPublicKey(t);return{secretKey:b0([t,e]),publicKey:e}}async function DS(t,e,r,n,i=pe.fromMiliseconds(Date.now())){const s={alg:Q2,typ:e_},o=D0(n.publicKey),a=i+r,c={iss:o,sub:t,aud:e,iat:i,exp:a},u=CS({header:s,payload:c}),l=g0.sign(u,n.secretKey.slice(0,32));return RS({header:s,payload:c,signature:l})}var Ud=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},BS=(function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t})(),NS=(function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t})(),PS=(function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t})(),US=(function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t})(),LS=(function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t})(),MS=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,$S=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ld=3,FS=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",MS]],Md=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function kS(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new LS:typeof navigator<"u"?jS(navigator.userAgent):VS()}function qS(t){return t!==""&&FS.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function jS(t){var e=qS(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new US;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Ld&&(i=Ud(Ud([],i,!0),HS(Ld-i.length),!0)):i=[];var s=i.join("."),o=zS(t),a=$S.exec(t);return a&&a[1]?new PS(r,s,o,a[1]):new BS(r,s,o)}function zS(t){for(var e=0,r=Md.length;e<r;e++){var n=Md[e],i=n[0],s=n[1],o=s.exec(t);if(o)return i}return null}function VS(){var t=typeof process<"u"&&process.version;return t?new NS(process.version.slice(1)):null}function HS(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Pe={},$d;function B0(){if($d)return Pe;$d=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.getLocalStorage=Pe.getLocalStorageOrThrow=Pe.getCrypto=Pe.getCryptoOrThrow=Pe.getLocation=Pe.getLocationOrThrow=Pe.getNavigator=Pe.getNavigatorOrThrow=Pe.getDocument=Pe.getDocumentOrThrow=Pe.getFromWindowOrThrow=Pe.getFromWindow=void 0;function t(p){let d;return typeof window<"u"&&typeof window[p]<"u"&&(d=window[p]),d}Pe.getFromWindow=t;function e(p){const d=t(p);if(!d)throw new Error(`${p} is not defined in Window`);return d}Pe.getFromWindowOrThrow=e;function r(){return e("document")}Pe.getDocumentOrThrow=r;function n(){return t("document")}Pe.getDocument=n;function i(){return e("navigator")}Pe.getNavigatorOrThrow=i;function s(){return t("navigator")}Pe.getNavigator=s;function o(){return e("location")}Pe.getLocationOrThrow=o;function a(){return t("location")}Pe.getLocation=a;function c(){return e("crypto")}Pe.getCryptoOrThrow=c;function u(){return t("crypto")}Pe.getCrypto=u;function l(){return e("localStorage")}Pe.getLocalStorageOrThrow=l;function f(){return t("localStorage")}return Pe.getLocalStorage=f,Pe}var pr=B0(),bi={},Fd;function KS(){if(Fd)return bi;Fd=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.getWindowMetadata=void 0;const t=B0();function e(){let r,n;try{r=t.getDocumentOrThrow(),n=t.getLocationOrThrow()}catch{return null}function i(){const d=r.getElementsByTagName("link"),h=[];for(let g=0;g<d.length;g++){const m=d[g],y=m.getAttribute("rel");if(y&&y.toLowerCase().indexOf("icon")>-1){const S=m.getAttribute("href");if(S)if(S.toLowerCase().indexOf("https:")===-1&&S.toLowerCase().indexOf("http:")===-1&&S.indexOf("//")!==0){let b=n.protocol+"//"+n.host;if(S.indexOf("/")===0)b+=S;else{const x=n.pathname.split("/");x.pop();const I=x.join("/");b+=I+"/"+S}h.push(b)}else if(S.indexOf("//")===0){const b=n.protocol+S;h.push(b)}else h.push(S)}}return h}function s(...d){const h=r.getElementsByTagName("meta");for(let g=0;g<h.length;g++){const m=h[g],y=["itemprop","property","name"].map(S=>m.getAttribute(S)).filter(S=>S?d.includes(S):!1);if(y.length&&y){const S=m.getAttribute("content");if(S)return S}}return""}function o(){let d=s("name","og:site_name","og:title","twitter:title");return d||(d=r.title),d}function a(){return s("description","og:description","twitter:description","keywords")}const c=o(),u=a(),l=n.origin,f=i();return{description:u,url:l,icons:f,name:c}}return bi.getWindowMetadata=e,bi}var WS=KS();const GS="0.1.1";function YS(){return GS}class Fe extends Error{constructor(e,r={}){const n=(()=>{if(r.cause instanceof Fe){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause&&"details"in r.cause&&typeof r.cause.details=="string"?r.cause.details:r.cause?.message?r.cause.message:r.details})(),i=r.cause instanceof Fe&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${i??""}`,a=[e||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...n||i?["",n?`Details: ${n}`:void 0,i?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${YS()}`}),this.cause=r.cause,this.details=n,this.docs=o,this.docsPath=i,this.shortMessage=e}walk(e){return N0(this,e)}}function N0(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?N0(t.cause,e):e?null:t}const jn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function XS(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Hi(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Tn(t,...e){if(!XS(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function ZS(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Hi(t.outputLen),Hi(t.blockLen)}function ri(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function P0(t,e){Tn(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function JS(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ni(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Nc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ar(t,e){return t<<32-e|t>>>e}const QS=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function ex(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function tx(t){for(let e=0;e<t.length;e++)t[e]=ex(t[e]);return t}const kd=QS?t=>t:tx;function rx(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function yo(t){return typeof t=="string"&&(t=rx(t)),Tn(t),t}function nx(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Tn(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}class Ll{}function U0(t){const e=n=>t().update(yo(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ix(t=32){if(jn&&typeof jn.getRandomValues=="function")return jn.getRandomValues(new Uint8Array(t));if(jn&&typeof jn.randomBytes=="function")return Uint8Array.from(jn.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function sx(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}function ox(t,e,r){return t&e^~t&r}function ax(t,e,r){return t&e^t&r^e&r}class cx extends Ll{constructor(e,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=Nc(this.buffer)}update(e){ri(this),e=yo(e),Tn(e);const{view:r,buffer:n,blockLen:i}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=Nc(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ri(this),P0(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,ni(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(n,0),o=0);for(let f=o;f<i;f++)r[f]=0;sx(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=Nc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)a.setUint32(4*f,l[f],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=s,e.length=i,e.pos=a,i%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const Fr=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),xs=BigInt(2**32-1),qd=BigInt(32);function ux(t,e=!1){return e?{h:Number(t&xs),l:Number(t>>qd&xs)}:{h:Number(t>>qd&xs)|0,l:Number(t&xs)|0}}function lx(t,e=!1){const r=t.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){const{h:o,l:a}=ux(t[s],e);[n[s],i[s]]=[o,a]}return[n,i]}const fx=(t,e,r)=>t<<r|e>>>32-r,hx=(t,e,r)=>e<<r|t>>>32-r,dx=(t,e,r)=>e<<r-32|t>>>64-r,px=(t,e,r)=>t<<r-32|e>>>64-r,gx=BigInt(0),Ei=BigInt(1),yx=BigInt(2),wx=BigInt(7),mx=BigInt(256),bx=BigInt(113),L0=[],M0=[],$0=[];for(let t=0,e=Ei,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],L0.push(2*(5*n+r)),M0.push((t+1)*(t+2)/2%64);let i=gx;for(let s=0;s<7;s++)e=(e<<Ei^(e>>wx)*bx)%mx,e&yx&&(i^=Ei<<(Ei<<BigInt(s))-Ei);$0.push(i)}const F0=lx($0,!0),Ex=F0[0],vx=F0[1],jd=(t,e,r)=>r>32?dx(t,e,r):fx(t,e,r),zd=(t,e,r)=>r>32?px(t,e,r):hx(t,e,r);function _x(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=r[c],l=r[c+1],f=jd(u,l,1)^r[a],p=zd(u,l,1)^r[a+1];for(let d=0;d<50;d+=10)t[o+d]^=f,t[o+d+1]^=p}let i=t[2],s=t[3];for(let o=0;o<24;o++){const a=M0[o],c=jd(i,s,a),u=zd(i,s,a),l=L0[o];i=t[l],s=t[l+1],t[l]=c,t[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=Ex[n],t[1]^=vx[n]}ni(r)}class Ml extends Ll{constructor(e,r,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,Hi(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=JS(this.state)}clone(){return this._cloneInto()}keccak(){kd(this.state32),_x(this.state32,this.rounds),kd(this.state32),this.posOut=0,this.pos=0}update(e){ri(this),e=yo(e),Tn(e);const{blockLen:r,state:n}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){ri(this,!1),Tn(e),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Hi(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(P0(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,ni(this.state)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new Ml(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Sx=(t,e,r)=>U0(()=>new Ml(e,t,r)),xx=Sx(1,136,256/8),Ix=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),kr=new Uint32Array(64);class Ax extends cx{constructor(e=32){super(64,e,8,!1),this.A=Fr[0]|0,this.B=Fr[1]|0,this.C=Fr[2]|0,this.D=Fr[3]|0,this.E=Fr[4]|0,this.F=Fr[5]|0,this.G=Fr[6]|0,this.H=Fr[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,r,n,i,s,o,a,c]}set(e,r,n,i,s,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let f=0;f<16;f++,r+=4)kr[f]=e.getUint32(r,!1);for(let f=16;f<64;f++){const p=kr[f-15],d=kr[f-2],h=ar(p,7)^ar(p,18)^p>>>3,g=ar(d,17)^ar(d,19)^d>>>10;kr[f]=g+kr[f-7]+h+kr[f-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:u,H:l}=this;for(let f=0;f<64;f++){const p=ar(a,6)^ar(a,11)^ar(a,25),d=l+p+ox(a,c,u)+Ix[f]+kr[f]|0,g=(ar(n,2)^ar(n,13)^ar(n,22))+ax(n,i,s)|0;l=u,u=c,c=a,a=o+d|0,o=s,s=i,i=n,n=d+g|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,i,s,o,a,c,u,l)}roundClean(){ni(kr)}destroy(){this.set(0,0,0,0,0,0,0,0),ni(this.buffer)}}const Tx=U0(()=>new Ax);const $l=BigInt(0),Iu=BigInt(1);function is(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Fl(t){if(!is(t))throw new Error("Uint8Array expected")}function Ki(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function Is(t){const e=t.toString(16);return e.length&1?"0"+e:e}function k0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?$l:BigInt("0x"+t)}const q0=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Ox=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Wi(t){if(Fl(t),q0)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=Ox[t[r]];return e}const br={_0:48,_9:57,A:65,F:70,a:97,f:102};function Vd(t){if(t>=br._0&&t<=br._9)return t-br._0;if(t>=br.A&&t<=br.F)return t-(br.A-10);if(t>=br.a&&t<=br.f)return t-(br.a-10)}function Vs(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(q0)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=Vd(t.charCodeAt(s)),a=Vd(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function xn(t){return k0(Wi(t))}function j0(t){return Fl(t),k0(Wi(Uint8Array.from(t).reverse()))}function ss(t,e){return Vs(t.toString(16).padStart(e*2,"0"))}function z0(t,e){return ss(t,e).reverse()}function kt(t,e,r){let n;if(typeof e=="string")try{n=Vs(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(is(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Hs(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Fl(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}const Pc=t=>typeof t=="bigint"&&$l<=t;function kl(t,e,r){return Pc(t)&&Pc(e)&&Pc(r)&&e<=t&&t<r}function Xn(t,e,r,n){if(!kl(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function Cx(t){let e;for(e=0;t>$l;t>>=Iu,e+=1);return e}const wo=t=>(Iu<<BigInt(t))-Iu,Uc=t=>new Uint8Array(t),Hd=t=>Uint8Array.from(t);function Rx(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Uc(t),i=Uc(t),s=0;const o=()=>{n.fill(1),i.fill(0),s=0},a=(...f)=>r(i,n,...f),c=(f=Uc(0))=>{i=a(Hd([0]),f),n=a(),f.length!==0&&(i=a(Hd([1]),f),n=a())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const p=[];for(;f<e;){n=a();const d=n.slice();p.push(d),f+=n.length}return Hs(...p)};return(f,p)=>{o(),c(f);let d;for(;!(d=p(u()));)c();return o(),d}}const Dx={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||is(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function mo(t,e,r={}){const n=(i,s,o)=>{const a=Dx[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}function Kd(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}function Bx(t,e){if(Xd(t)>e)throw new Qx({givenSize:Xd(t),maxSize:e})}const Er={zero:48,nine:57,A:65,F:70,a:97,f:102};function Wd(t){if(t>=Er.zero&&t<=Er.nine)return t-Er.zero;if(t>=Er.A&&t<=Er.F)return t-(Er.A-10);if(t>=Er.a&&t<=Er.f)return t-(Er.a-10)}function Nx(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;if(t.length>n)throw new eI({size:t.length,targetSize:n,type:"Bytes"});const i=new Uint8Array(n);for(let s=0;s<n;s++){const o=r==="right";i[o?s:n-s-1]=t[o?s:t.length-s-1]}return i}function V0(t,e){if(rn(t)>e)throw new zx({givenSize:rn(t),maxSize:e})}function Px(t,e){if(typeof e=="number"&&e>0&&e>rn(t)-1)throw new W0({offset:e,position:"start",size:rn(t)})}function Ux(t,e,r){if(typeof e=="number"&&typeof r=="number"&&rn(t)!==r-e)throw new W0({offset:r,position:"end",size:rn(t)})}function H0(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;const i=t.replace("0x","");if(i.length>n*2)throw new Vx({size:Math.ceil(i.length/2),targetSize:n,type:"Hex"});return`0x${i[r==="right"?"padEnd":"padStart"](n*2,"0")}`}const Lx="#__bigint";function ql(t,e,r){return JSON.stringify(t,(n,i)=>typeof i=="bigint"?i.toString()+Lx:i,r)}const Mx=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function $x(t,e={}){const{strict:r=!1}=e;if(!t)throw new Gd(t);if(typeof t!="string")throw new Gd(t);if(r&&!/^0x[0-9a-fA-F]*$/.test(t))throw new Yd(t);if(!t.startsWith("0x"))throw new Yd(t)}function Fx(...t){return`0x${t.reduce((e,r)=>e+r.replace("0x",""),"")}`}function jl(t){return t instanceof Uint8Array?Ks(t):Array.isArray(t)?Ks(new Uint8Array(t)):t}function Ks(t,e={}){let r="";for(let i=0;i<t.length;i++)r+=Mx[t[i]];const n=`0x${r}`;return typeof e.size=="number"?(V0(n,e.size),K0(n,e.size)):n}function Lc(t,e={}){const{signed:r,size:n}=e,i=BigInt(t);let s;n?r?s=(1n<<BigInt(n)*8n-1n)-1n:s=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&r?-s-1n:0;if(s&&i>s||i<o){const u=typeof t=="bigint"?"n":"";throw new jx({max:s?`${s}${u}`:void 0,min:`${o}${u}`,signed:r,size:n,value:`${t}${u}`})}const c=`0x${(r&&i<0?(1n<<BigInt(n*8))+BigInt(i):i).toString(16)}`;return n?kx(c,n):c}function kx(t,e){return H0(t,{dir:"left",size:e})}function K0(t,e){return H0(t,{dir:"right",size:e})}function Ar(t,e,r,n={}){const{strict:i}=n;Px(t,e);const s=`0x${t.replace("0x","").slice((e??0)*2,(r??t.length)*2)}`;return i&&Ux(s,e,r),s}function rn(t){return Math.ceil((t.length-2)/2)}function qx(t,e={}){const{strict:r=!1}=e;try{return $x(t,{strict:r}),!0}catch{return!1}}class jx extends Fe{constructor({max:e,min:r,signed:n,size:i,value:s}){super(`Number \`${s}\` is not in safe${i?` ${i*8}-bit`:""}${n?" signed":" unsigned"} integer range ${e?`(\`${r}\` to \`${e}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class Gd extends Fe{constructor(e){super(`Value \`${typeof e=="object"?ql(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class Yd extends Fe{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let zx=class extends Fe{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class W0 extends Fe{constructor({offset:e,position:r,size:n}){super(`Slice ${r==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let Vx=class extends Fe{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const Hx=new TextEncoder;function Kx(t){if(!(t instanceof Uint8Array)){if(!t)throw new As(t);if(typeof t!="object")throw new As(t);if(!("BYTES_PER_ELEMENT"in t))throw new As(t);if(t.BYTES_PER_ELEMENT!==1||t.constructor.name!=="Uint8Array")throw new As(t)}}function Wx(t){return t instanceof Uint8Array?t:typeof t=="string"?Yx(t):Gx(t)}function Gx(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function Yx(t,e={}){const{size:r}=e;let n=t;r&&(V0(t,r),n=K0(t,r));let i=n.slice(2);i.length%2&&(i=`0${i}`);const s=i.length/2,o=new Uint8Array(s);for(let a=0,c=0;a<s;a++){const u=Wd(i.charCodeAt(c++)),l=Wd(i.charCodeAt(c++));if(u===void 0||l===void 0)throw new Fe(`Invalid byte sequence ("${i[c-2]}${i[c-1]}" in "${i}").`);o[a]=u*16+l}return o}function Xx(t,e={}){const{size:r}=e,n=Hx.encode(t);return typeof r=="number"?(Bx(n,r),Zx(n,r)):n}function Zx(t,e){return Nx(t,{dir:"right",size:e})}function Xd(t){return t.length}function Jx(t){try{return Kx(t),!0}catch{return!1}}class As extends Fe{constructor(e){super(`Value \`${typeof e=="object"?ql(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class Qx extends Fe{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class eI extends Fe{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function G0(t,e={}){const{as:r=typeof t=="string"?"Hex":"Bytes"}=e,n=xx(Wx(t));return r==="Bytes"?n:Ks(n)}class tI extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const rI={checksum:new tI(8192)},Mc=rI.checksum;function Y0(t,e={}){const{compressed:r}=e,{prefix:n,x:i,y:s}=t;if(r===!1||typeof i=="bigint"&&typeof s=="bigint"){if(n!==4)throw new Zd({prefix:n,cause:new cI});return}if(r===!0||typeof i=="bigint"&&typeof s>"u"){if(n!==3&&n!==2)throw new Zd({prefix:n,cause:new aI});return}throw new oI({publicKey:t})}function nI(t){const e=(()=>{if(qx(t))return X0(t);if(Jx(t))return iI(t);const{prefix:r,x:n,y:i}=t;return typeof n=="bigint"&&typeof i=="bigint"?{prefix:r??4,x:n,y:i}:{prefix:r,x:n}})();return Y0(e),e}function iI(t){return X0(Ks(t))}function X0(t){if(t.length!==132&&t.length!==130&&t.length!==68)throw new uI({publicKey:t});if(t.length===130){const n=BigInt(Ar(t,0,32)),i=BigInt(Ar(t,32,64));return{prefix:4,x:n,y:i}}if(t.length===132){const n=Number(Ar(t,0,1)),i=BigInt(Ar(t,1,33)),s=BigInt(Ar(t,33,65));return{prefix:n,x:i,y:s}}const e=Number(Ar(t,0,1)),r=BigInt(Ar(t,1,33));return{prefix:e,x:r}}function sI(t,e={}){Y0(t);const{prefix:r,x:n,y:i}=t,{includePrefix:s=!0}=e;return Fx(s?Lc(r,{size:1}):"0x",Lc(n,{size:32}),typeof i=="bigint"?Lc(i,{size:32}):"0x")}class oI extends Fe{constructor({publicKey:e}){super(`Value \`${ql(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class Zd extends Fe{constructor({prefix:e,cause:r}){super(`Prefix "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class aI extends Fe{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class cI extends Fe{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let uI=class extends Fe{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${rn(jl(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const lI=/^0x[a-fA-F0-9]{40}$/;function Z0(t,e={}){const{strict:r=!0}=e;if(!lI.test(t))throw new Jd({address:t,cause:new dI});if(r){if(t.toLowerCase()===t)return;if(J0(t)!==t)throw new Jd({address:t,cause:new pI})}}function J0(t){if(Mc.has(t))return Mc.get(t);Z0(t,{strict:!1});const e=t.substring(2).toLowerCase(),r=G0(Xx(e),{as:"Bytes"}),n=e.split("");for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&n[s]&&(n[s]=n[s].toUpperCase()),(r[s>>1]&15)>=8&&n[s+1]&&(n[s+1]=n[s+1].toUpperCase());const i=`0x${n.join("")}`;return Mc.set(t,i),i}function fI(t,e={}){const{checksum:r=!1}=e;return Z0(t),r?J0(t):t}function hI(t,e={}){const r=G0(`0x${sI(t).slice(4)}`).substring(26);return fI(`0x${r}`,e)}class Jd extends Fe{constructor({address:e,cause:r}){super(`Address "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class dI extends Fe{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class pI extends Fe{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}class Q0 extends Ll{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,ZS(e);const n=yo(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),ni(s)}update(e){return ri(this),this.iHash.update(e),this}digestInto(e){ri(this),Tn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ey=(t,e,r)=>new Q0(t,e).update(r).digest();ey.create=(t,e)=>new Q0(t,e);const At=BigInt(0),bt=BigInt(1),bn=BigInt(2),gI=BigInt(3),ty=BigInt(4),ry=BigInt(5),ny=BigInt(8);function xt(t,e){const r=t%e;return r>=At?r:e+r}function Lt(t,e,r){let n=t;for(;e-- >At;)n*=n,n%=r;return n}function Au(t,e){if(t===At)throw new Error("invert: expected non-zero number");if(e<=At)throw new Error("invert: expected positive modulus, got "+e);let r=xt(t,e),n=e,i=At,s=bt;for(;r!==At;){const a=n/r,c=n%r,u=i-s*a;n=r,r=c,i=s,s=u}if(n!==bt)throw new Error("invert: does not exist");return xt(i,e)}function iy(t,e){const r=(t.ORDER+bt)/ty,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function yI(t,e){const r=(t.ORDER-ry)/ny,n=t.mul(e,bn),i=t.pow(n,r),s=t.mul(e,i),o=t.mul(t.mul(s,bn),i),a=t.mul(s,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function wI(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-bt,r=0;for(;e%bn===At;)e/=bn,r++;let n=bn;const i=zl(t);for(;Qd(i,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return iy;let s=i.pow(n,e);const o=(e+bt)/bn;return function(c,u){if(c.is0(u))return u;if(Qd(c,u)!==1)throw new Error("Cannot find square root");let l=r,f=c.mul(c.ONE,s),p=c.pow(u,e),d=c.pow(u,o);for(;!c.eql(p,c.ONE);){if(c.is0(p))return c.ZERO;let h=1,g=c.sqr(p);for(;!c.eql(g,c.ONE);)if(h++,g=c.sqr(g),h===l)throw new Error("Cannot find square root");const m=bt<<BigInt(l-h-1),y=c.pow(f,m);l=h,f=c.sqr(y),p=c.mul(p,f),d=c.mul(d,y)}return d}}function mI(t){return t%ty===gI?iy:t%ny===ry?yI:wI(t)}const bI=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function EI(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=bI.reduce((n,i)=>(n[i]="function",n),e);return mo(t,r)}function vI(t,e,r){if(r<At)throw new Error("invalid exponent, negatives unsupported");if(r===At)return t.ONE;if(r===bt)return e;let n=t.ONE,i=e;for(;r>At;)r&bt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=bt;return n}function sy(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce((o,a,c)=>t.is0(a)?o:(n[c]=o,t.mul(o,a)),t.ONE),s=t.inv(i);return e.reduceRight((o,a,c)=>t.is0(a)?o:(n[c]=t.mul(o,n[c]),t.mul(o,a)),s),n}function Qd(t,e){const r=(t.ORDER-bt)/bn,n=t.pow(e,r),i=t.eql(n,t.ONE),s=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function oy(t,e){e!==void 0&&Hi(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function zl(t,e,r=!1,n={}){if(t<=At)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=oy(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:wo(i),ZERO:At,ONE:bt,create:c=>xt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return At<=c&&c<t},is0:c=>c===At,isOdd:c=>(c&bt)===bt,neg:c=>xt(-c,t),eql:(c,u)=>c===u,sqr:c=>xt(c*c,t),add:(c,u)=>xt(c+u,t),sub:(c,u)=>xt(c-u,t),mul:(c,u)=>xt(c*u,t),pow:(c,u)=>vI(a,c,u),div:(c,u)=>xt(c*Au(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Au(c,t),sqrt:n.sqrt||(c=>(o||(o=mI(t)),o(a,c))),toBytes:c=>r?z0(c,s):ss(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?j0(c):xn(c)},invertBatch:c=>sy(a,c),cmov:(c,u,l)=>l?u:c});return Object.freeze(a)}function ay(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function cy(t){const e=ay(t);return e+Math.ceil(e/2)}function _I(t,e,r=!1){const n=t.length,i=ay(e),s=cy(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=r?j0(t):xn(t),a=xt(o,e-bt)+bt;return r?z0(a,i):ss(a,i)}const ep=BigInt(0),Tu=BigInt(1);function $c(t,e){const r=e.negate();return t?r:e}function uy(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Fc(t,e){uy(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),i=2**t,s=wo(t),o=BigInt(t);return{windows:r,windowSize:n,mask:s,maxNumber:i,shiftBy:o}}function tp(t,e,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:o}=r;let a=Number(t&i),c=t>>o;a>n&&(a-=s,c+=Tu);const u=e*n,l=u+Math.abs(a)-1,f=a===0,p=a<0,d=e%2!==0;return{nextN:c,offset:l,isZero:f,isNeg:p,isNegF:d,offsetF:u}}function SI(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function xI(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const kc=new WeakMap,ly=new WeakMap;function qc(t){return ly.get(t)||1}function II(t,e){return{constTimeNegate:$c,hasPrecomputes(r){return qc(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>ep;)n&Tu&&(i=i.add(s)),s=s.double(),n>>=Tu;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=Fc(n,e),o=[];let a=r,c=a;for(let u=0;u<i;u++){c=a,o.push(c);for(let l=1;l<s;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,i){let s=t.ZERO,o=t.BASE;const a=Fc(r,e);for(let c=0;c<a.windows;c++){const{nextN:u,offset:l,isZero:f,isNeg:p,isNegF:d,offsetF:h}=tp(i,c,a);i=u,f?o=o.add($c(d,n[h])):s=s.add($c(p,n[l]))}return{p:s,f:o}},wNAFUnsafe(r,n,i,s=t.ZERO){const o=Fc(r,e);for(let a=0;a<o.windows&&i!==ep;a++){const{nextN:c,offset:u,isZero:l,isNeg:f}=tp(i,a,o);if(i=c,!l){const p=n[u];s=s.add(f?p.negate():p)}}return s},getPrecomputes(r,n,i){let s=kc.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&kc.set(n,i(s))),s},wNAFCached(r,n,i){const s=qc(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const o=qc(r);return o===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,i),n,s)},setWindowSize(r,n){uy(n,e),ly.set(r,n),kc.delete(r)}}}function AI(t,e,r,n){SI(r,t),xI(n,e);const i=r.length,s=n.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=Cx(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=wo(c),l=new Array(Number(u)+1).fill(o),f=Math.floor((e.BITS-1)/c)*c;let p=o;for(let d=f;d>=0;d-=c){l.fill(o);for(let g=0;g<s;g++){const m=n[g],y=Number(m>>BigInt(d)&u);l[y]=l[y].add(r[g])}let h=o;for(let g=l.length-1,m=o;g>0;g--)m=m.add(l[g]),h=h.add(m);if(p=p.add(h),d!==0)for(let g=0;g<c;g++)p=p.double()}return p}function fy(t){return EI(t.Fp),mo(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...oy(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function rp(t){t.lowS!==void 0&&Ki("lowS",t.lowS),t.prehash!==void 0&&Ki("prehash",t.prehash)}function TI(t){const e=fy(t);mo(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}class OI extends Error{constructor(e=""){super(e)}}const Tr={Err:OI,_tlv:{encode:(t,e)=>{const{Err:r}=Tr;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,i=Is(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?Is(i.length/2|128):"";return Is(t)+s+i+e},decode(t,e){const{Err:r}=Tr;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const i=e[n++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const u=e.subarray(n,n+c);if(u.length!==c)throw new r("tlv.decode: length bytes not complete");if(u[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=Tr;if(t<Dr)throw new e("integer: negative integers are not allowed");let r=Is(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=Tr;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return xn(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=Tr,i=kt("signature",t),{v:s,l:o}=n.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:u,l}=n.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(u)}},hexFromSig(t){const{_tlv:e,_int:r}=Tr,n=e.encode(2,r.encode(t.r)),i=e.encode(2,r.encode(t.s)),s=n+i;return e.encode(48,s)}};function jc(t,e){return Wi(ss(t,e))}const Dr=BigInt(0),et=BigInt(1);BigInt(2);const zc=BigInt(3),CI=BigInt(4);function RI(t){const e=TI(t),{Fp:r}=e,n=zl(e.n,e.nBitLength),i=e.toBytes||((b,x,I)=>{const A=x.toAffine();return Hs(Uint8Array.from([4]),r.toBytes(A.x),r.toBytes(A.y))}),s=e.fromBytes||(b=>{const x=b.subarray(1),I=r.fromBytes(x.subarray(0,r.BYTES)),A=r.fromBytes(x.subarray(r.BYTES,2*r.BYTES));return{x:I,y:A}});function o(b){const{a:x,b:I}=e,A=r.sqr(b),B=r.mul(A,b);return r.add(r.add(B,r.mul(b,x)),I)}function a(b,x){const I=r.sqr(x),A=o(b);return r.eql(I,A)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(e.a,zc),CI),u=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(c,u)))throw new Error("bad curve params: a or b");function l(b){return kl(b,et,e.n)}function f(b){const{allowedPrivateKeyLengths:x,nByteLength:I,wrapPrivateKey:A,n:B}=e;if(x&&typeof b!="bigint"){if(is(b)&&(b=Wi(b)),typeof b!="string"||!x.includes(b.length))throw new Error("invalid private key");b=b.padStart(I*2,"0")}let P;try{P=typeof b=="bigint"?b:xn(kt("private key",b,I))}catch{throw new Error("invalid private key, expected hex or "+I+" bytes, got "+typeof b)}return A&&(P=xt(P,B)),Xn("private key",P,et,B),P}function p(b){if(!(b instanceof g))throw new Error("ProjectivePoint expected")}const d=Kd((b,x)=>{const{px:I,py:A,pz:B}=b;if(r.eql(B,r.ONE))return{x:I,y:A};const P=b.is0();x==null&&(x=P?r.ONE:r.inv(B));const N=r.mul(I,x),$=r.mul(A,x),G=r.mul(B,x);if(P)return{x:r.ZERO,y:r.ZERO};if(!r.eql(G,r.ONE))throw new Error("invZ was invalid");return{x:N,y:$}}),h=Kd(b=>{if(b.is0()){if(e.allowInfinityPoint&&!r.is0(b.py))return;throw new Error("bad point: ZERO")}const{x,y:I}=b.toAffine();if(!r.isValid(x)||!r.isValid(I))throw new Error("bad point: x or y not FE");if(!a(x,I))throw new Error("bad point: equation left != right");if(!b.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class g{constructor(x,I,A){if(x==null||!r.isValid(x))throw new Error("x required");if(I==null||!r.isValid(I)||r.is0(I))throw new Error("y required");if(A==null||!r.isValid(A))throw new Error("z required");this.px=x,this.py=I,this.pz=A,Object.freeze(this)}static fromAffine(x){const{x:I,y:A}=x||{};if(!x||!r.isValid(I)||!r.isValid(A))throw new Error("invalid affine point");if(x instanceof g)throw new Error("projective point not allowed");const B=P=>r.eql(P,r.ZERO);return B(I)&&B(A)?g.ZERO:new g(I,A,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(x){const I=sy(r,x.map(A=>A.pz));return x.map((A,B)=>A.toAffine(I[B])).map(g.fromAffine)}static fromHex(x){const I=g.fromAffine(s(kt("pointHex",x)));return I.assertValidity(),I}static fromPrivateKey(x){return g.BASE.multiply(f(x))}static msm(x,I){return AI(g,n,x,I)}_setWindowSize(x){S.setWindowSize(this,x)}assertValidity(){h(this)}hasEvenY(){const{y:x}=this.toAffine();if(r.isOdd)return!r.isOdd(x);throw new Error("Field doesn't support isOdd")}equals(x){p(x);const{px:I,py:A,pz:B}=this,{px:P,py:N,pz:$}=x,G=r.eql(r.mul(I,$),r.mul(P,B)),q=r.eql(r.mul(A,$),r.mul(N,B));return G&&q}negate(){return new g(this.px,r.neg(this.py),this.pz)}double(){const{a:x,b:I}=e,A=r.mul(I,zc),{px:B,py:P,pz:N}=this;let $=r.ZERO,G=r.ZERO,q=r.ZERO,L=r.mul(B,B),j=r.mul(P,P),T=r.mul(N,N),D=r.mul(B,P);return D=r.add(D,D),q=r.mul(B,N),q=r.add(q,q),$=r.mul(x,q),G=r.mul(A,T),G=r.add($,G),$=r.sub(j,G),G=r.add(j,G),G=r.mul($,G),$=r.mul(D,$),q=r.mul(A,q),T=r.mul(x,T),D=r.sub(L,T),D=r.mul(x,D),D=r.add(D,q),q=r.add(L,L),L=r.add(q,L),L=r.add(L,T),L=r.mul(L,D),G=r.add(G,L),T=r.mul(P,N),T=r.add(T,T),L=r.mul(T,D),$=r.sub($,L),q=r.mul(T,j),q=r.add(q,q),q=r.add(q,q),new g($,G,q)}add(x){p(x);const{px:I,py:A,pz:B}=this,{px:P,py:N,pz:$}=x;let G=r.ZERO,q=r.ZERO,L=r.ZERO;const j=e.a,T=r.mul(e.b,zc);let D=r.mul(I,P),F=r.mul(A,N),K=r.mul(B,$),k=r.add(I,A),X=r.add(P,N);k=r.mul(k,X),X=r.add(D,F),k=r.sub(k,X),X=r.add(I,B);let ee=r.add(P,$);return X=r.mul(X,ee),ee=r.add(D,K),X=r.sub(X,ee),ee=r.add(A,B),G=r.add(N,$),ee=r.mul(ee,G),G=r.add(F,K),ee=r.sub(ee,G),L=r.mul(j,X),G=r.mul(T,K),L=r.add(G,L),G=r.sub(F,L),L=r.add(F,L),q=r.mul(G,L),F=r.add(D,D),F=r.add(F,D),K=r.mul(j,K),X=r.mul(T,X),F=r.add(F,K),K=r.sub(D,K),K=r.mul(j,K),X=r.add(X,K),D=r.mul(F,X),q=r.add(q,D),D=r.mul(ee,X),G=r.mul(k,G),G=r.sub(G,D),D=r.mul(k,F),L=r.mul(ee,L),L=r.add(L,D),new g(G,q,L)}subtract(x){return this.add(x.negate())}is0(){return this.equals(g.ZERO)}wNAF(x){return S.wNAFCached(this,x,g.normalizeZ)}multiplyUnsafe(x){const{endo:I,n:A}=e;Xn("scalar",x,Dr,A);const B=g.ZERO;if(x===Dr)return B;if(this.is0()||x===et)return this;if(!I||S.hasPrecomputes(this))return S.wNAFCachedUnsafe(this,x,g.normalizeZ);let{k1neg:P,k1:N,k2neg:$,k2:G}=I.splitScalar(x),q=B,L=B,j=this;for(;N>Dr||G>Dr;)N&et&&(q=q.add(j)),G&et&&(L=L.add(j)),j=j.double(),N>>=et,G>>=et;return P&&(q=q.negate()),$&&(L=L.negate()),L=new g(r.mul(L.px,I.beta),L.py,L.pz),q.add(L)}multiply(x){const{endo:I,n:A}=e;Xn("scalar",x,et,A);let B,P;if(I){const{k1neg:N,k1:$,k2neg:G,k2:q}=I.splitScalar(x);let{p:L,f:j}=this.wNAF($),{p:T,f:D}=this.wNAF(q);L=S.constTimeNegate(N,L),T=S.constTimeNegate(G,T),T=new g(r.mul(T.px,I.beta),T.py,T.pz),B=L.add(T),P=j.add(D)}else{const{p:N,f:$}=this.wNAF(x);B=N,P=$}return g.normalizeZ([B,P])[0]}multiplyAndAddUnsafe(x,I,A){const B=g.BASE,P=($,G)=>G===Dr||G===et||!$.equals(B)?$.multiplyUnsafe(G):$.multiply(G),N=P(this,I).add(P(x,A));return N.is0()?void 0:N}toAffine(x){return d(this,x)}isTorsionFree(){const{h:x,isTorsionFree:I}=e;if(x===et)return!0;if(I)return I(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:x,clearCofactor:I}=e;return x===et?this:I?I(g,this):this.multiplyUnsafe(e.h)}toRawBytes(x=!0){return Ki("isCompressed",x),this.assertValidity(),i(g,this,x)}toHex(x=!0){return Ki("isCompressed",x),Wi(this.toRawBytes(x))}}g.BASE=new g(e.Gx,e.Gy,r.ONE),g.ZERO=new g(r.ZERO,r.ONE,r.ZERO);const{endo:m,nBitLength:y}=e,S=II(g,m?Math.ceil(y/2):y);return{CURVE:e,ProjectivePoint:g,normPrivateKeyToScalar:f,weierstrassEquation:o,isWithinCurveOrder:l}}function DI(t){const e=fy(t);return mo(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function BI(t){const e=DI(t),{Fp:r,n,nByteLength:i,nBitLength:s}=e,o=r.BYTES+1,a=2*r.BYTES+1;function c(T){return xt(T,n)}function u(T){return Au(T,n)}const{ProjectivePoint:l,normPrivateKeyToScalar:f,weierstrassEquation:p,isWithinCurveOrder:d}=RI({...e,toBytes(T,D,F){const K=D.toAffine(),k=r.toBytes(K.x),X=Hs;return Ki("isCompressed",F),F?X(Uint8Array.from([D.hasEvenY()?2:3]),k):X(Uint8Array.from([4]),k,r.toBytes(K.y))},fromBytes(T){const D=T.length,F=T[0],K=T.subarray(1);if(D===o&&(F===2||F===3)){const k=xn(K);if(!kl(k,et,r.ORDER))throw new Error("Point is not on curve");const X=p(k);let ee;try{ee=r.sqrt(X)}catch(z){const ce=z instanceof Error?": "+z.message:"";throw new Error("Point is not on curve"+ce)}const te=(ee&et)===et;return(F&1)===1!==te&&(ee=r.neg(ee)),{x:k,y:ee}}else if(D===a&&F===4){const k=r.fromBytes(K.subarray(0,r.BYTES)),X=r.fromBytes(K.subarray(r.BYTES,2*r.BYTES));return{x:k,y:X}}else{const k=o,X=a;throw new Error("invalid Point, expected length of "+k+", or uncompressed "+X+", got "+D)}}});function h(T){const D=n>>et;return T>D}function g(T){return h(T)?c(-T):T}const m=(T,D,F)=>xn(T.slice(D,F));class y{constructor(D,F,K){Xn("r",D,et,n),Xn("s",F,et,n),this.r=D,this.s=F,K!=null&&(this.recovery=K),Object.freeze(this)}static fromCompact(D){const F=i;return D=kt("compactSignature",D,F*2),new y(m(D,0,F),m(D,F,2*F))}static fromDER(D){const{r:F,s:K}=Tr.toSig(kt("DER",D));return new y(F,K)}assertValidity(){}addRecoveryBit(D){return new y(this.r,this.s,D)}recoverPublicKey(D){const{r:F,s:K,recovery:k}=this,X=B(kt("msgHash",D));if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");const ee=k===2||k===3?F+e.n:F;if(ee>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const te=(k&1)===0?"02":"03",le=l.fromHex(te+jc(ee,r.BYTES)),z=u(ee),ce=c(-X*z),W=c(K*z),V=l.BASE.multiplyAndAddUnsafe(le,ce,W);if(!V)throw new Error("point at infinify");return V.assertValidity(),V}hasHighS(){return h(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Vs(this.toDERHex())}toDERHex(){return Tr.hexFromSig(this)}toCompactRawBytes(){return Vs(this.toCompactHex())}toCompactHex(){const D=i;return jc(this.r,D)+jc(this.s,D)}}const S={isValidPrivateKey(T){try{return f(T),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const T=cy(e.n);return _I(e.randomBytes(T),e.n)},precompute(T=8,D=l.BASE){return D._setWindowSize(T),D.multiply(BigInt(3)),D}};function b(T,D=!0){return l.fromPrivateKey(T).toRawBytes(D)}function x(T){if(typeof T=="bigint")return!1;if(T instanceof l)return!0;const F=kt("key",T).length,K=r.BYTES,k=K+1,X=2*K+1;if(!(e.allowedPrivateKeyLengths||i===k))return F===k||F===X}function I(T,D,F=!0){if(x(T)===!0)throw new Error("first arg must be private key");if(x(D)===!1)throw new Error("second arg must be public key");return l.fromHex(D).multiply(f(T)).toRawBytes(F)}const A=e.bits2int||function(T){if(T.length>8192)throw new Error("input is too large");const D=xn(T),F=T.length*8-s;return F>0?D>>BigInt(F):D},B=e.bits2int_modN||function(T){return c(A(T))},P=wo(s);function N(T){return Xn("num < 2^"+s,T,Dr,P),ss(T,i)}function $(T,D,F=G){if(["recovered","canonical"].some(oe=>oe in F))throw new Error("sign() legacy options not supported");const{hash:K,randomBytes:k}=e;let{lowS:X,prehash:ee,extraEntropy:te}=F;X==null&&(X=!0),T=kt("msgHash",T),rp(F),ee&&(T=kt("prehashed msgHash",K(T)));const le=B(T),z=f(D),ce=[N(z),N(le)];if(te!=null&&te!==!1){const oe=te===!0?k(r.BYTES):te;ce.push(kt("extraEntropy",oe))}const W=Hs(...ce),V=le;function re(oe){const C=A(oe);if(!d(C))return;const _=u(C),v=l.BASE.multiply(C).toAffine(),R=c(v.x);if(R===Dr)return;const U=c(_*c(V+R*z));if(U===Dr)return;let Y=(v.x===R?0:2)|Number(v.y&et),J=U;return X&&h(U)&&(J=g(U),Y^=1),new y(R,J,Y)}return{seed:W,k2sig:re}}const G={lowS:e.lowS,prehash:!1},q={lowS:e.lowS,prehash:!1};function L(T,D,F=G){const{seed:K,k2sig:k}=$(T,D,F),X=e;return Rx(X.hash.outputLen,X.nByteLength,X.hmac)(K,k)}l.BASE._setWindowSize(8);function j(T,D,F,K=q){const k=T;D=kt("msgHash",D),F=kt("publicKey",F);const{lowS:X,prehash:ee,format:te}=K;if(rp(K),"strict"in K)throw new Error("options.strict was renamed to lowS");if(te!==void 0&&te!=="compact"&&te!=="der")throw new Error("format must be compact or der");const le=typeof k=="string"||is(k),z=!le&&!te&&typeof k=="object"&&k!==null&&typeof k.r=="bigint"&&typeof k.s=="bigint";if(!le&&!z)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let ce,W;try{if(z&&(ce=new y(k.r,k.s)),le){try{te!=="compact"&&(ce=y.fromDER(k))}catch(Y){if(!(Y instanceof Tr.Err))throw Y}!ce&&te!=="der"&&(ce=y.fromCompact(k))}W=l.fromHex(F)}catch{return!1}if(!ce||X&&ce.hasHighS())return!1;ee&&(D=e.hash(D));const{r:V,s:re}=ce,oe=B(D),C=u(re),_=c(oe*C),v=c(V*C),R=l.BASE.multiplyAndAddUnsafe(W,_,v)?.toAffine();return R?c(R.x)===V:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:I,sign:L,verify:j,ProjectivePoint:l,Signature:y,utils:S}}function NI(t){return{hash:t,hmac:(e,...r)=>ey(t,e,nx(...r)),randomBytes:ix}}function PI(t,e){const r=n=>BI({...t,...NI(n)});return{...r(e),create:r}}const hy=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),np=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),UI=BigInt(0),LI=BigInt(1),Ou=BigInt(2),ip=(t,e)=>(t+e/Ou)/e;function MI(t){const e=hy,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,l=u*u*t%e,f=Lt(l,r,e)*l%e,p=Lt(f,r,e)*l%e,d=Lt(p,Ou,e)*u%e,h=Lt(d,i,e)*d%e,g=Lt(h,s,e)*h%e,m=Lt(g,a,e)*g%e,y=Lt(m,c,e)*m%e,S=Lt(y,a,e)*g%e,b=Lt(S,r,e)*l%e,x=Lt(b,o,e)*h%e,I=Lt(x,n,e)*u%e,A=Lt(I,Ou,e);if(!Cu.eql(Cu.sqr(A),t))throw new Error("Cannot find square root");return A}const Cu=zl(hy,void 0,void 0,{sqrt:MI}),$I=PI({a:UI,b:BigInt(7),Fp:Cu,n:np,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=np,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-LI*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=ip(s*t,e),c=ip(-n*t,e);let u=xt(t-a*r-c*i,e),l=xt(-a*n-c*s,e);const f=u>o,p=l>o;if(f&&(u=e-u),p&&(l=e-l),u>o||l>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:f,k1:u,k2neg:p,k2:l}}}},Tx);function FI(t){if(t.length!==130&&t.length!==132)throw new qI({signature:t});const e=BigInt(Ar(t,0,32)),r=BigInt(Ar(t,32,64)),n=(()=>{const i=+`0x${t.slice(130)}`;if(!Number.isNaN(i))try{return kI(i)}catch{throw new jI({value:i})}})();return typeof n>"u"?{r:e,s:r}:{r:e,s:r,yParity:n}}function kI(t){if(t===0||t===27)return 0;if(t===1||t===28)return 1;if(t>=35)return t%2===0?1:0;throw new zI({value:t})}class qI extends Fe{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${rn(jl(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class jI extends Fe{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class zI extends Fe{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}function VI(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function dy(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(r=>typeof r=="string"):e.every(r=>Number.isSafeInteger(r)):!1}function Ws(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function Vl(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function Ru(t){if(!Array.isArray(t))throw new Error("array expected")}function Gs(t,e){if(!dy(!0,e))throw new Error(`${t}: array of strings expected`)}function HI(t,e){if(!dy(!1,e))throw new Error(`${t}: array of numbers expected`)}function KI(...t){const e=s=>s,r=(s,o)=>a=>s(o(a)),n=t.map(s=>s.encode).reduceRight(r,e),i=t.map(s=>s.decode).reduce(r,e);return{encode:n,decode:i}}function WI(t){const e=typeof t=="string"?t.split(""):t,r=e.length;Gs("alphabet",e);const n=new Map(e.map((i,s)=>[i,s]));return{encode:i=>(Ru(i),i.map(s=>{if(!Number.isSafeInteger(s)||s<0||s>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${t}`);return e[s]})),decode:i=>(Ru(i),i.map(s=>{Ws("alphabet.decode",s);const o=n.get(s);if(o===void 0)throw new Error(`Unknown letter: "${s}". Allowed: ${t}`);return o}))}}function GI(t=""){return Ws("join",t),{encode:e=>(Gs("join.decode",e),e.join(t)),decode:e=>(Ws("join.decode",e),e.split(t))}}function YI(t,e="="){return Vl(t),Ws("padding",e),{encode(r){for(Gs("padding.encode",r);r.length*t%8;)r.push(e);return r},decode(r){Gs("padding.decode",r);let n=r.length;if(n*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&r[n-1]===e;n--)if((n-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return r.slice(0,n)}}}const py=(t,e)=>e===0?t:py(e,t%e),Ys=(t,e)=>t+(e-py(t,e)),Vc=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function sp(t,e,r,n){if(Ru(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(Ys(e,r)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${r} carryBits=${Ys(e,r)}`);let i=0,s=0;const o=Vc[e],a=Vc[r]-1,c=[];for(const u of t){if(Vl(u),u>=o)throw new Error(`convertRadix2: invalid data word=${u} from=${e}`);if(i=i<<e|u,s+e>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${e}`);for(s+=e;s>=r;s-=r)c.push((i>>s-r&a)>>>0);const l=Vc[s];if(l===void 0)throw new Error("invalid carry");i&=l-1}if(i=i<<r-s&a,!n&&s>=e)throw new Error("Excess padding");if(!n&&i>0)throw new Error(`Non-zero padding: ${i}`);return n&&s>0&&c.push(i>>>0),c}function XI(t,e=!1){if(Vl(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(Ys(8,t)>32||Ys(t,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!VI(r))throw new Error("radix2.encode input should be Uint8Array");return sp(Array.from(r),8,t,!e)},decode:r=>(HI("radix2.decode",r),Uint8Array.from(sp(r,t,8,e)))}}const ZI=KI(XI(5),WI("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),YI(5),GI(""));function JI(t){return hI(QI(t))}function QI(t){const{payload:e,signature:r}=t,{r:n,s:i,yParity:s}=r,a=new $I.Signature(BigInt(n),BigInt(i)).addRecoveryBit(s).recoverPublicKey(jl(e).substring(2));return nI(a)}function e3(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let u=0;u<e.length;u++)e[u]=255;for(let u=0;u<t.length;u++){const l=t.charAt(u),f=l.charCodeAt(0);if(e[f]!==255)throw new TypeError(l+" is ambiguous");e[f]=u}const r=t.length,n=t.charAt(0),i=Math.log(r)/Math.log(256),s=Math.log(256)/Math.log(r);function o(u){if(u instanceof Uint8Array||(ArrayBuffer.isView(u)?u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength):Array.isArray(u)&&(u=Uint8Array.from(u))),!(u instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(u.length===0)return"";let l=0,f=0,p=0;const d=u.length;for(;p!==d&&u[p]===0;)p++,l++;const h=(d-p)*s+1>>>0,g=new Uint8Array(h);for(;p!==d;){let S=u[p],b=0;for(let x=h-1;(S!==0||b<f)&&x!==-1;x--,b++)S+=256*g[x]>>>0,g[x]=S%r>>>0,S=S/r>>>0;if(S!==0)throw new Error("Non-zero carry");f=b,p++}let m=h-f;for(;m!==h&&g[m]===0;)m++;let y=n.repeat(l);for(;m<h;++m)y+=t.charAt(g[m]);return y}function a(u){if(typeof u!="string")throw new TypeError("Expected String");if(u.length===0)return new Uint8Array;let l=0,f=0,p=0;for(;u[l]===n;)f++,l++;const d=(u.length-l)*i+1>>>0,h=new Uint8Array(d);for(;l<u.length;){const S=u.charCodeAt(l);if(S>255)return;let b=e[S];if(b===255)return;let x=0;for(let I=d-1;(b!==0||x<p)&&I!==-1;I--,x++)b+=r*h[I]>>>0,h[I]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");p=x,l++}let g=d-p;for(;g!==d&&h[g]===0;)g++;const m=new Uint8Array(f+(d-g));let y=f;for(;g!==d;)m[y++]=h[g++];return m}function c(u){const l=a(u);if(l)return l;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var t3="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const os=e3(t3);function r3(t){const e=t.length;let r=0,n=0;for(;n<e;){let i=t.charCodeAt(n++);if((i&4294967168)===0){r++;continue}else if((i&4294965248)===0)r+=2;else{if(i>=55296&&i<=56319&&n<e){const s=t.charCodeAt(n);(s&64512)===56320&&(++n,i=((i&1023)<<10)+(s&1023)+65536)}(i&4294901760)===0?r+=3:r+=4}}return r}function n3(t,e,r){const n=t.length;let i=r,s=0;for(;s<n;){let o=t.charCodeAt(s++);if((o&4294967168)===0){e[i++]=o;continue}else if((o&4294965248)===0)e[i++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&s<n){const a=t.charCodeAt(s);(a&64512)===56320&&(++s,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(e[i++]=o>>12&15|224,e[i++]=o>>6&63|128):(e[i++]=o>>18&7|240,e[i++]=o>>12&63|128,e[i++]=o>>6&63|128)}e[i++]=o&63|128}}const i3=new TextEncoder,s3=50;function o3(t,e,r){i3.encodeInto(t,e.subarray(r))}function a3(t,e,r){t.length>s3?o3(t,e,r):n3(t,e,r)}const c3=4096;function gy(t,e,r){let n=e;const i=n+r,s=[];let o="";for(;n<i;){const a=t[n++];if((a&128)===0)s.push(a);else if((a&224)===192){const c=t[n++]&63;s.push((a&31)<<6|c)}else if((a&240)===224){const c=t[n++]&63,u=t[n++]&63;s.push((a&31)<<12|c<<6|u)}else if((a&248)===240){const c=t[n++]&63,u=t[n++]&63,l=t[n++]&63;let f=(a&7)<<18|c<<12|u<<6|l;f>65535&&(f-=65536,s.push(f>>>10&1023|55296),f=56320|f&1023),s.push(f)}else s.push(a);s.length>=c3&&(o+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(o+=String.fromCharCode(...s)),o}const u3=new TextDecoder,l3=200;function f3(t,e,r){const n=t.subarray(e,e+r);return u3.decode(n)}function h3(t,e,r){return r>l3?f3(t,e,r):gy(t,e,r)}class Ts{constructor(e,r){this.type=e,this.data=r}}class Bt extends Error{constructor(e){super(e);const r=Object.create(Bt.prototype);Object.setPrototypeOf(this,r),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Bt.name})}}const vi=4294967295;function d3(t,e,r){const n=r/4294967296,i=r;t.setUint32(e,n),t.setUint32(e+4,i)}function yy(t,e,r){const n=Math.floor(r/4294967296),i=r;t.setUint32(e,n),t.setUint32(e+4,i)}function wy(t,e){const r=t.getInt32(e),n=t.getUint32(e+4);return r*4294967296+n}function p3(t,e){const r=t.getUint32(e),n=t.getUint32(e+4);return r*4294967296+n}const g3=-1,y3=4294967296-1,w3=17179869184-1;function m3({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=w3)if(e===0&&t<=y3){const r=new Uint8Array(4);return new DataView(r.buffer).setUint32(0,t),r}else{const r=t/4294967296,n=t&4294967295,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,e<<2|r&3),s.setUint32(4,n),i}else{const r=new Uint8Array(12),n=new DataView(r.buffer);return n.setUint32(0,e),yy(n,4,t),r}}function b3(t){const e=t.getTime(),r=Math.floor(e/1e3),n=(e-r*1e3)*1e6,i=Math.floor(n/1e9);return{sec:r+i,nsec:n-i*1e9}}function E3(t){if(t instanceof Date){const e=b3(t);return m3(e)}else return null}function v3(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const r=e.getUint32(0),n=e.getUint32(4),i=(r&3)*4294967296+n,s=r>>>2;return{sec:i,nsec:s}}case 12:{const r=wy(e,4),n=e.getUint32(0);return{sec:r,nsec:n}}default:throw new Bt(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function _3(t){const e=v3(t);return new Date(e.sec*1e3+e.nsec/1e6)}const S3={type:g3,encode:E3,decode:_3};class Xs{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(S3)}register({type:e,encode:r,decode:n}){if(e>=0)this.encoders[e]=r,this.decoders[e]=n;else{const i=-1-e;this.builtInEncoders[i]=r,this.builtInDecoders[i]=n}}tryToEncode(e,r){for(let n=0;n<this.builtInEncoders.length;n++){const i=this.builtInEncoders[n];if(i!=null){const s=i(e,r);if(s!=null){const o=-1-n;return new Ts(o,s)}}}for(let n=0;n<this.encoders.length;n++){const i=this.encoders[n];if(i!=null){const s=i(e,r);if(s!=null){const o=n;return new Ts(o,s)}}}return e instanceof Ts?e:null}decode(e,r,n){const i=r<0?this.builtInDecoders[-1-r]:this.decoders[r];return i?i(e,r,n):new Ts(r,e)}}Xs.defaultCodec=new Xs;function x3(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Du(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):x3(t)?new Uint8Array(t):Uint8Array.from(t)}const I3=100,A3=2048;let T3=class my{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??Xs.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??I3,this.initialBufferSize=e?.initialBufferSize??A3,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new my({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,r){if(r>this.maxDepth)throw new Error(`Too deep objects in depth ${r}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,r)}ensureBufferSizeToWrite(e){const r=this.pos+e;this.view.byteLength<r&&this.resizeBuffer(r*2)}resizeBuffer(e){const r=new ArrayBuffer(e),n=new Uint8Array(r),i=new DataView(r);n.set(this.bytes),this.view=i,this.bytes=n}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const n=r3(e);this.ensureBufferSizeToWrite(5+n),this.writeStringHeader(n),a3(e,this.bytes,this.pos),this.pos+=n}encodeObject(e,r){const n=this.extensionCodec.tryToEncode(e,this.context);if(n!=null)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,r);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,r);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const r=e.byteLength;if(r<256)this.writeU8(196),this.writeU8(r);else if(r<65536)this.writeU8(197),this.writeU16(r);else if(r<4294967296)this.writeU8(198),this.writeU32(r);else throw new Error(`Too large binary: ${r}`);const n=Du(e);this.writeU8a(n)}encodeArray(e,r){const n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw new Error(`Too large array: ${n}`);for(const i of e)this.doEncode(i,r+1)}countWithoutUndefined(e,r){let n=0;for(const i of r)e[i]!==void 0&&n++;return n}encodeMap(e,r){const n=Object.keys(e);this.sortKeys&&n.sort();const i=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else if(i<4294967296)this.writeU8(223),this.writeU32(i);else throw new Error(`Too large map object: ${i}`);for(const s of n){const o=e[s];this.ignoreUndefined&&o===void 0||(this.encodeString(s),this.doEncode(o,r+1))}}encodeExtension(e){if(typeof e.data=="function"){const n=e.data(this.pos+6),i=n.length;if(i>=4294967296)throw new Error(`Too large extension object: ${i}`);this.writeU8(201),this.writeU32(i),this.writeI8(e.type),this.writeU8a(n);return}const r=e.data.length;if(r===1)this.writeU8(212);else if(r===2)this.writeU8(213);else if(r===4)this.writeU8(214);else if(r===8)this.writeU8(215);else if(r===16)this.writeU8(216);else if(r<256)this.writeU8(199),this.writeU8(r);else if(r<65536)this.writeU8(200),this.writeU16(r);else if(r<4294967296)this.writeU8(201),this.writeU32(r);else throw new Error(`Too large extension object: ${r}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const r=e.length;this.ensureBufferSizeToWrite(r),this.bytes.set(e,this.pos),this.pos+=r}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),d3(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),yy(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function O3(t,e){return new T3(e).encodeSharedRef(t)}function Hc(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const C3=16,R3=16;class D3{constructor(e=C3,r=R3){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=r,this.caches=[];for(let n=0;n<this.maxKeyLength;n++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,r,n){const i=this.caches[n-1];e:for(const s of i){const o=s.bytes;for(let a=0;a<n;a++)if(o[a]!==e[r+a])continue e;return s.str}return null}store(e,r){const n=this.caches[e.length-1],i={bytes:e,str:r};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=i:n.push(i)}decode(e,r,n){const i=this.find(e,r,n);if(i!=null)return this.hit++,i;this.miss++;const s=gy(e,r,n),o=Uint8Array.prototype.slice.call(e,r,r+n);return this.store(o,s),s}}const Bu="array",Pi="map_key",by="map_value",B3=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new Bt("The type of key must be string or number but "+typeof t)};class N3{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const r=this.getUninitializedStateFromPool();r.type=Bu,r.position=0,r.size=e,r.array=new Array(e)}pushMapState(e){const r=this.getUninitializedStateFromPool();r.type=Pi,r.readCount=0,r.size=e,r.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Bu){const n=e;n.size=0,n.array=void 0,n.position=0,n.type=void 0}if(e.type===Pi||e.type===by){const n=e;n.size=0,n.map=void 0,n.readCount=0,n.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const _i=-1,Hl=new DataView(new ArrayBuffer(0)),P3=new Uint8Array(Hl.buffer);try{Hl.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const op=new RangeError("Insufficient data"),U3=new D3;let L3=class Ey{constructor(e){this.totalPos=0,this.pos=0,this.view=Hl,this.bytes=P3,this.headByte=_i,this.stack=new N3,this.entered=!1,this.extensionCodec=e?.extensionCodec??Xs.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??vi,this.maxBinLength=e?.maxBinLength??vi,this.maxArrayLength=e?.maxArrayLength??vi,this.maxMapLength=e?.maxMapLength??vi,this.maxExtLength=e?.maxExtLength??vi,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:U3,this.mapKeyConverter=e?.mapKeyConverter??B3}clone(){return new Ey({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=_i,this.stack.reset()}setBuffer(e){const r=Du(e);this.bytes=r,this.view=new DataView(r.buffer,r.byteOffset,r.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===_i&&!this.hasRemaining(1))this.setBuffer(e);else{const r=this.bytes.subarray(this.pos),n=Du(e),i=new Uint8Array(r.length+n.length);i.set(r),i.set(n,r.length),this.setBuffer(i)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:r,pos:n}=this;return new RangeError(`Extra ${r.byteLength-n} of ${r.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const r=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return r}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let r=!1,n;for await(const a of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{n=this.doDecodeSync(),r=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return n}const{headByte:i,pos:s,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Hc(i)} at ${o} (${s} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,r){if(this.entered){yield*this.clone().decodeMultiAsync(e,r);return}try{this.entered=!0;let n=r,i=-1;for await(const s of e){if(r&&i===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),n&&(i=this.readArraySize(),n=!1,this.complete());try{for(;yield this.doDecodeSync(),--i!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let r;if(e>=224)r=e-256;else if(e<192)if(e<128)r=e;else if(e<144){const i=e-128;if(i!==0){this.pushMapState(i),this.complete();continue e}else r={}}else if(e<160){const i=e-144;if(i!==0){this.pushArrayState(i),this.complete();continue e}else r=[]}else{const i=e-160;r=this.decodeString(i,0)}else if(e===192)r=null;else if(e===194)r=!1;else if(e===195)r=!0;else if(e===202)r=this.readF32();else if(e===203)r=this.readF64();else if(e===204)r=this.readU8();else if(e===205)r=this.readU16();else if(e===206)r=this.readU32();else if(e===207)this.useBigInt64?r=this.readU64AsBigInt():r=this.readU64();else if(e===208)r=this.readI8();else if(e===209)r=this.readI16();else if(e===210)r=this.readI32();else if(e===211)this.useBigInt64?r=this.readI64AsBigInt():r=this.readI64();else if(e===217){const i=this.lookU8();r=this.decodeString(i,1)}else if(e===218){const i=this.lookU16();r=this.decodeString(i,2)}else if(e===219){const i=this.lookU32();r=this.decodeString(i,4)}else if(e===220){const i=this.readU16();if(i!==0){this.pushArrayState(i),this.complete();continue e}else r=[]}else if(e===221){const i=this.readU32();if(i!==0){this.pushArrayState(i),this.complete();continue e}else r=[]}else if(e===222){const i=this.readU16();if(i!==0){this.pushMapState(i),this.complete();continue e}else r={}}else if(e===223){const i=this.readU32();if(i!==0){this.pushMapState(i),this.complete();continue e}else r={}}else if(e===196){const i=this.lookU8();r=this.decodeBinary(i,1)}else if(e===197){const i=this.lookU16();r=this.decodeBinary(i,2)}else if(e===198){const i=this.lookU32();r=this.decodeBinary(i,4)}else if(e===212)r=this.decodeExtension(1,0);else if(e===213)r=this.decodeExtension(2,0);else if(e===214)r=this.decodeExtension(4,0);else if(e===215)r=this.decodeExtension(8,0);else if(e===216)r=this.decodeExtension(16,0);else if(e===199){const i=this.lookU8();r=this.decodeExtension(i,1)}else if(e===200){const i=this.lookU16();r=this.decodeExtension(i,2)}else if(e===201){const i=this.lookU32();r=this.decodeExtension(i,4)}else throw new Bt(`Unrecognized type byte: ${Hc(e)}`);this.complete();const n=this.stack;for(;n.length>0;){const i=n.top();if(i.type===Bu)if(i.array[i.position]=r,i.position++,i.position===i.size)r=i.array,n.release(i);else continue e;else if(i.type===Pi){if(r==="__proto__")throw new Bt("The key __proto__ is not allowed");i.key=this.mapKeyConverter(r),i.type=by;continue e}else if(i.map[i.key]=r,i.readCount++,i.readCount===i.size)r=i.map,n.release(i);else{i.key=null,i.type=Pi;continue e}}return r}}readHeadByte(){return this.headByte===_i&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=_i}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Bt(`Unrecognized array type byte: ${Hc(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Bt(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Bt(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,r){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,r):this.decodeBinary(e,r)}decodeUtf8String(e,r){if(e>this.maxStrLength)throw new Bt(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+r+e)throw op;const n=this.pos+r;let i;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?i=this.keyDecoder.decode(this.bytes,n,e):i=h3(this.bytes,n,e),this.pos+=r+e,i}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Pi:!1}decodeBinary(e,r){if(e>this.maxBinLength)throw new Bt(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+r))throw op;const n=this.pos+r,i=this.bytes.subarray(n,n+e);return this.pos+=r+e,i}decodeExtension(e,r){if(e>this.maxExtLength)throw new Bt(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const n=this.view.getInt8(this.pos+r),i=this.decodeBinary(e,r+1);return this.extensionCodec.decode(i,n,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=p3(this.view,this.pos);return this.pos+=8,e}readI64(){const e=wy(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function M3(t,e){return new L3(e).decode(t)}function Kl(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function vy(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Kl(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ui(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=vy(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return Kl(r)}function $3(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function f(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var g=0,m=0,y=0,S=h.length;y!==S&&h[y]===0;)y++,g++;for(var b=(S-y)*l+1>>>0,x=new Uint8Array(b);y!==S;){for(var I=h[y],A=0,B=b-1;(I!==0||A<m)&&B!==-1;B--,A++)I+=256*x[B]>>>0,x[B]=I%a>>>0,I=I/a>>>0;if(I!==0)throw new Error("Non-zero carry");m=A,y++}for(var P=b-m;P!==b&&x[P]===0;)P++;for(var N=c.repeat(g);P<b;++P)N+=t.charAt(x[P]);return N}function p(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var g=0;if(h[g]!==" "){for(var m=0,y=0;h[g]===c;)m++,g++;for(var S=(h.length-g)*u+1>>>0,b=new Uint8Array(S);h[g];){var x=r[h.charCodeAt(g)];if(x===255)return;for(var I=0,A=S-1;(x!==0||I<y)&&A!==-1;A--,I++)x+=a*b[A]>>>0,b[A]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=I,g++}if(h[g]!==" "){for(var B=S-y;B!==S&&b[B]===0;)B++;for(var P=new Uint8Array(m+(S-B)),N=m;B!==S;)P[N++]=b[B++];return P}}}function d(h){var g=p(h);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:p,decode:d}}var F3=$3,k3=F3;const q3=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},j3=t=>new TextEncoder().encode(t),z3=t=>new TextDecoder().decode(t);class V3{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class H3{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return _y(this,e)}}class K3{constructor(e){this.decoders=e}or(e){return _y(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _y=(t,e)=>new K3({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class W3{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new V3(e,r,n),this.decoder=new H3(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const bo=({name:t,prefix:e,encode:r,decode:n})=>new W3(t,e,r,n),as=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=k3(r,e);return bo({prefix:t,name:e,encode:n,decode:s=>q3(i(s))})},G3=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let l=0;l<s;++l){const f=i[t[l]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Y3=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},st=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>bo({prefix:e,name:t,encode(i){return Y3(i,n,r)},decode(i){return G3(i,n,r,t)}}),X3=bo({prefix:"\0",name:"identity",encode:t=>z3(t),decode:t=>j3(t)}),Z3=Object.freeze(Object.defineProperty({__proto__:null,identity:X3},Symbol.toStringTag,{value:"Module"})),J3=st({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Q3=Object.freeze(Object.defineProperty({__proto__:null,base2:J3},Symbol.toStringTag,{value:"Module"})),eA=st({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),tA=Object.freeze(Object.defineProperty({__proto__:null,base8:eA},Symbol.toStringTag,{value:"Module"})),rA=as({prefix:"9",name:"base10",alphabet:"0123456789"}),nA=Object.freeze(Object.defineProperty({__proto__:null,base10:rA},Symbol.toStringTag,{value:"Module"})),iA=st({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),sA=st({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),oA=Object.freeze(Object.defineProperty({__proto__:null,base16:iA,base16upper:sA},Symbol.toStringTag,{value:"Module"})),aA=st({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),cA=st({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uA=st({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),lA=st({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fA=st({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hA=st({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),dA=st({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),pA=st({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gA=st({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),yA=Object.freeze(Object.defineProperty({__proto__:null,base32:aA,base32hex:fA,base32hexpad:dA,base32hexpadupper:pA,base32hexupper:hA,base32pad:uA,base32padupper:lA,base32upper:cA,base32z:gA},Symbol.toStringTag,{value:"Module"})),wA=as({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),mA=as({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),bA=Object.freeze(Object.defineProperty({__proto__:null,base36:wA,base36upper:mA},Symbol.toStringTag,{value:"Module"})),EA=as({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vA=as({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),_A=Object.freeze(Object.defineProperty({__proto__:null,base58btc:EA,base58flickr:vA},Symbol.toStringTag,{value:"Module"})),SA=st({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),xA=st({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),IA=st({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),AA=st({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),TA=Object.freeze(Object.defineProperty({__proto__:null,base64:SA,base64pad:xA,base64url:IA,base64urlpad:AA},Symbol.toStringTag,{value:"Module"})),Sy=Array.from("ððªâð°ðððððððððððððâð»ð¥ð¾ð¿ðâ¤ðð¤£ðððð­ðððððð¥ð¥°ðððð¢ð¤ðððªðâºðð¤ððððð¹ð¤¦ððââ¨ð¤·ð±ðð¸ððððððððð¤©ððð¤ðð¯ððð¶ðð¤­â£ððððªðð¥ððð©ð¡ð¤ªðð¥³ð¥ð¤¤ððð³âððð´ðð¬ððð·ð»ðâ­âð¥ºððð¤ð¦âð£ððâ¹ððð âððºðð»ððððð¹ð£ð«ðððµð¤ðð´ð¤ð¼ð«â½ð¤âðð¤«ðð®ðð»ðð¶ðð²ð¿ð§¡ðâ¡ððââðð°ð¤¨ð¶ð¤ð¶ð°ðð¢ð¤ðð¨ð¨ð¤¬âððºð¤ððð±ðð¶ð¥´â¶â¡âðð¸â¬ð¨ðð¦ð·ðºâ ðððµðð¤²ð¤ ð¤§ððµðð§ð¾ððð¤ðð¤¯ð·âð§ð¯ððð¤ððâð´ð£ð¸ððð¥ð¤¢ðð¡ð©ðð¸ð»ð¤ð¤®ð¼ð¥µð©ððð¼ðð£ð¥"),OA=Sy.reduce((t,e,r)=>(t[r]=e,t),[]),CA=Sy.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function RA(t){return t.reduce((e,r)=>(e+=OA[r],e),"")}function DA(t){const e=[];for(const r of t){const n=CA[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const BA=bo({prefix:"ð",name:"base256emoji",encode:RA,decode:DA}),NA=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:BA},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const ap={...Z3,...Q3,...tA,...nA,...oA,...yA,...bA,..._A,...TA,...NA};function xy(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const cp=xy("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Kc=xy("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=vy(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Iy={utf8:cp,"utf-8":cp,hex:ap.base16,latin1:Kc,ascii:Kc,binary:Kc,...ap};function zt(t,e="utf8"){const r=Iy[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Kl(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Ot(t,e="utf8"){const r=Iy[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}const PA={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Wc,up;function Ay(){if(up)return Wc;up=1;const t="Input must be an string, Buffer or Uint8Array";function e(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(t);return a}function r(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function n(o){return(4294967296+o).toString(16).substring(1)}function i(o,a,c){let u=`
`+o+" = ";for(let l=0;l<a.length;l+=2){if(c===32)u+=n(a[l]).toUpperCase(),u+=" ",u+=n(a[l+1]).toUpperCase();else if(c===64)u+=n(a[l+1]).toUpperCase(),u+=n(a[l]).toUpperCase();else throw new Error("Invalid size "+c);l%6===4?u+=`
`+new Array(o.length+4).join(" "):l<a.length-2&&(u+=" ")}console.log(u)}function s(o,a,c){let u=new Date().getTime();const l=new Uint8Array(a);for(let p=0;p<a;p++)l[p]=p%256;const f=new Date().getTime();console.log("Generated random input in "+(f-u)+"ms"),u=f;for(let p=0;p<c;p++){const d=o(l),h=new Date().getTime(),g=h-u;u=h,console.log("Hashed in "+g+"ms: "+d.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(g/1e3)*100)/100+" MB PER SECOND")}}return Wc={normalizeInput:e,toHex:r,debugPrint:i,testSpeed:s},Wc}var Gc,lp;function UA(){if(lp)return Gc;lp=1;const t=Ay();function e(y,S,b){const x=y[S]+y[b];let I=y[S+1]+y[b+1];x>=4294967296&&I++,y[S]=x,y[S+1]=I}function r(y,S,b,x){let I=y[S]+b;b<0&&(I+=4294967296);let A=y[S+1]+x;I>=4294967296&&A++,y[S]=I,y[S+1]=A}function n(y,S){return y[S]^y[S+1]<<8^y[S+2]<<16^y[S+3]<<24}function i(y,S,b,x,I,A){const B=u[I],P=u[I+1],N=u[A],$=u[A+1];e(c,y,S),r(c,y,B,P);let G=c[x]^c[y],q=c[x+1]^c[y+1];c[x]=q,c[x+1]=G,e(c,b,x),G=c[S]^c[b],q=c[S+1]^c[b+1],c[S]=G>>>24^q<<8,c[S+1]=q>>>24^G<<8,e(c,y,S),r(c,y,N,$),G=c[x]^c[y],q=c[x+1]^c[y+1],c[x]=G>>>16^q<<16,c[x+1]=q>>>16^G<<16,e(c,b,x),G=c[S]^c[b],q=c[S+1]^c[b+1],c[S]=q>>>31^G<<1,c[S+1]=G>>>31^q<<1}const s=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(y){return y*2})),c=new Uint32Array(32),u=new Uint32Array(32);function l(y,S){let b=0;for(b=0;b<16;b++)c[b]=y.h[b],c[b+16]=s[b];for(c[24]=c[24]^y.t,c[25]=c[25]^y.t/4294967296,S&&(c[28]=~c[28],c[29]=~c[29]),b=0;b<32;b++)u[b]=n(y.b,4*b);for(b=0;b<12;b++)i(0,8,16,24,a[b*16+0],a[b*16+1]),i(2,10,18,26,a[b*16+2],a[b*16+3]),i(4,12,20,28,a[b*16+4],a[b*16+5]),i(6,14,22,30,a[b*16+6],a[b*16+7]),i(0,10,20,30,a[b*16+8],a[b*16+9]),i(2,12,22,24,a[b*16+10],a[b*16+11]),i(4,14,16,26,a[b*16+12],a[b*16+13]),i(6,8,18,28,a[b*16+14],a[b*16+15]);for(b=0;b<16;b++)y.h[b]=y.h[b]^c[b]^c[b+16]}const f=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function p(y,S,b,x){if(y===0||y>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(S&&S.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(b&&b.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(x&&x.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const I={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:y};f.fill(0),f[0]=y,S&&(f[1]=S.length),f[2]=1,f[3]=1,b&&f.set(b,32),x&&f.set(x,48);for(let A=0;A<16;A++)I.h[A]=s[A]^n(f,A*4);return S&&(d(I,S),I.c=128),I}function d(y,S){for(let b=0;b<S.length;b++)y.c===128&&(y.t+=y.c,l(y,!1),y.c=0),y.b[y.c++]=S[b]}function h(y){for(y.t+=y.c;y.c<128;)y.b[y.c++]=0;l(y,!0);const S=new Uint8Array(y.outlen);for(let b=0;b<y.outlen;b++)S[b]=y.h[b>>2]>>8*(b&3);return S}function g(y,S,b,x,I){b=b||64,y=t.normalizeInput(y),x&&(x=t.normalizeInput(x)),I&&(I=t.normalizeInput(I));const A=p(b,S,x,I);return d(A,y),h(A)}function m(y,S,b,x,I){const A=g(y,S,b,x,I);return t.toHex(A)}return Gc={blake2b:g,blake2bHex:m,blake2bInit:p,blake2bUpdate:d,blake2bFinal:h},Gc}var Yc,fp;function LA(){if(fp)return Yc;fp=1;const t=Ay();function e(h,g){return h[g]^h[g+1]<<8^h[g+2]<<16^h[g+3]<<24}function r(h,g,m,y,S,b){o[h]=o[h]+o[g]+S,o[y]=n(o[y]^o[h],16),o[m]=o[m]+o[y],o[g]=n(o[g]^o[m],12),o[h]=o[h]+o[g]+b,o[y]=n(o[y]^o[h],8),o[m]=o[m]+o[y],o[g]=n(o[g]^o[m],7)}function n(h,g){return h>>>g^h<<32-g}const i=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),s=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(h,g){let m=0;for(m=0;m<8;m++)o[m]=h.h[m],o[m+8]=i[m];for(o[12]^=h.t,o[13]^=h.t/4294967296,g&&(o[14]=~o[14]),m=0;m<16;m++)a[m]=e(h.b,4*m);for(m=0;m<10;m++)r(0,4,8,12,a[s[m*16+0]],a[s[m*16+1]]),r(1,5,9,13,a[s[m*16+2]],a[s[m*16+3]]),r(2,6,10,14,a[s[m*16+4]],a[s[m*16+5]]),r(3,7,11,15,a[s[m*16+6]],a[s[m*16+7]]),r(0,5,10,15,a[s[m*16+8]],a[s[m*16+9]]),r(1,6,11,12,a[s[m*16+10]],a[s[m*16+11]]),r(2,7,8,13,a[s[m*16+12]],a[s[m*16+13]]),r(3,4,9,14,a[s[m*16+14]],a[s[m*16+15]]);for(m=0;m<8;m++)h.h[m]^=o[m]^o[m+8]}function u(h,g){if(!(h>0&&h<=32))throw new Error("Incorrect output length, should be in [1, 32]");const m=g?g.length:0;if(g&&!(m>0&&m<=32))throw new Error("Incorrect key length, should be in [1, 32]");const y={h:new Uint32Array(i),b:new Uint8Array(64),c:0,t:0,outlen:h};return y.h[0]^=16842752^m<<8^h,m>0&&(l(y,g),y.c=64),y}function l(h,g){for(let m=0;m<g.length;m++)h.c===64&&(h.t+=h.c,c(h,!1),h.c=0),h.b[h.c++]=g[m]}function f(h){for(h.t+=h.c;h.c<64;)h.b[h.c++]=0;c(h,!0);const g=new Uint8Array(h.outlen);for(let m=0;m<h.outlen;m++)g[m]=h.h[m>>2]>>8*(m&3)&255;return g}function p(h,g,m){m=m||32,h=t.normalizeInput(h);const y=u(m,g);return l(y,h),f(y)}function d(h,g,m){const y=p(h,g,m);return t.toHex(y)}return Yc={blake2s:p,blake2sHex:d,blake2sInit:u,blake2sUpdate:l,blake2sFinal:f},Yc}var Xc,hp;function MA(){if(hp)return Xc;hp=1;const t=UA(),e=LA();return Xc={blake2b:t.blake2b,blake2bHex:t.blake2bHex,blake2bInit:t.blake2bInit,blake2bUpdate:t.blake2bUpdate,blake2bFinal:t.blake2bFinal,blake2s:e.blake2s,blake2sHex:e.blake2sHex,blake2sInit:e.blake2sInit,blake2sUpdate:e.blake2sUpdate,blake2sFinal:e.blake2sFinal},Xc}var $A=MA(),FA={};const Eo=":";function Zn(t){const[e,r]=t.split(Eo);return{namespace:e,reference:r}}function Ty(t){const{namespace:e,reference:r}=t;return[e,r].join(Eo)}function Wl(t){const[e,r,n]=t.split(Eo);return{namespace:e,reference:r,address:n}}function Oy(t){const{namespace:e,reference:r,address:n}=t;return[e,r,n].join(Eo)}function Gl(t,e){const r=[];return t.forEach(n=>{const i=e(n);r.includes(i)||r.push(i)}),r}function Cy(t){const{address:e}=Wl(t);return e}function Ry(t){const{namespace:e,reference:r}=Wl(t);return Ty({namespace:e,reference:r})}function kA(t,e){const{namespace:r,reference:n}=Zn(e);return Oy({namespace:r,reference:n,address:t})}function qA(t){return Gl(t,Cy)}function Dy(t){return Gl(t,Ry)}function jA(t,e=[]){const r=[];return Object.keys(t).forEach(n=>{if(e.length&&!e.includes(n))return;const i=t[n];r.push(...i.accounts)}),r}function zA(t,e=[]){const r=[];return Object.keys(t).forEach(n=>{if(e.length&&!e.includes(n))return;const i=t[n];r.push(...Dy(i.accounts))}),r}function VA(t,e=[]){const r=[];return Object.keys(t).forEach(n=>{if(e.length&&!e.includes(n))return;const i=t[n];r.push(...vo(n,i))}),r}function vo(t,e){return t.includes(":")?[t]:e.chains||[]}var HA=Object.defineProperty,KA=Object.defineProperties,WA=Object.getOwnPropertyDescriptors,dp=Object.getOwnPropertySymbols,GA=Object.prototype.hasOwnProperty,YA=Object.prototype.propertyIsEnumerable,Nu=(t,e,r)=>e in t?HA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pp=(t,e)=>{for(var r in e||(e={}))GA.call(e,r)&&Nu(t,r,e[r]);if(dp)for(var r of dp(e))YA.call(e,r)&&Nu(t,r,e[r]);return t},XA=(t,e)=>KA(t,WA(e)),gp=(t,e,r)=>Nu(t,typeof e!="symbol"?e+"":e,r);const By="ReactNative",mt={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Zs=" ",ZA=":",Ny="/",Yl=2,JA=1e3,Py="js";function Gi(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ur(){return!pr.getDocument()&&!!pr.getNavigator()&&navigator.product===By}function Uy(){return Ur()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function Ly(){return Ur()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Pn(){return!Gi()&&!!pr.getNavigator()&&!!pr.getDocument()}function Un(){return Ur()?mt.reactNative:Gi()?mt.node:Pn()?mt.browser:mt.unknown}function Pu(){var t;try{return Ur()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function My(t,e){const r=new URLSearchParams(t);return Object.entries(e).sort(([n],[i])=>n.localeCompare(i)).forEach(([n,i])=>{i!=null&&r.set(n,String(i))}),r.toString()}function $y(t){var e,r;const n=Xl();try{return t!=null&&t.url&&n.url&&new URL(t.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),t.url=n.url),(e=t?.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(i=>i!=="")),XA(pp(pp({},n),t),{url:t?.url||n.url,name:t?.name||n.name,description:t?.description||n.description,icons:(r=t?.icons)!=null&&r.length&&t.icons.length>0?t.icons:n.icons})}catch(i){return console.warn("Error populating app metadata",i),t||n}}function Xl(){return WS.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function QA(t,e){var r;const n=Un(),i={protocol:t,version:e,env:n};return n==="browser"&&(i.host=((r=pr.getLocation())==null?void 0:r.host)||"unknown"),i}function Fy(){if(Un()===mt.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=kS();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function ky(){var t;const e=Un();return e===mt.browser?[e,((t=pr.getLocation())==null?void 0:t.host)||"unknown"].join(":"):e}function Zl(t,e,r){const n=Fy(),i=ky();return[[t,e].join("-"),[Py,r].join("-"),n,i].join("/")}function qy({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const u=r.split("?"),l=Zl(t,e,n),f={auth:i,ua:l,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},p=My(u[1]||"",f);return u[0]+"?"+p}function e8(t){let e=(t.match(/^[^:]+(?=:\/\/)/gi)||[])[0];const r=typeof e<"u"?t.split("://")[1]:t;return e=e==="wss"?"https":"http",[e,r].join("://")}function t8(t,e,r){if(!t[e]||typeof t[e]!==r)throw new Error(`Missing or invalid "${e}" param`)}function jy(t,e=Yl){return zy(t.split(Ny),e)}function r8(t){return jy(t).join(Zs)}function Qr(t,e){return t.filter(r=>e.includes(r)).length===t.length}function zy(t,e=Yl){return t.slice(Math.max(t.length-e,0))}function Js(t){return Object.fromEntries(t.entries())}function Qs(t){return new Map(Object.entries(t))}function n8(t,e){const r={};return Object.keys(t).forEach(n=>{r[n]=e(t[n])}),r}const i8=t=>t;function Vy(t){return t.trim().replace(/^\w/,e=>e.toUpperCase())}function s8(t){return t.split(Zs).map(e=>Vy(e)).join(Zs)}function Wr(t=pe.FIVE_MINUTES,e){const r=pe.toMiliseconds(t||pe.FIVE_MINUTES);let n,i,s,o;return{resolve:a=>{s&&n&&(clearTimeout(s),n(a),o=Promise.resolve(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{const u=new Error(e);o=Promise.reject(u),c(u)},r),n=a,i=c})}}function tr(t,e,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),e);try{const o=await t;n(o)}catch(o){i(o)}clearTimeout(s)})}function Jl(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Hy(t){return Jl("topic",t)}function Ky(t){return Jl("id",t)}function Ql(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Ke(t,e){return pe.fromMiliseconds((e||Date.now())+pe.toMiliseconds(t))}function Or(t){return Date.now()>=pe.toMiliseconds(t)}function Be(t,e){return`${t}${e?`:${e}`:""}`}function Vt(t=[],e=[]){return[...new Set([...t,...e])]}async function Wy({id:t,topic:e,wcDeepLink:r}){var n;try{if(!r)return;const i=typeof r=="string"?JSON.parse(r):r,s=i?.href;if(typeof s!="string")return;const o=Gy(s,t,e),a=Un();if(a===mt.browser){if(!((n=pr.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}Yy(o)}else a===mt.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(i){console.error(i)}}function Gy(t,e,r){const n=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let i=`${t}`;if(t.startsWith("https://t.me")){const s=t.includes("?")?"&startapp=":"?startapp=";i=`${i}${s}${Qy(n,!0)}`}else i=`${i}/wc?${n}`;return i}function Yy(t){let e="_self";Jy()?e="_top":(Zy()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function Xy(t,e){let r="";try{if(Pn()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(n){console.error(n)}return r}function Uu(t,e){return t.filter(r=>e.includes(r))}function Lu(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),n=r.indexOf(e);return r[n+2]}function Mu(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function _o(){return typeof process<"u"&&FA.IS_VITEST==="true"}function Zy(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function Jy(){try{return window.self!==window.top}catch{return!1}}function Qy(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function ef(t){return Buffer.from(t,"base64").toString("utf-8")}function ew(t){return new Promise(e=>setTimeout(e,t))}let tw=class{constructor({limit:e}){gp(this,"limit"),gp(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const r=this.set.values().next().value;r&&this.set.delete(r)}this.set.add(e)}}has(e){return this.set.has(e)}};const Os=BigInt(2**32-1),yp=BigInt(32);function rw(t,e=!1){return e?{h:Number(t&Os),l:Number(t>>yp&Os)}:{h:Number(t>>yp&Os)|0,l:Number(t&Os)|0}}function nw(t,e=!1){const r=t.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){const{h:o,l:a}=rw(t[s],e);[n[s],i[s]]=[o,a]}return[n,i]}const wp=(t,e,r)=>t>>>r,mp=(t,e,r)=>t<<32-r|e>>>r,Gr=(t,e,r)=>t>>>r|e<<32-r,Yr=(t,e,r)=>t<<32-r|e>>>r,Ri=(t,e,r)=>t<<64-r|e>>>r-32,Di=(t,e,r)=>t>>>r-32|e<<64-r,o8=(t,e)=>e,a8=(t,e)=>t,c8=(t,e,r)=>t<<r|e>>>32-r,u8=(t,e,r)=>e<<r|t>>>32-r,l8=(t,e,r)=>e<<r-32|t>>>64-r,f8=(t,e,r)=>t<<r-32|e>>>64-r;function er(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}const tf=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),rf=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,h8=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),d8=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,p8=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),g8=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,zn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function So(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Pr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function nr(t,...e){if(!So(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function xo(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Pr(t.outputLen),Pr(t.blockLen)}function nn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function nf(t,e){nr(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Yi(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Ht(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Zc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function cr(t,e){return t<<32-e|t>>>e}const iw=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function sw(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const xr=iw?t=>t:t=>sw(t);function y8(t){for(let e=0;e<t.length;e++)t[e]=sw(t[e]);return t}const Xr=iw?t=>t:y8,ow=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",w8=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Jn(t){if(nr(t),ow)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=w8[t[r]];return e}const vr={_0:48,_9:57,A:65,F:70,a:97,f:102};function bp(t){if(t>=vr._0&&t<=vr._9)return t-vr._0;if(t>=vr.A&&t<=vr.F)return t-(vr.A-10);if(t>=vr.a&&t<=vr.f)return t-(vr.a-10)}function eo(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(ow)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=bp(t.charCodeAt(s)),a=bp(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function aw(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function rr(t){return typeof t=="string"&&(t=aw(t)),nr(t),t}function Jr(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];nr(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}class Io{}function cs(t){const e=n=>t().update(rr(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function m8(t){const e=(n,i)=>t(i).update(rr(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function Ln(t=32){if(zn&&typeof zn.getRandomValues=="function")return zn.getRandomValues(new Uint8Array(t));if(zn&&typeof zn.randomBytes=="function")return Uint8Array.from(zn.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const b8=BigInt(0),Si=BigInt(1),E8=BigInt(2),v8=BigInt(7),_8=BigInt(256),S8=BigInt(113),cw=[],uw=[],lw=[];for(let t=0,e=Si,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],cw.push(2*(5*n+r)),uw.push((t+1)*(t+2)/2%64);let i=b8;for(let s=0;s<7;s++)e=(e<<Si^(e>>v8)*S8)%_8,e&E8&&(i^=Si<<(Si<<BigInt(s))-Si);lw.push(i)}const fw=nw(lw,!0),x8=fw[0],I8=fw[1],Ep=(t,e,r)=>r>32?l8(t,e,r):c8(t,e,r),vp=(t,e,r)=>r>32?f8(t,e,r):u8(t,e,r);function A8(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=r[c],l=r[c+1],f=Ep(u,l,1)^r[a],p=vp(u,l,1)^r[a+1];for(let d=0;d<50;d+=10)t[o+d]^=f,t[o+d+1]^=p}let i=t[2],s=t[3];for(let o=0;o<24;o++){const a=uw[o],c=Ep(i,s,a),u=vp(i,s,a),l=cw[o];i=t[l],s=t[l+1],t[l]=c,t[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=x8[n],t[1]^=I8[n]}Ht(r)}let T8=class hw extends Io{constructor(e,r,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,Pr(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Yi(this.state)}clone(){return this._cloneInto()}keccak(){Xr(this.state32),A8(this.state32,this.rounds),Xr(this.state32),this.posOut=0,this.pos=0}update(e){nn(this),e=rr(e),nr(e);const{blockLen:r,state:n}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){nn(this,!1),nr(e),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Pr(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(nf(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Ht(this.state)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new hw(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}};const O8=(t,e,r)=>cs(()=>new T8(e,t,r)),C8=O8(1,136,256/8);function R8(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}function D8(t,e,r){return t&e^~t&r}function B8(t,e,r){return t&e^t&r^e&r}let dw=class extends Io{constructor(e,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=Zc(this.buffer)}update(e){nn(this),e=rr(e),nr(e);const{view:r,buffer:n,blockLen:i}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=Zc(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){nn(this),nf(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,Ht(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(n,0),o=0);for(let f=o;f<i;f++)r[f]=0;R8(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=Zc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)a.setUint32(4*f,l[f],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=s,e.length=i,e.pos=a,i%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}};const qr=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),at=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),ct=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),N8=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),jr=new Uint32Array(64);class P8 extends dw{constructor(e=32){super(64,e,8,!1),this.A=qr[0]|0,this.B=qr[1]|0,this.C=qr[2]|0,this.D=qr[3]|0,this.E=qr[4]|0,this.F=qr[5]|0,this.G=qr[6]|0,this.H=qr[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,r,n,i,s,o,a,c]}set(e,r,n,i,s,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let f=0;f<16;f++,r+=4)jr[f]=e.getUint32(r,!1);for(let f=16;f<64;f++){const p=jr[f-15],d=jr[f-2],h=cr(p,7)^cr(p,18)^p>>>3,g=cr(d,17)^cr(d,19)^d>>>10;jr[f]=g+jr[f-7]+h+jr[f-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:u,H:l}=this;for(let f=0;f<64;f++){const p=cr(a,6)^cr(a,11)^cr(a,25),d=l+p+D8(a,c,u)+N8[f]+jr[f]|0,h=(cr(n,2)^cr(n,13)^cr(n,22))+B8(n,i,s)|0;l=u,u=c,c=a,a=o+d|0,o=s,s=i,i=n,n=d+h|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,i,s,o,a,c,u,l)}roundClean(){Ht(jr)}destroy(){this.set(0,0,0,0,0,0,0,0),Ht(this.buffer)}}const pw=nw(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),U8=pw[0],L8=pw[1],zr=new Uint32Array(80),Vr=new Uint32Array(80);let sf=class extends dw{constructor(e=64){super(128,e,16,!1),this.Ah=ct[0]|0,this.Al=ct[1]|0,this.Bh=ct[2]|0,this.Bl=ct[3]|0,this.Ch=ct[4]|0,this.Cl=ct[5]|0,this.Dh=ct[6]|0,this.Dl=ct[7]|0,this.Eh=ct[8]|0,this.El=ct[9]|0,this.Fh=ct[10]|0,this.Fl=ct[11]|0,this.Gh=ct[12]|0,this.Gl=ct[13]|0,this.Hh=ct[14]|0,this.Hl=ct[15]|0}get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:f,Fl:p,Gh:d,Gl:h,Hh:g,Hl:m}=this;return[e,r,n,i,s,o,a,c,u,l,f,p,d,h,g,m]}set(e,r,n,i,s,o,a,c,u,l,f,p,d,h,g,m){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=f|0,this.Fl=p|0,this.Gh=d|0,this.Gl=h|0,this.Hh=g|0,this.Hl=m|0}process(e,r){for(let b=0;b<16;b++,r+=4)zr[b]=e.getUint32(r),Vr[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){const x=zr[b-15]|0,I=Vr[b-15]|0,A=Gr(x,I,1)^Gr(x,I,8)^wp(x,I,7),B=Yr(x,I,1)^Yr(x,I,8)^mp(x,I,7),P=zr[b-2]|0,N=Vr[b-2]|0,$=Gr(P,N,19)^Ri(P,N,61)^wp(P,N,6),G=Yr(P,N,19)^Di(P,N,61)^mp(P,N,6),q=h8(B,G,Vr[b-7],Vr[b-16]),L=d8(q,A,$,zr[b-7],zr[b-16]);zr[b]=L|0,Vr[b]=q|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:f,El:p,Fh:d,Fl:h,Gh:g,Gl:m,Hh:y,Hl:S}=this;for(let b=0;b<80;b++){const x=Gr(f,p,14)^Gr(f,p,18)^Ri(f,p,41),I=Yr(f,p,14)^Yr(f,p,18)^Di(f,p,41),A=f&d^~f&g,B=p&h^~p&m,P=p8(S,I,B,L8[b],Vr[b]),N=g8(P,y,x,A,U8[b],zr[b]),$=P|0,G=Gr(n,i,28)^Ri(n,i,34)^Ri(n,i,39),q=Yr(n,i,28)^Di(n,i,34)^Di(n,i,39),L=n&s^n&a^s&a,j=i&o^i&c^o&c;y=g|0,S=m|0,g=d|0,m=h|0,d=f|0,h=p|0,{h:f,l:p}=er(u|0,l|0,N|0,$|0),u=a|0,l=c|0,a=s|0,c=o|0,s=n|0,o=i|0;const T=tf($,q,j);n=rf(T,N,G,L),i=T|0}({h:n,l:i}=er(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=er(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=er(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=er(this.Dh|0,this.Dl|0,u|0,l|0),{h:f,l:p}=er(this.Eh|0,this.El|0,f|0,p|0),{h:d,l:h}=er(this.Fh|0,this.Fl|0,d|0,h|0),{h:g,l:m}=er(this.Gh|0,this.Gl|0,g|0,m|0),{h:y,l:S}=er(this.Hh|0,this.Hl|0,y|0,S|0),this.set(n,i,s,o,a,c,u,l,f,p,d,h,g,m,y,S)}roundClean(){Ht(zr,Vr)}destroy(){Ht(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class M8 extends sf{constructor(){super(48),this.Ah=at[0]|0,this.Al=at[1]|0,this.Bh=at[2]|0,this.Bl=at[3]|0,this.Ch=at[4]|0,this.Cl=at[5]|0,this.Dh=at[6]|0,this.Dl=at[7]|0,this.Eh=at[8]|0,this.El=at[9]|0,this.Fh=at[10]|0,this.Fl=at[11]|0,this.Gh=at[12]|0,this.Gl=at[13]|0,this.Hh=at[14]|0,this.Hl=at[15]|0}}const ut=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class $8 extends sf{constructor(){super(32),this.Ah=ut[0]|0,this.Al=ut[1]|0,this.Bh=ut[2]|0,this.Bl=ut[3]|0,this.Ch=ut[4]|0,this.Cl=ut[5]|0,this.Dh=ut[6]|0,this.Dl=ut[7]|0,this.Eh=ut[8]|0,this.El=ut[9]|0,this.Fh=ut[10]|0,this.Fl=ut[11]|0,this.Gh=ut[12]|0,this.Gl=ut[13]|0,this.Hh=ut[14]|0,this.Hl=ut[15]|0}}const Ao=cs(()=>new P8),F8=cs(()=>new sf),k8=cs(()=>new M8),q8=cs(()=>new $8),j8=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Ge=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ye=new Uint32Array(32);function Hr(t,e,r,n,i,s){const o=i[s],a=i[s+1];let c=ye[2*t],u=ye[2*t+1],l=ye[2*e],f=ye[2*e+1],p=ye[2*r],d=ye[2*r+1],h=ye[2*n],g=ye[2*n+1],m=tf(c,l,o);u=rf(m,u,f,a),c=m|0,{Dh:g,Dl:h}={Dh:g^u,Dl:h^c},{Dh:g,Dl:h}={Dh:o8(g,h),Dl:a8(g)},{h:d,l:p}=er(d,p,g,h),{Bh:f,Bl:l}={Bh:f^d,Bl:l^p},{Bh:f,Bl:l}={Bh:Gr(f,l,24),Bl:Yr(f,l,24)},ye[2*t]=c,ye[2*t+1]=u,ye[2*e]=l,ye[2*e+1]=f,ye[2*r]=p,ye[2*r+1]=d,ye[2*n]=h,ye[2*n+1]=g}function Kr(t,e,r,n,i,s){const o=i[s],a=i[s+1];let c=ye[2*t],u=ye[2*t+1],l=ye[2*e],f=ye[2*e+1],p=ye[2*r],d=ye[2*r+1],h=ye[2*n],g=ye[2*n+1],m=tf(c,l,o);u=rf(m,u,f,a),c=m|0,{Dh:g,Dl:h}={Dh:g^u,Dl:h^c},{Dh:g,Dl:h}={Dh:Gr(g,h,16),Dl:Yr(g,h,16)},{h:d,l:p}=er(d,p,g,h),{Bh:f,Bl:l}={Bh:f^d,Bl:l^p},{Bh:f,Bl:l}={Bh:Ri(f,l,63),Bl:Di(f,l,63)},ye[2*t]=c,ye[2*t+1]=u,ye[2*e]=l,ye[2*e+1]=f,ye[2*r]=p,ye[2*r+1]=d,ye[2*n]=h,ye[2*n+1]=g}function z8(t,e={},r,n,i){if(Pr(r),t<0||t>r)throw new Error("outputLen bigger than keyLen");const{key:s,salt:o,personalization:a}=e;if(s!==void 0&&(s.length<1||s.length>r))throw new Error("key length must be undefined or 1.."+r);if(o!==void 0&&o.length!==n)throw new Error("salt must be undefined or "+n);if(a!==void 0&&a.length!==i)throw new Error("personalization must be undefined or "+i)}class V8 extends Io{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Pr(e),Pr(r),this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=Yi(this.buffer)}update(e){nn(this),e=rr(e),nr(e);const{blockLen:r,buffer:n,buffer32:i}=this,s=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<s;){this.pos===r&&(Xr(i),this.compress(i,0,!1),Xr(i),this.pos=0);const u=Math.min(r-this.pos,s-c),l=o+c;if(u===r&&!(l%4)&&c+u<s){const f=new Uint32Array(a,l,Math.floor((s-c)/4));Xr(f);for(let p=0;c+r<s;p+=i.length,c+=r)this.length+=r,this.compress(f,p,!1);Xr(f);continue}n.set(e.subarray(c,c+u),this.pos),this.pos+=u,this.length+=u,c+=u}return this}digestInto(e){nn(this),nf(e,this);const{pos:r,buffer32:n}=this;this.finished=!0,Ht(this.buffer.subarray(r)),Xr(n),this.compress(n,0,!0),Xr(n);const i=Yi(e);this.get().forEach((s,o)=>i[o]=xr(s))}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){const{buffer:r,length:n,finished:i,destroyed:s,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(r),e.destroyed=s,e.finished=i,e.length=n,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class H8 extends V8{constructor(e={}){const r=e.dkLen===void 0?64:e.dkLen;super(128,r),this.v0l=Ge[0]|0,this.v0h=Ge[1]|0,this.v1l=Ge[2]|0,this.v1h=Ge[3]|0,this.v2l=Ge[4]|0,this.v2h=Ge[5]|0,this.v3l=Ge[6]|0,this.v3h=Ge[7]|0,this.v4l=Ge[8]|0,this.v4h=Ge[9]|0,this.v5l=Ge[10]|0,this.v5h=Ge[11]|0,this.v6l=Ge[12]|0,this.v6h=Ge[13]|0,this.v7l=Ge[14]|0,this.v7h=Ge[15]|0,z8(r,e,64,16,16);let{key:n,personalization:i,salt:s}=e,o=0;if(n!==void 0&&(n=rr(n),o=n.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,s!==void 0){s=rr(s);const a=Yi(s);this.v4l^=xr(a[0]),this.v4h^=xr(a[1]),this.v5l^=xr(a[2]),this.v5h^=xr(a[3])}if(i!==void 0){i=rr(i);const a=Yi(i);this.v6l^=xr(a[0]),this.v6h^=xr(a[1]),this.v7l^=xr(a[2]),this.v7h^=xr(a[3])}if(n!==void 0){const a=new Uint8Array(this.blockLen);a.set(n),this.update(a)}}get(){let{v0l:e,v0h:r,v1l:n,v1h:i,v2l:s,v2h:o,v3l:a,v3h:c,v4l:u,v4h:l,v5l:f,v5h:p,v6l:d,v6h:h,v7l:g,v7h:m}=this;return[e,r,n,i,s,o,a,c,u,l,f,p,d,h,g,m]}set(e,r,n,i,s,o,a,c,u,l,f,p,d,h,g,m){this.v0l=e|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=u|0,this.v4h=l|0,this.v5l=f|0,this.v5h=p|0,this.v6l=d|0,this.v6h=h|0,this.v7l=g|0,this.v7h=m|0}compress(e,r,n){this.get().forEach((c,u)=>ye[u]=c),ye.set(Ge,16);let{h:i,l:s}=rw(BigInt(this.length));ye[24]=Ge[8]^s,ye[25]=Ge[9]^i,n&&(ye[28]=~ye[28],ye[29]=~ye[29]);let o=0;const a=j8;for(let c=0;c<12;c++)Hr(0,4,8,12,e,r+2*a[o++]),Kr(0,4,8,12,e,r+2*a[o++]),Hr(1,5,9,13,e,r+2*a[o++]),Kr(1,5,9,13,e,r+2*a[o++]),Hr(2,6,10,14,e,r+2*a[o++]),Kr(2,6,10,14,e,r+2*a[o++]),Hr(3,7,11,15,e,r+2*a[o++]),Kr(3,7,11,15,e,r+2*a[o++]),Hr(0,5,10,15,e,r+2*a[o++]),Kr(0,5,10,15,e,r+2*a[o++]),Hr(1,6,11,12,e,r+2*a[o++]),Kr(1,6,11,12,e,r+2*a[o++]),Hr(2,7,8,13,e,r+2*a[o++]),Kr(2,7,8,13,e,r+2*a[o++]),Hr(3,4,9,14,e,r+2*a[o++]),Kr(3,4,9,14,e,r+2*a[o++]);this.v0l^=ye[0]^ye[16],this.v0h^=ye[1]^ye[17],this.v1l^=ye[2]^ye[18],this.v1h^=ye[3]^ye[19],this.v2l^=ye[4]^ye[20],this.v2h^=ye[5]^ye[21],this.v3l^=ye[6]^ye[22],this.v3h^=ye[7]^ye[23],this.v4l^=ye[8]^ye[24],this.v4h^=ye[9]^ye[25],this.v5l^=ye[10]^ye[26],this.v5h^=ye[11]^ye[27],this.v6l^=ye[12]^ye[28],this.v6h^=ye[13]^ye[29],this.v7l^=ye[14]^ye[30],this.v7h^=ye[15]^ye[31],Ht(ye)}destroy(){this.destroyed=!0,Ht(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const K8=m8(t=>new H8(t)),W8="https://rpc.walletconnect.org/v1";function of(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(C8(r)).toString("hex")}async function gw(t,e,r,n,i,s){switch(r.t){case"eip191":return await yw(t,e,r.s);case"eip1271":return await ww(t,e,r.s,n,i,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}function yw(t,e,r){const n=FI(r);return JI({payload:of(e),signature:n}).toLowerCase()===t.toLowerCase()}async function ww(t,e,r,n,i,s){const o=Zn(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",u=r.substring(2),l=(u.length/2).toString(16).padStart(64,"0"),f=(e.startsWith("0x")?e:of(e)).substring(2),p=a+f+c+l+u,d=await fetch(`${s||W8}/?chainId=${n}&projectId=${i}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:G8(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:p},"latest"]})}),{result:h}=await d.json();return h?h.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function G8(){return Date.now()+Math.floor(Math.random()*1e3)}function mw(t){const e=atob(t),r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);const n=r[0];if(n===0)throw new Error("No signatures found");const i=1+n*64;if(r.length<i)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const s=Buffer.from(t,"base64").slice(1,65);return os.encode(s)}function bw(t){const e=new Uint8Array(Buffer.from(t,"base64")),r=Array.from("TransactionData::").map(s=>s.charCodeAt(0)),n=new Uint8Array(r.length+e.length);n.set(r),n.set(e,r.length);const i=K8(n,{dkLen:32});return os.encode(i)}function $u(t){const e=new Uint8Array(Ao(Ew(t)));return os.encode(e)}function Ew(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function Fu(t){const e=Buffer.from(t,"base64"),r=M3(e).txn;if(!r)throw new Error("Invalid signed transaction: missing 'txn' field");const n=O3(r),i=Buffer.from("TX"),s=Buffer.concat([i,Buffer.from(n)]),o=q8(s);return ZI.encode(o).replace(/=+$/,"")}function Jc(t){const e=[];let r=BigInt(t);for(;r>=BigInt(128);)e.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return e.push(Number(r)),Buffer.from(e)}function vw(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),r=Buffer.from(t.signed.authInfoBytes,"base64"),n=Buffer.from(t.signature.signature,"base64"),i=[];i.push(Buffer.from([10])),i.push(Jc(e.length)),i.push(e),i.push(Buffer.from([18])),i.push(Jc(r.length)),i.push(r),i.push(Buffer.from([26])),i.push(Jc(n.length)),i.push(n);const s=Buffer.concat(i),o=Ao(s);return Buffer.from(o).toString("hex").toUpperCase()}function _w(t){var e,r;const n=[];try{if(typeof t=="string")return n.push(t),n;if(typeof t!="object")return n;t!=null&&t.id&&n.push(t.id);const i=(r=(e=t?.capabilities)==null?void 0:e.caip345)==null?void 0:r.transactionHashes;i&&n.push(...i)}catch(i){console.warn("getWalletSendCallsHashes failed: ",i)}return n}var Y8=Object.defineProperty,X8=Object.defineProperties,Z8=Object.getOwnPropertyDescriptors,_p=Object.getOwnPropertySymbols,J8=Object.prototype.hasOwnProperty,Q8=Object.prototype.propertyIsEnumerable,Sp=(t,e,r)=>e in t?Y8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,af=(t,e)=>{for(var r in e||(e={}))J8.call(e,r)&&Sp(t,r,e[r]);if(_p)for(var r of _p(e))Q8.call(e,r)&&Sp(t,r,e[r]);return t},Sw=(t,e)=>X8(t,Z8(e));const eT="did:pkh:",To=t=>t?.split(":"),xw=t=>{const e=t&&To(t);if(e)return t.includes(eT)?e[3]:e[1]},to=t=>{const e=t&&To(t);if(e)return e[2]+":"+e[3]},Xi=t=>{const e=t&&To(t);if(e)return e.pop()};async function ku(t){const{cacao:e,projectId:r}=t,{s:n,p:i}=e,s=cf(i,i.iss),o=Xi(i.iss);return await gw(o,s,n,to(i.iss),r)}const cf=(t,e)=>{const r=`${t.domain} wants you to sign in with your Ethereum account:`,n=Xi(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=t.statement||void 0;const s=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${xw(e)}`,c=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,l=t.exp?`Expiration Time: ${t.exp}`:void 0,f=t.nbf?`Not Before: ${t.nbf}`:void 0,p=t.requestId?`Request ID: ${t.requestId}`:void 0,d=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,h=In(t.resources);if(h){const g=sn(h);i=ff(i,g)}return[r,n,"",i,"",s,o,a,c,u,l,f,p,d].filter(g=>g!=null).join(`
`)};function tT(t,e,r){return r.includes("did:pkh:")||(r=`did:pkh:${r}`),{h:{t:"caip122"},p:{iss:r,domain:t.domain,aud:t.aud,version:t.version,nonce:t.nonce,iat:t.iat,statement:t.statement,requestId:t.requestId,resources:t.resources,nbf:t.nbf,exp:t.exp},s:e}}function rT(t){var e;const{authPayload:r,chains:n,methods:i}=t,s=r.statement||"";if(!(n!=null&&n.length))return r;const o=r.chains,a=Uu(o,n);if(!(a!=null&&a.length))throw new Error("No supported chains");const c=Iw(r.resources);if(!c)return r;gr(c);const u=Aw(c,"eip155");let l=r?.resources||[];if(u!=null&&u.length){const f=Tw(u),p=Uu(f,i);if(!(p!=null&&p.length))throw new Error(`Supported methods don't satisfy the requested: ${JSON.stringify(f)}, supported: ${JSON.stringify(i)}`);const d=uf("request",p,{chains:a}),h=Dw(c,"eip155",d);l=((e=r?.resources)==null?void 0:e.slice(0,-1))||[],l.push(Oo(h))}return Sw(af({},r),{statement:Uw(s,In(l)),chains:a,resources:r!=null&&r.resources||l.length>0?l:void 0})}function Iw(t){const e=In(t);if(e&&lf(e))return sn(e)}function nT(t,e){var r;return(r=t?.att)==null?void 0:r.hasOwnProperty(e)}function Aw(t,e){var r,n;return(r=t?.att)!=null&&r[e]?Object.keys((n=t?.att)==null?void 0:n[e]):[]}function iT(t){return t?.map(e=>Object.keys(e))||[]}function Tw(t){return t?.map(e=>{var r;return(r=e.split("/"))==null?void 0:r[1]})||[]}function Ow(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function Cw(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function gr(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const n=t.att[r];if(Array.isArray(n))throw new Error(`Resource must be an object: ${r}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(n).forEach(i=>{const s=n[i];if(!Array.isArray(s))throw new Error(`Ability limits ${i} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${i} is empty array, must be an array with objects`);s.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${i}) must be an array of objects, found: ${o}`)})})})}function Rw(t,e,r,n={}){return r?.sort((i,s)=>i.localeCompare(s)),{att:{[t]:uf(e,r,n)}}}function Dw(t,e,r){var n;t.att[e]=af({},r);const i=(n=Object.keys(t.att))==null?void 0:n.sort((o,a)=>o.localeCompare(a)),s={att:{}};return i.reduce((o,a)=>(o.att[a]=t.att[a],o),s)}function uf(t,e,r={}){e=e?.sort((i,s)=>i.localeCompare(s));const n=e.map(i=>({[`${t}/${i}`]:[r]}));return Object.assign({},...n)}function Oo(t){return gr(t),`urn:recap:${Ow(t).replace(/=/g,"")}`}function sn(t){const e=Cw(t.replace("urn:recap:",""));return gr(e),e}function Bw(t,e,r){const n=Rw(t,e,r);return Oo(n)}function lf(t){return t&&t.includes("urn:recap:")}function Nw(t,e){const r=sn(t),n=sn(e),i=Pw(r,n);return Oo(i)}function Pw(t,e){gr(t),gr(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((i,s)=>i.localeCompare(s)),n={att:{}};return r.forEach(i=>{var s,o;Object.keys(((s=t.att)==null?void 0:s[i])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[i])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,u;n.att[i]=Sw(af({},n.att[i]),{[a]:((c=t.att[i])==null?void 0:c[a])||((u=e.att[i])==null?void 0:u[a])})})}),n}function ff(t="",e){gr(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const n=[];let i=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(f=>({ability:f.split("/")[0],action:f.split("/")[1]}));c.sort((f,p)=>f.action.localeCompare(p.action));const u={};c.forEach(f=>{u[f.ability]||(u[f.ability]=[]),u[f.ability].push(f.action)});const l=Object.keys(u).map(f=>(i++,`(${i}) '${f}': '${u[f].join("', '")}' for '${a}'.`));n.push(l.join(", ").replace(".,","."))});const s=n.join(" "),o=`${r}${s}`;return`${t?t+" ":""}${o}`}function qu(t){var e;const r=sn(t);gr(r);const n=(e=r.att)==null?void 0:e.eip155;return n?Object.keys(n).map(i=>i.split("/")[1]):[]}function ju(t){const e=sn(t);gr(e);const r=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(i=>{var s;(s=i?.[0])!=null&&s.chains&&r.push(i[0].chains)})}),[...new Set(r.flat())]}function Uw(t,e){if(!e)return t;const r=sn(e);return gr(r),ff(t,r)}function In(t){if(!t)return;const e=t?.[t.length-1];return lf(e)?e:void 0}function Lw(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function zu(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Qc(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function It(t,...e){if(!Lw(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function xp(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function sT(t,e){It(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function tn(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ii(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function oT(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const aT=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function cT(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Vu(t){if(typeof t=="string")t=cT(t);else if(Lw(t))t=Hu(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function uT(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function lT(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}const fT=(t,e)=>{function r(n,...i){if(It(n),!aT)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const u=i[0];if(!u)throw new Error("nonce / iv required");t.varSizeNonce?It(u):It(u,t.nonceLength)}const s=t.tagLength;s&&i[1]!==void 0&&It(i[1]);const o=e(n,...i),a=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");It(l)}};let c=!1;return{encrypt(u,l){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,It(u),a(o.encrypt.length,l),o.encrypt(u,l)},decrypt(u,l){if(It(u),s&&u.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,l),o.decrypt(u,l)}}}return Object.assign(r,t),r};function Ip(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!dT(e))throw new Error("invalid output, must be aligned");return e}function Ap(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s);t.setUint32(e+4,o,n),t.setUint32(e+0,a,n)}function hT(t,e,r){zu(r);const n=new Uint8Array(16),i=oT(n);return Ap(i,0,BigInt(e),r),Ap(i,8,BigInt(t),r),n}function dT(t){return t.byteOffset%4===0}function Hu(t){return Uint8Array.from(t)}const Mw=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),pT=Mw("expand 16-byte k"),gT=Mw("expand 32-byte k"),yT=tn(pT),wT=tn(gT);function Ce(t,e){return t<<e|t>>>32-e}function Ku(t){return t.byteOffset%4===0}const Cs=64,mT=16,$w=2**32-1,Tp=new Uint32Array;function bT(t,e,r,n,i,s,o,a){const c=i.length,u=new Uint8Array(Cs),l=tn(u),f=Ku(i)&&Ku(s),p=f?tn(i):Tp,d=f?tn(s):Tp;for(let h=0;h<c;o++){if(t(e,r,n,l,o,a),o>=$w)throw new Error("arx: counter overflow");const g=Math.min(Cs,c-h);if(f&&g===Cs){const m=h/4;if(h%4!==0)throw new Error("arx: invalid block position");for(let y=0,S;y<mT;y++)S=m+y,d[S]=p[S]^l[y];h+=Cs;continue}for(let m=0,y;m<g;m++)y=h+m,s[y]=i[y]^u[m];h+=g}}function ET(t,e){const{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:s,rounds:o}=uT({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Qc(i),Qc(o),zu(s),zu(r),(a,c,u,l,f=0)=>{It(a),It(c),It(u);const p=u.length;if(l===void 0&&(l=new Uint8Array(p)),It(l),Qc(f),f<0||f>=$w)throw new Error("arx: counter overflow");if(l.length<p)throw new Error(`arx: output (${l.length}) is shorter than data (${p})`);const d=[];let h=a.length,g,m;if(h===32)d.push(g=Hu(a)),m=wT;else if(h===16&&r)g=new Uint8Array(32),g.set(a),g.set(a,16),m=yT,d.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${h}`);Ku(c)||d.push(c=Hu(c));const y=tn(g);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(m,y,tn(c.subarray(0,16)),y),c=c.subarray(16)}const S=16-i;if(S!==c.length)throw new Error(`arx: nonce must be ${S} or 16 bytes`);if(S!==12){const x=new Uint8Array(12);x.set(c,s?0:12-c.length),c=x,d.push(c)}const b=tn(c);return bT(t,m,y,b,u,l,f,o),ii(...d),l}}const rt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class vT{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Vu(e),It(e,32);const r=rt(e,0),n=rt(e,2),i=rt(e,4),s=rt(e,6),o=rt(e,8),a=rt(e,10),c=rt(e,12),u=rt(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=rt(e,16+2*l)}process(e,r,n=!1){const i=n?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],u=o[2],l=o[3],f=o[4],p=o[5],d=o[6],h=o[7],g=o[8],m=o[9],y=rt(e,r+0),S=rt(e,r+2),b=rt(e,r+4),x=rt(e,r+6),I=rt(e,r+8),A=rt(e,r+10),B=rt(e,r+12),P=rt(e,r+14);let N=s[0]+(y&8191),$=s[1]+((y>>>13|S<<3)&8191),G=s[2]+((S>>>10|b<<6)&8191),q=s[3]+((b>>>7|x<<9)&8191),L=s[4]+((x>>>4|I<<12)&8191),j=s[5]+(I>>>1&8191),T=s[6]+((I>>>14|A<<2)&8191),D=s[7]+((A>>>11|B<<5)&8191),F=s[8]+((B>>>8|P<<8)&8191),K=s[9]+(P>>>5|i),k=0,X=k+N*a+$*(5*m)+G*(5*g)+q*(5*h)+L*(5*d);k=X>>>13,X&=8191,X+=j*(5*p)+T*(5*f)+D*(5*l)+F*(5*u)+K*(5*c),k+=X>>>13,X&=8191;let ee=k+N*c+$*a+G*(5*m)+q*(5*g)+L*(5*h);k=ee>>>13,ee&=8191,ee+=j*(5*d)+T*(5*p)+D*(5*f)+F*(5*l)+K*(5*u),k+=ee>>>13,ee&=8191;let te=k+N*u+$*c+G*a+q*(5*m)+L*(5*g);k=te>>>13,te&=8191,te+=j*(5*h)+T*(5*d)+D*(5*p)+F*(5*f)+K*(5*l),k+=te>>>13,te&=8191;let le=k+N*l+$*u+G*c+q*a+L*(5*m);k=le>>>13,le&=8191,le+=j*(5*g)+T*(5*h)+D*(5*d)+F*(5*p)+K*(5*f),k+=le>>>13,le&=8191;let z=k+N*f+$*l+G*u+q*c+L*a;k=z>>>13,z&=8191,z+=j*(5*m)+T*(5*g)+D*(5*h)+F*(5*d)+K*(5*p),k+=z>>>13,z&=8191;let ce=k+N*p+$*f+G*l+q*u+L*c;k=ce>>>13,ce&=8191,ce+=j*a+T*(5*m)+D*(5*g)+F*(5*h)+K*(5*d),k+=ce>>>13,ce&=8191;let W=k+N*d+$*p+G*f+q*l+L*u;k=W>>>13,W&=8191,W+=j*c+T*a+D*(5*m)+F*(5*g)+K*(5*h),k+=W>>>13,W&=8191;let V=k+N*h+$*d+G*p+q*f+L*l;k=V>>>13,V&=8191,V+=j*u+T*c+D*a+F*(5*m)+K*(5*g),k+=V>>>13,V&=8191;let re=k+N*g+$*h+G*d+q*p+L*f;k=re>>>13,re&=8191,re+=j*l+T*u+D*c+F*a+K*(5*m),k+=re>>>13,re&=8191;let oe=k+N*m+$*g+G*h+q*d+L*p;k=oe>>>13,oe&=8191,oe+=j*f+T*l+D*u+F*c+K*a,k+=oe>>>13,oe&=8191,k=(k<<2)+k|0,k=k+X|0,X=k&8191,k=k>>>13,ee+=k,s[0]=X,s[1]=ee,s[2]=te,s[3]=le,s[4]=z,s[5]=ce,s[6]=W,s[7]=V,s[8]=re,s[9]=oe}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)n[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;ii(n)}update(e){xp(this),e=Vu(e),It(e);const{buffer:r,blockLen:n}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o===n){for(;n<=i-s;s+=n)this.process(e,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){ii(this.h,this.r,this.buffer,this.pad)}digestInto(e){xp(this),sT(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=n[o]>>>0,e[s++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}}function _T(t){const e=(n,i)=>t(i).update(Vu(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}const ST=_T(t=>new vT(t));function xT(t,e,r,n,i,s=20){let o=t[0],a=t[1],c=t[2],u=t[3],l=e[0],f=e[1],p=e[2],d=e[3],h=e[4],g=e[5],m=e[6],y=e[7],S=i,b=r[0],x=r[1],I=r[2],A=o,B=a,P=c,N=u,$=l,G=f,q=p,L=d,j=h,T=g,D=m,F=y,K=S,k=b,X=x,ee=I;for(let le=0;le<s;le+=2)A=A+$|0,K=Ce(K^A,16),j=j+K|0,$=Ce($^j,12),A=A+$|0,K=Ce(K^A,8),j=j+K|0,$=Ce($^j,7),B=B+G|0,k=Ce(k^B,16),T=T+k|0,G=Ce(G^T,12),B=B+G|0,k=Ce(k^B,8),T=T+k|0,G=Ce(G^T,7),P=P+q|0,X=Ce(X^P,16),D=D+X|0,q=Ce(q^D,12),P=P+q|0,X=Ce(X^P,8),D=D+X|0,q=Ce(q^D,7),N=N+L|0,ee=Ce(ee^N,16),F=F+ee|0,L=Ce(L^F,12),N=N+L|0,ee=Ce(ee^N,8),F=F+ee|0,L=Ce(L^F,7),A=A+G|0,ee=Ce(ee^A,16),D=D+ee|0,G=Ce(G^D,12),A=A+G|0,ee=Ce(ee^A,8),D=D+ee|0,G=Ce(G^D,7),B=B+q|0,K=Ce(K^B,16),F=F+K|0,q=Ce(q^F,12),B=B+q|0,K=Ce(K^B,8),F=F+K|0,q=Ce(q^F,7),P=P+L|0,k=Ce(k^P,16),j=j+k|0,L=Ce(L^j,12),P=P+L|0,k=Ce(k^P,8),j=j+k|0,L=Ce(L^j,7),N=N+$|0,X=Ce(X^N,16),T=T+X|0,$=Ce($^T,12),N=N+$|0,X=Ce(X^N,8),T=T+X|0,$=Ce($^T,7);let te=0;n[te++]=o+A|0,n[te++]=a+B|0,n[te++]=c+P|0,n[te++]=u+N|0,n[te++]=l+$|0,n[te++]=f+G|0,n[te++]=p+q|0,n[te++]=d+L|0,n[te++]=h+j|0,n[te++]=g+T|0,n[te++]=m+D|0,n[te++]=y+F|0,n[te++]=S+K|0,n[te++]=b+k|0,n[te++]=x+X|0,n[te++]=I+ee|0}const IT=ET(xT,{counterRight:!1,counterLength:4,allowShortKeys:!1}),AT=new Uint8Array(16),Op=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(AT.subarray(r))},TT=new Uint8Array(32);function Cp(t,e,r,n,i){const s=t(e,r,TT),o=ST.create(s);i&&Op(o,i),Op(o,n);const a=hT(n.length,i?i.length:0,!0);o.update(a);const c=o.digest();return ii(s,a),c}const OT=t=>(e,r,n)=>({encrypt(i,s){const o=i.length;s=Ip(o+16,s,!1),s.set(i);const a=s.subarray(0,-16);t(e,r,a,a,1);const c=Cp(t,e,r,a,n);return s.set(c,o),ii(c),s},decrypt(i,s){s=Ip(i.length-16,s,!1);const o=i.subarray(0,-16),a=i.subarray(-16),c=Cp(t,e,r,o,n);if(!lT(a,c))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),t(e,r,s,s,1),ii(c),s}}),Fw=fT({blockSize:64,nonceLength:12,tagLength:16},OT(IT));let kw=class extends Io{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,xo(e);const n=rr(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),Ht(s)}update(e){return nn(this),this.iHash.update(e),this}digestInto(e){nn(this),nr(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Co=(t,e,r)=>new kw(t,e).update(r).digest();Co.create=(t,e)=>new kw(t,e);function CT(t,e,r){return xo(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Co(t,rr(r),rr(e))}const eu=Uint8Array.from([0]),Rp=Uint8Array.of();function RT(t,e,r,n=32){xo(t),Pr(n);const i=t.outputLen;if(n>255*i)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/i);r===void 0&&(r=Rp);const o=new Uint8Array(s*i),a=Co.create(t,e),c=a._cloneInto(),u=new Uint8Array(a.outputLen);for(let l=0;l<s;l++)eu[0]=l+1,c.update(l===0?Rp:u).update(r).update(eu).digestInto(u),o.set(u,i*l),a._cloneInto(c);return a.destroy(),c.destroy(),Ht(u,eu),o.slice(0,n)}const DT=(t,e,r,n,i)=>RT(t,CT(t,e,r),n,i),Ro=Ao,hf=BigInt(0),Wu=BigInt(1);function ro(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}"`;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function En(t,e,r=""){const n=So(t),i=t?.length,s=e!==void 0;if(!n||s&&i!==e){const o=r&&`"${r}" `,a=s?` of length ${e}`:"",c=n?`length=${i}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function Rs(t){const e=t.toString(16);return e.length&1?"0"+e:e}function qw(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?hf:BigInt("0x"+t)}function Do(t){return qw(Jn(t))}function no(t){return nr(t),qw(Jn(Uint8Array.from(t).reverse()))}function df(t,e){return eo(t.toString(16).padStart(e*2,"0"))}function pf(t,e){return df(t,e).reverse()}function ht(t,e,r){let n;if(typeof e=="string")try{n=eo(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(So(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}const tu=t=>typeof t=="bigint"&&hf<=t;function BT(t,e,r){return tu(t)&&tu(e)&&tu(r)&&e<=t&&t<r}function Gu(t,e,r,n){if(!BT(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function jw(t){let e;for(e=0;t>hf;t>>=Wu,e+=1);return e}const us=t=>(Wu<<BigInt(t))-Wu;function NT(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");const n=p=>new Uint8Array(p),i=p=>Uint8Array.of(p);let s=n(t),o=n(t),a=0;const c=()=>{s.fill(1),o.fill(0),a=0},u=(...p)=>r(o,s,...p),l=(p=n(0))=>{o=u(i(0),p),s=u(),p.length!==0&&(o=u(i(1),p),s=u())},f=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let p=0;const d=[];for(;p<e;){s=u();const h=s.slice();d.push(h),p+=s.length}return Jr(...d)};return(p,d)=>{c(),l(p);let h;for(;!(h=d(f()));)l();return c(),h}}function Bo(t,e,r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function n(i,s,o){const a=t[i];if(o&&a===void 0)return;const c=typeof a;if(c!==s||a===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${c}`)}Object.entries(e).forEach(([i,s])=>n(i,s,!1)),Object.entries(r).forEach(([i,s])=>n(i,s,!0))}function Dp(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}const Tt=BigInt(0),Et=BigInt(1),vn=BigInt(2),zw=BigInt(3),Vw=BigInt(4),Hw=BigInt(5),PT=BigInt(7),Kw=BigInt(8),UT=BigInt(9),Ww=BigInt(16);function Nt(t,e){const r=t%e;return r>=Tt?r:e+r}function Jt(t,e,r){let n=t;for(;e-- >Tt;)n*=n,n%=r;return n}function Bp(t,e){if(t===Tt)throw new Error("invert: expected non-zero number");if(e<=Tt)throw new Error("invert: expected positive modulus, got "+e);let r=Nt(t,e),n=e,i=Tt,s=Et;for(;r!==Tt;){const o=n/r,a=n%r,c=i-s*o;n=r,r=a,i=s,s=c}if(n!==Et)throw new Error("invert: does not exist");return Nt(i,e)}function gf(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function Gw(t,e){const r=(t.ORDER+Et)/Vw,n=t.pow(e,r);return gf(t,n,e),n}function LT(t,e){const r=(t.ORDER-Hw)/Kw,n=t.mul(e,vn),i=t.pow(n,r),s=t.mul(e,i),o=t.mul(t.mul(s,vn),i),a=t.mul(s,t.sub(o,t.ONE));return gf(t,a,e),a}function MT(t){const e=an(t),r=Yw(t),n=r(e,e.neg(e.ONE)),i=r(e,n),s=r(e,e.neg(n)),o=(t+PT)/Ww;return(a,c)=>{let u=a.pow(c,o),l=a.mul(u,n);const f=a.mul(u,i),p=a.mul(u,s),d=a.eql(a.sqr(l),c),h=a.eql(a.sqr(f),c);u=a.cmov(u,l,d),l=a.cmov(p,f,h);const g=a.eql(a.sqr(l),c),m=a.cmov(u,l,g);return gf(a,m,c),m}}function Yw(t){if(t<zw)throw new Error("sqrt is not defined for small field");let e=t-Et,r=0;for(;e%vn===Tt;)e/=vn,r++;let n=vn;const i=an(t);for(;Np(i,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return Gw;let s=i.pow(n,e);const o=(e+Et)/vn;return function(a,c){if(a.is0(c))return c;if(Np(a,c)!==1)throw new Error("Cannot find square root");let u=r,l=a.mul(a.ONE,s),f=a.pow(c,e),p=a.pow(c,o);for(;!a.eql(f,a.ONE);){if(a.is0(f))return a.ZERO;let d=1,h=a.sqr(f);for(;!a.eql(h,a.ONE);)if(d++,h=a.sqr(h),d===u)throw new Error("Cannot find square root");const g=Et<<BigInt(u-d-1),m=a.pow(l,g);u=d,l=a.sqr(m),f=a.mul(f,l),p=a.mul(p,m)}return p}}function $T(t){return t%Vw===zw?Gw:t%Kw===Hw?LT:t%Ww===UT?MT(t):Yw(t)}const FT=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function kT(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=FT.reduce((n,i)=>(n[i]="function",n),e);return Bo(t,r),t}function qT(t,e,r){if(r<Tt)throw new Error("invalid exponent, negatives unsupported");if(r===Tt)return t.ONE;if(r===Et)return e;let n=t.ONE,i=e;for(;r>Tt;)r&Et&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Et;return n}function Xw(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce((o,a,c)=>t.is0(a)?o:(n[c]=o,t.mul(o,a)),t.ONE),s=t.inv(i);return e.reduceRight((o,a,c)=>t.is0(a)?o:(n[c]=t.mul(o,n[c]),t.mul(o,a)),s),n}function Np(t,e){const r=(t.ORDER-Et)/vn,n=t.pow(e,r),i=t.eql(n,t.ONE),s=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function Zw(t,e){e!==void 0&&Pr(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function an(t,e,r=!1,n={}){if(t<=Tt)throw new Error("invalid field: expected ORDER > 0, got "+t);let i,s,o=!1,a;if(typeof e=="object"&&e!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const p=e;p.BITS&&(i=p.BITS),p.sqrt&&(s=p.sqrt),typeof p.isLE=="boolean"&&(r=p.isLE),typeof p.modFromBytes=="boolean"&&(o=p.modFromBytes),a=p.allowedLengths}else typeof e=="number"&&(i=e),n.sqrt&&(s=n.sqrt);const{nBitLength:c,nByteLength:u}=Zw(t,i);if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let l;const f=Object.freeze({ORDER:t,isLE:r,BITS:c,BYTES:u,MASK:us(c),ZERO:Tt,ONE:Et,allowedLengths:a,create:p=>Nt(p,t),isValid:p=>{if(typeof p!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof p);return Tt<=p&&p<t},is0:p=>p===Tt,isValidNot0:p=>!f.is0(p)&&f.isValid(p),isOdd:p=>(p&Et)===Et,neg:p=>Nt(-p,t),eql:(p,d)=>p===d,sqr:p=>Nt(p*p,t),add:(p,d)=>Nt(p+d,t),sub:(p,d)=>Nt(p-d,t),mul:(p,d)=>Nt(p*d,t),pow:(p,d)=>qT(f,p,d),div:(p,d)=>Nt(p*Bp(d,t),t),sqrN:p=>p*p,addN:(p,d)=>p+d,subN:(p,d)=>p-d,mulN:(p,d)=>p*d,inv:p=>Bp(p,t),sqrt:s||(p=>(l||(l=$T(t)),l(f,p))),toBytes:p=>r?pf(p,u):df(p,u),fromBytes:(p,d=!0)=>{if(a){if(!a.includes(p.length)||p.length>u)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+p.length);const g=new Uint8Array(u);g.set(p,r?0:g.length-p.length),p=g}if(p.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+p.length);let h=r?no(p):Do(p);if(o&&(h=Nt(h,t)),!d&&!f.isValid(h))throw new Error("invalid field element: outside of range 0..ORDER");return h},invertBatch:p=>Xw(f,p),cmov:(p,d,h)=>h?d:p});return Object.freeze(f)}function Jw(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Qw(t){const e=Jw(t);return e+Math.ceil(e/2)}function jT(t,e,r=!1){const n=t.length,i=Jw(e),s=Qw(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=r?no(t):Do(t),a=Nt(o,e-Et)+Et;return r?pf(a,i):df(a,i)}const si=BigInt(0),_n=BigInt(1);function io(t,e){const r=e.negate();return t?r:e}function ru(t,e){const r=Xw(t.Fp,e.map(n=>n.Z));return e.map((n,i)=>t.fromAffine(n.toAffine(r[i])))}function em(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function nu(t,e){em(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),i=2**t,s=us(t),o=BigInt(t);return{windows:r,windowSize:n,mask:s,maxNumber:i,shiftBy:o}}function Pp(t,e,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:o}=r;let a=Number(t&i),c=t>>o;a>n&&(a-=s,c+=_n);const u=e*n,l=u+Math.abs(a)-1,f=a===0,p=a<0,d=e%2!==0;return{nextN:c,offset:l,isZero:f,isNeg:p,isNegF:d,offsetF:u}}function zT(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function VT(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const iu=new WeakMap,tm=new WeakMap;function su(t){return tm.get(t)||1}function Up(t){if(t!==si)throw new Error("invalid wNAF")}class HT{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,n=this.ZERO){let i=e;for(;r>si;)r&_n&&(n=n.add(i)),i=i.double(),r>>=_n;return n}precomputeWindow(e,r){const{windows:n,windowSize:i}=nu(r,this.bits),s=[];let o=e,a=o;for(let c=0;c<n;c++){a=o,s.push(a);for(let u=1;u<i;u++)a=a.add(o),s.push(a);o=a.double()}return s}wNAF(e,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let i=this.ZERO,s=this.BASE;const o=nu(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:u,isZero:l,isNeg:f,isNegF:p,offsetF:d}=Pp(n,a,o);n=c,l?s=s.add(io(p,r[d])):i=i.add(io(f,r[u]))}return Up(n),{p:i,f:s}}wNAFUnsafe(e,r,n,i=this.ZERO){const s=nu(e,this.bits);for(let o=0;o<s.windows&&n!==si;o++){const{nextN:a,offset:c,isZero:u,isNeg:l}=Pp(n,o,s);if(n=a,!u){const f=r[c];i=i.add(l?f.negate():f)}}return Up(n),i}getPrecomputes(e,r,n){let i=iu.get(r);return i||(i=this.precomputeWindow(r,e),e!==1&&(typeof n=="function"&&(i=n(i)),iu.set(r,i))),i}cached(e,r,n){const i=su(e);return this.wNAF(i,this.getPrecomputes(i,e,n),r)}unsafe(e,r,n,i){const s=su(e);return s===1?this._unsafeLadder(e,r,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,n),r,i)}createCache(e,r){em(r,this.bits),tm.set(e,r),iu.delete(e)}hasCache(e){return su(e)!==1}}function KT(t,e,r,n){let i=e,s=t.ZERO,o=t.ZERO;for(;r>si||n>si;)r&_n&&(s=s.add(i)),n&_n&&(o=o.add(i)),i=i.double(),r>>=_n,n>>=_n;return{p1:s,p2:o}}function WT(t,e,r,n){zT(r,t),VT(n,e);const i=r.length,s=n.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=jw(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=us(c),l=new Array(Number(u)+1).fill(o),f=Math.floor((e.BITS-1)/c)*c;let p=o;for(let d=f;d>=0;d-=c){l.fill(o);for(let g=0;g<s;g++){const m=n[g],y=Number(m>>BigInt(d)&u);l[y]=l[y].add(r[g])}let h=o;for(let g=l.length-1,m=o;g>0;g--)m=m.add(l[g]),h=h.add(m);if(p=p.add(h),d!==0)for(let g=0;g<c;g++)p=p.double()}return p}function Lp(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return kT(e),e}else return an(t,{isLE:r})}function GT(t,e,r={},n){if(n===void 0&&(n=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>si))throw new Error(`CURVE.${a} must be positive bigint`)}const i=Lp(e.p,r.Fp,n),s=Lp(e.n,r.Fn,n),o=["Gx","Gy","a","b"];for(const a of o)if(!i.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:i,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),aw("HashToScalar-");const xi=BigInt(0),Vn=BigInt(1),Ds=BigInt(2);function YT(t){return Bo(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function XT(t){const e=YT(t),{P:r,type:n,adjustScalarBytes:i,powPminus2:s,randomBytes:o}=e,a=n==="x25519";if(!a&&n!=="x448")throw new Error("invalid type");const c=o||Ln,u=a?255:448,l=a?32:56,f=BigInt(a?9:5),p=BigInt(a?121665:39081),d=a?Ds**BigInt(254):Ds**BigInt(447),h=a?BigInt(8)*Ds**BigInt(251)-Vn:BigInt(4)*Ds**BigInt(445)-Vn,g=d+h+Vn,m=q=>Nt(q,r),y=S(f);function S(q){return pf(m(q),l)}function b(q){const L=ht("u coordinate",q,l);return a&&(L[31]&=127),m(no(L))}function x(q){return no(i(ht("scalar",q,l)))}function I(q,L){const j=P(b(L),x(q));if(j===xi)throw new Error("invalid private or public key received");return S(j)}function A(q){return I(q,y)}function B(q,L,j){const T=m(q*(L-j));return L=m(L-T),j=m(j+T),{x_2:L,x_3:j}}function P(q,L){Gu("u",q,xi,r),Gu("scalar",L,d,g);const j=L,T=q;let D=Vn,F=xi,K=q,k=Vn,X=xi;for(let te=BigInt(u-1);te>=xi;te--){const le=j>>te&Vn;X^=le,{x_2:D,x_3:K}=B(X,D,K),{x_2:F,x_3:k}=B(X,F,k),X=le;const z=D+F,ce=m(z*z),W=D-F,V=m(W*W),re=ce-V,oe=K+k,C=K-k,_=m(C*z),v=m(oe*W),R=_+v,U=_-v;K=m(R*R),k=m(T*m(U*U)),D=m(ce*V),F=m(re*(ce+m(p*re)))}({x_2:D,x_3:K}=B(X,D,K)),{x_2:F,x_3:k}=B(X,F,k);const ee=s(F);return m(D*ee)}const N={secretKey:l,publicKey:l,seed:l},$=(q=c(l))=>(nr(q,N.seed),q);function G(q){const L=$(q);return{secretKey:L,publicKey:A(L)}}return{keygen:G,getSharedSecret:(q,L)=>I(q,L),getPublicKey:q=>A(q),scalarMult:I,scalarMultBase:A,utils:{randomSecretKey:$,randomPrivateKey:$},GuBytes:y.slice(),lengths:N}}const ZT=BigInt(1),Mp=BigInt(2),JT=BigInt(3),QT=BigInt(5);BigInt(8);const rm=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),eO={p:rm,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function tO(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=rm,o=t*t%s*t%s,a=Jt(o,Mp,s)*o%s,c=Jt(a,ZT,s)*t%s,u=Jt(c,QT,s)*c%s,l=Jt(u,e,s)*u%s,f=Jt(l,r,s)*l%s,p=Jt(f,n,s)*f%s,d=Jt(p,i,s)*p%s,h=Jt(d,i,s)*p%s,g=Jt(h,e,s)*u%s;return{pow_p_5_8:Jt(g,Mp,s)*t%s,b2:o}}function rO(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const nO=an(eO.p,{isLE:!0}),Yu=(()=>{const t=nO.ORDER;return XT({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:r,b2:n}=tO(e);return Nt(Jt(r,JT,t)*n,t)},adjustScalarBytes:rO})})(),$p=(t,e)=>(t+(t>=0?e:-e)/nm)/e;function iO(t,e,r){const[[n,i],[s,o]]=e,a=$p(o*t,r),c=$p(-i*t,r);let u=t-a*n-c*s,l=-a*i-c*o;const f=u<Nr,p=l<Nr;f&&(u=-u),p&&(l=-l);const d=us(Math.ceil(jw(r)/2))+Qn;if(u<Nr||u>=d||l<Nr||l>=d)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:f,k1:u,k2neg:p,k2:l}}function Xu(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function ou(t,e){const r={};for(let n of Object.keys(e))r[n]=t[n]===void 0?e[n]:t[n];return ro(r.lowS,"lowS"),ro(r.prehash,"prehash"),r.format!==void 0&&Xu(r.format),r}class sO extends Error{constructor(e=""){super(e)}}const Cr={Err:sO,_tlv:{encode:(t,e)=>{const{Err:r}=Cr;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,i=Rs(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?Rs(i.length/2|128):"";return Rs(t)+s+i+e},decode(t,e){const{Err:r}=Cr;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const i=e[n++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const u=e.subarray(n,n+c);if(u.length!==c)throw new r("tlv.decode: length bytes not complete");if(u[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=Cr;if(t<Nr)throw new e("integer: negative integers are not allowed");let r=Rs(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=Cr;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Do(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=Cr,i=ht("signature",t),{v:s,l:o}=n.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:u,l}=n.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(u)}},hexFromSig(t){const{_tlv:e,_int:r}=Cr,n=e.encode(2,r.encode(t.r)),i=e.encode(2,r.encode(t.s)),s=n+i;return e.encode(48,s)}},Nr=BigInt(0),Qn=BigInt(1),nm=BigInt(2),Bs=BigInt(3),oO=BigInt(4);function Yn(t,e){const{BYTES:r}=t;let n;if(typeof e=="bigint")n=e;else{let i=ht("private key",e);try{n=t.fromBytes(i)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!t.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function aO(t,e={}){const r=GT("weierstrass",t,e),{Fp:n,Fn:i}=r;let s=r.CURVE;const{h:o,n:a}=s;Bo(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!n.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const u=sm(n,i);function l(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function f(q,L,j){const{x:T,y:D}=L.toAffine(),F=n.toBytes(T);if(ro(j,"isCompressed"),j){l();const K=!n.isOdd(D);return Jr(im(K),F)}else return Jr(Uint8Array.of(4),F,n.toBytes(D))}function p(q){En(q,void 0,"Point");const{publicKey:L,publicKeyUncompressed:j}=u,T=q.length,D=q[0],F=q.subarray(1);if(T===L&&(D===2||D===3)){const K=n.fromBytes(F);if(!n.isValid(K))throw new Error("bad point: is not on curve, wrong x");const k=g(K);let X;try{X=n.sqrt(k)}catch(te){const le=te instanceof Error?": "+te.message:"";throw new Error("bad point: is not on curve, sqrt error"+le)}l();const ee=n.isOdd(X);return(D&1)===1!==ee&&(X=n.neg(X)),{x:K,y:X}}else if(T===j&&D===4){const K=n.BYTES,k=n.fromBytes(F.subarray(0,K)),X=n.fromBytes(F.subarray(K,K*2));if(!m(k,X))throw new Error("bad point: is not on curve");return{x:k,y:X}}else throw new Error(`bad point: got length ${T}, expected compressed=${L} or uncompressed=${j}`)}const d=e.toBytes||f,h=e.fromBytes||p;function g(q){const L=n.sqr(q),j=n.mul(L,q);return n.add(n.add(j,n.mul(q,s.a)),s.b)}function m(q,L){const j=n.sqr(L),T=g(q);return n.eql(j,T)}if(!m(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const y=n.mul(n.pow(s.a,Bs),oO),S=n.mul(n.sqr(s.b),BigInt(27));if(n.is0(n.add(y,S)))throw new Error("bad curve params: a or b");function b(q,L,j=!1){if(!n.isValid(L)||j&&n.is0(L))throw new Error(`bad point coordinate ${q}`);return L}function x(q){if(!(q instanceof N))throw new Error("ProjectivePoint expected")}function I(q){if(!c||!c.basises)throw new Error("no endo");return iO(q,c.basises,i.ORDER)}const A=Dp((q,L)=>{const{X:j,Y:T,Z:D}=q;if(n.eql(D,n.ONE))return{x:j,y:T};const F=q.is0();L==null&&(L=F?n.ONE:n.inv(D));const K=n.mul(j,L),k=n.mul(T,L),X=n.mul(D,L);if(F)return{x:n.ZERO,y:n.ZERO};if(!n.eql(X,n.ONE))throw new Error("invZ was invalid");return{x:K,y:k}}),B=Dp(q=>{if(q.is0()){if(e.allowInfinityPoint&&!n.is0(q.Y))return;throw new Error("bad point: ZERO")}const{x:L,y:j}=q.toAffine();if(!n.isValid(L)||!n.isValid(j))throw new Error("bad point: x or y not field elements");if(!m(L,j))throw new Error("bad point: equation left != right");if(!q.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function P(q,L,j,T,D){return j=new N(n.mul(j.X,q),j.Y,j.Z),L=io(T,L),j=io(D,j),L.add(j)}class N{constructor(L,j,T){this.X=b("x",L),this.Y=b("y",j,!0),this.Z=b("z",T),Object.freeze(this)}static CURVE(){return s}static fromAffine(L){const{x:j,y:T}=L||{};if(!L||!n.isValid(j)||!n.isValid(T))throw new Error("invalid affine point");if(L instanceof N)throw new Error("projective point not allowed");return n.is0(j)&&n.is0(T)?N.ZERO:new N(j,T,n.ONE)}static fromBytes(L){const j=N.fromAffine(h(En(L,void 0,"point")));return j.assertValidity(),j}static fromHex(L){return N.fromBytes(ht("pointHex",L))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(L=8,j=!0){return G.createCache(this,L),j||this.multiply(Bs),this}assertValidity(){B(this)}hasEvenY(){const{y:L}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(L)}equals(L){x(L);const{X:j,Y:T,Z:D}=this,{X:F,Y:K,Z:k}=L,X=n.eql(n.mul(j,k),n.mul(F,D)),ee=n.eql(n.mul(T,k),n.mul(K,D));return X&&ee}negate(){return new N(this.X,n.neg(this.Y),this.Z)}double(){const{a:L,b:j}=s,T=n.mul(j,Bs),{X:D,Y:F,Z:K}=this;let k=n.ZERO,X=n.ZERO,ee=n.ZERO,te=n.mul(D,D),le=n.mul(F,F),z=n.mul(K,K),ce=n.mul(D,F);return ce=n.add(ce,ce),ee=n.mul(D,K),ee=n.add(ee,ee),k=n.mul(L,ee),X=n.mul(T,z),X=n.add(k,X),k=n.sub(le,X),X=n.add(le,X),X=n.mul(k,X),k=n.mul(ce,k),ee=n.mul(T,ee),z=n.mul(L,z),ce=n.sub(te,z),ce=n.mul(L,ce),ce=n.add(ce,ee),ee=n.add(te,te),te=n.add(ee,te),te=n.add(te,z),te=n.mul(te,ce),X=n.add(X,te),z=n.mul(F,K),z=n.add(z,z),te=n.mul(z,ce),k=n.sub(k,te),ee=n.mul(z,le),ee=n.add(ee,ee),ee=n.add(ee,ee),new N(k,X,ee)}add(L){x(L);const{X:j,Y:T,Z:D}=this,{X:F,Y:K,Z:k}=L;let X=n.ZERO,ee=n.ZERO,te=n.ZERO;const le=s.a,z=n.mul(s.b,Bs);let ce=n.mul(j,F),W=n.mul(T,K),V=n.mul(D,k),re=n.add(j,T),oe=n.add(F,K);re=n.mul(re,oe),oe=n.add(ce,W),re=n.sub(re,oe),oe=n.add(j,D);let C=n.add(F,k);return oe=n.mul(oe,C),C=n.add(ce,V),oe=n.sub(oe,C),C=n.add(T,D),X=n.add(K,k),C=n.mul(C,X),X=n.add(W,V),C=n.sub(C,X),te=n.mul(le,oe),X=n.mul(z,V),te=n.add(X,te),X=n.sub(W,te),te=n.add(W,te),ee=n.mul(X,te),W=n.add(ce,ce),W=n.add(W,ce),V=n.mul(le,V),oe=n.mul(z,oe),W=n.add(W,V),V=n.sub(ce,V),V=n.mul(le,V),oe=n.add(oe,V),ce=n.mul(W,oe),ee=n.add(ee,ce),ce=n.mul(C,oe),X=n.mul(re,X),X=n.sub(X,ce),ce=n.mul(re,W),te=n.mul(C,te),te=n.add(te,ce),new N(X,ee,te)}subtract(L){return this.add(L.negate())}is0(){return this.equals(N.ZERO)}multiply(L){const{endo:j}=e;if(!i.isValidNot0(L))throw new Error("invalid scalar: out of range");let T,D;const F=K=>G.cached(this,K,k=>ru(N,k));if(j){const{k1neg:K,k1:k,k2neg:X,k2:ee}=I(L),{p:te,f:le}=F(k),{p:z,f:ce}=F(ee);D=le.add(ce),T=P(j.beta,te,z,K,X)}else{const{p:K,f:k}=F(L);T=K,D=k}return ru(N,[T,D])[0]}multiplyUnsafe(L){const{endo:j}=e,T=this;if(!i.isValid(L))throw new Error("invalid scalar: out of range");if(L===Nr||T.is0())return N.ZERO;if(L===Qn)return T;if(G.hasCache(this))return this.multiply(L);if(j){const{k1neg:D,k1:F,k2neg:K,k2:k}=I(L),{p1:X,p2:ee}=KT(N,T,F,k);return P(j.beta,X,ee,D,K)}else return G.unsafe(T,L)}multiplyAndAddUnsafe(L,j,T){const D=this.multiplyUnsafe(j).add(L.multiplyUnsafe(T));return D.is0()?void 0:D}toAffine(L){return A(this,L)}isTorsionFree(){const{isTorsionFree:L}=e;return o===Qn?!0:L?L(N,this):G.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:L}=e;return o===Qn?this:L?L(N,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(L=!0){return ro(L,"isCompressed"),this.assertValidity(),d(N,this,L)}toHex(L=!0){return Jn(this.toBytes(L))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(L=!0){return this.toBytes(L)}_setWindowSize(L){this.precompute(L)}static normalizeZ(L){return ru(N,L)}static msm(L,j){return WT(N,i,L,j)}static fromPrivateKey(L){return N.BASE.multiply(Yn(i,L))}}N.BASE=new N(s.Gx,s.Gy,n.ONE),N.ZERO=new N(n.ZERO,n.ONE,n.ZERO),N.Fp=n,N.Fn=i;const $=i.BITS,G=new HT(N,e.endo?Math.ceil($/2):$);return N.BASE.precompute(8),N}function im(t){return Uint8Array.of(t?2:3)}function sm(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function cO(t,e={}){const{Fn:r}=t,n=e.randomBytes||Ln,i=Object.assign(sm(t.Fp,r),{seed:Qw(r.ORDER)});function s(p){try{return!!Yn(r,p)}catch{return!1}}function o(p,d){const{publicKey:h,publicKeyUncompressed:g}=i;try{const m=p.length;return d===!0&&m!==h||d===!1&&m!==g?!1:!!t.fromBytes(p)}catch{return!1}}function a(p=n(i.seed)){return jT(En(p,i.seed,"seed"),r.ORDER)}function c(p,d=!0){return t.BASE.multiply(Yn(r,p)).toBytes(d)}function u(p){const d=a(p);return{secretKey:d,publicKey:c(d)}}function l(p){if(typeof p=="bigint")return!1;if(p instanceof t)return!0;const{secretKey:d,publicKey:h,publicKeyUncompressed:g}=i;if(r.allowedLengths||d===h)return;const m=ht("key",p).length;return m===h||m===g}function f(p,d,h=!0){if(l(p)===!0)throw new Error("first arg must be private key");if(l(d)===!1)throw new Error("second arg must be public key");const g=Yn(r,p);return t.fromHex(d).multiply(g).toBytes(h)}return Object.freeze({getPublicKey:c,getSharedSecret:f,keygen:u,Point:t,utils:{isValidSecretKey:s,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:p=>Yn(r,p),precompute(p=8,d=t.BASE){return d.precompute(p,!1)}},lengths:i})}function uO(t,e,r={}){xo(e),Bo(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=r.randomBytes||Ln,i=r.hmac||((j,...T)=>Co(e,j,Jr(...T))),{Fp:s,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:u,getPublicKey:l,getSharedSecret:f,utils:p,lengths:d}=cO(t,r),h={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},g="compact";function m(j){const T=a>>Qn;return j>T}function y(j,T){if(!o.isValidNot0(T))throw new Error(`invalid signature ${j}: out of range 1..Point.Fn.ORDER`);return T}function S(j,T){Xu(T);const D=d.signature,F=T==="compact"?D:T==="recovered"?D+1:void 0;return En(j,F,`${T} signature`)}class b{constructor(T,D,F){this.r=y("r",T),this.s=y("s",D),F!=null&&(this.recovery=F),Object.freeze(this)}static fromBytes(T,D=g){S(T,D);let F;if(D==="der"){const{r:ee,s:te}=Cr.toSig(En(T));return new b(ee,te)}D==="recovered"&&(F=T[0],D="compact",T=T.subarray(1));const K=o.BYTES,k=T.subarray(0,K),X=T.subarray(K,K*2);return new b(o.fromBytes(k),o.fromBytes(X),F)}static fromHex(T,D){return this.fromBytes(eo(T),D)}addRecoveryBit(T){return new b(this.r,this.s,T)}recoverPublicKey(T){const D=s.ORDER,{r:F,s:K,recovery:k}=this;if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");if(a*nm<D&&k>1)throw new Error("recovery id is ambiguous for h>1 curve");const X=k===2||k===3?F+a:F;if(!s.isValid(X))throw new Error("recovery id 2 or 3 invalid");const ee=s.toBytes(X),te=t.fromBytes(Jr(im((k&1)===0),ee)),le=o.inv(X),z=I(ht("msgHash",T)),ce=o.create(-z*le),W=o.create(K*le),V=t.BASE.multiplyUnsafe(ce).add(te.multiplyUnsafe(W));if(V.is0())throw new Error("point at infinify");return V.assertValidity(),V}hasHighS(){return m(this.s)}toBytes(T=g){if(Xu(T),T==="der")return eo(Cr.hexFromSig(this));const D=o.toBytes(this.r),F=o.toBytes(this.s);if(T==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Jr(Uint8Array.of(this.recovery),D,F)}return Jr(D,F)}toHex(T){return Jn(this.toBytes(T))}assertValidity(){}static fromCompact(T){return b.fromBytes(ht("sig",T),"compact")}static fromDER(T){return b.fromBytes(ht("sig",T),"der")}normalizeS(){return this.hasHighS()?new b(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Jn(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Jn(this.toBytes("compact"))}}const x=r.bits2int||function(j){if(j.length>8192)throw new Error("input is too large");const T=Do(j),D=j.length*8-c;return D>0?T>>BigInt(D):T},I=r.bits2int_modN||function(j){return o.create(x(j))},A=us(c);function B(j){return Gu("num < 2^"+c,j,Nr,A),o.toBytes(j)}function P(j,T){return En(j,void 0,"message"),T?En(e(j),void 0,"prehashed message"):j}function N(j,T,D){if(["recovered","canonical"].some(W=>W in D))throw new Error("sign() legacy options not supported");const{lowS:F,prehash:K,extraEntropy:k}=ou(D,h);j=P(j,K);const X=I(j),ee=Yn(o,T),te=[B(ee),B(X)];if(k!=null&&k!==!1){const W=k===!0?n(d.secretKey):k;te.push(ht("extraEntropy",W))}const le=Jr(...te),z=X;function ce(W){const V=x(W);if(!o.isValidNot0(V))return;const re=o.inv(V),oe=t.BASE.multiply(V).toAffine(),C=o.create(oe.x);if(C===Nr)return;const _=o.create(re*o.create(z+C*ee));if(_===Nr)return;let v=(oe.x===C?0:2)|Number(oe.y&Qn),R=_;return F&&m(_)&&(R=o.neg(_),v^=1),new b(C,R,v)}return{seed:le,k2sig:ce}}function $(j,T,D={}){j=ht("message",j);const{seed:F,k2sig:K}=N(j,T,D);return NT(e.outputLen,o.BYTES,i)(F,K)}function G(j){let T;const D=typeof j=="string"||So(j),F=!D&&j!==null&&typeof j=="object"&&typeof j.r=="bigint"&&typeof j.s=="bigint";if(!D&&!F)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(F)T=new b(j.r,j.s);else if(D){try{T=b.fromBytes(ht("sig",j),"der")}catch(K){if(!(K instanceof Cr.Err))throw K}if(!T)try{T=b.fromBytes(ht("sig",j),"compact")}catch{return!1}}return T||!1}function q(j,T,D,F={}){const{lowS:K,prehash:k,format:X}=ou(F,h);if(D=ht("publicKey",D),T=P(ht("message",T),k),"strict"in F)throw new Error("options.strict was renamed to lowS");const ee=X===void 0?G(j):b.fromBytes(ht("sig",j),X);if(ee===!1)return!1;try{const te=t.fromBytes(D);if(K&&ee.hasHighS())return!1;const{r:le,s:z}=ee,ce=I(T),W=o.inv(z),V=o.create(ce*W),re=o.create(le*W),oe=t.BASE.multiplyUnsafe(V).add(te.multiplyUnsafe(re));return oe.is0()?!1:o.create(oe.x)===le}catch{return!1}}function L(j,T,D={}){const{prehash:F}=ou(D,h);return T=P(T,F),b.fromBytes(j,"recovered").recoverPublicKey(T).toBytes()}return Object.freeze({keygen:u,getPublicKey:l,getSharedSecret:f,utils:p,lengths:d,Point:t,sign:$,verify:q,recoverPublicKey:L,Signature:b,hash:e})}function lO(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp;let n=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const i=an(e.n,{BITS:t.nBitLength,allowedLengths:n,modFromBytes:t.wrapPrivateKey}),s={Fp:r,Fn:i,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}function fO(t){const{CURVE:e,curveOpts:r}=lO(t),n={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:r,hash:t.hash,ecdsaOpts:n}}function hO(t,e){const r=e.Point;return Object.assign({},e,{ProjectivePoint:r,CURVE:Object.assign({},t,Zw(r.Fn.ORDER,r.Fn.BITS))})}function dO(t){const{CURVE:e,curveOpts:r,hash:n,ecdsaOpts:i}=fO(t),s=aO(e,r),o=uO(s,n,i);return hO(t,o)}function Zu(t,e){const r=n=>dO({...t,hash:n});return{...r(e),create:r}}const om={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},am={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},cm={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},pO=an(om.p),gO=an(am.p),yO=an(cm.p),wO=Zu({...om,Fp:pO,lowS:!1},Ao);Zu({...am,Fp:gO,lowS:!1},k8),Zu({...cm,Fp:yO,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},F8);const mO=wO,yf="base10",dt="base16",wt="base64pad",Br="base64url",li="utf8",wf=0,dr=1,fi=2,bO=0,Fp=1,Li=12,mf=32;function um(){const t=Yu.utils.randomPrivateKey(),e=Yu.getPublicKey(t);return{privateKey:Ot(t,dt),publicKey:Ot(e,dt)}}function so(){const t=Ln(mf);return Ot(t,dt)}function lm(t,e){const r=Yu.getSharedSecret(zt(t,dt),zt(e,dt)),n=DT(Ro,r,void 0,void 0,mf);return Ot(n,dt)}function Mi(t){const e=Ro(zt(t,dt));return Ot(e,dt)}function Pt(t){const e=Ro(zt(t,li));return Ot(e,dt)}function bf(t){return zt(`${t}`,yf)}function on(t){return Number(Ot(t,yf))}function fm(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function hm(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4;return e+"=".repeat(r)}function dm(t){const e=bf(typeof t.type<"u"?t.type:wf);if(on(e)===dr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?zt(t.senderPublicKey,dt):void 0,n=typeof t.iv<"u"?zt(t.iv,dt):Ln(Li),i=zt(t.symKey,dt),s=Fw(i,n).encrypt(zt(t.message,li)),o=Ef({type:e,sealed:s,iv:n,senderPublicKey:r});return t.encoding===Br?fm(o):o}function pm(t){const e=zt(t.symKey,dt),{sealed:r,iv:n}=oi({encoded:t.encoded,encoding:t.encoding}),i=Fw(e,n).decrypt(r);if(i===null)throw new Error("Failed to decrypt");return Ot(i,li)}function gm(t,e){const r=bf(fi),n=Ln(Li),i=zt(t,li),s=Ef({type:r,sealed:i,iv:n});return e===Br?fm(s):s}function ym(t,e){const{sealed:r}=oi({encoded:t,encoding:e});return Ot(r,li)}function Ef(t){if(on(t.type)===fi)return Ot(Ui([t.type,t.sealed]),wt);if(on(t.type)===dr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Ot(Ui([t.type,t.senderPublicKey,t.iv,t.sealed]),wt)}return Ot(Ui([t.type,t.iv,t.sealed]),wt)}function oi(t){const e=(t.encoding||wt)===Br?hm(t.encoded):t.encoded,r=zt(e,wt),n=r.slice(bO,Fp),i=Fp;if(on(n)===dr){const c=i+mf,u=c+Li,l=r.slice(i,c),f=r.slice(c,u),p=r.slice(u);return{type:n,sealed:p,iv:f,senderPublicKey:l}}if(on(n)===fi){const c=r.slice(i),u=Ln(Li);return{type:n,sealed:c,iv:u}}const s=i+Li,o=r.slice(i,s),a=r.slice(s);return{type:n,sealed:a,iv:o}}function wm(t,e){const r=oi({encoded:t,encoding:e?.encoding});return vf({type:on(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Ot(r.senderPublicKey,dt):void 0,receiverPublicKey:e?.receiverPublicKey})}function vf(t){const e=t?.type||wf;if(e===dr){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Ju(t){return t.type===dr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function Qu(t){return t.type===fi}function mm(t){const e=Buffer.from(t.x,"base64"),r=Buffer.from(t.y,"base64");return Ui([new Uint8Array([4]),e,r])}function bm(t,e){const[r,n,i]=t.split("."),s=Buffer.from(hm(i),"base64");if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32),a=s.slice(32,64),c=`${r}.${n}`,u=Ro(c),l=mm(e);if(!mO.verify(Ui([o,a]),u,l))throw new Error("Invalid signature");return xu(t).payload}const Em="irn";function Zi(t){return t?.relay||{protocol:Em}}function Sn(t){const e=PA[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var EO=Object.defineProperty,vO=Object.defineProperties,_O=Object.getOwnPropertyDescriptors,kp=Object.getOwnPropertySymbols,SO=Object.prototype.hasOwnProperty,xO=Object.prototype.propertyIsEnumerable,qp=(t,e,r)=>e in t?EO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,au=(t,e)=>{for(var r in e||(e={}))SO.call(e,r)&&qp(t,r,e[r]);if(kp)for(var r of kp(e))xO.call(e,r)&&qp(t,r,e[r]);return t},IO=(t,e)=>vO(t,_O(e));function vm(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=t[i];r[s]=o}}),r}function el(t){if(!t.includes("wc:")){const u=ef(t);u!=null&&u.includes("wc:")&&(t=u)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(s),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:_m(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:vm(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function _m(t){return t.startsWith("//")?t.substring(2):t}function Sm(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=i,o=r+e+s;t[s]&&(n[o]=t[s])}),n}function tl(t){const e=new URLSearchParams,r=au(au(IO(au({},Sm(t.relay)),{symKey:t.symKey}),t.expiryTimestamp&&{expiryTimestamp:t.expiryTimestamp.toString()}),t.methods&&{methods:t.methods.join(",")});return Object.entries(r).sort(([n],[i])=>n.localeCompare(i)).forEach(([n,i])=>{i!==void 0&&e.append(n,String(i))}),`${t.protocol}:${t.topic}@${t.version}?${e}`}function Bi(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}var AO=Object.defineProperty,TO=Object.defineProperties,OO=Object.getOwnPropertyDescriptors,jp=Object.getOwnPropertySymbols,CO=Object.prototype.hasOwnProperty,RO=Object.prototype.propertyIsEnumerable,zp=(t,e,r)=>e in t?AO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,DO=(t,e)=>{for(var r in e||(e={}))CO.call(e,r)&&zp(t,r,e[r]);if(jp)for(var r of jp(e))RO.call(e,r)&&zp(t,r,e[r]);return t},BO=(t,e)=>TO(t,OO(e));function Mn(t){const e=[];return t.forEach(r=>{const[n,i]=r.split(":");e.push(`${n}:${i}`)}),e}function xm(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Mn(r.accounts))}),e}function Im(t,e){const r=[];return Object.values(t).forEach(n=>{Mn(n.accounts).includes(e)&&r.push(...n.methods)}),r}function Am(t,e){const r=[];return Object.values(t).forEach(n=>{Mn(n.accounts).includes(e)&&r.push(...n.events)}),r}function NO(t,e){const r=$i(t,e);if(r)throw new Error(r.message);const n={};for(const[i,s]of Object.entries(t))n[i]={methods:s.methods,events:s.events,chains:s.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return n}function PO(t){var e;const{proposal:{requiredNamespaces:r,optionalNamespaces:n={}},supportedNamespaces:i}=t,s=Ji(r),o=Ji(n),a={};Object.keys(i).forEach(l=>{const f=i[l].chains,p=i[l].methods,d=i[l].events,h=i[l].accounts;f.forEach(g=>{if(!h.some(m=>m.includes(g)))throw new Error(`No accounts provided for chain ${g} in namespace ${l}`)}),a[l]={chains:f,methods:p,events:d,accounts:h}});const c=oo(r,a,"approve()");if(c)throw new Error(c.message);const u={};if(!Object.keys(r).length&&!Object.keys(n).length)return a;Object.keys(s).forEach(l=>{const f=i[l].chains.filter(g=>{var m,y;return(y=(m=s[l])==null?void 0:m.chains)==null?void 0:y.includes(g)}),p=i[l].methods.filter(g=>{var m,y;return(y=(m=s[l])==null?void 0:m.methods)==null?void 0:y.includes(g)}),d=i[l].events.filter(g=>{var m,y;return(y=(m=s[l])==null?void 0:m.events)==null?void 0:y.includes(g)}),h=f.map(g=>i[l].accounts.filter(m=>m.includes(`${g}:`))).flat();u[l]={chains:f,methods:p,events:d,accounts:h}}),Object.keys(o).forEach(l=>{var f,p,d,h,g,m;if(!i[l])return;const y=(p=(f=o[l])==null?void 0:f.chains)==null?void 0:p.filter(I=>i[l].chains.includes(I)),S=i[l].methods.filter(I=>{var A,B;return(B=(A=o[l])==null?void 0:A.methods)==null?void 0:B.includes(I)}),b=i[l].events.filter(I=>{var A,B;return(B=(A=o[l])==null?void 0:A.events)==null?void 0:B.includes(I)}),x=y?.map(I=>i[l].accounts.filter(A=>A.includes(`${I}:`))).flat();u[l]={chains:Vt((d=u[l])==null?void 0:d.chains,y),methods:Vt((h=u[l])==null?void 0:h.methods,S),events:Vt((g=u[l])==null?void 0:g.events,b),accounts:Vt((m=u[l])==null?void 0:m.accounts,x)}});for(const[l,f]of Object.entries(u))(f.accounts.length===0||((e=f?.chains)==null?void 0:e.length)===0)&&delete u[l];return u}function _f(t){return t.includes(":")}function Tm(t){return _f(t)?t.split(":")[0]:t}function Ji(t){var e,r,n;const i={};if(!ai(t))return i;for(const[s,o]of Object.entries(t)){const a=_f(s)?[s]:o.chains,c=o.methods||[],u=o.events||[],l=Tm(s);i[l]=BO(DO({},i[l]),{chains:Vt(a,(e=i[l])==null?void 0:e.chains),methods:Vt(c,(r=i[l])==null?void 0:r.methods),events:Vt(u,(n=i[l])==null?void 0:n.events)})}return i}function Om(t){const e={};return t?.forEach(r=>{var n;const[i,s]=r.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[],methods:[]}),e[i].accounts.push(r),(n=e[i].chains)==null||n.push(`${i}:${s}`)}),e}function rl(t,e){e=e.map(n=>n.replace("did:pkh:",""));const r=Om(e);for(const[n,i]of Object.entries(r))i.methods?i.methods=Vt(i.methods,t):i.methods=t,i.events=["chainChanged","accountsChanged"];return r}function Cm(t,e){var r,n,i,s,o,a;const c=Ji(t),u=Ji(e),l={},f=Object.keys(c).concat(Object.keys(u));for(const p of f)l[p]={chains:Vt((r=c[p])==null?void 0:r.chains,(n=u[p])==null?void 0:n.chains),methods:Vt((i=c[p])==null?void 0:i.methods,(s=u[p])==null?void 0:s.methods),events:Vt((o=c[p])==null?void 0:o.events,(a=u[p])==null?void 0:a.events)};return l}const Rm={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Dm={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function de(t,e){const{message:r,code:n}=Dm[t];return{message:e?`${r} ${e}`:r,code:n}}function ke(t,e){const{message:r,code:n}=Rm[t];return{message:e?`${r} ${e}`:r,code:n}}function On(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function ai(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function We(t){return typeof t>"u"}function ze(t,e){return e&&We(t)?!0:typeof t=="string"&&!!t.trim().length}function No(t,e){return e&&We(t)?!0:typeof t=="number"&&!isNaN(t)}function Bm(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),i=Object.keys(r);let s=!0;return Qr(i,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:u}=t.namespaces[o],l=Mn(a),f=r[o];(!Qr(vo(o,f),l)||!Qr(f.methods,c)||!Qr(f.events,u))&&(s=!1)}),s):!1}function Qi(t){return ze(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Nm(t){if(ze(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Qi(r)}}return!1}function Pm(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(ze(t,!1)){if(e(t))return!0;const r=ef(t);return e(r)}}catch{}return!1}function Um(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Lm(t){return t?.topic}function Mm(t,e){let r=null;return ze(t?.publicKey,!1)||(r=de("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function nl(t){let e=!0;return On(t)?t.length&&(e=t.every(r=>ze(r,!1))):e=!1,e}function $m(t,e,r){let n=null;return On(e)&&e.length?e.forEach(i=>{n||Qi(i)||(n=ke("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):Qi(t)||(n=ke("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function Fm(t,e,r){let n=null;return Object.entries(t).forEach(([i,s])=>{if(n)return;const o=$m(i,vo(i,s),`${e} ${r}`);o&&(n=o)}),n}function km(t,e){let r=null;return On(t)?t.forEach(n=>{r||Nm(n)||(r=ke("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=ke("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function qm(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=km(n?.accounts,`${e} namespace`);i&&(r=i)}),r}function jm(t,e){let r=null;return nl(t?.methods)?nl(t?.events)||(r=ke("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=ke("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Sf(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=jm(n,`${e}, namespace`);i&&(r=i)}),r}function zm(t,e,r){let n=null;if(t&&ai(t)){const i=Sf(t,e);i&&(n=i);const s=Fm(t,e,r);s&&(n=s)}else n=de("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return n}function $i(t,e){let r=null;if(t&&ai(t)){const n=Sf(t,e);n&&(r=n);const i=qm(t,e);i&&(r=i)}else r=de("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function xf(t){return ze(t.protocol,!0)}function Vm(t,e){let r=!1;return e&&!t?r=!0:t&&On(t)&&t.length&&t.forEach(n=>{r=xf(n)}),r}function Hm(t){return typeof t=="number"}function yt(t){return typeof t<"u"&&typeof t!==null}function Km(t){return!(!t||typeof t!="object"||!t.code||!No(t.code,!1)||!t.message||!ze(t.message,!1))}function Wm(t){return!(We(t)||!ze(t.method,!1))}function Gm(t){return!(We(t)||We(t.result)&&We(t.error)||!No(t.id,!1)||!ze(t.jsonrpc,!1))}function Ym(t){return!(We(t)||!ze(t.name,!1))}function il(t,e){return!(!Qi(e)||!xm(t).includes(e))}function Xm(t,e,r){return ze(r,!1)?Im(t,e).includes(r):!1}function Zm(t,e,r){return ze(r,!1)?Am(t,e).includes(r):!1}function oo(t,e,r){let n=null;const i=UO(t),s=LO(e),o=Object.keys(i),a=Object.keys(s),c=Vp(Object.keys(t)),u=Vp(Object.keys(e)),l=c.filter(f=>!u.includes(f));return l.length&&(n=de("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${l.toString()}
      Received: ${Object.keys(e).toString()}`)),Qr(o,a)||(n=de("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(f=>{if(!f.includes(":")||n)return;const p=Mn(e[f].accounts);p.includes(f)||(n=de("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${f}
        Required: ${f}
        Approved: ${p.toString()}`))}),o.forEach(f=>{n||(Qr(i[f].methods,s[f].methods)?Qr(i[f].events,s[f].events)||(n=de("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${f}`)):n=de("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${f}`))}),n}function UO(t){const e={};return Object.keys(t).forEach(r=>{var n;r.includes(":")?e[r]=t[r]:(n=t[r].chains)==null||n.forEach(i=>{e[i]={methods:t[r].methods,events:t[r].events}})}),e}function Vp(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function LO(t){const e={};return Object.keys(t).forEach(r=>{r.includes(":")?e[r]=t[r]:Mn(t[r].accounts)?.forEach(i=>{e[i]={accounts:t[r].accounts.filter(s=>s.includes(`${i}:`)),methods:t[r].methods,events:t[r].events}})}),e}function Jm(t,e){return No(t,!1)&&t<=e.max&&t>=e.min}function sl(){const t=Un();return new Promise(e=>{switch(t){case mt.browser:e(Qm());break;case mt.reactNative:e(e1());break;case mt.node:e(t1());break;default:e(!0)}})}function Qm(){return Pn()&&navigator?.onLine}async function e1(){return Ur()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function t1(){return!0}function r1(t){switch(Un()){case mt.browser:n1(t);break;case mt.reactNative:i1(t);break;case mt.node:break}}function n1(t){!Ur()&&Pn()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function i1(t){Ur()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}function s1(){var t;return Pn()&&pr.getDocument()?((t=pr.getDocument())==null?void 0:t.visibilityState)==="visible":!0}const cu={};class Gn{static get(e){return cu[e]}static set(e,r){cu[e]=r}static delete(e){delete cu[e]}}function o1(t){const e=os.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function a1({publicKey:t,signature:e,payload:r}){var n;const i=ol(r.method),s=128|parseInt(((n=r.version)==null?void 0:n.toString())||"4"),o=$O(r.address),a=r.era==="00"?new Uint8Array([0]):ol(r.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(r.nonce,16),u=new Uint8Array([c&255,c>>8&255]),l=BigInt(`0x${MO(r.tip)}`),f=kO(l),p=new Uint8Array([0,...t,o,...e,...a,...u,...f,...i]),d=FO(p.length+1);return new Uint8Array([...d,s,...p])}function c1(t){const e=ol(t),r=$A.blake2b(e,void 0,32);return"0x"+Buffer.from(r).toString("hex")}function ol(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function MO(t){return t.startsWith("0x")?t.slice(2):t}function $O(t){const e=os.decode(t)[0];return e===42?0:e===60?2:1}function FO(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function kO(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function u1(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),r=o1(t.transaction.address),n=a1({publicKey:r,signature:e,payload:t.transaction}),i=Buffer.from(n).toString("hex");return c1(i)}function If({logger:t,name:e}){const r=typeof t=="string"?r0({opts:{level:t,name:e}}).logger:t;return r.level=typeof t=="string"?t:t.level,r}const qO=Object.freeze(Object.defineProperty({__proto__:null,BASE10:yf,BASE16:dt,BASE64:wt,BASE64URL:Br,COLON:ZA,DEFAULT_DEPTH:Yl,EMPTY_SPACE:Zs,ENV_MAP:mt,INTERNAL_ERRORS:Dm,LimitedSet:tw,MemoryStore:Gn,ONE_THOUSAND:JA,REACT_NATIVE_PRODUCT:By,RELAYER_DEFAULT_PROTOCOL:Em,SDK_ERRORS:Rm,SDK_TYPE:Py,SLASH:Ny,TYPE_0:wf,TYPE_1:dr,TYPE_2:fi,UTF8:li,addResourceToRecap:Dw,addSignatureToExtrinsic:a1,appendToQueryString:My,assertType:t8,assignAbilityToActions:uf,base64Decode:Cw,base64Encode:Ow,buildApprovedNamespaces:PO,buildAuthObject:tT,buildNamespacesFromAuth:rl,buildRecapStatement:Uw,buildSignedExtrinsicHash:u1,calcExpiry:Ke,capitalize:s8,capitalizeWord:Vy,createDelayedPromise:Wr,createEncodedRecap:Bw,createExpiringPromise:tr,createLogger:If,createRecap:Rw,decodeRecap:sn,decodeTypeByte:on,decodeTypeTwoEnvelope:ym,decrypt:pm,deriveExtrinsicHash:c1,deriveSymKey:lm,deserialize:oi,encodeRecap:Oo,encodeTypeByte:bf,encodeTypeTwoEnvelope:gm,encrypt:dm,engineEvent:Be,enumify:i8,extractSolanaTransactionId:mw,formatAccountId:Oy,formatAccountWithChain:kA,formatChainId:Ty,formatDeeplinkUrl:Gy,formatExpirerTarget:Jl,formatIdTarget:Ky,formatMessage:cf,formatMessageContext:r8,formatRelayParams:Sm,formatRelayRpcUrl:qy,formatStatementFromRecap:ff,formatTopicTarget:Hy,formatUA:Zl,formatUri:tl,fromBase64:ef,generateKeyPair:um,generateRandomBytes32:so,getAccountsChains:Mn,getAccountsFromNamespaces:jA,getAddressFromAccount:Cy,getAddressesFromAccounts:qA,getAlgorandTransactionId:Fu,getAppId:Pu,getAppMetadata:Xl,getBrowserOnlineStatus:Qm,getChainFromAccount:Ry,getChainsFromAccounts:Dy,getChainsFromNamespace:vo,getChainsFromNamespaces:zA,getChainsFromRecap:ju,getChainsFromRequiredNamespaces:VA,getCommonValuesInArrays:Uu,getCryptoKeyFromKeyData:mm,getDecodedRecapFromResources:Iw,getDeepLink:Xy,getDidAddress:Xi,getDidAddressSegments:To,getDidChainId:xw,getEnvironment:Un,getHttpUrl:e8,getInternalError:de,getJavascriptID:ky,getJavascriptOS:Fy,getLastItems:zy,getLinkModeURL:Bi,getMethodsFromRecap:qu,getNamespacedDidChainId:to,getNamespacesChains:xm,getNamespacesEventsForChainId:Am,getNamespacesFromAccounts:Om,getNamespacesMethodsForChainId:Im,getNearTransactionIdFromSignedTransaction:$u,getNearUint8ArrayFromBytes:Ew,getNodeOnlineStatus:t1,getReCapActions:Tw,getReactNativeOnlineStatus:e1,getRecapAbilitiesFromResource:iT,getRecapFromResources:In,getRecapResource:Aw,getRelayClientMetadata:QA,getRelayProtocolApi:Sn,getRelayProtocolName:Zi,getRequiredNamespacesFromNamespaces:NO,getSdkError:ke,getSearchParamFromURL:Lu,getSignDirectHash:vw,getSuiDigest:bw,getUniqueValues:Gl,getWalletSendCallsHashes:_w,handleDeeplinkRedirect:Wy,hasOverlap:Qr,hashEthereumMessage:of,hashKey:Mi,hashMessage:Pt,isAndroid:Uy,isAppVisible:s1,isBrowser:Pn,isCaipNamespace:_f,isConformingNamespaces:oo,isExpired:Or,isIframe:Jy,isIos:Ly,isNode:Gi,isOnline:sl,isProposalStruct:Um,isReactNative:Ur,isRecap:lf,isSessionCompatible:Bm,isSessionStruct:Lm,isTelegram:Zy,isTestRun:_o,isTypeOneEnvelope:Ju,isTypeTwoEnvelope:Qu,isUndefined:We,isValidAccountId:Nm,isValidAccounts:km,isValidActions:jm,isValidArray:On,isValidChainId:Qi,isValidChains:$m,isValidController:Mm,isValidEip1271Signature:ww,isValidEip191Signature:yw,isValidErrorReason:Km,isValidEvent:Ym,isValidId:Hm,isValidNamespaceAccounts:qm,isValidNamespaceActions:Sf,isValidNamespaceChains:Fm,isValidNamespaceMethodsOrEvents:nl,isValidNamespaces:$i,isValidNamespacesChainId:il,isValidNamespacesEvent:Zm,isValidNamespacesRequest:Xm,isValidNumber:No,isValidObject:ai,isValidParams:yt,isValidRecap:gr,isValidRelay:xf,isValidRelays:Vm,isValidRequest:Wm,isValidRequestExpiry:Jm,isValidRequiredNamespaces:zm,isValidResponse:Gm,isValidString:ze,isValidUrl:Pm,mapEntries:n8,mapToObj:Js,mergeArrays:Vt,mergeEncodedRecaps:Nw,mergeRecaps:Pw,mergeRequiredAndOptionalNamespaces:Cm,normalizeNamespaces:Ji,objToMap:Qs,openDeeplink:Yy,parseAccountId:Wl,parseChainId:Zn,parseContextNames:jy,parseExpirerTarget:Ql,parseNamespaceKey:Tm,parseRelayParams:vm,parseTopic:_m,parseUri:el,populateAppMetadata:$y,populateAuthPayload:rT,recapHasResource:nT,serialize:Ef,sleep:ew,ss58AddressToPublicKey:o1,subscribeToBrowserNetworkChange:n1,subscribeToNetworkChange:r1,subscribeToReactNativeNetworkChange:i1,toBase64:Qy,uuidv4:Mu,validateDecoding:wm,validateEncoding:vf,validateSignedCacao:ku,verifyP256Jwt:bm,verifySignature:gw},Symbol.toStringTag,{value:"Module"})),jO="PARSE_ERROR",zO="INVALID_REQUEST",VO="METHOD_NOT_FOUND",HO="INVALID_PARAMS",l1="INTERNAL_ERROR",Af="SERVER_ERROR",KO=[-32700,-32600,-32601,-32602,-32603],Fi={[jO]:{code:-32700,message:"Parse error"},[zO]:{code:-32600,message:"Invalid Request"},[VO]:{code:-32601,message:"Method not found"},[HO]:{code:-32602,message:"Invalid params"},[l1]:{code:-32603,message:"Internal error"},[Af]:{code:-32e3,message:"Server error"}},f1=Af;function WO(t){return KO.includes(t)}function Hp(t){return Object.keys(Fi).includes(t)?Fi[t]:Fi[f1]}function GO(t){const e=Object.values(Fi).find(r=>r.code===t);return e||Fi[f1]}function YO(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var uu={},_r={},Kp;function XO(){if(Kp)return _r;Kp=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.isBrowserCryptoAvailable=_r.getSubtleCrypto=_r.getBrowerCrypto=void 0;function t(){return jt?.crypto||jt?.msCrypto||{}}_r.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}_r.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return _r.isBrowserCryptoAvailable=r,_r}var Sr={},Wp;function ZO(){if(Wp)return Sr;Wp=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.isBrowser=Sr.isNode=Sr.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Sr.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Sr.isNode=e;function r(){return!t()&&!e()}return Sr.isBrowser=r,Sr}var Gp;function JO(){return Gp||(Gp=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ts;e.__exportStar(XO(),t),e.__exportStar(ZO(),t)})(uu)),uu}var QO=JO();function fr(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function en(t=6){return BigInt(fr(t))}function Rr(t,e,r){return{id:r||fr(),jsonrpc:"2.0",method:t,params:e}}function ao(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Tf(t,e,r){return{id:t,jsonrpc:"2.0",error:eC(e)}}function eC(t,e){return typeof t>"u"?Hp(l1):(typeof t=="string"&&(t=Object.assign(Object.assign({},Hp(Af)),{message:t})),WO(t.code)&&(t=GO(t.code)),t)}class tC{}class rC extends tC{constructor(){super()}}class nC extends rC{constructor(e){super()}}const iC="^wss?:";function sC(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function oC(t,e){const r=sC(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Yp(t){return oC(t,iC)}function aC(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function h1(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Of(t){return h1(t)&&"method"in t}function Po(t){return h1(t)&&(hr(t)||qt(t))}function hr(t){return"result"in t}function qt(t){return"error"in t}class cC extends nC{constructor(e){super(e),this.events=new ir.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Rr(e.method,e.params||[],e.id||en().toString()),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{qt(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Po(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const uC=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),lC=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Xp=t=>t.split("?")[0],Zp=10,fC=uC();let hC=class{constructor(e){if(this.url=e,this.events=new ir.EventEmitter,this.registering=!1,!Yp(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(An(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!Yp(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=QO.isReactNative()?void 0:{rejectUnauthorized:!aC(e)},s=new fC(e,[],i);lC()?s.onerror=o=>{const a=o;n(this.emitError(a.error))}:s.on("error",o=>{n(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?ti(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=Tf(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return YO(e,Xp(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Zp&&this.events.setMaxListeners(Zp)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${Xp(this.url)}`));return this.events.emit("register_error",r),r}};var dC={};const d1="wc",p1=2,al="core",yr=`${d1}@2:${al}:`,pC={logger:"error"},gC={database:":memory:"},yC="crypto",Jp="client_ed25519_seed",wC=pe.ONE_DAY,mC="keychain",bC="0.3",EC="messages",vC="0.3",_C=pe.SIX_HOURS,SC="publisher",g1="irn",xC="error",y1="wss://relay.walletconnect.org",IC="relayer",je={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},AC="_subscription",Mt={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},TC=.1,cl="2.22.4",$e={link_mode:"link_mode",relay:"relay"},Ms={inbound:"inbound",outbound:"outbound"},OC="0.3",CC="WALLETCONNECT_CLIENT_ID",Qp="WALLETCONNECT_LINK_MODE_APPS",Dt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},RC="subscription",DC="0.3",BC="pairing",NC="0.3",Ii={wc_pairingDelete:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:pe.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:pe.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:0},res:{ttl:pe.ONE_DAY,prompt:!1,tag:0}}},mn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Gt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},PC="history",UC="0.3",LC="expirer",Ft={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},MC="0.3",$C="verify-api",FC="https://verify.walletconnect.com",w1="https://verify.walletconnect.org",ki=w1,kC=`${ki}/v3`,qC=[FC,w1],jC="echo",zC="https://echo.walletconnect.com",lr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Ir={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Yt={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},dn={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},pn={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Ai={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},VC=.1,HC="event-client",KC=86400,WC="https://pulse.walletconnect.org/batch";function GC(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function f(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var g=0,m=0,y=0,S=h.length;y!==S&&h[y]===0;)y++,g++;for(var b=(S-y)*l+1>>>0,x=new Uint8Array(b);y!==S;){for(var I=h[y],A=0,B=b-1;(I!==0||A<m)&&B!==-1;B--,A++)I+=256*x[B]>>>0,x[B]=I%a>>>0,I=I/a>>>0;if(I!==0)throw new Error("Non-zero carry");m=A,y++}for(var P=b-m;P!==b&&x[P]===0;)P++;for(var N=c.repeat(g);P<b;++P)N+=t.charAt(x[P]);return N}function p(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var g=0;if(h[g]!==" "){for(var m=0,y=0;h[g]===c;)m++,g++;for(var S=(h.length-g)*u+1>>>0,b=new Uint8Array(S);h[g];){var x=r[h.charCodeAt(g)];if(x===255)return;for(var I=0,A=S-1;(x!==0||I<y)&&A!==-1;A--,I++)x+=a*b[A]>>>0,b[A]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=I,g++}if(h[g]!==" "){for(var B=S-y;B!==S&&b[B]===0;)B++;for(var P=new Uint8Array(m+(S-B)),N=m;B!==S;)P[N++]=b[B++];return P}}}function d(h){var g=p(h);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:p,decode:d}}var YC=GC,XC=YC;const m1=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ZC=t=>new TextEncoder().encode(t),JC=t=>new TextDecoder().decode(t);class QC{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class eR{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return b1(this,e)}}class tR{constructor(e){this.decoders=e}or(e){return b1(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const b1=(t,e)=>new tR({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class rR{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new QC(e,r,n),this.decoder=new eR(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Uo=({name:t,prefix:e,encode:r,decode:n})=>new rR(t,e,r,n),ls=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=XC(r,e);return Uo({prefix:t,name:e,encode:n,decode:s=>m1(i(s))})},nR=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let l=0;l<s;++l){const f=i[t[l]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},iR=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},ot=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Uo({prefix:e,name:t,encode(i){return iR(i,n,r)},decode(i){return nR(i,n,r,t)}}),sR=Uo({prefix:"\0",name:"identity",encode:t=>JC(t),decode:t=>ZC(t)});var oR=Object.freeze({__proto__:null,identity:sR});const aR=ot({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var cR=Object.freeze({__proto__:null,base2:aR});const uR=ot({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var lR=Object.freeze({__proto__:null,base8:uR});const fR=ls({prefix:"9",name:"base10",alphabet:"0123456789"});var hR=Object.freeze({__proto__:null,base10:fR});const dR=ot({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pR=ot({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var gR=Object.freeze({__proto__:null,base16:dR,base16upper:pR});const yR=ot({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),wR=ot({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mR=ot({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),bR=ot({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ER=ot({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vR=ot({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),_R=ot({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),SR=ot({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xR=ot({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var IR=Object.freeze({__proto__:null,base32:yR,base32upper:wR,base32pad:mR,base32padupper:bR,base32hex:ER,base32hexupper:vR,base32hexpad:_R,base32hexpadupper:SR,base32z:xR});const AR=ls({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),TR=ls({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var OR=Object.freeze({__proto__:null,base36:AR,base36upper:TR});const CR=ls({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),RR=ls({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var DR=Object.freeze({__proto__:null,base58btc:CR,base58flickr:RR});const BR=ot({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),NR=ot({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),PR=ot({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),UR=ot({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var LR=Object.freeze({__proto__:null,base64:BR,base64pad:NR,base64url:PR,base64urlpad:UR});const E1=Array.from("ððªâð°ðððððððððððððâð»ð¥ð¾ð¿ðâ¤ðð¤£ðððð­ðððððð¥ð¥°ðððð¢ð¤ðððªðâºðð¤ððððð¹ð¤¦ððââ¨ð¤·ð±ðð¸ððððððððð¤©ððð¤ðð¯ððð¶ðð¤­â£ððððªðð¥ððð©ð¡ð¤ªðð¥³ð¥ð¤¤ððð³âððð´ðð¬ððð·ð»ðâ­âð¥ºððð¤ð¦âð£ððâ¹ððð âððºðð»ððððð¹ð£ð«ðððµð¤ðð´ð¤ð¼ð«â½ð¤âðð¤«ðð®ðð»ðð¶ðð²ð¿ð§¡ðâ¡ððââðð°ð¤¨ð¶ð¤ð¶ð°ðð¢ð¤ðð¨ð¨ð¤¬âððºð¤ððð±ðð¶ð¥´â¶â¡âðð¸â¬ð¨ðð¦ð·ðºâ ðððµðð¤²ð¤ ð¤§ððµðð§ð¾ððð¤ðð¤¯ð·âð§ð¯ððð¤ððâð´ð£ð¸ððð¥ð¤¢ðð¡ð©ðð¸ð»ð¤ð¤®ð¼ð¥µð©ððð¼ðð£ð¥"),MR=E1.reduce((t,e,r)=>(t[r]=e,t),[]),$R=E1.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function FR(t){return t.reduce((e,r)=>(e+=MR[r],e),"")}function kR(t){const e=[];for(const r of t){const n=$R[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const qR=Uo({prefix:"ð",name:"base256emoji",encode:FR,decode:kR});var jR=Object.freeze({__proto__:null,base256emoji:qR}),zR=v1,eg=128,VR=-128,HR=Math.pow(2,31);function v1(t,e,r){e=e||[],r=r||0;for(var n=r;t>=HR;)e[r++]=t&255|eg,t/=128;for(;t&VR;)e[r++]=t&255|eg,t>>>=7;return e[r]=t|0,v1.bytes=r-n+1,e}var KR=ul,WR=128,tg=127;function ul(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw ul.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&tg)<<i:(o&tg)*Math.pow(2,i),i+=7}while(o>=WR);return ul.bytes=s-n,r}var GR=Math.pow(2,7),YR=Math.pow(2,14),XR=Math.pow(2,21),ZR=Math.pow(2,28),JR=Math.pow(2,35),QR=Math.pow(2,42),eD=Math.pow(2,49),tD=Math.pow(2,56),rD=Math.pow(2,63),nD=function(t){return t<GR?1:t<YR?2:t<XR?3:t<ZR?4:t<JR?5:t<QR?6:t<eD?7:t<tD?8:t<rD?9:10},iD={encode:zR,decode:KR,encodingLength:nD},_1=iD;const rg=(t,e,r=0)=>(_1.encode(t,e,r),e),ng=t=>_1.encodingLength(t),ll=(t,e)=>{const r=e.byteLength,n=ng(t),i=n+ng(r),s=new Uint8Array(i+r);return rg(t,s,0),rg(r,s,n),s.set(e,i),new sD(t,r,e,s)};class sD{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const S1=({name:t,code:e,encode:r})=>new oD(t,e,r);class oD{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ll(this.code,r):r.then(n=>ll(this.code,n))}else throw Error("Unknown type, must be binary type")}}const x1=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),aD=S1({name:"sha2-256",code:18,encode:x1("SHA-256")}),cD=S1({name:"sha2-512",code:19,encode:x1("SHA-512")});var uD=Object.freeze({__proto__:null,sha256:aD,sha512:cD});const I1=0,lD="identity",A1=m1,fD=t=>ll(I1,A1(t)),hD={code:I1,name:lD,encode:A1,digest:fD};var dD=Object.freeze({__proto__:null,identity:hD});new TextEncoder,new TextDecoder;const ig={...oR,...cR,...lR,...hR,...gR,...IR,...OR,...DR,...LR,...jR};({...uD,...dD});function T1(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function pD(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?T1(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function O1(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const sg=O1("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),lu=O1("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=pD(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),gD={utf8:sg,"utf-8":sg,hex:ig.base16,latin1:lu,ascii:lu,binary:lu,...ig};function yD(t,e="utf8"){const r=gD[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?T1(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var wD=Object.defineProperty,mD=(t,e,r)=>e in t?wD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ur=(t,e,r)=>mD(t,typeof e!="symbol"?e+"":e,r);class bD{constructor(e,r){this.core=e,this.logger=r,ur(this,"keychain",new Map),ur(this,"name",mC),ur(this,"version",bC),ur(this,"initialized",!1),ur(this,"storagePrefix",yr),ur(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),ur(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),ur(this,"set",async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()}),ur(this,"get",n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i}),ur(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=Ut(r,this.name)}get context(){return Ct(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Js(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Qs(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}}var ED=Object.defineProperty,vD=(t,e,r)=>e in t?ED(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xe=(t,e,r)=>vD(t,typeof e!="symbol"?e+"":e,r);class _D{constructor(e,r,n){this.core=e,this.logger=r,Xe(this,"name",yC),Xe(this,"keychain"),Xe(this,"randomSessionIdentifier",so()),Xe(this,"initialized",!1),Xe(this,"clientId"),Xe(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Xe(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),Xe(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const i=await this.getClientSeed(),s=Pd(i),o=D0(s.publicKey);return this.clientId=o,o}),Xe(this,"generateKeyPair",()=>{this.isInitialized();const i=um();return this.setPrivateKey(i.publicKey,i.privateKey)}),Xe(this,"signJWT",async i=>{this.isInitialized();const s=await this.getClientSeed(),o=Pd(s),a=this.randomSessionIdentifier;return await DS(a,i,wC,o)}),Xe(this,"generateSharedKey",(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),c=lm(a,s);return this.setSymKey(c,o)}),Xe(this,"setSymKey",async(i,s)=>{this.isInitialized();const o=s||Mi(i);return await this.keychain.set(o,i),o}),Xe(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),Xe(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),Xe(this,"encode",async(i,s,o)=>{this.isInitialized();const a=vf(o),c=An(s);if(Qu(a))return gm(c,o?.encoding);if(Ju(a)){const p=a.senderPublicKey,d=a.receiverPublicKey;i=await this.generateSharedKey(p,d)}const u=this.getSymKey(i),{type:l,senderPublicKey:f}=a;return dm({type:l,symKey:u,message:c,senderPublicKey:f,encoding:o?.encoding})}),Xe(this,"decode",async(i,s,o)=>{this.isInitialized();const a=wm(s,o);if(Qu(a)){const c=ym(s,o?.encoding);return ti(c)}if(Ju(a)){const c=a.receiverPublicKey,u=a.senderPublicKey;i=await this.generateSharedKey(c,u)}try{const c=this.getSymKey(i),u=pm({symKey:c,encoded:s,encoding:o?.encoding});return ti(u)}catch(c){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Xe(this,"getPayloadType",(i,s=wt)=>{const o=oi({encoded:i,encoding:s});return on(o.type)}),Xe(this,"getPayloadSenderPublicKey",(i,s=wt)=>{const o=oi({encoded:i,encoding:s});return o.senderPublicKey?Ot(o.senderPublicKey,dt):void 0}),this.core=e,this.logger=Ut(r,this.name),this.keychain=n||new bD(this.core,this.logger)}get context(){return Ct(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Jp)}catch{e=so(),await this.keychain.set(Jp,e)}return yD(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}}var SD=Object.defineProperty,xD=Object.defineProperties,ID=Object.getOwnPropertyDescriptors,og=Object.getOwnPropertySymbols,AD=Object.prototype.hasOwnProperty,TD=Object.prototype.propertyIsEnumerable,fl=(t,e,r)=>e in t?SD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,OD=(t,e)=>{for(var r in e||(e={}))AD.call(e,r)&&fl(t,r,e[r]);if(og)for(var r of og(e))TD.call(e,r)&&fl(t,r,e[r]);return t},CD=(t,e)=>xD(t,ID(e)),Rt=(t,e,r)=>fl(t,typeof e!="symbol"?e+"":e,r);class RD extends Cv{constructor(e,r){super(e,r),this.logger=e,this.core=r,Rt(this,"messages",new Map),Rt(this,"messagesWithoutClientAck",new Map),Rt(this,"name",EC),Rt(this,"version",vC),Rt(this,"initialized",!1),Rt(this,"storagePrefix",yr),Rt(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const i=await this.getRelayerMessagesWithoutClientAck();typeof i<"u"&&(this.messagesWithoutClientAck=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),Rt(this,"set",async(n,i,s)=>{this.isInitialized();const o=Pt(i);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=i,this.messages.set(n,a),s===Ms.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,CD(OD({},c),{[o]:i}))}return await this.persist(),o}),Rt(this,"get",n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i}),Rt(this,"getWithoutAck",n=>{this.isInitialized();const i={};for(const s of n){const o=this.messagesWithoutClientAck.get(s)||{};i[s]=Object.values(o)}return i}),Rt(this,"has",(n,i)=>{this.isInitialized();const s=this.get(n),o=Pt(i);return typeof s[o]<"u"}),Rt(this,"ack",async(n,i)=>{this.isInitialized();const s=this.messagesWithoutClientAck.get(n);if(typeof s>"u")return;const o=Pt(i);delete s[o],Object.keys(s).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,s),await this.persist()}),Rt(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=Ut(e,this.name),this.core=r}get context(){return Ct(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Js(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Js(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Qs(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Qs(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}}var DD=Object.defineProperty,BD=Object.defineProperties,ND=Object.getOwnPropertyDescriptors,ag=Object.getOwnPropertySymbols,PD=Object.prototype.hasOwnProperty,UD=Object.prototype.propertyIsEnumerable,hl=(t,e,r)=>e in t?DD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Hn=(t,e)=>{for(var r in e||(e={}))PD.call(e,r)&&hl(t,r,e[r]);if(ag)for(var r of ag(e))UD.call(e,r)&&hl(t,r,e[r]);return t},cg=(t,e)=>BD(t,ND(e)),$t=(t,e,r)=>hl(t,typeof e!="symbol"?e+"":e,r);class LD extends Rv{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,$t(this,"events",new ir.EventEmitter),$t(this,"name",SC),$t(this,"queue",new Map),$t(this,"publishTimeout",pe.toMiliseconds(pe.ONE_MINUTE)),$t(this,"initialPublishTimeout",pe.toMiliseconds(pe.ONE_SECOND*15)),$t(this,"needsTransportRestart",!1),$t(this,"publish",async(n,i,s)=>{var o,a,c,u,l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});const f=s?.ttl||_C,p=s?.prompt||!1,d=s?.tag||0,h=s?.id||en().toString(),g=Sn(Zi().protocol),m={id:h,method:s?.publishMethod||g.publish,params:Hn({topic:n,message:i,ttl:f,prompt:p,tag:d,attestation:s?.attestation},s?.tvf)},y=`Failed to publish payload, please try again. id:${h} tag:${d}`;try{We((o=m.params)==null?void 0:o.prompt)&&((a=m.params)==null||delete a.prompt),We((c=m.params)==null?void 0:c.tag)&&((u=m.params)==null||delete u.tag);const S=new Promise(async b=>{const x=({id:A})=>{var B;((B=m.id)==null?void 0:B.toString())===A.toString()&&(this.removeRequestFromQueue(A),this.relayer.events.removeListener(je.publish,x),b())};this.relayer.events.on(je.publish,x);const I=tr(new Promise((A,B)=>{this.rpcPublish(m,s).then(A).catch(P=>{this.logger.warn(P,P?.message),B(P)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${h} tag:${d}`);try{await I,this.events.removeListener(je.publish,x)}catch(A){this.queue.set(h,{request:m,opts:s,attempt:1}),this.logger.warn(A,A?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:h,topic:n,message:i,opts:s}}),await tr(S,this.publishTimeout,y)}catch(S){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(S),(l=s?.internal)!=null&&l.throwOnFailedPublish)throw S}finally{this.queue.delete(h)}}),$t(this,"publishCustom",async n=>{var i,s,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:n});const{payload:u,opts:l={}}=n,{attestation:f,tvf:p,publishMethod:d,prompt:h,tag:g,ttl:m=pe.FIVE_MINUTES}=l,y=l.id||en().toString(),S=Sn(Zi().protocol),b=d||S.publish,x={id:y,method:b,params:Hn(cg(Hn({},u),{ttl:m,prompt:h,tag:g,attestation:f}),p)},I=`Failed to publish custom payload, please try again. id:${y} tag:${g}`;try{We((i=x.params)==null?void 0:i.prompt)&&((s=x.params)==null||delete s.prompt),We((o=x.params)==null?void 0:o.tag)&&((a=x.params)==null||delete a.tag);const A=new Promise(async B=>{const P=({id:$})=>{var G;((G=x.id)==null?void 0:G.toString())===$.toString()&&(this.removeRequestFromQueue($),this.relayer.events.removeListener(je.publish,P),B())};this.relayer.events.on(je.publish,P);const N=tr(new Promise(($,G)=>{this.rpcPublish(x,l).then($).catch(q=>{this.logger.warn(q,q?.message),G(q)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${b} id:${y} tag:${g}`);try{await N,this.events.removeListener(je.publish,P)}catch($){this.queue.set(y,{request:x,opts:l,attempt:1}),this.logger.warn($,$?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:y,payload:u,opts:l}}),await tr(A,this.publishTimeout,I)}catch(A){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(A),(c=l?.internal)!=null&&c.throwOnFailedPublish)throw A}finally{this.queue.delete(y)}}),$t(this,"on",(n,i)=>{this.events.on(n,i)}),$t(this,"once",(n,i)=>{this.events.once(n,i)}),$t(this,"off",(n,i)=>{this.events.off(n,i)}),$t(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.relayer=e,this.logger=Ut(r,this.name),this.registerEventListeners()}get context(){return Ct(this.logger)}async rpcPublish(e,r){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const n=await this.relayer.request(e);return this.relayer.events.emit(je.publish,Hn(Hn({},e),r)),this.logger.debug("Successfully Published Payload"),n}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{var n;const i=e.attempt+1;this.queue.set(r,cg(Hn({},e),{attempt:i})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(n=e.request.params)==null?void 0:n.tag}, attempt: ${i}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Bn.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(je.connection_stalled);return}this.checkQueue()}),this.relayer.on(je.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var MD=Object.defineProperty,$D=(t,e,r)=>e in t?MD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kn=(t,e,r)=>$D(t,typeof e!="symbol"?e+"":e,r);class FD{constructor(){Kn(this,"map",new Map),Kn(this,"set",(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])}),Kn(this,"get",e=>this.map.get(e)||[]),Kn(this,"exists",(e,r)=>this.get(e).includes(r)),Kn(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),Kn(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var kD=Object.defineProperty,qD=Object.defineProperties,jD=Object.getOwnPropertyDescriptors,ug=Object.getOwnPropertySymbols,zD=Object.prototype.hasOwnProperty,VD=Object.prototype.propertyIsEnumerable,dl=(t,e,r)=>e in t?kD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ti=(t,e)=>{for(var r in e||(e={}))zD.call(e,r)&&dl(t,r,e[r]);if(ug)for(var r of ug(e))VD.call(e,r)&&dl(t,r,e[r]);return t},fu=(t,e)=>qD(t,jD(e)),Ue=(t,e,r)=>dl(t,typeof e!="symbol"?e+"":e,r);class HD extends Nv{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,Ue(this,"subscriptions",new Map),Ue(this,"topicMap",new FD),Ue(this,"events",new ir.EventEmitter),Ue(this,"name",RC),Ue(this,"version",DC),Ue(this,"pending",new Map),Ue(this,"cached",[]),Ue(this,"initialized",!1),Ue(this,"storagePrefix",yr),Ue(this,"subscribeTimeout",pe.toMiliseconds(pe.ONE_MINUTE)),Ue(this,"initialSubscribeTimeout",pe.toMiliseconds(pe.ONE_SECOND*15)),Ue(this,"clientId"),Ue(this,"batchSubscribeTopicsLimit",500),Ue(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Ue(this,"subscribe",async(n,i)=>{var s;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const o=Zi(i),a={topic:n,relay:o,transportType:i?.transportType};(s=i?.internal)!=null&&s.skipSubscribe||this.pending.set(n,a);const c=await this.rpcSubscribe(n,o,i);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),Ue(this,"unsubscribe",async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)}),Ue(this,"isSubscribed",n=>new Promise(i=>{i(this.topicMap.topics.includes(n))})),Ue(this,"isKnownTopic",n=>new Promise(i=>{i(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(s=>s.topic===n))})),Ue(this,"on",(n,i)=>{this.events.on(n,i)}),Ue(this,"once",(n,i)=>{this.events.once(n,i)}),Ue(this,"off",(n,i)=>{this.events.off(n,i)}),Ue(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),Ue(this,"start",async()=>{await this.onConnect()}),Ue(this,"stop",async()=>{await this.onDisconnect()}),Ue(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Ue(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(i=>{n.push(i)}),await this.batchSubscribe(n)}),Ue(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Bn.pulse,async()=>{await this.checkPending()}),this.events.on(Dt.created,async n=>{const i=Dt.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()}),this.events.on(Dt.deleted,async n=>{const i=Dt.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()})}),this.relayer=e,this.logger=Ut(r,this.name),this.clientId=""}get context(){return Ct(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=Zi(n);await this.restartToComplete({topic:e,id:r,relay:i}),await this.rpcUnsubscribe(e,r,i);const s=ke("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r,n){var i,s;const o=await this.getSubscriptionId(e);if((i=n?.internal)!=null&&i.skipSubscribe)return o;(!n||n?.transportType===$e.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const a={method:Sn(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(s=n?.internal)==null?void 0:s.throwOnFailedPublish;try{if(n?.transportType===$e.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(f=>this.logger.warn(f))},pe.toMiliseconds(pe.ONE_SECOND)),o;const u=new Promise(async f=>{const p=d=>{d.topic===e&&(this.events.removeListener(Dt.created,p),f(d.id))};this.events.on(Dt.created,p);try{const d=await tr(new Promise((h,g)=>{this.relayer.request(a).catch(m=>{this.logger.warn(m,m?.message),g(m)}).then(h)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Dt.created,p),f(d)}catch{}}),l=await tr(u,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return l?o:null}catch(u){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(je.connection_stalled),c)throw u}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:Sn(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await tr(new Promise(i=>{this.relayer.request(n).catch(s=>this.logger.warn(s)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(je.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,n={method:Sn(r.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await tr(new Promise((s,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(je.connection_stalled)}return i}rpcUnsubscribe(e,r,n){const i={method:Sn(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,r){this.setSubscription(e,fu(Ti({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Ti({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,Ti({},r)),this.topicMap.set(r.topic,e),this.events.emit(Dt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=de("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Dt.deleted,fu(Ti({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Dt.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const i=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Dt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(r=>{var n;return r.topic===((n=this.subscriptions.get(r.id))==null?void 0:n.topic)})){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>fu(Ti({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await ew(pe.toMiliseconds(pe.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Pt(e+await this.getClientId())}}var KD=Object.defineProperty,lg=Object.getOwnPropertySymbols,WD=Object.prototype.hasOwnProperty,GD=Object.prototype.propertyIsEnumerable,pl=(t,e,r)=>e in t?KD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,fg=(t,e)=>{for(var r in e||(e={}))WD.call(e,r)&&pl(t,r,e[r]);if(lg)for(var r of lg(e))GD.call(e,r)&&pl(t,r,e[r]);return t},Re=(t,e,r)=>pl(t,typeof e!="symbol"?e+"":e,r);class YD extends Dv{constructor(e){var r;super(e),Re(this,"protocol","wc"),Re(this,"version",2),Re(this,"core"),Re(this,"logger"),Re(this,"events",new ir.EventEmitter),Re(this,"provider"),Re(this,"messages"),Re(this,"subscriber"),Re(this,"publisher"),Re(this,"name",IC),Re(this,"transportExplicitlyClosed",!1),Re(this,"initialized",!1),Re(this,"connectionAttemptInProgress",!1),Re(this,"relayUrl"),Re(this,"projectId"),Re(this,"packageName"),Re(this,"bundleId"),Re(this,"hasExperiencedNetworkDisruption",!1),Re(this,"pingTimeout"),Re(this,"heartBeatTimeout",pe.toMiliseconds(pe.THIRTY_SECONDS+pe.FIVE_SECONDS)),Re(this,"reconnectTimeout"),Re(this,"connectPromise"),Re(this,"reconnectInProgress",!1),Re(this,"requestsInFlight",[]),Re(this,"connectTimeout",pe.toMiliseconds(pe.ONE_SECOND*15)),Re(this,"request",async n=>{var i,s;this.logger.debug("Publishing Request Payload");const o=n.id||en().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:n.method,topic:(i=n.params)==null?void 0:i.topic},"relayer.request - publishing...");const a=`${o}:${((s=n.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(u=>u!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),Re(this,"resetPingTimeout",()=>{Gi()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,i,s,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(s=(i=(n=this.provider)==null?void 0:n.connection)==null?void 0:i.socket)==null?void 0:s.terminate)==null||o.call(s)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),Re(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),Re(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected ð"),this.startPingTimeout(),this.events.emit(je.connect)}),Re(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected ð"),this.requestsInFlight=[],this.onProviderDisconnect()}),Re(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(je.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Re(this,"registerProviderListeners",()=>{this.provider.on(Mt.payload,this.onPayloadHandler),this.provider.on(Mt.connect,this.onConnectHandler),this.provider.on(Mt.disconnect,this.onDisconnectHandler),this.provider.on(Mt.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=If({logger:(r=e.logger)!=null?r:xC,name:this.name}),this.messages=new RD(this.logger,e.core),this.subscriber=new HD(this,this.logger),this.publisher=new LD(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||y1,Uy()?this.packageName=Pu():Ly()&&(this.bundleId=Pu()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return Ct(this.logger)}get connected(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:$e.relay},Ms.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,r){var n,i,s;this.isInitialized(),(!(r!=null&&r.transportType)||r?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((n=r?.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(i=r?.internal)==null?void 0:i.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",c;const u=l=>{l.topic===e&&(this.subscriber.off(Dt.created,u),c())};return await Promise.all([new Promise(l=>{c=l,this.subscriber.on(Dt.created,u)}),new Promise(async(l,f)=>{a=await this.subscriber.subscribe(e,fg({internal:{throwOnFailedPublish:o}},r)).catch(p=>{o&&f(p)})||a,l()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await tr(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,n)=>{await this.connect(e).then(r).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await sl())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((n,i)=>n.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const n of r)try{await this.onMessageEvent(n)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+i?.message)}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:n}=e;if(!r.sessionExists){const i=Ke(pe.FIVE_MINUTES),s={topic:n,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,s)}this.events.emit(je.message,e),await this.recordMessageEvent(e,Ms.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(n,i)=>{const s=()=>{i(new Error("Connection interrupted while trying to connect"))};this.provider.once(Mt.disconnect,s),await tr(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(Mt.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Mt.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Mt.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const i=n;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(n=>setTimeout(n,pe.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,n,i,s;if(Gi())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((s=(i=(n=this.provider)==null?void 0:n.connection)==null?void 0:i.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new cC(new hC(qy({sdkVersion:cl,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,r){const{topic:n,message:i}=e;await this.messages.set(n,i,r)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(r))return this.logger.warn(`Ignoring message for unknown topic ${r}`),!0;const i=this.messages.has(r,n);return i&&this.logger.warn(`Ignoring duplicate message: ${n}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Of(e)){if(!e.method.endsWith(AC))return;const r=e.params,{topic:n,message:i,publishedAt:s,attestation:o}=r.data,a={topic:n,message:i,publishedAt:s,transportType:$e.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(fg({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Po(e)&&this.events.emit(je.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Ms.inbound),this.events.emit(je.message,e))}async acknowledgePayload(e){const r=ao(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Mt.payload,this.onPayloadHandler),this.provider.off(Mt.connect,this.onConnectHandler),this.provider.off(Mt.disconnect,this.onDisconnectHandler),this.provider.off(Mt.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await sl();r1(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(n=>this.logger.error(n,n?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Bn.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&s1())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(r){this.logger.warn(r,r?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(je.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},pe.toMiliseconds(TC)))))}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function XD(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function hg(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function dg(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const ZD="[object RegExp]",JD="[object String]",QD="[object Number]",e4="[object Boolean]",pg="[object Arguments]",t4="[object Symbol]",r4="[object Date]",n4="[object Map]",i4="[object Set]",s4="[object Array]",o4="[object Function]",a4="[object ArrayBuffer]",hu="[object Object]",c4="[object Error]",u4="[object DataView]",l4="[object Uint8Array]",f4="[object Uint8ClampedArray]",h4="[object Uint16Array]",d4="[object Uint32Array]",p4="[object BigUint64Array]",g4="[object Int8Array]",y4="[object Int16Array]",w4="[object Int32Array]",m4="[object BigInt64Array]",b4="[object Float32Array]",E4="[object Float64Array]";function v4(){}function gg(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function _4(t,e,r){return Ni(t,e,void 0,void 0,void 0,void 0,r)}function Ni(t,e,r,n,i,s,o){const a=o(t,e,r,n,i,s);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return qi(t,e,s,o)}return qi(t,e,s,o)}function qi(t,e,r,n){if(Object.is(t,e))return!0;let i=dg(t),s=dg(e);if(i===pg&&(i=hu),s===pg&&(s=hu),i!==s)return!1;switch(i){case JD:return t.toString()===e.toString();case QD:{const c=t.valueOf(),u=e.valueOf();return XD(c,u)}case e4:case r4:case t4:return Object.is(t.valueOf(),e.valueOf());case ZD:return t.source===e.source&&t.flags===e.flags;case o4:return t===e}r=r??new Map;const o=r.get(t),a=r.get(e);if(o!=null&&a!=null)return o===e;r.set(t,e),r.set(e,t);try{switch(i){case n4:{if(t.size!==e.size)return!1;for(const[c,u]of t.entries())if(!e.has(c)||!Ni(u,e.get(c),c,t,e,r,n))return!1;return!0}case i4:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),u=Array.from(e.values());for(let l=0;l<c.length;l++){const f=c[l],p=u.findIndex(d=>Ni(f,d,void 0,t,e,r,n));if(p===-1)return!1;u.splice(p,1)}return!0}case s4:case l4:case f4:case h4:case d4:case p4:case g4:case y4:case w4:case m4:case b4:case E4:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!Ni(t[c],e[c],c,t,e,r,n))return!1;return!0}case a4:return t.byteLength!==e.byteLength?!1:qi(new Uint8Array(t),new Uint8Array(e),r,n);case u4:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:qi(new Uint8Array(t),new Uint8Array(e),r,n);case c4:return t.name===e.name&&t.message===e.message;case hu:{if(!(qi(t.constructor,e.constructor,r,n)||gg(t)&&gg(e)))return!1;const c=[...Object.keys(t),...hg(t)],u=[...Object.keys(e),...hg(e)];if(c.length!==u.length)return!1;for(let l=0;l<c.length;l++){const f=c[l],p=t[f];if(!Object.hasOwn(e,f))return!1;const d=e[f];if(!Ni(p,d,f,t,e,r,n))return!1}return!0}default:return!1}}finally{r.delete(t),r.delete(e)}}function S4(t,e){return _4(t,e,v4)}var x4=Object.defineProperty,yg=Object.getOwnPropertySymbols,I4=Object.prototype.hasOwnProperty,A4=Object.prototype.propertyIsEnumerable,gl=(t,e,r)=>e in t?x4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wg=(t,e)=>{for(var r in e||(e={}))I4.call(e,r)&&gl(t,r,e[r]);if(yg)for(var r of yg(e))A4.call(e,r)&&gl(t,r,e[r]);return t},_t=(t,e,r)=>gl(t,typeof e!="symbol"?e+"":e,r);class $n extends Bv{constructor(e,r,n,i=yr,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,_t(this,"map",new Map),_t(this,"version",OC),_t(this,"cached",[]),_t(this,"initialized",!1),_t(this,"getKey"),_t(this,"storagePrefix",yr),_t(this,"recentlyDeleted",[]),_t(this,"recentlyDeletedLimit",200),_t(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!We(o)?this.map.set(this.getKey(o),o):Um(o)?this.map.set(o.id,o):Lm(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),_t(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),_t(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),_t(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>S4(a[c],o[c]))):this.values)),_t(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=wg(wg({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),_t(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Ut(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Ct(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:i}=de("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}const{message:n}=de("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}}var T4=Object.defineProperty,O4=(t,e,r)=>e in t?T4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ae=(t,e,r)=>O4(t,typeof e!="symbol"?e+"":e,r);class C4{constructor(e,r){this.core=e,this.logger=r,Ae(this,"name",BC),Ae(this,"version",NC),Ae(this,"events",new Yg),Ae(this,"pairings"),Ae(this,"initialized",!1),Ae(this,"storagePrefix",yr),Ae(this,"ignoredPayloadTypes",[dr]),Ae(this,"registeredMethods",[]),Ae(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Ae(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),Ae(this,"create",async n=>{this.isInitialized();const i=so(),s=await this.core.crypto.setSymKey(i),o=Ke(pe.FIVE_MINUTES),a={protocol:g1},c={topic:s,expiry:o,relay:a,active:!1,methods:n?.methods},u=tl({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:a,expiryTimestamp:o,methods:n?.methods});return this.events.emit(mn.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:n?.transportType,internal:n?.internal}),{topic:s,uri:u}}),Ae(this,"pair",async n=>{this.isInitialized();const i=this.core.eventClient.createEvent({properties:{topic:n?.uri,trace:[lr.pairing_started]}});this.isValidPair(n,i);const{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:u}=el(n.uri);i.props.properties.topic=s,i.addTrace(lr.pairing_uri_validation_success),i.addTrace(lr.pairing_uri_not_expired);let l;if(this.pairings.keys.includes(s)){if(l=this.pairings.get(s),i.addTrace(lr.existing_pairing),l.active)throw i.setError(Ir.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);i.addTrace(lr.pairing_not_expired)}const f=c||Ke(pe.FIVE_MINUTES),p={topic:s,relay:a,expiry:f,active:!1,methods:u};this.core.expirer.set(s,f),await this.pairings.set(s,p),i.addTrace(lr.store_new_pairing),n.activatePairing&&await this.activate({topic:s}),this.events.emit(mn.create,p),i.addTrace(lr.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),i.addTrace(lr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(Ir.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(d){throw i.setError(Ir.subscribe_pairing_topic_failure),d}return i.addTrace(lr.subscribe_pairing_topic_success),p}),Ae(this,"activate",async({topic:n})=>{this.isInitialized();const i=Ke(pe.FIVE_MINUTES);this.core.expirer.set(n,i),await this.pairings.update(n,{active:!0,expiry:i})}),Ae(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Wr();this.events.once(Be("pairing_ping",s),({error:u})=>{u?c(u):a()}),await o()}}),Ae(this,"updateExpiry",async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})}),Ae(this,"updateMetadata",async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})}),Ae(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Ae(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",ke("USER_DISCONNECTED")),await this.deletePairing(i))}),Ae(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:i,relay:s,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(i);return tl({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),Ae(this,"sendRequest",async(n,i,s)=>{const o=Rr(i,s),a=await this.core.crypto.encode(n,o),c=Ii[i].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),Ae(this,"sendResult",async(n,i,s)=>{const o=ao(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,u=Ii[c].res;await this.core.relayer.publish(i,a,u),await this.core.history.resolve(o)}),Ae(this,"sendError",async(n,i,s)=>{const o=Tf(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,u=Ii[c]?Ii[c].res:Ii.unregistered_method.res;await this.core.relayer.publish(i,a,u),await this.core.history.resolve(o)}),Ae(this,"deletePairing",async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,ke("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])}),Ae(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(i=>Or(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))}),Ae(this,"onRelayEventRequest",async n=>{const{topic:i,payload:s}=n;switch(s.method){case"wc_pairingPing":return await this.onPairingPingRequest(i,s);case"wc_pairingDelete":return await this.onPairingDeleteRequest(i,s);default:return await this.onUnknownRpcMethodRequest(i,s)}}),Ae(this,"onRelayEventResponse",async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;return o==="wc_pairingPing"?this.onPairingPingResponse(i,s):this.onUnknownRpcMethodResponse(o)}),Ae(this,"onPairingPingRequest",async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit(mn.ping,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),Ae(this,"onPairingPingResponse",(n,i)=>{const{id:s}=i;setTimeout(()=>{hr(i)?this.events.emit(Be("pairing_ping",s),{}):qt(i)&&this.events.emit(Be("pairing_ping",s),{error:i.error})},500)}),Ae(this,"onPairingDeleteRequest",async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(mn.delete,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),Ae(this,"onUnknownRpcMethodRequest",async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=ke("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,a),this.logger.error(a)}catch(a){await this.sendError(s,n,a),this.logger.error(a)}}),Ae(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(ke("WC_METHOD_UNSUPPORTED",n))}),Ae(this,"isValidPair",(n,i)=>{var s;if(!yt(n)){const{message:a}=de("MISSING_OR_INVALID",`pair() params: ${n}`);throw i.setError(Ir.malformed_pairing_uri),new Error(a)}if(!Pm(n.uri)){const{message:a}=de("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw i.setError(Ir.malformed_pairing_uri),new Error(a)}const o=el(n?.uri);if(!((s=o?.relay)!=null&&s.protocol)){const{message:a}=de("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(Ir.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=de("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(Ir.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&pe.toMiliseconds(o?.expiryTimestamp)<Date.now()){i.setError(Ir.pairing_expired);const{message:a}=de("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Ae(this,"isValidPing",async n=>{if(!yt(n)){const{message:s}=de("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),Ae(this,"isValidDisconnect",async n=>{if(!yt(n)){const{message:s}=de("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),Ae(this,"isValidPairingTopic",async n=>{if(!ze(n,!1)){const{message:i}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(Or(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=de("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}}),this.core=e,this.logger=Ut(r,this.name),this.pairings=new $n(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ct(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(je.message,async e=>{const{topic:r,message:n,transportType:i}=e;if(this.pairings.keys.includes(r)&&i!==$e.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const s=await this.core.crypto.decode(r,n);Of(s)?(this.core.history.set(r,s),await this.onRelayEventRequest({topic:r,payload:s})):Po(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id)),await this.core.relayer.messages.ack(r,n)}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(Ft.expired,async e=>{const{topic:r}=Ql(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(mn.expire,{topic:r}))})}}var R4=Object.defineProperty,D4=(t,e,r)=>e in t?R4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,nt=(t,e,r)=>D4(t,typeof e!="symbol"?e+"":e,r);class B4 extends Ov{constructor(e,r){super(e,r),this.core=e,this.logger=r,nt(this,"records",new Map),nt(this,"events",new ir.EventEmitter),nt(this,"name",PC),nt(this,"version",UC),nt(this,"cached",[]),nt(this,"initialized",!1),nt(this,"storagePrefix",yr),nt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),nt(this,"set",(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s,expiry:Ke(pe.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Gt.created,o)}),nt(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=qt(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.persist(),this.events.emit(Gt.updated,i))}),nt(this,"get",async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i))),nt(this,"delete",(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(Gt.deleted,s)}}),this.persist()}),nt(this,"exists",async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1)),nt(this,"on",(n,i)=>{this.events.on(n,i)}),nt(this,"once",(n,i)=>{this.events.once(n,i)}),nt(this,"off",(n,i)=>{this.events.off(n,i)}),nt(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=Ut(r,this.name)}get context(){return Ct(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Rr(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=de("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Gt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Gt.created,e=>{const r=Gt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Gt.updated,e=>{const r=Gt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Gt.deleted,e=>{const r=Gt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(Bn.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{pe.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(Gt.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}}var N4=Object.defineProperty,P4=(t,e,r)=>e in t?N4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lt=(t,e,r)=>P4(t,typeof e!="symbol"?e+"":e,r);class U4 extends Pv{constructor(e,r){super(e,r),this.core=e,this.logger=r,lt(this,"expirations",new Map),lt(this,"events",new ir.EventEmitter),lt(this,"name",LC),lt(this,"version",MC),lt(this,"cached",[]),lt(this,"initialized",!1),lt(this,"storagePrefix",yr),lt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),lt(this,"has",n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}}),lt(this,"set",(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(Ft.created,{target:s,expiration:o})}),lt(this,"get",n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)}),lt(this,"del",n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(Ft.deleted,{target:i,expiration:s})}}),lt(this,"on",(n,i)=>{this.events.on(n,i)}),lt(this,"once",(n,i)=>{this.events.once(n,i)}),lt(this,"off",(n,i)=>{this.events.off(n,i)}),lt(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=Ut(r,this.name)}get context(){return Ct(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Hy(e);if(typeof e=="number")return Ky(e);const{message:r}=de("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ft.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=de("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;pe.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Ft.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Bn.pulse,()=>this.checkExpirations()),this.events.on(Ft.created,e=>{const r=Ft.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Ft.expired,e=>{const r=Ft.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Ft.deleted,e=>{const r=Ft.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}}var L4=Object.defineProperty,M4=(t,e,r)=>e in t?L4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,He=(t,e,r)=>M4(t,typeof e!="symbol"?e+"":e,r);class $4 extends Uv{constructor(e,r,n){super(e,r,n),this.core=e,this.logger=r,this.store=n,He(this,"name",$C),He(this,"abortController"),He(this,"isDevEnv"),He(this,"verifyUrlV3",kC),He(this,"storagePrefix",yr),He(this,"version",p1),He(this,"publicKey"),He(this,"fetchPromise"),He(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&pe.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),He(this,"register",async i=>{if(!Pn()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=i,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const u=pr.getDocument(),l=this.startAbortTimer(pe.ONE_SECOND*5),f=await new Promise((p,d)=>{const h=()=>{window.removeEventListener("message",m),u.body.removeChild(g),d("attestation aborted")};this.abortController.signal.addEventListener("abort",h);const g=u.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",h,{signal:this.abortController.signal});const m=y=>{if(y.data&&typeof y.data=="string")try{const S=JSON.parse(y.data);if(S.type==="verify_attestation"){if(xu(S.attestation).payload.id!==o)return;clearInterval(l),u.body.removeChild(g),this.abortController.signal.removeEventListener("abort",h),window.removeEventListener("message",m),p(S.attestation===null?"":S.attestation)}}catch(S){this.logger.warn(S)}};u.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug(f,"jwt attestation"),f}catch(u){this.logger.warn(u)}return""}),He(this,"resolve",async i=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=i;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(xu(s).payload.id!==a)return;const u=await this.isValidJwtAttestation(s);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!o)return;const c=this.getVerifyUrl(i?.verifyUrl);return this.fetchAttestation(o,c)}),He(this,"fetchAttestation",async(i,s)=>{this.logger.debug(`resolving attestation: ${i} from url: ${s}`);const o=this.startAbortTimer(pe.ONE_SECOND*5),a=await fetch(`${s}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),He(this,"getVerifyUrl",i=>{let s=i||ki;return qC.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${ki}`),s=ki),s}),He(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const i=this.startAbortTimer(pe.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await s.json()}catch(i){this.logger.warn(i)}}),He(this,"persistPublicKey",async i=>{this.logger.debug(i,"persisting public key to local storage"),await this.store.setItem(this.storeKey,i),this.publicKey=i}),He(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),He(this,"isValidJwtAttestation",async i=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(i,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),He(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),He(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const i=await this.fetchPromise;return this.fetchPromise=void 0,i}),He(this,"validateAttestation",(i,s)=>{const o=bm(i,s.publicKey),a={hasExpired:pe.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Ut(r,this.name),this.abortController=new AbortController,this.isDevEnv=_o(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Ct(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),pe.toMiliseconds(e))}}var F4=Object.defineProperty,k4=(t,e,r)=>e in t?F4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mg=(t,e,r)=>k4(t,typeof e!="symbol"?e+"":e,r);class q4 extends Lv{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,mg(this,"context",jC),mg(this,"registerDeviceToken",async n=>{const{clientId:i,token:s,notificationType:o,enableEncrypted:a=!1}=n,c=`${zC}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:s,always_raw:a})})}),this.logger=Ut(r,this.context)}}var j4=Object.defineProperty,bg=Object.getOwnPropertySymbols,z4=Object.prototype.hasOwnProperty,V4=Object.prototype.propertyIsEnumerable,yl=(t,e,r)=>e in t?j4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Oi=(t,e)=>{for(var r in e||(e={}))z4.call(e,r)&&yl(t,r,e[r]);if(bg)for(var r of bg(e))V4.call(e,r)&&yl(t,r,e[r]);return t},Ze=(t,e,r)=>yl(t,typeof e!="symbol"?e+"":e,r);class H4 extends Mv{constructor(e,r,n=!0){super(e,r,n),this.core=e,this.logger=r,Ze(this,"context",HC),Ze(this,"storagePrefix",yr),Ze(this,"storageVersion",VC),Ze(this,"events",new Map),Ze(this,"shouldPersist",!1),Ze(this,"init",async()=>{if(!_o())try{const i={eventId:Mu(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Zl(this.core.relayer.protocol,this.core.relayer.version,cl)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),Ze(this,"createEvent",i=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=i,u=Mu(),l=this.core.projectId||"",f=Date.now(),p=Oi({eventId:u,timestamp:f,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:l,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,p),this.shouldPersist=!0),p}),Ze(this,"getEvent",i=>{const{eventId:s,topic:o}=i;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Oi(Oi({},a),this.setMethods(a.eventId))}),Ze(this,"deleteEvent",i=>{const{eventId:s}=i;this.events.delete(s),this.shouldPersist=!0}),Ze(this,"setEventListeners",()=>{this.core.heartbeat.on(Bn.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{pe.fromMiliseconds(Date.now())-pe.fromMiliseconds(i.timestamp)>KC&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),Ze(this,"setMethods",i=>({addTrace:s=>this.addTrace(i,s),setError:s=>this.setError(i,s)})),Ze(this,"addTrace",(i,s)=>{const o=this.events.get(i);o&&(o.props.properties.trace.push(s),this.events.set(i,o),this.shouldPersist=!0)}),Ze(this,"setError",(i,s)=>{const o=this.events.get(i);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),Ze(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Ze(this,"restore",async()=>{try{const i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(s=>{this.events.set(s.eventId,Oi(Oi({},s),this.setMethods(s.eventId)))})}catch(i){this.logger.warn(i)}}),Ze(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const i=[];for(const[s,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(const s of i)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),Ze(this,"sendEvent",async i=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${WC}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${cl}${s}`,{method:"POST",body:JSON.stringify(i)})}),Ze(this,"getAppDomain",()=>Xl().url),this.logger=Ut(r,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var K4=Object.defineProperty,Eg=Object.getOwnPropertySymbols,W4=Object.prototype.hasOwnProperty,G4=Object.prototype.propertyIsEnumerable,wl=(t,e,r)=>e in t?K4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vg=(t,e)=>{for(var r in e||(e={}))W4.call(e,r)&&wl(t,r,e[r]);if(Eg)for(var r of Eg(e))G4.call(e,r)&&wl(t,r,e[r]);return t},Le=(t,e,r)=>wl(t,typeof e!="symbol"?e+"":e,r);class Cf extends xv{constructor(e){var r;super(e),Le(this,"protocol",d1),Le(this,"version",p1),Le(this,"name",al),Le(this,"relayUrl"),Le(this,"projectId"),Le(this,"customStoragePrefix"),Le(this,"events",new ir.EventEmitter),Le(this,"logger"),Le(this,"heartbeat"),Le(this,"relayer"),Le(this,"crypto"),Le(this,"storage"),Le(this,"history"),Le(this,"expirer"),Le(this,"pairing"),Le(this,"verify"),Le(this,"echoClient"),Le(this,"linkModeSupportedApps"),Le(this,"eventClient"),Le(this,"initialized",!1),Le(this,"logChunkController"),Le(this,"on",(a,c)=>this.events.on(a,c)),Le(this,"once",(a,c)=>this.events.once(a,c)),Le(this,"off",(a,c)=>this.events.off(a,c)),Le(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Le(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:u})=>{if(!a||!c)return;const l={topic:a,message:c,publishedAt:Date.now(),transportType:$e.link_mode};this.relayer.onLinkMessageEvent(l,{sessionExists:u})});const n=this.getGlobalCore(e?.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||y1,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=wv({level:typeof e?.logger=="string"&&e.logger?e.logger:pC.logger,name:al}),{logger:s,chunkLoggerController:o}=r0({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Ut(s,this.name),this.heartbeat=new dE,this.crypto=new _D(this,this.logger,e?.keychain),this.history=new B4(this,this.logger),this.expirer=new U4(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new YE(vg(vg({},gC),e?.storageOptions)),this.relayer=new YD({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new C4(this,this.logger),this.verify=new $4(this,this.logger,this.storage),this.echoClient=new q4(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new H4(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const r=new Cf(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(CC,n),r}get context(){return Ct(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Qp,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Qp)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${e}`,n=`${r}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[r]}catch(r){console.warn("Failed to get global WalletConnect core",r);return}}setGlobalCore(e){var r;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((r=e.opts)==null?void 0:r.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&dC.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}}const Y4=Cf,Rf="wc",Df=2,Bf="client",Lo=`${Rf}@${Df}:${Bf}:`,$s={name:Bf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},X4={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire",session_authenticate:"session_authenticate",session_request_expire:"session_request_expire",session_connect:"session_connect"},Z4={database:":memory:"},ml="WALLETCONNECT_DEEPLINK_CHOICE",J4={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Q4="history",eB="0.3",C1="proposal",tB=pe.THIRTY_DAYS,bl="Proposal expired",R1="session",yn=pe.SEVEN_DAYS,D1="engine",Qe={wc_sessionPropose:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1114},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:pe.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:pe.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1119}}},Fs={min:pe.FIVE_MINUTES,max:pe.SEVEN_DAYS},Qt={idle:"IDLE",active:"ACTIVE"},B1={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},N1="request",P1=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],U1="wc",rB=1.5,L1="auth",M1="authKeys",$1="pairingTopics",F1="requests",fs=`${U1}@${1.5}:${L1}:`,ji=`${fs}:PUB_KEY`;var nB=Object.defineProperty,iB=Object.defineProperties,sB=Object.getOwnPropertyDescriptors,_g=Object.getOwnPropertySymbols,oB=Object.prototype.hasOwnProperty,aB=Object.prototype.propertyIsEnumerable,El=(t,e,r)=>e in t?nB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ne=(t,e)=>{for(var r in e||(e={}))oB.call(e,r)&&El(t,r,e[r]);if(_g)for(var r of _g(e))aB.call(e,r)&&El(t,r,e[r]);return t},ft=(t,e)=>iB(t,sB(e)),fe=(t,e,r)=>El(t,typeof e!="symbol"?e+"":e,r);class cB extends qv{constructor(e){super(e),fe(this,"name",D1),fe(this,"events",new Yg),fe(this,"initialized",!1),fe(this,"requestQueue",{state:Qt.idle,queue:[]}),fe(this,"sessionRequestQueue",{state:Qt.idle,queue:[]}),fe(this,"emittedSessionRequests",new tw({limit:500})),fe(this,"requestQueueDelay",pe.ONE_SECOND),fe(this,"expectedPairingMethodMap",new Map),fe(this,"recentlyDeletedMap",new Map),fe(this,"recentlyDeletedLimit",200),fe(this,"relayMessageCache",[]),fe(this,"pendingSessions",new Map),fe(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Qe)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},pe.toMiliseconds(this.requestQueueDelay)))}),fe(this,"connect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=ft(Ne({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n),n.optionalNamespaces=Cm(n.requiredNamespaces,n.optionalNamespaces),n.requiredNamespaces={};const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:u}=n;let l=i,f,p=!1;try{if(l){const A=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),p=A.active}}catch(A){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),A}if(!l||!p){const{topic:A,uri:B}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});l=A,f=B}if(!l){const{message:A}=de("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(A)}const d=await this.client.core.crypto.generateKeyPair(),h=Qe.wc_sessionPropose.req.ttl||pe.FIVE_MINUTES,g=Ke(h),m=ft(Ne(Ne({requiredNamespaces:s,optionalNamespaces:o,relays:u??[{protocol:g1}],proposer:{publicKey:d,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:l},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:fr()}),y=Be("session_connect",m.id),{reject:S,resolve:b,done:x}=Wr(h,bl),I=({id:A})=>{A===m.id&&(this.client.events.off("proposal_expire",I),this.pendingSessions.delete(m.id),this.events.emit(y,{error:{message:bl,code:0}}))};return this.client.events.on("proposal_expire",I),this.events.once(y,({error:A,session:B})=>{this.client.events.off("proposal_expire",I),A?S(A):B&&b(B)}),await this.sendProposeSession({proposal:m,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:m.id}}}),await this.setProposal(m.id,m),{uri:f,approval:x}}),fe(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(n){throw this.client.logger.error("pair() failed"),n}}),fe(this,"approve",async r=>{var n,i,s;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=r?.id)==null?void 0:n.toString(),trace:[Yt.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(N){throw o.setError(dn.no_internet_connection),N}try{await this.isValidProposalId(r?.id)}catch(N){throw this.client.logger.error(`approve() -> proposal.get(${r?.id}) failed`),o.setError(dn.proposal_not_found),N}try{await this.isValidApprove(r)}catch(N){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(dn.session_approve_namespace_validation_failure),N}const{id:a,relayProtocol:c,namespaces:u,sessionProperties:l,scopedProperties:f,sessionConfig:p}=r,d=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:h,proposer:g,requiredNamespaces:m,optionalNamespaces:y}=d;let S=(i=this.client.core.eventClient)==null?void 0:i.getEvent({topic:h});S||(S=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:Yt.session_approve_started,properties:{topic:h,trace:[Yt.session_approve_started,Yt.session_namespaces_validation_success]}}));const b=await this.client.core.crypto.generateKeyPair(),x=g.publicKey,I=await this.client.core.crypto.generateSharedKey(b,x),A=Ne(Ne(Ne({relay:{protocol:c??"irn"},namespaces:u,controller:{publicKey:b,metadata:this.client.metadata},expiry:Ke(yn)},l&&{sessionProperties:l}),f&&{scopedProperties:f}),p&&{sessionConfig:p}),B=$e.relay;S.addTrace(Yt.subscribing_session_topic);try{await this.client.core.relayer.subscribe(I,{transportType:B,internal:{skipSubscribe:!0}})}catch(N){throw S.setError(dn.subscribe_session_topic_failure),N}S.addTrace(Yt.subscribe_session_topic_success);const P=ft(Ne({},A),{topic:I,requiredNamespaces:m,optionalNamespaces:y,pairingTopic:h,acknowledged:!1,self:A.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:b,transportType:$e.relay});await this.client.session.set(I,P),S.addTrace(Yt.store_session);try{await this.sendApproveSession({sessionTopic:I,proposal:d,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:b},sessionSettleRequest:A,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:a}}}),S.addTrace(Yt.session_approve_publish_success)}catch(N){throw this.client.logger.error(N),this.client.session.delete(I,ke("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(I),N}return this.client.core.eventClient.deleteEvent({eventId:S.eventId}),await this.client.core.pairing.updateMetadata({topic:h,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:h}),await this.setExpiry(I,Ke(yn)),{topic:I,acknowledged:()=>Promise.resolve(this.client.session.get(I))}}),fe(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:i}=r;let s;try{s=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}s&&await this.sendError({id:n,topic:s,error:i,rpcOpts:Qe.wc_sessionPropose.reject}),await this.deleteProposal(n)}),fe(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(f){throw this.client.logger.error("update() -> isValidUpdate() failed"),f}const{topic:n,namespaces:i}=r,{done:s,resolve:o,reject:a}=Wr(),c=fr(),u=en().toString(),l=this.client.session.get(n).namespaces;return this.events.once(Be("session_update",c),({error:f})=>{f?a(f):o()}),await this.client.session.update(n,{namespaces:i}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:u}).catch(f=>{this.client.logger.error(f),this.client.session.update(n,{namespaces:l}),a(f)}),{acknowledged:s}}),fe(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=r,i=fr(),{done:s,resolve:o,reject:a}=Wr();return this.events.once(Be("session_extend",i),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,Ke(yn)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:s}}),fe(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}const{chainId:n,request:i,topic:s,expiry:o=Qe.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(s);a?.transportType===$e.relay&&await this.confirmOnlineStateOrThrow();const c=fr(),u=en().toString(),{done:l,resolve:f,reject:p}=Wr(o,"Request expired. Please try again.");this.events.once(Be("session_request",c),({error:m,result:y})=>{m?p(m):f(y)});const d="wc_sessionRequest",h=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(h)return await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:s,method:d,params:{request:ft(Ne({},i),{expiryTimestamp:Ke(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:h}).catch(m=>p(m)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:n,id:c}),await l();const g={request:ft(Ne({},i),{expiryTimestamp:Ke(o)}),chainId:n};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:s,method:d,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(y=>p(y)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:n,id:c}),m()}),new Promise(async m=>{var y;if(!((y=a.sessionConfig)!=null&&y.disableDeepLink)){const S=await Xy(this.client.core.storage,ml);await Wy({id:c,topic:s,wcDeepLink:S})}m()}),l()]).then(m=>m[2])}),fe(this,"respond",async r=>{var n,i;this.isInitialized();const s=this.client.core.eventClient.createEvent({properties:{topic:r?.topic||((i=(n=r?.response)==null?void 0:n.id)==null?void 0:i.toString()),trace:[Yt.session_request_response_started]}});try{await this.isValidRespond(r)}catch(f){throw s.addTrace(f?.message),s.setError(dn.session_request_response_validation_failure),f}s.addTrace(Yt.session_request_response_validation_success);const{topic:o,response:a}=r,{id:c}=a,u=this.client.session.get(o);u.transportType===$e.relay&&await this.confirmOnlineStateOrThrow();const l=this.getAppLinkIfEnabled(u.peer.metadata,u.transportType);try{s.addTrace(Yt.session_request_response_publish_started),hr(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:l}):qt(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:l}),this.cleanupAfterResponse(r)}catch(f){throw s.addTrace(f?.message),s.setError(dn.session_request_response_publish_failure),f}}),fe(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(i){throw this.client.logger.error("ping() -> isValidPing() failed"),i}const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=fr(),s=en().toString(),{done:o,resolve:a,reject:c}=Wr();this.events.once(Be("session_ping",i),({error:u})=>{u?c(u):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:i,relayRpcId:s}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),fe(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:n,event:i,chainId:s}=r,o=en().toString(),a=fr();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:i,chainId:s},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),fe(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:n}=r;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:ke("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:i}=de("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(i)}}),fe(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(n=>Bm(n,r)))),fe(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),fe(this,"authenticate",async(r,n)=>{var i;this.isInitialized(),this.isValidAuthenticate(r);const s=n&&this.client.core.linkModeSupportedApps.includes(n)&&((i=this.client.metadata.redirect)==null?void 0:i.linkMode),o=s?$e.link_mode:$e.relay;o===$e.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:u,domain:l,nonce:f,type:p,exp:d,nbf:h,methods:g=[],expiry:m}=r,y=[...r.resources||[]],{topic:S,uri:b}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:S,uri:b}});const x=await this.client.core.crypto.generateKeyPair(),I=Mi(x);if(await Promise.all([this.client.auth.authKeys.set(ji,{responseTopic:I,publicKey:x}),this.client.auth.pairingTopics.set(I,{topic:I,pairingTopic:S})]),await this.client.core.relayer.subscribe(I,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${S}`),g.length>0){const{namespace:k}=Zn(a[0]);let X=Bw(k,"request",g);In(y)&&(X=Nw(X,y.pop())),y.push(X)}const A=m&&m>Qe.wc_sessionAuthenticate.req.ttl?m:Qe.wc_sessionAuthenticate.req.ttl,B={authPayload:{type:p??"caip122",chains:a,statement:c,aud:u,domain:l,version:"1",nonce:f,iat:new Date().toISOString(),exp:d,nbf:h,resources:y},requester:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:Ke(A)},P={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},N={requiredNamespaces:{},optionalNamespaces:P,relays:[{protocol:"irn"}],pairingTopic:S,proposer:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:Ke(Qe.wc_sessionPropose.req.ttl),id:fr()},{done:$,resolve:G,reject:q}=Wr(A,"Request expired"),L=fr(),j=Be("session_connect",N.id),T=Be("session_request",L),D=async({error:k,session:X})=>{this.events.off(T,F),k?q(k):X&&G({session:X})},F=async k=>{var X,ee,te;if(await this.deletePendingAuthRequest(L,{message:"fulfilled",code:0}),k.error){const oe=ke("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return k.error.code===oe.code?void 0:(this.events.off(j,D),q(k.error.message))}await this.deleteProposal(N.id),this.events.off(j,D);const{cacaos:le,responder:z}=k.result,ce=[],W=[];for(const oe of le){await ku({cacao:oe,projectId:this.client.core.projectId})||(this.client.logger.error(oe,"Signature verification failed"),q(ke("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:C}=oe,_=In(C.resources),v=[to(C.iss)],R=Xi(C.iss);if(_){const U=qu(_),Y=ju(_);ce.push(...U),v.push(...Y)}for(const U of v)W.push(`${U}:${R}`)}const V=await this.client.core.crypto.generateSharedKey(x,z.publicKey);let re;ce.length>0&&(re={topic:V,acknowledged:!0,self:{publicKey:x,metadata:this.client.metadata},peer:z,controller:z.publicKey,expiry:Ke(yn),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:S,namespaces:rl([...new Set(ce)],[...new Set(W)]),transportType:o},await this.client.core.relayer.subscribe(V,{transportType:o}),await this.client.session.set(V,re),S&&await this.client.core.pairing.updateMetadata({topic:S,metadata:z.metadata}),re=this.client.session.get(V)),(X=this.client.metadata.redirect)!=null&&X.linkMode&&(ee=z.metadata.redirect)!=null&&ee.linkMode&&(te=z.metadata.redirect)!=null&&te.universal&&n&&(this.client.core.addLinkModeSupportedApp(z.metadata.redirect.universal),this.client.session.update(V,{transportType:$e.link_mode})),G({auths:le,session:re})};this.events.once(j,D),this.events.once(T,F);let K;try{if(s){const k=Rr("wc_sessionAuthenticate",B,L);this.client.core.history.set(S,k);const X=await this.client.core.crypto.encode("",k,{type:fi,encoding:Br});K=Bi(n,S,X)}else await Promise.all([this.sendRequest({topic:S,method:"wc_sessionAuthenticate",params:B,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:L}),this.sendRequest({topic:S,method:"wc_sessionPropose",params:N,expiry:Qe.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:N.id})])}catch(k){throw this.events.off(j,D),this.events.off(T,F),k}return await this.setProposal(N.id,N),await this.setAuthRequest(L,{request:ft(Ne({},B),{verifyContext:{}}),pairingTopic:S,transportType:o}),{uri:K??b,response:$}}),fe(this,"approveSessionAuthenticate",async r=>{const{id:n,auths:i}=r,s=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[pn.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw s.setError(Ai.no_internet_connection),m}const o=this.getPendingAuthRequest(n);if(!o)throw s.setError(Ai.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||$e.relay;a===$e.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),l=Mi(c),f={type:dr,receiverPublicKey:c,senderPublicKey:u},p=[],d=[];for(const m of i){if(!await ku({cacao:m,projectId:this.client.core.projectId})){s.setError(Ai.invalid_cacao);const I=ke("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:l,error:I,encodeOpts:f}),new Error(I.message)}s.addTrace(pn.cacaos_verified);const{p:y}=m,S=In(y.resources),b=[to(y.iss)],x=Xi(y.iss);if(S){const I=qu(S),A=ju(S);p.push(...I),b.push(...A)}for(const I of b)d.push(`${I}:${x}`)}const h=await this.client.core.crypto.generateSharedKey(u,c);s.addTrace(pn.create_authenticated_session_topic);let g;if(p?.length>0){g={topic:h,acknowledged:!0,self:{publicKey:u,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Ke(yn),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:rl([...new Set(p)],[...new Set(d)]),transportType:a},s.addTrace(pn.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(h,{transportType:a})}catch(m){throw s.setError(Ai.subscribe_authenticated_session_topic_failure),m}s.addTrace(pn.subscribe_authenticated_session_topic_success),await this.client.session.set(h,g),s.addTrace(pn.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}s.addTrace(pn.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:n,result:{cacaos:i,responder:{publicKey:u,metadata:this.client.metadata}},encodeOpts:f,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw s.setError(Ai.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:g}}),fe(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();const{id:n,reason:i}=r,s=this.getPendingAuthRequest(n);if(!s)throw new Error(`Could not find pending auth request with id ${n}`);s.transportType===$e.relay&&await this.confirmOnlineStateOrThrow();const o=s.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Mi(o),u={type:dr,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:i,encodeOpts:u,rpcOpts:Qe.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.deleteProposal(n)}),fe(this,"formatAuthMessage",r=>{this.isInitialized();const{request:n,iss:i}=r;return cf(n,i)}),fe(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),fe(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter(s=>{var o,a;return((o=s.peerMetadata)==null?void 0:o.url)&&((a=s.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&s.topic&&s.topic!==n.topic});if(i.length===0)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),fe(this,"deleteSession",async r=>{var n;const{topic:i,expirerHasDeleted:s=!1,emitEvent:o=!0,id:a=0}=r,{self:c}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),await this.client.session.delete(i,ke("USER_DISCONNECTED")),this.addToRecentlyDeleted(i,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),s||this.client.core.expirer.del(i),this.client.core.storage.removeItem(ml).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===i&&this.deletePendingSessionRequest(u.id,ke("USER_DISCONNECTED"))}),i===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=Qt.idle),o&&this.client.events.emit("session_delete",{id:a,topic:i})}),fe(this,"deleteProposal",async(r,n)=>{if(n)try{const i=this.client.proposal.get(r);this.client.core.eventClient.getEvent({topic:i.pairingTopic})?.setError(dn.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,ke("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),fe(this,"deletePendingSessionRequest",async(r,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==r),i&&(this.sessionRequestQueue.state=Qt.idle,this.client.events.emit("session_request_expire",{id:r}))}),fe(this,"deletePendingAuthRequest",async(r,n,i=!1)=>{await Promise.all([this.client.auth.requests.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)])}),fe(this,"setExpiry",async(r,n)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,n),await this.client.session.update(r,{expiry:n}))}),fe(this,"setProposal",async(r,n)=>{this.client.core.expirer.set(r,Ke(Qe.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,n)}),fe(this,"setAuthRequest",async(r,n)=>{const{request:i,pairingTopic:s,transportType:o=$e.relay}=n;this.client.core.expirer.set(r,i.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:r,pairingTopic:s,verifyContext:i.verifyContext,transportType:o})}),fe(this,"setPendingSessionRequest",async r=>{const{id:n,topic:i,params:s,verifyContext:o}=r,a=s.request.expiryTimestamp||Ke(Qe.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:i,params:s,verifyContext:o})}),fe(this,"sendRequest",async r=>{const{topic:n,method:i,params:s,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:u,appLink:l,tvf:f,publishOpts:p={}}=r,d=Rr(i,s,c);let h;const g=!!l;try{const S=g?Br:wt;h=await this.client.core.crypto.encode(n,d,{encoding:S})}catch(S){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),S}let m;if(P1.includes(i)){const S=Pt(JSON.stringify(d)),b=Pt(h);m=await this.client.core.verify.register({id:b,decryptedId:S})}const y=Ne(Ne({},Qe[i].req),p);if(y.attestation=m,o&&(y.ttl=o),a&&(y.id=a),this.client.core.history.set(n,d),g){const S=Bi(l,n,h);await global.Linking.openURL(S,this.client.name)}else y.tvf=ft(Ne({},f),{correlationId:d.id}),u?(y.internal=ft(Ne({},y.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,h,y)):this.client.core.relayer.publish(n,h,y).catch(S=>this.client.logger.error(S));return d.id}),fe(this,"sendProposeSession",async r=>{const{proposal:n,publishOpts:i}=r,s=Rr("wc_sessionPropose",n,n.id);this.client.core.history.set(n.pairingTopic,s);const o=await this.client.core.crypto.encode(n.pairingTopic,s,{encoding:wt}),a=Pt(JSON.stringify(s)),c=Pt(o),u=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:n.pairingTopic,sessionProposal:o},opts:ft(Ne({},i),{publishMethod:"wc_proposeSession",attestation:u})})}),fe(this,"sendApproveSession",async r=>{const{sessionTopic:n,pairingProposalResponse:i,proposal:s,sessionSettleRequest:o,publishOpts:a}=r,c=ao(s.id,i),u=await this.client.core.crypto.encode(s.pairingTopic,c,{encoding:wt}),l=Rr("wc_sessionSettle",o,a?.id),f=await this.client.core.crypto.encode(n,l,{encoding:wt});this.client.core.history.set(n,l),await this.client.core.relayer.publishCustom({payload:{sessionTopic:n,pairingTopic:s.pairingTopic,sessionProposalResponse:u,sessionSettlementRequest:f},opts:ft(Ne({},a),{publishMethod:"wc_approveSession"})})}),fe(this,"sendResult",async r=>{const{id:n,topic:i,result:s,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=r,u=ao(n,s);let l;const f=c&&typeof(global==null?void 0:global.Linking)<"u";try{const h=f?Br:wt;l=await this.client.core.crypto.encode(i,u,ft(Ne({},a||{}),{encoding:h}))}catch(h){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${i} failed`),h}let p,d;try{p=await this.client.core.history.get(i,n);const h=p.request;try{d=this.getTVFParams(n,h.params,s)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g?.message}`)}}catch(h){throw this.client.logger.error(`sendResult() -> history.get(${i}, ${n}) failed`),h}if(f){const h=Bi(c,i,l);await global.Linking.openURL(h,this.client.name)}else{const h=p.request.method,g=Qe[h].res;g.tvf=ft(Ne({},d),{correlationId:n}),o?(g.internal=ft(Ne({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,l,g)):this.client.core.relayer.publish(i,l,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(u)}),fe(this,"sendError",async r=>{const{id:n,topic:i,error:s,encodeOpts:o,rpcOpts:a,appLink:c}=r,u=Tf(n,s);let l;const f=c&&typeof(global==null?void 0:global.Linking)<"u";try{const d=f?Br:wt;l=await this.client.core.crypto.encode(i,u,ft(Ne({},o||{}),{encoding:d}))}catch(d){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${i} failed`),d}let p;try{p=await this.client.core.history.get(i,n)}catch(d){throw this.client.logger.error(`sendError() -> history.get(${i}, ${n}) failed`),d}if(f){const d=Bi(c,i,l);await global.Linking.openURL(d,this.client.name)}else{const d=p.request.method,h=a||Qe[d].res;this.client.core.relayer.publish(i,l,h)}await this.client.core.history.resolve(u)}),fe(this,"cleanup",async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{let s=!1;Or(i.expiry)&&(s=!0),this.client.core.crypto.keychain.has(i.topic)||(s=!0),s&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{Or(i.expiryTimestamp)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession({topic:i})),...n.map(i=>this.deleteProposal(i))])}),fe(this,"onProviderMessageEvent",async r=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(r):await this.onRelayMessage(r)}),fe(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),fe(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Qt.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Qt.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=Qt.idle}),fe(this,"processRequest",async r=>{const{topic:n,payload:i,attestation:s,transportType:o,encryptedId:a}=r,c=i.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:i,attestation:s,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,i);case"wc_sessionPing":return await this.onSessionPingRequest(n,i);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:i,attestation:s,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,i);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:i,attestation:s,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),fe(this,"onRelayEventResponse",async r=>{const{topic:n,payload:i,transportType:s}=r,o=(await this.client.core.history.get(n,i.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i,s);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),fe(this,"onRelayEventUnknownPayload",r=>{const{topic:n}=r,{message:i}=de("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(i)}),fe(this,"shouldIgnorePairingRequest",r=>{const{topic:n,requestMethod:i}=r,s=this.expectedPairingMethodMap.get(n);return!s||s.includes(i)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),fe(this,"onSessionProposeRequest",async r=>{const{topic:n,payload:i,attestation:s,encryptedId:o}=r,{params:a,id:c}=i;try{const u=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),u?.setError(Ir.proposal_listener_not_found)),this.isValidConnect(Ne({},i.params));const l=a.expiryTimestamp||Ke(Qe.wc_sessionPropose.req.ttl),f=Ne({id:c,pairingTopic:n,expiryTimestamp:l,attestation:s,encryptedId:o},a);await this.setProposal(c,f);const p=await this.getVerifyContext({attestationId:s,hash:Pt(JSON.stringify(i)),encryptedId:o,metadata:f.proposer.metadata});u?.addTrace(lr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:p})}catch(u){await this.sendError({id:c,topic:n,error:u,rpcOpts:Qe.wc_sessionPropose.autoReject}),this.client.logger.error(u)}}),fe(this,"onSessionProposeResponse",async(r,n,i)=>{const{id:s}=n;if(hr(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const u=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const l=await this.client.core.crypto.generateSharedKey(c,u);this.pendingSessions.set(s,{sessionTopic:l,pairingTopic:r,proposalId:s,publicKey:c});const f=await this.client.core.relayer.subscribe(l,{transportType:i});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:f}),await this.client.core.pairing.activate({topic:r})}else if(qt(n)){await this.deleteProposal(s);const o=Be("session_connect",s);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),fe(this,"onSessionSettleRequest",async(r,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:c,namespaces:u,sessionProperties:l,scopedProperties:f,sessionConfig:p}=n.params,d=[...this.pendingSessions.values()].find(m=>m.sessionTopic===r);if(!d)return this.client.logger.error(`Pending session not found for topic ${r}`);const h=this.client.proposal.get(d.proposalId),g=ft(Ne(Ne(Ne({topic:r,relay:o,expiry:c,namespaces:u,acknowledged:!0,pairingTopic:d.pairingTopic,requiredNamespaces:h.requiredNamespaces,optionalNamespaces:h.optionalNamespaces,controller:a.publicKey,self:{publicKey:d.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},l&&{sessionProperties:l}),f&&{scopedProperties:f}),p&&{sessionConfig:p}),{transportType:$e.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:d.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(Be("session_connect",d.proposalId),{session:g}),this.pendingSessions.delete(d.proposalId),this.deleteProposal(d.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:n.id,topic:r,result:!0})}catch(o){await this.sendError({id:i,topic:r,error:o}),this.client.logger.error(o)}}),fe(this,"onSessionSettleResponse",async(r,n)=>{const{id:i}=n;hr(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Be("session_approve",i),{})):qt(n)&&(await this.client.session.delete(r,ke("USER_DISCONNECTED")),this.events.emit(Be("session_approve",i),{error:n.error}))}),fe(this,"onSessionUpdateRequest",async(r,n)=>{const{params:i,id:s}=n;try{const o=`${r}_session_update`,a=Gn.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.warn(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:r,error:ke("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Ne({topic:r},i));try{Gn.set(o,s),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult({id:s,topic:r,result:!0})}catch(c){throw Gn.delete(o),c}this.client.events.emit("session_update",{id:s,topic:r,params:i})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),fe(this,"isRequestOutOfSync",(r,n)=>n.toString().slice(0,-3)<r.toString().slice(0,-3)),fe(this,"onSessionUpdateResponse",(r,n)=>{const{id:i}=n,s=Be("session_update",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);hr(n)?this.events.emit(Be("session_update",i),{}):qt(n)&&this.events.emit(Be("session_update",i),{error:n.error})}),fe(this,"onSessionExtendRequest",async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Ke(yn)),await this.sendResult({id:i,topic:r,result:!0}),this.client.events.emit("session_extend",{id:i,topic:r})}catch(s){await this.sendError({id:i,topic:r,error:s}),this.client.logger.error(s)}}),fe(this,"onSessionExtendResponse",(r,n)=>{const{id:i}=n,s=Be("session_extend",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);hr(n)?this.events.emit(Be("session_extend",i),{}):qt(n)&&this.events.emit(Be("session_extend",i),{error:n.error})}),fe(this,"onSessionPingRequest",async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:i,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:r})}catch(s){await this.sendError({id:i,topic:r,error:s}),this.client.logger.error(s)}}),fe(this,"onSessionPingResponse",(r,n)=>{const{id:i}=n,s=Be("session_ping",i);setTimeout(()=>{if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners 2176`);hr(n)?this.events.emit(Be("session_ping",i),{}):qt(n)&&this.events.emit(Be("session_ping",i),{error:n.error})},500)}),fe(this,"onSessionDeleteRequest",async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(s=>{this.client.core.relayer.once(je.publish,async()=>{s(await this.deleteSession({topic:r,id:i}))})}),this.sendResult({id:i,topic:r,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:ke("USER_DISCONNECTED")})]).catch(s=>this.client.logger.error(s))}catch(s){this.client.logger.error(s)}}),fe(this,"onSessionRequest",async r=>{var n,i,s;const{topic:o,payload:a,attestation:c,encryptedId:u,transportType:l}=r,{id:f,params:p}=a;try{await this.isValidRequest(Ne({topic:o},p));const d=this.client.session.get(o),h=await this.getVerifyContext({attestationId:c,hash:Pt(JSON.stringify(Rr("wc_sessionRequest",p,f))),encryptedId:u,metadata:d.peer.metadata,transportType:l}),g={id:f,topic:o,params:p,verifyContext:h};await this.setPendingSessionRequest(g),l===$e.link_mode&&(n=d.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((i=d.peer.metadata.redirect)==null?void 0:i.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(d){await this.sendError({id:f,topic:o,error:d}),this.client.logger.error(d)}}),fe(this,"onSessionRequestResponse",(r,n)=>{const{id:i}=n,s=Be("session_request",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);hr(n)?this.events.emit(Be("session_request",i),{result:n.result}):qt(n)&&this.events.emit(Be("session_request",i),{error:n.error})}),fe(this,"onSessionEventRequest",async(r,n)=>{const{id:i,params:s}=n;try{const o=`${r}_session_event_${s.event.name}`,a=Gn.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.info(`Discarding out of sync request - ${i}`);return}this.isValidEmit(Ne({topic:r},s)),this.client.events.emit("session_event",{id:i,topic:r,params:s}),Gn.set(o,i)}catch(o){await this.sendError({id:i,topic:r,error:o}),this.client.logger.error(o)}}),fe(this,"onSessionAuthenticateResponse",(r,n)=>{const{id:i}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:n}),hr(n)?this.events.emit(Be("session_request",i),{result:n.result}):qt(n)&&this.events.emit(Be("session_request",i),{error:n.error})}),fe(this,"onSessionAuthenticateRequest",async r=>{var n;const{topic:i,payload:s,attestation:o,encryptedId:a,transportType:c}=r;try{const{requester:u,authPayload:l,expiryTimestamp:f}=s.params,p=await this.getVerifyContext({attestationId:o,hash:Pt(JSON.stringify(s)),encryptedId:a,metadata:u.metadata,transportType:c}),d={requester:u,pairingTopic:i,id:s.id,authPayload:l,verifyContext:p,expiryTimestamp:f};await this.setAuthRequest(s.id,{request:d,pairingTopic:i,transportType:c}),c===$e.link_mode&&(n=u.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(u.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:i,params:s.params,id:s.id,verifyContext:p})}catch(u){this.client.logger.error(u);const l=s.params.requester.publicKey,f=await this.client.core.crypto.generateKeyPair(),p=this.getAppLinkIfEnabled(s.params.requester.metadata,c),d={type:dr,receiverPublicKey:l,senderPublicKey:f};await this.sendError({id:s.id,topic:i,error:u,encodeOpts:d,rpcOpts:Qe.wc_sessionAuthenticate.autoReject,appLink:p})}}),fe(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),fe(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Qt.idle,this.processSessionRequestQueue()},pe.toMiliseconds(this.requestQueueDelay))}),fe(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:n})=>{const i=this.client.core.history.pending;i.length>0&&i.filter(s=>s.topic===r&&s.request.method==="wc_sessionRequest").forEach(s=>{const o=s.request.id,a=Be("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(Be("session_request",s.request.id),{error:n})})}),fe(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Qt.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(r)}catch(n){this.client.logger.error(n)}}),fe(this,"emitSessionRequest",r=>{if(this.emittedSessionRequests.has(r.id)){this.client.logger.warn({id:r.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${r.id}`);return}this.sessionRequestQueue.state=Qt.active,this.emittedSessionRequests.add(r.id),this.client.events.emit("session_request",r)}),fe(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const n=this.client.proposal.getAll().find(i=>i.pairingTopic===r.topic);n&&this.onSessionProposeRequest({topic:r.topic,payload:Rr("wc_sessionPropose",ft(Ne({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id),attestation:n.attestation,encryptedId:n.encryptedId})}),fe(this,"isValidConnect",async r=>{if(!yt(r)){const{message:u}=de("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(u)}const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:o,scopedProperties:a,relays:c}=r;if(We(n)||await this.isValidPairingTopic(n),!Vm(c,!0)){const{message:u}=de("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(u)}if(i&&!We(i)&&ai(i)!==0){const u="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(u):this.client.logger.warn(u),this.validateNamespaces(i,"requiredNamespaces")}if(s&&!We(s)&&ai(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),o&&!We(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!We(a)){this.validateSessionProps(a,"scopedProperties");const u=Object.keys(i||{}).concat(Object.keys(s||{}));if(!Object.keys(a).every(l=>u.includes(l.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(u)}`)}}),fe(this,"validateNamespaces",(r,n)=>{const i=zm(r,"connect()",n);if(i)throw new Error(i.message)}),fe(this,"isValidApprove",async r=>{if(!yt(r))throw new Error(de("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:s,sessionProperties:o,scopedProperties:a}=r;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),u=$i(i,"approve()");if(u)throw new Error(u.message);const l=oo(c.requiredNamespaces,i,"approve()");if(l)throw new Error(l.message);if(!ze(s,!0)){const{message:f}=de("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}if(o&&!We(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!We(a)){this.validateSessionProps(a,"scopedProperties");const f=new Set(Object.keys(i));if(!Object.keys(a).every(p=>f.has(p.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(f).join(", ")}`)}}),fe(this,"isValidReject",async r=>{if(!yt(r)){const{message:s}=de("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:n,reason:i}=r;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!Km(i)){const{message:s}=de("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}}),fe(this,"isValidSessionSettleRequest",r=>{if(!yt(r)){const{message:u}=de("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(u)}const{relay:n,controller:i,namespaces:s,expiry:o}=r;if(!xf(n)){const{message:u}=de("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}const a=Mm(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=$i(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Or(o)){const{message:u}=de("EXPIRED","onSessionSettleRequest()");throw new Error(u)}}),fe(this,"isValidUpdate",async r=>{if(!yt(r)){const{message:c}=de("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}const{topic:n,namespaces:i}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const s=this.client.session.get(n),o=$i(i,"update()");if(o)throw new Error(o.message);const a=oo(s.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)}),fe(this,"isValidExtend",async r=>{if(!yt(r)){const{message:i}=de("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),fe(this,"isValidRequest",async r=>{if(!yt(r)){const{message:c}=de("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}const{topic:n,request:i,chainId:s,expiry:o}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!il(a,s)){const{message:c}=de("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(c)}if(!Wm(i)){const{message:c}=de("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(c)}if(!Xm(a,s,i.method)){const{message:c}=de("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(c)}if(o&&!Jm(o,Fs)){const{message:c}=de("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Fs.min} and ${Fs.max}`);throw new Error(c)}}),fe(this,"isValidRespond",async r=>{var n;if(!yt(r)){const{message:a}=de("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(a)}const{topic:i,response:s}=r;try{await this.isValidSessionTopic(i)}catch(a){throw(n=r?.response)!=null&&n.id&&this.cleanupAfterResponse(r),a}if(!Gm(s)){const{message:a}=de("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(a)}const o=this.client.pendingRequest.get(s.id);if(o.topic!==i){const{message:a}=de("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${s.id}, expected topic: ${o.topic}, received topic: ${i}`);throw new Error(a)}}),fe(this,"isValidPing",async r=>{if(!yt(r)){const{message:i}=de("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),fe(this,"isValidEmit",async r=>{if(!yt(r)){const{message:a}=de("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:n,event:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!il(o,s)){const{message:a}=de("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!Ym(i)){const{message:a}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}if(!Zm(o,s,i.name)){const{message:a}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}}),fe(this,"isValidDisconnect",async r=>{if(!yt(r)){const{message:i}=de("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),fe(this,"isValidAuthenticate",r=>{const{chains:n,uri:i,domain:s,nonce:o}=r;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!ze(i,!1))throw new Error("uri is required parameter");if(!ze(s,!1))throw new Error("domain is required parameter");if(!ze(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>Zn(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=Zn(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),fe(this,"getVerifyContext",async r=>{const{attestationId:n,hash:i,encryptedId:s,metadata:o,transportType:a}=r,c={verified:{verifyUrl:o.verifyUrl||ki,validation:"UNKNOWN",origin:o.url||""}};try{if(a===$e.link_mode){const l=this.getAppLinkIfEnabled(o,a);return c.verified.validation=l&&new URL(l).origin===new URL(o.url).origin?"VALID":"INVALID",c}const u=await this.client.core.verify.resolve({attestationId:n,hash:i,encryptedId:s,verifyUrl:o.verifyUrl});u&&(c.verified.origin=u.origin,c.verified.isScam=u.isScam,c.verified.validation=u.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.warn(u)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),fe(this,"validateSessionProps",(r,n)=>{Object.values(r).forEach((i,s)=>{if(i==null){const{message:o}=de("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${i} for key ${Object.keys(r)[s]}`);throw new Error(o)}})}),fe(this,"getPendingAuthRequest",r=>{const n=this.client.auth.requests.get(r);return typeof n=="object"?n:void 0}),fe(this,"addToRecentlyDeleted",(r,n)=>{if(this.recentlyDeletedMap.set(r,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let i=0;const s=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(i++>=s)break;this.recentlyDeletedMap.delete(o)}}}),fe(this,"checkRecentlyDeleted",r=>{const n=this.recentlyDeletedMap.get(r);if(n){const{message:i}=de("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${r}`);throw new Error(i)}}),fe(this,"isLinkModeEnabled",(r,n)=>{var i,s,o,a,c,u,l,f,p;return!r||n!==$e.link_mode?!1:((s=(i=this.client.metadata)==null?void 0:i.redirect)==null?void 0:s.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((u=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:u.universal)!==""&&((l=r?.redirect)==null?void 0:l.universal)!==void 0&&((f=r?.redirect)==null?void 0:f.universal)!==""&&((p=r?.redirect)==null?void 0:p.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),fe(this,"getAppLinkIfEnabled",(r,n)=>{var i;return this.isLinkModeEnabled(r,n)?(i=r?.redirect)==null?void 0:i.universal:void 0}),fe(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const n=Lu(r,"topic")||"",i=decodeURIComponent(Lu(r,"wc_ev")||""),s=this.client.session.keys.includes(n);s&&this.client.session.update(n,{transportType:$e.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:i,sessionExists:s})}),fe(this,"registerLinkModeListeners",async()=>{var r;if(_o()||Ur()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const i=await n.getInitialURL();i&&setTimeout(()=>{this.handleLinkModeMessage({url:i})},50)}}}),fe(this,"getTVFParams",(r,n,i)=>{var s,o,a;if(!((s=n.request)!=null&&s.method))return{};const c={correlationId:r,rpcMethods:[n.request.method],chainId:n.chainId};try{const u=this.extractTxHashesFromResult(n.request,i);c.txHashes=u,c.contractAddresses=this.isValidContractData(n.request.params)?[(a=(o=n.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(u){this.client.logger.warn(u,"Error getting TVF params")}return c}),fe(this,"isValidContractData",r=>{var n;if(!r)return!1;try{const i=r?.data||((n=r?.[0])==null?void 0:n.data);if(!i.startsWith("0x"))return!1;const s=i.slice(2);return/^[0-9a-fA-F]*$/.test(s)?s.length%2===0:!1}catch{}return!1}),fe(this,"extractTxHashesFromResult",(r,n)=>{var i;try{if(!n)return[];const s=r.method,o=B1[s];if(s==="sui_signTransaction")return[bw(n.transactionBytes)];if(s==="near_signTransaction")return[$u(n)];if(s==="near_signTransactions")return n.map(c=>$u(c));if(s==="xrpl_signTransactionFor"||s==="xrpl_signTransaction")return[(i=n.tx_json)==null?void 0:i.hash];if(s==="polkadot_signTransaction")return[u1({transaction:r.params.transactionPayload,signature:n.signature})];if(s==="algo_signTxn")return On(n)?n.map(c=>Fu(c)):[Fu(n)];if(s==="cosmos_signDirect")return[vw(n)];if(s==="wallet_sendCalls")return _w(n);if(typeof n=="string")return[n];const a=n[o.key];if(On(a))return s==="solana_signAllTransactions"?a.map(c=>mw(c)):a;if(typeof a=="string")return[a]}catch(s){this.client.logger.warn(s,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,r=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,i]of Object.entries(r))for(const s of i)try{await this.onProviderMessageEvent({topic:n,message:s,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${s}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:e}=de("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(je.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:r,message:n,attestation:i,transportType:s}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(ji)?this.client.auth.authKeys.get(ji):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(r,n,{receiverPublicKey:o,encoding:s===$e.link_mode?Br:wt});Of(a)?(this.client.core.history.set(r,a),await this.onRelayEventRequest({topic:r,payload:a,attestation:i,transportType:s,encryptedId:Pt(n)})):Po(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:s}),this.client.core.history.delete(r,a.id)):await this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:s}),await this.client.core.relayer.messages.ack(r,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Ft.expired,async e=>{const{topic:r,id:n}=Ql(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,de("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,de("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(mn.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(mn.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!ze(e,!1)){const{message:r}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Or(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=de("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!ze(e,!1)){const{message:r}=de("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=de("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Or(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=de("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=de("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(ze(e,!1)){const{message:r}=de("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=de("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Hm(e)){const{message:r}=de("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=de("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Or(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=de("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class uB extends $n{constructor(e,r){super(e,r,C1,Lo),this.core=e,this.logger=r}}class k1 extends $n{constructor(e,r){super(e,r,R1,Lo),this.core=e,this.logger=r}}class lB extends $n{constructor(e,r){super(e,r,N1,Lo,n=>n.id),this.core=e,this.logger=r}}class fB extends $n{constructor(e,r){super(e,r,M1,fs,()=>ji),this.core=e,this.logger=r}}class hB extends $n{constructor(e,r){super(e,r,$1,fs),this.core=e,this.logger=r}}class dB extends $n{constructor(e,r){super(e,r,F1,fs,n=>n.id),this.core=e,this.logger=r}}var pB=Object.defineProperty,gB=(t,e,r)=>e in t?pB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,du=(t,e,r)=>gB(t,typeof e!="symbol"?e+"":e,r);class yB{constructor(e,r){this.core=e,this.logger=r,du(this,"authKeys"),du(this,"pairingTopics"),du(this,"requests"),this.authKeys=new fB(this.core,this.logger),this.pairingTopics=new hB(this.core,this.logger),this.requests=new dB(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var wB=Object.defineProperty,mB=(t,e,r)=>e in t?wB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Te=(t,e,r)=>mB(t,typeof e!="symbol"?e+"":e,r);class Mo extends kv{constructor(e){super(e),Te(this,"protocol",Rf),Te(this,"version",Df),Te(this,"name",$s.name),Te(this,"metadata"),Te(this,"core"),Te(this,"logger"),Te(this,"events",new ir.EventEmitter),Te(this,"engine"),Te(this,"session"),Te(this,"proposal"),Te(this,"pendingRequest"),Te(this,"auth"),Te(this,"signConfig"),Te(this,"on",(n,i)=>this.events.on(n,i)),Te(this,"once",(n,i)=>this.events.once(n,i)),Te(this,"off",(n,i)=>this.events.off(n,i)),Te(this,"removeListener",(n,i)=>this.events.removeListener(n,i)),Te(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),Te(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"update",async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"request",async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"find",n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),Te(this,"authenticate",async(n,i)=>{try{return await this.engine.authenticate(n,i)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(i){throw this.logger.error(i.message),i}}),this.name=e?.name||$s.name,this.metadata=$y(e?.metadata),this.signConfig=e?.signConfig;const r=If({logger:e?.logger||$s.logger,name:this.name});this.logger=r,this.core=e?.core||new Y4(e),this.session=new k1(this.core,this.logger),this.proposal=new uB(this.core,this.logger),this.pendingRequest=new lB(this.core,this.logger),this.engine=new cB(this),this.auth=new yB(this.core,this.logger)}static async init(e){const r=new Mo(e);return await r.initialize(),r}get context(){return Ct(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const bB=k1,EB=Mo,vB=Object.freeze(Object.defineProperty({__proto__:null,AUTH_CONTEXT:L1,AUTH_KEYS_CONTEXT:M1,AUTH_PAIRING_TOPIC_CONTEXT:$1,AUTH_PROTOCOL:U1,AUTH_PUBLIC_KEY_NAME:ji,AUTH_REQUEST_CONTEXT:F1,AUTH_STORAGE_PREFIX:fs,AUTH_VERSION:rB,ENGINE_CONTEXT:D1,ENGINE_QUEUE_STATES:Qt,ENGINE_RPC_OPTS:Qe,HISTORY_CONTEXT:Q4,HISTORY_EVENTS:J4,HISTORY_STORAGE_VERSION:eB,METHODS_TO_VERIFY:P1,PROPOSAL_CONTEXT:C1,PROPOSAL_EXPIRY:tB,PROPOSAL_EXPIRY_MESSAGE:bl,REQUEST_CONTEXT:N1,SESSION_CONTEXT:R1,SESSION_EXPIRY:yn,SESSION_REQUEST_EXPIRY_BOUNDARIES:Fs,SIGN_CLIENT_CONTEXT:Bf,SIGN_CLIENT_DEFAULT:$s,SIGN_CLIENT_EVENTS:X4,SIGN_CLIENT_PROTOCOL:Rf,SIGN_CLIENT_STORAGE_OPTIONS:Z4,SIGN_CLIENT_STORAGE_PREFIX:Lo,SIGN_CLIENT_VERSION:Df,SessionStore:bB,SignClient:EB,TVF_METHODS:B1,WALLETCONNECT_DEEPLINK_CHOICE:ml,default:Mo},Symbol.toStringTag,{value:"Module"})),_B=co(vB),q1=co(qO);var Xt={},gn={},Sg;function Nf(){if(Sg)return gn;Sg=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.OptionalOperation=gn.Operation=void 0;var t;(function(r){r.SIGN_TRANSACTION="mvx_signTransaction",r.SIGN_TRANSACTIONS="mvx_signTransactions",r.SIGN_MESSAGE="mvx_signMessage"})(t||(gn.Operation=t={}));var e;return(function(r){r.SIGN_LOGIN_TOKEN="mvx_signLoginToken",r.SIGN_NATIVE_AUTH_TOKEN="mvx_signNativeAuthToken",r.CANCEL_ACTION="mvx_cancelAction"})(e||(gn.OptionalOperation=e={})),gn}var xg;function j1(){if(xg)return Xt;xg=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.WALLETCONNECT_SIGN_LOGIN_DELAY=Xt.WALLETCONNECT_MULTIVERSX_OPTIONAL_METHODS=Xt.WALLETCONNECT_MULTIVERSX_METHODS=Xt.WALLETCONNECT_MULTIVERSX_NAMESPACE=void 0;const t=Nf();return Xt.WALLETCONNECT_MULTIVERSX_NAMESPACE="mvx",Xt.WALLETCONNECT_MULTIVERSX_METHODS=Object.values(t.Operation),Xt.WALLETCONNECT_MULTIVERSX_OPTIONAL_METHODS=Object.values(t.OptionalOperation),Xt.WALLETCONNECT_SIGN_LOGIN_DELAY=500,Xt}var Zt={},Ig;function z1(){if(Ig)return Zt;Ig=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.WalletConnectV2ProviderErrorMessagesEnum=Zt.ErrBadAddress=Zt.ErrNotImplemented=Zt.Err=void 0;class t extends Error{constructor(s,o){super(s),this.inner=void 0,this.inner=o}}Zt.Err=t;class e extends t{constructor(){super("Method not yet implemented")}}Zt.ErrNotImplemented=e;class r extends t{constructor(s,o){super(`Bad address: ${s}`,o)}}Zt.ErrBadAddress=r;var n;return(function(i){i.unableToInit="WalletConnect is unable to init",i.notInitialized="WalletConnect is not initialized",i.unableToConnect="WalletConnect is unable to connect",i.unableToConnectExisting="WalletConnect is unable to connect to existing pairing",i.unableToSignLoginToken="WalletConnect could not sign login token",i.unableToSign="WalletConnect could not sign the message",i.unableToLogin="WalletConnect is unable to login",i.unableToHandleTopic="WalletConnect: Unable to handle topic update",i.unableToHandleEvent="WalletConnect: Unable to handle events",i.unableToHandleCleanup="WalletConnect: Unable to handle cleanup",i.sessionNotConnected="WalletConnect Session is not connected",i.sessionDeleted="WalletConnect Session Deleted",i.sessionExpired="WalletConnect Session Expired",i.alreadyLoggedOut="WalletConnect: Already logged out",i.pingFailed="WalletConnect Ping Failed",i.invalidAddress="WalletConnect: Invalid address",i.requestDifferentChain="WalletConnect: Request Chain Id different than Connection Chain Id",i.invalidMessageResponse="WalletConnect could not sign the message",i.invalidMessageSignature="WalletConnect: Invalid message signature",i.invalidTransactionResponse="WalletConnect could not sign the transactions. Invalid signatures",i.invalidCustomRequestResponse="WalletConnect could not send the custom request",i.transactionError="Transaction canceled",i.connectionError="WalletConnect could not establish a connection",i.invalidGuardian="WalletConnect: Invalid Guardian"})(n||(Zt.WalletConnectV2ProviderErrorMessagesEnum=n={})),Zt}var Ci={},Ag;function V1(){if(Ag)return Ci;Ag=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.Logger=void 0;class t{static error(r){console.error(r)}static trace(r){console.trace(r)}}return Ci.Logger=t,Ci}var gt={},Tg;function SB(){if(Tg)return gt;Tg=1;var t=gt&&gt.__awaiter||function(y,S,b,x){function I(A){return A instanceof b?A:new b(function(B){B(A)})}return new(b||(b=Promise))(function(A,B){function P(G){try{$(x.next(G))}catch(q){B(q)}}function N(G){try{$(x.throw(G))}catch(q){B(q)}}function $(G){G.done?A(G.value):I(G.value).then(P,N)}$((x=x.apply(y,S||[])).next())})};Object.defineProperty(gt,"__esModule",{value:!0}),gt.getCurrentSession=a,gt.getCurrentTopic=c,gt.getConnectionParams=u,gt.getExistingConnectionParams=l,gt.getMvxNamespace=f,gt.addressIsValid=p,gt.getAddressFromSession=d,gt.applyTransactionSignature=h,gt.getMetadata=g,gt.sleep=m;const e=Tl(),r=q1,n=j1(),i=z1(),s=V1(),o=Nf();function a(y,S){if(!S)throw new Error(i.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);const b=S.find(l(y)).filter(x=>x.acknowledged);if(b.length>0){const x=b.length-1;return b[x]}if(S.session.length>0){const x=S.session.keys.length-1;return S.session.get(S.session.keys[x])}throw s.Logger.error(i.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),new Error(i.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected)}function c(y,S){if(!S)throw new Error(i.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);const b=a(y,S);if(!b?.topic)throw new Error(i.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);return b.topic}function u(y,S){return{optionalNamespaces:f(y,S)}}function l(y,S){return{requiredNamespaces:f(y,S)}}function f(y,S){var b,x,I;const A=[...n.WALLETCONNECT_MULTIVERSX_METHODS,...(b=S?.methods)!==null&&b!==void 0?b:[]];!((x=S?.methods)===null||x===void 0)&&x.includes(o.OptionalOperation.SIGN_LOGIN_TOKEN)||A.push(o.OptionalOperation.SIGN_LOGIN_TOKEN);const B=[`${n.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${y}`],P=(I=S?.events)!==null&&I!==void 0?I:[];return{[n.WALLETCONNECT_MULTIVERSX_NAMESPACE]:{methods:A,chains:B,events:P}}}function p(y){try{return!e.Address.newFromBech32(y).isEmpty()}catch{return!1}}function d(y){const S=y.namespaces[n.WALLETCONNECT_MULTIVERSX_NAMESPACE];if(S&&S.accounts){const b=S.accounts[0],[x,I,A]=b.split(":");return A}return""}function h({transaction:y,response:S}){if(!S)throw s.Logger.error(i.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse),new Error(i.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse);const{signature:b,guardianSignature:x,version:I,options:A,guardian:B}=S,P=y.guardian.toBech32();if(P&&P!==B)throw s.Logger.error(i.WalletConnectV2ProviderErrorMessagesEnum.invalidGuardian),new Error(i.WalletConnectV2ProviderErrorMessagesEnum.invalidGuardian);return B&&(y.guardian=e.Address.newFromBech32(B)),I&&(y.version=I),A!=null&&(y.options=A),y.signature=Buffer.from(b,"hex"),x&&(y.guardianSignature=Buffer.from(x,"hex")),y}function g(y){if(y)return Object.assign(Object.assign({},y),{url:(0,r.getAppMetadata)().url})}function m(y){return t(this,void 0,void 0,function*(){return yield new Promise(S=>setTimeout(()=>{S()},y))})}return gt}var Og;function xB(){return Og||(Og=1,(function(t){var e=un&&un.__awaiter||function(d,h,g,m){function y(S){return S instanceof g?S:new g(function(b){b(S)})}return new(g||(g=Promise))(function(S,b){function x(B){try{A(m.next(B))}catch(P){b(P)}}function I(B){try{A(m.throw(B))}catch(P){b(P)}}function A(B){B.done?S(B.value):y(B.value).then(x,I)}A((m=m.apply(d,h||[])).next())})},r=un&&un.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(t,"__esModule",{value:!0}),t.WalletConnectV2Provider=t.OptionalOperation=t.Operation=t.WalletConnectV2ProviderErrorMessagesEnum=void 0;const n=Lb(),i=Tl(),s=r(_B),o=q1,a=j1(),c=z1();Object.defineProperty(t,"WalletConnectV2ProviderErrorMessagesEnum",{enumerable:!0,get:function(){return c.WalletConnectV2ProviderErrorMessagesEnum}});const u=V1(),l=Nf();Object.defineProperty(t,"Operation",{enumerable:!0,get:function(){return l.Operation}}),Object.defineProperty(t,"OptionalOperation",{enumerable:!0,get:function(){return l.OptionalOperation}});const f=SB();class p{constructor(h,g,m,y,S){this.chainId="",this.isInitializing=!1,this.processingTopic="",this.options={},this.account={address:""},this.onClientConnect=h,this.chainId=g,this.walletConnectV2Relay=m,this.walletConnectV2ProjectId=y,this.options=S}disconnect(){this.account={address:"",signature:""},this.walletConnector=void 0,this.session=void 0,this.pairings=void 0}init(){return e(this,void 0,void 0,function*(){var h,g;if(this.isInitialized())return this.isInitialized();try{if(!this.isInitializing){this.isInitializing=!0,this.disconnect();const m=!((h=this.options)===null||h===void 0)&&h.metadata?{metadata:(0,f.getMetadata)((g=this.options)===null||g===void 0?void 0:g.metadata)}:{},y=yield s.default.init(Object.assign(Object.assign(Object.assign({},this.options),{relayUrl:this.walletConnectV2Relay,projectId:this.walletConnectV2ProjectId}),m));this.walletConnector=y,this.isInitializing=!1,yield this.subscribeToEvents(y),yield this.checkPersistedState(y)}}catch{throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToInit)}finally{return this.isInitializing=!1,this.isInitialized()}})}isInitialized(){return!!this.walletConnector&&!this.isInitializing}isConnected(){return!!(this.isInitialized()&&typeof this.session<"u")}getAccount(){return this.account}setAccount(h){this.account=h}connect(h){return e(this,void 0,void 0,function*(){var g,m;if(typeof this.walletConnector>"u")throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);const y=(0,f.getConnectionParams)(this.chainId,h);try{return yield this.walletConnector.connect(Object.assign({pairingTopic:h?.topic},y))}catch{if(h?.topic)try{(m=(g=this.walletConnector.core)===null||g===void 0?void 0:g.expirer)===null||m===void 0||m.set(h.topic,0)}catch{u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToHandleCleanup)}throw this.disconnect(),u.Logger.error(h?.topic?c.WalletConnectV2ProviderErrorMessagesEnum.unableToConnectExisting:c.WalletConnectV2ProviderErrorMessagesEnum.unableToConnect),new Error(h?.topic?c.WalletConnectV2ProviderErrorMessagesEnum.unableToConnectExisting:c.WalletConnectV2ProviderErrorMessagesEnum.unableToConnect)}})}login(h){return e(this,void 0,void 0,function*(){var g;if(this.isInitializing=!0,typeof this.walletConnector>"u"&&(yield this.connect()),typeof this.walletConnector>"u")throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);typeof this.session<"u"&&(yield this.logout({topic:(g=this.session)===null||g===void 0?void 0:g.topic}));try{if(h&&h.approval){const m=yield h.approval();if(h.token){yield(0,f.sleep)(a.WALLETCONNECT_SIGN_LOGIN_DELAY);const y=(0,f.getAddressFromSession)(m),b=m.namespaces[a.WALLETCONNECT_MULTIVERSX_NAMESPACE].methods.includes(l.OptionalOperation.SIGN_NATIVE_AUTH_TOKEN)?l.OptionalOperation.SIGN_NATIVE_AUTH_TOKEN:l.OptionalOperation.SIGN_LOGIN_TOKEN,{signature:x}=yield this.walletConnector.request({chainId:`${a.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:m.topic,request:{method:b,params:{token:h.token,address:y}}});if(!x)throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToSignLoginToken),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToSignLoginToken);return yield this.onSessionConnected({session:m,signature:x})}return yield this.onSessionConnected({session:m,signature:""})}}catch{throw this.disconnect(),u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToLogin),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToLogin)}finally{this.isInitializing=!1}return null})}logout(h){return e(this,void 0,void 0,function*(){if(typeof this.walletConnector>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);try{if(this.processingTopic===(h?.topic||(0,f.getCurrentTopic)(this.chainId,this.walletConnector)))return!0;if(h?.topic)this.processingTopic=h.topic,yield this.walletConnector.disconnect({topic:h.topic,reason:(0,o.getSdkError)("USER_DISCONNECTED")});else{const g=(0,f.getCurrentTopic)(this.chainId,this.walletConnector);this.processingTopic=g,yield this.walletConnector.disconnect({topic:g,reason:(0,o.getSdkError)("USER_DISCONNECTED")}),this.disconnect(),yield this.cleanupPendingPairings({deletePairings:!0})}}catch{u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.alreadyLoggedOut)}finally{this.processingTopic=""}return!0})}getAddress(){if(typeof this.walletConnector>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);return this.account.address}getSignature(){if(typeof this.walletConnector>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);return this.account.signature}getPairings(){return e(this,void 0,void 0,function*(){var h,g,m,y,S;if(typeof this.walletConnector>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);return(S=(y=(m=(g=(h=this.walletConnector)===null||h===void 0?void 0:h.core)===null||g===void 0?void 0:g.pairing)===null||m===void 0?void 0:m.pairings)===null||y===void 0?void 0:y.getAll({active:!0}))!==null&&S!==void 0?S:[]})}signMessage(h){return e(this,void 0,void 0,function*(){var g;const m=new n.Message({data:Buffer.from(h.data),address:(g=h.address)!==null&&g!==void 0?g:i.Address.newFromBech32(this.account.address),signer:"wallet-connect-v2",version:h.version});if(typeof this.walletConnector>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(typeof this.session>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),this.onClientConnect.onClientLogout(),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);try{const y=this.getAddress(),{signature:S}=yield this.walletConnector.request({chainId:`${a.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:(0,f.getCurrentTopic)(this.chainId,this.walletConnector),request:{method:l.Operation.SIGN_MESSAGE,params:{address:y,message:m.data.toString()}}});if(!S)throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.invalidMessageResponse),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.invalidMessageResponse);try{m.signature=Buffer.from(S,"hex")}catch{throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.invalidMessageSignature),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.invalidMessageSignature)}}catch{throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToSign)}return m})}signTransaction(h){return e(this,void 0,void 0,function*(){if(typeof this.walletConnector>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(typeof this.session>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),this.onClientConnect.onClientLogout(),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);const g=h.toPlainObject();if(this.chainId!==h.chainID.valueOf())throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.requestDifferentChain),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.requestDifferentChain);try{const m=yield this.walletConnector.request({chainId:`${a.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:(0,f.getCurrentTopic)(this.chainId,this.walletConnector),request:{method:l.Operation.SIGN_TRANSACTION,params:{transaction:g}}});return(0,f.applyTransactionSignature)({transaction:h,response:m})}catch{throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.transactionError)}})}signTransactions(h){return e(this,void 0,void 0,function*(){if(typeof this.walletConnector>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(typeof this.session>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),this.onClientConnect.onClientLogout(),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);const g=h.map(m=>{if(this.chainId!==m.chainID.valueOf())throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.requestDifferentChain),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.requestDifferentChain);return m.toPlainObject()});try{const{signatures:m}=yield this.walletConnector.request({chainId:`${a.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:(0,f.getCurrentTopic)(this.chainId,this.walletConnector),request:{method:l.Operation.SIGN_TRANSACTIONS,params:{transactions:g}}});if(!m)throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse);if(!Array.isArray(m)||h.length!==m.length)throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse);for(const[y,S]of h.entries()){const b=m[y];(0,f.applyTransactionSignature)({transaction:S,response:b})}return h}catch{throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.transactionError)}})}sendCustomRequest(h){return e(this,void 0,void 0,function*(){var g;if(typeof this.walletConnector>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(typeof this.session>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),this.onClientConnect.onClientLogout(),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);if(!((g=h?.request)===null||g===void 0)&&g.method){try{const m=Object.assign({},h.request);let{method:y}=m;const{response:S}=yield this.walletConnector.request({chainId:`${a.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:(0,f.getCurrentTopic)(this.chainId,this.walletConnector),request:Object.assign(Object.assign({},m),{method:y})});S||u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.invalidCustomRequestResponse)}catch{u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.invalidCustomRequestResponse)}return}})}ping(){return e(this,void 0,void 0,function*(){if(typeof this.walletConnector>"u")throw u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);typeof this.session>"u"&&u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);try{const h=(0,f.getCurrentTopic)(this.chainId,this.walletConnector);return yield this.walletConnector.ping({topic:h}),!0}catch{return u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.pingFailed),!1}})}loginAccount(h){return e(this,void 0,void 0,function*(){return h?(0,f.addressIsValid)(h.address)?(this.account.address=h.address,h.signature&&(this.account.signature=h.signature),this.onClientConnect.onClientLogin(),this.account.address):(u.Logger.error(`${c.WalletConnectV2ProviderErrorMessagesEnum.invalidAddress} ${h.address}`),this.walletConnector&&(yield this.logout()),""):""})}onSessionConnected(h){return e(this,void 0,void 0,function*(){if(!h)return null;this.session=h.session,this.account.signature=h.signature||"";const g=(0,f.getAddressFromSession)(h.session);return g?(yield this.loginAccount({address:g,signature:h.signature}),this.account.address=g,this.account):null})}handleSessionEvents(h){return e(this,arguments,void 0,function*({topic:g,params:m}){var y;if(typeof this.walletConnector>"u")throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(this.session&&((y=this.session)===null||y===void 0?void 0:y.topic)!==g)return;const{event:S}=m;if(S?.name&&(0,f.getCurrentTopic)(this.chainId,this.walletConnector)===g){const b=S.data;this.onClientConnect.onClientEvent(b)}})}subscribeToEvents(h){return e(this,void 0,void 0,function*(){if(typeof h>"u")throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);try{h.on("session_update",({topic:g,params:m})=>{var y;if(!this.session||((y=this.session)===null||y===void 0?void 0:y.topic)!==g)return;const{namespaces:S}=m,b=h.session.get(g),x=Object.assign(Object.assign({},b),{namespaces:S});this.onSessionConnected({session:x})}),h.on("session_event",this.handleSessionEvents.bind(this)),h.on("session_delete",g=>e(this,[g],void 0,function*({topic:m}){var y;this.isInitializing&&(this.onClientConnect.onClientLogout(),this.disconnect()),!(!this.session||((y=this.session)===null||y===void 0?void 0:y.topic)!==m)&&(u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionDeleted),this.onClientConnect.onClientLogout(),this.disconnect(),yield this.cleanupPendingPairings({deletePairings:!0}))})),h.on("session_expire",g=>e(this,[g],void 0,function*({topic:m}){var y;!this.session||((y=this.session)===null||y===void 0?void 0:y.topic)!==m||(u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.sessionExpired),this.onClientConnect.onClientLogout(),this.disconnect(),yield this.cleanupPendingPairings({deletePairings:!0}))}))}catch{u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToHandleEvent)}})}checkPersistedState(h){return e(this,void 0,void 0,function*(){if(typeof h>"u")throw new Error(c.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(this.pairings=yield this.getPairings(),!(typeof this.session<"u")&&h.session.length&&!this.account.address&&!this.isInitializing){const g=(0,f.getCurrentSession)(this.chainId,h);if(g)return yield this.onSessionConnected({session:g}),g}})}cleanupPendingPairings(){return e(this,arguments,void 0,function*(h={}){var g,m,y,S,b,x,I,A;if(!(typeof this.walletConnector>"u"))try{const B=(y=(m=(g=this.walletConnector.core)===null||g===void 0?void 0:g.pairing)===null||m===void 0?void 0:m.pairings)===null||y===void 0?void 0:y.getAll({active:!1});if(!(0,o.isValidArray)(B))return;for(const P of B)if(h.deletePairings)(b=(S=this.walletConnector.core)===null||S===void 0?void 0:S.expirer)===null||b===void 0||b.set(P.topic,0);else try{yield(A=(I=(x=this.walletConnector.core)===null||x===void 0?void 0:x.relayer)===null||I===void 0?void 0:I.subscriber)===null||A===void 0?void 0:A.unsubscribe(P.topic)}catch{u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToHandleCleanup)}}catch{u.Logger.error(c.WalletConnectV2ProviderErrorMessagesEnum.unableToHandleCleanup)}})}}t.WalletConnectV2Provider=p})(un)),un}var Cg;function IB(){return Cg||(Cg=1,(function(t){var e=cn&&cn.__createBinding||(Object.create?(function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}):(function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]})),r=cn&&cn.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(xB(),t)})(cn)),cn}var AB=IB();const Rg=document.getElementById("status"),Dg=document.getElementById("address"),vl=document.getElementById("connectBtn"),_l=document.getElementById("disconnectBtn"),H1=document.getElementById("MyWalletConnectQRContainer"),TB="f4f84c031236a02d1fda5167859868f4",OB="wss://relay.walletconnect.com",CB="T",RB={onClientLogin:async function(){const t=await zi.getAddress();Rg.textContent="Status: Connected",Dg.textContent="Address: "+t,vl.style.display="none",_l.style.display="inline-block",H1.innerHTML=""},onClientLogout:async function(){Rg.textContent="Status: Not connected",Dg.textContent="",vl.style.display="inline-block",_l.style.display="none"}},zi=new AB.WalletConnectV2Provider(RB,CB,OB,TB);async function DB(t){const e=await pb.toString(t,{type:"svg"});H1.innerHTML=e}vl.addEventListener("click",async()=>{try{await zi.init();const{uri:t,approval:e}=await zi.connect();await DB(t),await zi.login({approval:e})}catch(t){console.error("Erreur WalletConnect:",t),alert("Erreur WalletConnect : "+t.message)}});_l.addEventListener("click",async()=>{await zi.logout()});

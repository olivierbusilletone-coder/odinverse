(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const Hs of document.querySelectorAll('link[rel="modulepreload"]'))at(Hs);new MutationObserver(Hs=>{for(const zs of Hs)if(zs.type==="childList")for(const Ys of zs.addedNodes)Ys.tagName==="LINK"&&Ys.rel==="modulepreload"&&at(Ys)}).observe(document,{childList:!0,subtree:!0});function Z(Hs){const zs={};return Hs.integrity&&(zs.integrity=Hs.integrity),Hs.referrerPolicy&&(zs.referrerPolicy=Hs.referrerPolicy),Hs.crossOrigin==="use-credentials"?zs.credentials="include":Hs.crossOrigin==="anonymous"?zs.credentials="omit":zs.credentials="same-origin",zs}function at(Hs){if(Hs.ep)return;Hs.ep=!0;const zs=Z(Hs);fetch(Hs.href,zs)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(F){return F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F}function getAugmentedNamespace(F){if(F.__esModule)return F;var t=F.default;if(typeof t=="function"){var Z=function at(){return this instanceof at?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};Z.prototype=t.prototype}else Z={};return Object.defineProperty(Z,"__esModule",{value:!0}),Object.keys(F).forEach(function(at){var Hs=Object.getOwnPropertyDescriptor(F,at);Object.defineProperty(Z,at,Hs.get?Hs:{enumerable:!0,get:function(){return F[at]}})}),Z}var browser$3={exports:{}},process$1=browser$3.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?cachedSetTimeout=setTimeout:cachedSetTimeout=defaultSetTimout}catch{cachedSetTimeout=defaultSetTimout}try{typeof clearTimeout=="function"?cachedClearTimeout=clearTimeout:cachedClearTimeout=defaultClearTimeout}catch{cachedClearTimeout=defaultClearTimeout}})();function runTimeout(F){if(cachedSetTimeout===setTimeout)return setTimeout(F,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(F,0);try{return cachedSetTimeout(F,0)}catch{try{return cachedSetTimeout.call(null,F,0)}catch{return cachedSetTimeout.call(this,F,0)}}}function runClearTimeout(F){if(cachedClearTimeout===clearTimeout)return clearTimeout(F);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(F);try{return cachedClearTimeout(F)}catch{try{return cachedClearTimeout.call(null,F)}catch{return cachedClearTimeout.call(this,F)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){!draining||!currentQueue||(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var F=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(F)}}process$1.nextTick=function(F){var t=new Array(arguments.length-1);if(arguments.length>1)for(var Z=1;Z<arguments.length;Z++)t[Z-1]=arguments[Z];queue.push(new Item(F,t)),queue.length===1&&!draining&&runTimeout(drainQueue)};function Item(F,t){this.fun=F,this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};process$1.title="browser";process$1.browser=!0;process$1.env={};process$1.argv=[];process$1.version="";process$1.versions={};function noop$4(){}process$1.on=noop$4;process$1.addListener=noop$4;process$1.once=noop$4;process$1.off=noop$4;process$1.removeListener=noop$4;process$1.removeAllListeners=noop$4;process$1.emit=noop$4;process$1.prependListener=noop$4;process$1.prependOnceListener=noop$4;process$1.listeners=function(F){return[]};process$1.binding=function(F){throw new Error("process.binding is not supported")};process$1.cwd=function(){return"/"};process$1.chdir=function(F){throw new Error("process.chdir is not supported")};process$1.umask=function(){return 0};var browserExports$1=browser$3.exports;const process$2=getDefaultExportFromCjs(browserExports$1);var buffer={},base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$3=0,len=code.length;i$3<len;++i$3)lookup[i$3]=code[i$3],revLookup[code.charCodeAt(i$3)]=i$3;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(F){var t=F.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var Z=F.indexOf("=");Z===-1&&(Z=t);var at=Z===t?0:4-Z%4;return[Z,at]}function byteLength(F){var t=getLens(F),Z=t[0],at=t[1];return(Z+at)*3/4-at}function _byteLength(F,t,Z){return(t+Z)*3/4-Z}function toByteArray(F){var t,Z=getLens(F),at=Z[0],Hs=Z[1],zs=new Arr(_byteLength(F,at,Hs)),Ys=0,Zs=Hs>0?at-4:at,$u;for($u=0;$u<Zs;$u+=4)t=revLookup[F.charCodeAt($u)]<<18|revLookup[F.charCodeAt($u+1)]<<12|revLookup[F.charCodeAt($u+2)]<<6|revLookup[F.charCodeAt($u+3)],zs[Ys++]=t>>16&255,zs[Ys++]=t>>8&255,zs[Ys++]=t&255;return Hs===2&&(t=revLookup[F.charCodeAt($u)]<<2|revLookup[F.charCodeAt($u+1)]>>4,zs[Ys++]=t&255),Hs===1&&(t=revLookup[F.charCodeAt($u)]<<10|revLookup[F.charCodeAt($u+1)]<<4|revLookup[F.charCodeAt($u+2)]>>2,zs[Ys++]=t>>8&255,zs[Ys++]=t&255),zs}function tripletToBase64(F){return lookup[F>>18&63]+lookup[F>>12&63]+lookup[F>>6&63]+lookup[F&63]}function encodeChunk(F,t,Z){for(var at,Hs=[],zs=t;zs<Z;zs+=3)at=(F[zs]<<16&16711680)+(F[zs+1]<<8&65280)+(F[zs+2]&255),Hs.push(tripletToBase64(at));return Hs.join("")}function fromByteArray(F){for(var t,Z=F.length,at=Z%3,Hs=[],zs=16383,Ys=0,Zs=Z-at;Ys<Zs;Ys+=zs)Hs.push(encodeChunk(F,Ys,Ys+zs>Zs?Zs:Ys+zs));return at===1?(t=F[Z-1],Hs.push(lookup[t>>2]+lookup[t<<4&63]+"==")):at===2&&(t=(F[Z-2]<<8)+F[Z-1],Hs.push(lookup[t>>10]+lookup[t>>4&63]+lookup[t<<2&63]+"=")),Hs.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(F,t,Z,at,Hs){var zs,Ys,Zs=Hs*8-at-1,$u=(1<<Zs)-1,Eu=$u>>1,Au=-7,vu=Z?Hs-1:0,Iu=Z?-1:1,_u=F[t+vu];for(vu+=Iu,zs=_u&(1<<-Au)-1,_u>>=-Au,Au+=Zs;Au>0;zs=zs*256+F[t+vu],vu+=Iu,Au-=8);for(Ys=zs&(1<<-Au)-1,zs>>=-Au,Au+=at;Au>0;Ys=Ys*256+F[t+vu],vu+=Iu,Au-=8);if(zs===0)zs=1-Eu;else{if(zs===$u)return Ys?NaN:(_u?-1:1)*(1/0);Ys=Ys+Math.pow(2,at),zs=zs-Eu}return(_u?-1:1)*Ys*Math.pow(2,zs-at)};ieee754.write=function(F,t,Z,at,Hs,zs){var Ys,Zs,$u,Eu=zs*8-Hs-1,Au=(1<<Eu)-1,vu=Au>>1,Iu=Hs===23?Math.pow(2,-24)-Math.pow(2,-77):0,_u=at?0:zs-1,Su=at?1:-1,Bu=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(Zs=isNaN(t)?1:0,Ys=Au):(Ys=Math.floor(Math.log(t)/Math.LN2),t*($u=Math.pow(2,-Ys))<1&&(Ys--,$u*=2),Ys+vu>=1?t+=Iu/$u:t+=Iu*Math.pow(2,1-vu),t*$u>=2&&(Ys++,$u/=2),Ys+vu>=Au?(Zs=0,Ys=Au):Ys+vu>=1?(Zs=(t*$u-1)*Math.pow(2,Hs),Ys=Ys+vu):(Zs=t*Math.pow(2,vu-1)*Math.pow(2,Hs),Ys=0));Hs>=8;F[Z+_u]=Zs&255,_u+=Su,Zs/=256,Hs-=8);for(Ys=Ys<<Hs|Zs,Eu+=Hs;Eu>0;F[Z+_u]=Ys&255,_u+=Su,Ys/=256,Eu-=8);F[Z+_u-Su]|=Bu*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(F){const t=base64Js,Z=ieee754,at=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;F.Buffer=Zs,F.SlowBuffer=Pu,F.INSPECT_MAX_BYTES=50;const Hs=2147483647;F.kMaxLength=Hs,Zs.TYPED_ARRAY_SUPPORT=zs(),!Zs.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function zs(){try{const Nu=new Uint8Array(1),Cu={foo:function(){return 42}};return Object.setPrototypeOf(Cu,Uint8Array.prototype),Object.setPrototypeOf(Nu,Cu),Nu.foo()===42}catch{return!1}}Object.defineProperty(Zs.prototype,"parent",{enumerable:!0,get:function(){if(Zs.isBuffer(this))return this.buffer}}),Object.defineProperty(Zs.prototype,"offset",{enumerable:!0,get:function(){if(Zs.isBuffer(this))return this.byteOffset}});function Ys(Nu){if(Nu>Hs)throw new RangeError('The value "'+Nu+'" is invalid for option "size"');const Cu=new Uint8Array(Nu);return Object.setPrototypeOf(Cu,Zs.prototype),Cu}function Zs(Nu,Cu,xu){if(typeof Nu=="number"){if(typeof Cu=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return vu(Nu)}return $u(Nu,Cu,xu)}Zs.poolSize=8192;function $u(Nu,Cu,xu){if(typeof Nu=="string")return Iu(Nu,Cu);if(ArrayBuffer.isView(Nu))return Su(Nu);if(Nu==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Nu);if($l(Nu,ArrayBuffer)||Nu&&$l(Nu.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&($l(Nu,SharedArrayBuffer)||Nu&&$l(Nu.buffer,SharedArrayBuffer)))return Bu(Nu,Cu,xu);if(typeof Nu=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ku=Nu.valueOf&&Nu.valueOf();if(ku!=null&&ku!==Nu)return Zs.from(ku,Cu,xu);const sl=Du(Nu);if(sl)return sl;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Nu[Symbol.toPrimitive]=="function")return Zs.from(Nu[Symbol.toPrimitive]("string"),Cu,xu);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Nu)}Zs.from=function(Nu,Cu,xu){return $u(Nu,Cu,xu)},Object.setPrototypeOf(Zs.prototype,Uint8Array.prototype),Object.setPrototypeOf(Zs,Uint8Array);function Eu(Nu){if(typeof Nu!="number")throw new TypeError('"size" argument must be of type number');if(Nu<0)throw new RangeError('The value "'+Nu+'" is invalid for option "size"')}function Au(Nu,Cu,xu){return Eu(Nu),Nu<=0?Ys(Nu):Cu!==void 0?typeof xu=="string"?Ys(Nu).fill(Cu,xu):Ys(Nu).fill(Cu):Ys(Nu)}Zs.alloc=function(Nu,Cu,xu){return Au(Nu,Cu,xu)};function vu(Nu){return Eu(Nu),Ys(Nu<0?0:Tu(Nu)|0)}Zs.allocUnsafe=function(Nu){return vu(Nu)},Zs.allocUnsafeSlow=function(Nu){return vu(Nu)};function Iu(Nu,Cu){if((typeof Cu!="string"||Cu==="")&&(Cu="utf8"),!Zs.isEncoding(Cu))throw new TypeError("Unknown encoding: "+Cu);const xu=Uu(Nu,Cu)|0;let ku=Ys(xu);const sl=ku.write(Nu,Cu);return sl!==xu&&(ku=ku.slice(0,sl)),ku}function _u(Nu){const Cu=Nu.length<0?0:Tu(Nu.length)|0,xu=Ys(Cu);for(let ku=0;ku<Cu;ku+=1)xu[ku]=Nu[ku]&255;return xu}function Su(Nu){if($l(Nu,Uint8Array)){const Cu=new Uint8Array(Nu);return Bu(Cu.buffer,Cu.byteOffset,Cu.byteLength)}return _u(Nu)}function Bu(Nu,Cu,xu){if(Cu<0||Nu.byteLength<Cu)throw new RangeError('"offset" is outside of buffer bounds');if(Nu.byteLength<Cu+(xu||0))throw new RangeError('"length" is outside of buffer bounds');let ku;return Cu===void 0&&xu===void 0?ku=new Uint8Array(Nu):xu===void 0?ku=new Uint8Array(Nu,Cu):ku=new Uint8Array(Nu,Cu,xu),Object.setPrototypeOf(ku,Zs.prototype),ku}function Du(Nu){if(Zs.isBuffer(Nu)){const Cu=Tu(Nu.length)|0,xu=Ys(Cu);return xu.length===0||Nu.copy(xu,0,0,Cu),xu}if(Nu.length!==void 0)return typeof Nu.length!="number"||Al(Nu.length)?Ys(0):_u(Nu);if(Nu.type==="Buffer"&&Array.isArray(Nu.data))return _u(Nu.data)}function Tu(Nu){if(Nu>=Hs)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Hs.toString(16)+" bytes");return Nu|0}function Pu(Nu){return+Nu!=Nu&&(Nu=0),Zs.alloc(+Nu)}Zs.isBuffer=function(Cu){return Cu!=null&&Cu._isBuffer===!0&&Cu!==Zs.prototype},Zs.compare=function(Cu,xu){if($l(Cu,Uint8Array)&&(Cu=Zs.from(Cu,Cu.offset,Cu.byteLength)),$l(xu,Uint8Array)&&(xu=Zs.from(xu,xu.offset,xu.byteLength)),!Zs.isBuffer(Cu)||!Zs.isBuffer(xu))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Cu===xu)return 0;let ku=Cu.length,sl=xu.length;for(let gl=0,El=Math.min(ku,sl);gl<El;++gl)if(Cu[gl]!==xu[gl]){ku=Cu[gl],sl=xu[gl];break}return ku<sl?-1:sl<ku?1:0},Zs.isEncoding=function(Cu){switch(String(Cu).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Zs.concat=function(Cu,xu){if(!Array.isArray(Cu))throw new TypeError('"list" argument must be an Array of Buffers');if(Cu.length===0)return Zs.alloc(0);let ku;if(xu===void 0)for(xu=0,ku=0;ku<Cu.length;++ku)xu+=Cu[ku].length;const sl=Zs.allocUnsafe(xu);let gl=0;for(ku=0;ku<Cu.length;++ku){let El=Cu[ku];if($l(El,Uint8Array))gl+El.length>sl.length?(Zs.isBuffer(El)||(El=Zs.from(El)),El.copy(sl,gl)):Uint8Array.prototype.set.call(sl,El,gl);else if(Zs.isBuffer(El))El.copy(sl,gl);else throw new TypeError('"list" argument must be an Array of Buffers');gl+=El.length}return sl};function Uu(Nu,Cu){if(Zs.isBuffer(Nu))return Nu.length;if(ArrayBuffer.isView(Nu)||$l(Nu,ArrayBuffer))return Nu.byteLength;if(typeof Nu!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Nu);const xu=Nu.length,ku=arguments.length>2&&arguments[2]===!0;if(!ku&&xu===0)return 0;let sl=!1;for(;;)switch(Cu){case"ascii":case"latin1":case"binary":return xu;case"utf8":case"utf-8":return Ju(Nu).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xu*2;case"hex":return xu>>>1;case"base64":return Zu(Nu).length;default:if(sl)return ku?-1:Ju(Nu).length;Cu=(""+Cu).toLowerCase(),sl=!0}}Zs.byteLength=Uu;function Fu(Nu,Cu,xu){let ku=!1;if((Cu===void 0||Cu<0)&&(Cu=0),Cu>this.length||((xu===void 0||xu>this.length)&&(xu=this.length),xu<=0)||(xu>>>=0,Cu>>>=0,xu<=Cu))return"";for(Nu||(Nu="utf8");;)switch(Nu){case"hex":return Xu(this,Cu,xu);case"utf8":case"utf-8":return rl(this,Cu,xu);case"ascii":return Yu(this,Cu,xu);case"latin1":case"binary":return ul(this,Cu,xu);case"base64":return Qu(this,Cu,xu);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return al(this,Cu,xu);default:if(ku)throw new TypeError("Unknown encoding: "+Nu);Nu=(Nu+"").toLowerCase(),ku=!0}}Zs.prototype._isBuffer=!0;function Lu(Nu,Cu,xu){const ku=Nu[Cu];Nu[Cu]=Nu[xu],Nu[xu]=ku}Zs.prototype.swap16=function(){const Cu=this.length;if(Cu%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let xu=0;xu<Cu;xu+=2)Lu(this,xu,xu+1);return this},Zs.prototype.swap32=function(){const Cu=this.length;if(Cu%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let xu=0;xu<Cu;xu+=4)Lu(this,xu,xu+3),Lu(this,xu+1,xu+2);return this},Zs.prototype.swap64=function(){const Cu=this.length;if(Cu%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let xu=0;xu<Cu;xu+=8)Lu(this,xu,xu+7),Lu(this,xu+1,xu+6),Lu(this,xu+2,xu+5),Lu(this,xu+3,xu+4);return this},Zs.prototype.toString=function(){const Cu=this.length;return Cu===0?"":arguments.length===0?rl(this,0,Cu):Fu.apply(this,arguments)},Zs.prototype.toLocaleString=Zs.prototype.toString,Zs.prototype.equals=function(Cu){if(!Zs.isBuffer(Cu))throw new TypeError("Argument must be a Buffer");return this===Cu?!0:Zs.compare(this,Cu)===0},Zs.prototype.inspect=function(){let Cu="";const xu=F.INSPECT_MAX_BYTES;return Cu=this.toString("hex",0,xu).replace(/(.{2})/g,"$1 ").trim(),this.length>xu&&(Cu+=" ... "),"<Buffer "+Cu+">"},at&&(Zs.prototype[at]=Zs.prototype.inspect),Zs.prototype.compare=function(Cu,xu,ku,sl,gl){if($l(Cu,Uint8Array)&&(Cu=Zs.from(Cu,Cu.offset,Cu.byteLength)),!Zs.isBuffer(Cu))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Cu);if(xu===void 0&&(xu=0),ku===void 0&&(ku=Cu?Cu.length:0),sl===void 0&&(sl=0),gl===void 0&&(gl=this.length),xu<0||ku>Cu.length||sl<0||gl>this.length)throw new RangeError("out of range index");if(sl>=gl&&xu>=ku)return 0;if(sl>=gl)return-1;if(xu>=ku)return 1;if(xu>>>=0,ku>>>=0,sl>>>=0,gl>>>=0,this===Cu)return 0;let El=gl-sl,xl=ku-xu;const Rl=Math.min(El,xl),Tl=this.slice(sl,gl),Sl=Cu.slice(xu,ku);for(let Dl=0;Dl<Rl;++Dl)if(Tl[Dl]!==Sl[Dl]){El=Tl[Dl],xl=Sl[Dl];break}return El<xl?-1:xl<El?1:0};function qu(Nu,Cu,xu,ku,sl){if(Nu.length===0)return-1;if(typeof xu=="string"?(ku=xu,xu=0):xu>2147483647?xu=2147483647:xu<-2147483648&&(xu=-2147483648),xu=+xu,Al(xu)&&(xu=sl?0:Nu.length-1),xu<0&&(xu=Nu.length+xu),xu>=Nu.length){if(sl)return-1;xu=Nu.length-1}else if(xu<0)if(sl)xu=0;else return-1;if(typeof Cu=="string"&&(Cu=Zs.from(Cu,ku)),Zs.isBuffer(Cu))return Cu.length===0?-1:zu(Nu,Cu,xu,ku,sl);if(typeof Cu=="number")return Cu=Cu&255,typeof Uint8Array.prototype.indexOf=="function"?sl?Uint8Array.prototype.indexOf.call(Nu,Cu,xu):Uint8Array.prototype.lastIndexOf.call(Nu,Cu,xu):zu(Nu,[Cu],xu,ku,sl);throw new TypeError("val must be string, number or Buffer")}function zu(Nu,Cu,xu,ku,sl){let gl=1,El=Nu.length,xl=Cu.length;if(ku!==void 0&&(ku=String(ku).toLowerCase(),ku==="ucs2"||ku==="ucs-2"||ku==="utf16le"||ku==="utf-16le")){if(Nu.length<2||Cu.length<2)return-1;gl=2,El/=2,xl/=2,xu/=2}function Rl(Sl,Dl){return gl===1?Sl[Dl]:Sl.readUInt16BE(Dl*gl)}let Tl;if(sl){let Sl=-1;for(Tl=xu;Tl<El;Tl++)if(Rl(Nu,Tl)===Rl(Cu,Sl===-1?0:Tl-Sl)){if(Sl===-1&&(Sl=Tl),Tl-Sl+1===xl)return Sl*gl}else Sl!==-1&&(Tl-=Tl-Sl),Sl=-1}else for(xu+xl>El&&(xu=El-xl),Tl=xu;Tl>=0;Tl--){let Sl=!0;for(let Dl=0;Dl<xl;Dl++)if(Rl(Nu,Tl+Dl)!==Rl(Cu,Dl)){Sl=!1;break}if(Sl)return Tl}return-1}Zs.prototype.includes=function(Cu,xu,ku){return this.indexOf(Cu,xu,ku)!==-1},Zs.prototype.indexOf=function(Cu,xu,ku){return qu(this,Cu,xu,ku,!0)},Zs.prototype.lastIndexOf=function(Cu,xu,ku){return qu(this,Cu,xu,ku,!1)};function tl(Nu,Cu,xu,ku){xu=Number(xu)||0;const sl=Nu.length-xu;ku?(ku=Number(ku),ku>sl&&(ku=sl)):ku=sl;const gl=Cu.length;ku>gl/2&&(ku=gl/2);let El;for(El=0;El<ku;++El){const xl=parseInt(Cu.substr(El*2,2),16);if(Al(xl))return El;Nu[xu+El]=xl}return El}function Wu(Nu,Cu,xu,ku){return fl(Ju(Cu,Nu.length-xu),Nu,xu,ku)}function cl(Nu,Cu,xu,ku){return fl(ll(Cu),Nu,xu,ku)}function wl(Nu,Cu,xu,ku){return fl(Zu(Cu),Nu,xu,ku)}function hl(Nu,Cu,xu,ku){return fl(Ku(Cu,Nu.length-xu),Nu,xu,ku)}Zs.prototype.write=function(Cu,xu,ku,sl){if(xu===void 0)sl="utf8",ku=this.length,xu=0;else if(ku===void 0&&typeof xu=="string")sl=xu,ku=this.length,xu=0;else if(isFinite(xu))xu=xu>>>0,isFinite(ku)?(ku=ku>>>0,sl===void 0&&(sl="utf8")):(sl=ku,ku=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const gl=this.length-xu;if((ku===void 0||ku>gl)&&(ku=gl),Cu.length>0&&(ku<0||xu<0)||xu>this.length)throw new RangeError("Attempt to write outside buffer bounds");sl||(sl="utf8");let El=!1;for(;;)switch(sl){case"hex":return tl(this,Cu,xu,ku);case"utf8":case"utf-8":return Wu(this,Cu,xu,ku);case"ascii":case"latin1":case"binary":return cl(this,Cu,xu,ku);case"base64":return wl(this,Cu,xu,ku);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return hl(this,Cu,xu,ku);default:if(El)throw new TypeError("Unknown encoding: "+sl);sl=(""+sl).toLowerCase(),El=!0}},Zs.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Qu(Nu,Cu,xu){return Cu===0&&xu===Nu.length?t.fromByteArray(Nu):t.fromByteArray(Nu.slice(Cu,xu))}function rl(Nu,Cu,xu){xu=Math.min(Nu.length,xu);const ku=[];let sl=Cu;for(;sl<xu;){const gl=Nu[sl];let El=null,xl=gl>239?4:gl>223?3:gl>191?2:1;if(sl+xl<=xu){let Rl,Tl,Sl,Dl;switch(xl){case 1:gl<128&&(El=gl);break;case 2:Rl=Nu[sl+1],(Rl&192)===128&&(Dl=(gl&31)<<6|Rl&63,Dl>127&&(El=Dl));break;case 3:Rl=Nu[sl+1],Tl=Nu[sl+2],(Rl&192)===128&&(Tl&192)===128&&(Dl=(gl&15)<<12|(Rl&63)<<6|Tl&63,Dl>2047&&(Dl<55296||Dl>57343)&&(El=Dl));break;case 4:Rl=Nu[sl+1],Tl=Nu[sl+2],Sl=Nu[sl+3],(Rl&192)===128&&(Tl&192)===128&&(Sl&192)===128&&(Dl=(gl&15)<<18|(Rl&63)<<12|(Tl&63)<<6|Sl&63,Dl>65535&&Dl<1114112&&(El=Dl))}}El===null?(El=65533,xl=1):El>65535&&(El-=65536,ku.push(El>>>10&1023|55296),El=56320|El&1023),ku.push(El),sl+=xl}return ju(ku)}const Hu=4096;function ju(Nu){const Cu=Nu.length;if(Cu<=Hu)return String.fromCharCode.apply(String,Nu);let xu="",ku=0;for(;ku<Cu;)xu+=String.fromCharCode.apply(String,Nu.slice(ku,ku+=Hu));return xu}function Yu(Nu,Cu,xu){let ku="";xu=Math.min(Nu.length,xu);for(let sl=Cu;sl<xu;++sl)ku+=String.fromCharCode(Nu[sl]&127);return ku}function ul(Nu,Cu,xu){let ku="";xu=Math.min(Nu.length,xu);for(let sl=Cu;sl<xu;++sl)ku+=String.fromCharCode(Nu[sl]);return ku}function Xu(Nu,Cu,xu){const ku=Nu.length;(!Cu||Cu<0)&&(Cu=0),(!xu||xu<0||xu>ku)&&(xu=ku);let sl="";for(let gl=Cu;gl<xu;++gl)sl+=_l[Nu[gl]];return sl}function al(Nu,Cu,xu){const ku=Nu.slice(Cu,xu);let sl="";for(let gl=0;gl<ku.length-1;gl+=2)sl+=String.fromCharCode(ku[gl]+ku[gl+1]*256);return sl}Zs.prototype.slice=function(Cu,xu){const ku=this.length;Cu=~~Cu,xu=xu===void 0?ku:~~xu,Cu<0?(Cu+=ku,Cu<0&&(Cu=0)):Cu>ku&&(Cu=ku),xu<0?(xu+=ku,xu<0&&(xu=0)):xu>ku&&(xu=ku),xu<Cu&&(xu=Cu);const sl=this.subarray(Cu,xu);return Object.setPrototypeOf(sl,Zs.prototype),sl};function pl(Nu,Cu,xu){if(Nu%1!==0||Nu<0)throw new RangeError("offset is not uint");if(Nu+Cu>xu)throw new RangeError("Trying to access beyond buffer length")}Zs.prototype.readUintLE=Zs.prototype.readUIntLE=function(Cu,xu,ku){Cu=Cu>>>0,xu=xu>>>0,ku||pl(Cu,xu,this.length);let sl=this[Cu],gl=1,El=0;for(;++El<xu&&(gl*=256);)sl+=this[Cu+El]*gl;return sl},Zs.prototype.readUintBE=Zs.prototype.readUIntBE=function(Cu,xu,ku){Cu=Cu>>>0,xu=xu>>>0,ku||pl(Cu,xu,this.length);let sl=this[Cu+--xu],gl=1;for(;xu>0&&(gl*=256);)sl+=this[Cu+--xu]*gl;return sl},Zs.prototype.readUint8=Zs.prototype.readUInt8=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,1,this.length),this[Cu]},Zs.prototype.readUint16LE=Zs.prototype.readUInt16LE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,2,this.length),this[Cu]|this[Cu+1]<<8},Zs.prototype.readUint16BE=Zs.prototype.readUInt16BE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,2,this.length),this[Cu]<<8|this[Cu+1]},Zs.prototype.readUint32LE=Zs.prototype.readUInt32LE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,4,this.length),(this[Cu]|this[Cu+1]<<8|this[Cu+2]<<16)+this[Cu+3]*16777216},Zs.prototype.readUint32BE=Zs.prototype.readUInt32BE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,4,this.length),this[Cu]*16777216+(this[Cu+1]<<16|this[Cu+2]<<8|this[Cu+3])},Zs.prototype.readBigUInt64LE=Cl(function(Cu){Cu=Cu>>>0,Vu(Cu,"offset");const xu=this[Cu],ku=this[Cu+7];(xu===void 0||ku===void 0)&&Gu(Cu,this.length-8);const sl=xu+this[++Cu]*2**8+this[++Cu]*2**16+this[++Cu]*2**24,gl=this[++Cu]+this[++Cu]*2**8+this[++Cu]*2**16+ku*2**24;return BigInt(sl)+(BigInt(gl)<<BigInt(32))}),Zs.prototype.readBigUInt64BE=Cl(function(Cu){Cu=Cu>>>0,Vu(Cu,"offset");const xu=this[Cu],ku=this[Cu+7];(xu===void 0||ku===void 0)&&Gu(Cu,this.length-8);const sl=xu*2**24+this[++Cu]*2**16+this[++Cu]*2**8+this[++Cu],gl=this[++Cu]*2**24+this[++Cu]*2**16+this[++Cu]*2**8+ku;return(BigInt(sl)<<BigInt(32))+BigInt(gl)}),Zs.prototype.readIntLE=function(Cu,xu,ku){Cu=Cu>>>0,xu=xu>>>0,ku||pl(Cu,xu,this.length);let sl=this[Cu],gl=1,El=0;for(;++El<xu&&(gl*=256);)sl+=this[Cu+El]*gl;return gl*=128,sl>=gl&&(sl-=Math.pow(2,8*xu)),sl},Zs.prototype.readIntBE=function(Cu,xu,ku){Cu=Cu>>>0,xu=xu>>>0,ku||pl(Cu,xu,this.length);let sl=xu,gl=1,El=this[Cu+--sl];for(;sl>0&&(gl*=256);)El+=this[Cu+--sl]*gl;return gl*=128,El>=gl&&(El-=Math.pow(2,8*xu)),El},Zs.prototype.readInt8=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,1,this.length),this[Cu]&128?(255-this[Cu]+1)*-1:this[Cu]},Zs.prototype.readInt16LE=function(Cu,xu){Cu=Cu>>>0,xu||pl(Cu,2,this.length);const ku=this[Cu]|this[Cu+1]<<8;return ku&32768?ku|4294901760:ku},Zs.prototype.readInt16BE=function(Cu,xu){Cu=Cu>>>0,xu||pl(Cu,2,this.length);const ku=this[Cu+1]|this[Cu]<<8;return ku&32768?ku|4294901760:ku},Zs.prototype.readInt32LE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,4,this.length),this[Cu]|this[Cu+1]<<8|this[Cu+2]<<16|this[Cu+3]<<24},Zs.prototype.readInt32BE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,4,this.length),this[Cu]<<24|this[Cu+1]<<16|this[Cu+2]<<8|this[Cu+3]},Zs.prototype.readBigInt64LE=Cl(function(Cu){Cu=Cu>>>0,Vu(Cu,"offset");const xu=this[Cu],ku=this[Cu+7];(xu===void 0||ku===void 0)&&Gu(Cu,this.length-8);const sl=this[Cu+4]+this[Cu+5]*2**8+this[Cu+6]*2**16+(ku<<24);return(BigInt(sl)<<BigInt(32))+BigInt(xu+this[++Cu]*2**8+this[++Cu]*2**16+this[++Cu]*2**24)}),Zs.prototype.readBigInt64BE=Cl(function(Cu){Cu=Cu>>>0,Vu(Cu,"offset");const xu=this[Cu],ku=this[Cu+7];(xu===void 0||ku===void 0)&&Gu(Cu,this.length-8);const sl=(xu<<24)+this[++Cu]*2**16+this[++Cu]*2**8+this[++Cu];return(BigInt(sl)<<BigInt(32))+BigInt(this[++Cu]*2**24+this[++Cu]*2**16+this[++Cu]*2**8+ku)}),Zs.prototype.readFloatLE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,4,this.length),Z.read(this,Cu,!0,23,4)},Zs.prototype.readFloatBE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,4,this.length),Z.read(this,Cu,!1,23,4)},Zs.prototype.readDoubleLE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,8,this.length),Z.read(this,Cu,!0,52,8)},Zs.prototype.readDoubleBE=function(Cu,xu){return Cu=Cu>>>0,xu||pl(Cu,8,this.length),Z.read(this,Cu,!1,52,8)};function ml(Nu,Cu,xu,ku,sl,gl){if(!Zs.isBuffer(Nu))throw new TypeError('"buffer" argument must be a Buffer instance');if(Cu>sl||Cu<gl)throw new RangeError('"value" argument is out of bounds');if(xu+ku>Nu.length)throw new RangeError("Index out of range")}Zs.prototype.writeUintLE=Zs.prototype.writeUIntLE=function(Cu,xu,ku,sl){if(Cu=+Cu,xu=xu>>>0,ku=ku>>>0,!sl){const xl=Math.pow(2,8*ku)-1;ml(this,Cu,xu,ku,xl,0)}let gl=1,El=0;for(this[xu]=Cu&255;++El<ku&&(gl*=256);)this[xu+El]=Cu/gl&255;return xu+ku},Zs.prototype.writeUintBE=Zs.prototype.writeUIntBE=function(Cu,xu,ku,sl){if(Cu=+Cu,xu=xu>>>0,ku=ku>>>0,!sl){const xl=Math.pow(2,8*ku)-1;ml(this,Cu,xu,ku,xl,0)}let gl=ku-1,El=1;for(this[xu+gl]=Cu&255;--gl>=0&&(El*=256);)this[xu+gl]=Cu/El&255;return xu+ku},Zs.prototype.writeUint8=Zs.prototype.writeUInt8=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,1,255,0),this[xu]=Cu&255,xu+1},Zs.prototype.writeUint16LE=Zs.prototype.writeUInt16LE=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,2,65535,0),this[xu]=Cu&255,this[xu+1]=Cu>>>8,xu+2},Zs.prototype.writeUint16BE=Zs.prototype.writeUInt16BE=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,2,65535,0),this[xu]=Cu>>>8,this[xu+1]=Cu&255,xu+2},Zs.prototype.writeUint32LE=Zs.prototype.writeUInt32LE=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,4,4294967295,0),this[xu+3]=Cu>>>24,this[xu+2]=Cu>>>16,this[xu+1]=Cu>>>8,this[xu]=Cu&255,xu+4},Zs.prototype.writeUint32BE=Zs.prototype.writeUInt32BE=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,4,4294967295,0),this[xu]=Cu>>>24,this[xu+1]=Cu>>>16,this[xu+2]=Cu>>>8,this[xu+3]=Cu&255,xu+4};function Il(Nu,Cu,xu,ku,sl){Ou(Cu,ku,sl,Nu,xu,7);let gl=Number(Cu&BigInt(4294967295));Nu[xu++]=gl,gl=gl>>8,Nu[xu++]=gl,gl=gl>>8,Nu[xu++]=gl,gl=gl>>8,Nu[xu++]=gl;let El=Number(Cu>>BigInt(32)&BigInt(4294967295));return Nu[xu++]=El,El=El>>8,Nu[xu++]=El,El=El>>8,Nu[xu++]=El,El=El>>8,Nu[xu++]=El,xu}function dl(Nu,Cu,xu,ku,sl){Ou(Cu,ku,sl,Nu,xu,7);let gl=Number(Cu&BigInt(4294967295));Nu[xu+7]=gl,gl=gl>>8,Nu[xu+6]=gl,gl=gl>>8,Nu[xu+5]=gl,gl=gl>>8,Nu[xu+4]=gl;let El=Number(Cu>>BigInt(32)&BigInt(4294967295));return Nu[xu+3]=El,El=El>>8,Nu[xu+2]=El,El=El>>8,Nu[xu+1]=El,El=El>>8,Nu[xu]=El,xu+8}Zs.prototype.writeBigUInt64LE=Cl(function(Cu,xu=0){return Il(this,Cu,xu,BigInt(0),BigInt("0xffffffffffffffff"))}),Zs.prototype.writeBigUInt64BE=Cl(function(Cu,xu=0){return dl(this,Cu,xu,BigInt(0),BigInt("0xffffffffffffffff"))}),Zs.prototype.writeIntLE=function(Cu,xu,ku,sl){if(Cu=+Cu,xu=xu>>>0,!sl){const Rl=Math.pow(2,8*ku-1);ml(this,Cu,xu,ku,Rl-1,-Rl)}let gl=0,El=1,xl=0;for(this[xu]=Cu&255;++gl<ku&&(El*=256);)Cu<0&&xl===0&&this[xu+gl-1]!==0&&(xl=1),this[xu+gl]=(Cu/El>>0)-xl&255;return xu+ku},Zs.prototype.writeIntBE=function(Cu,xu,ku,sl){if(Cu=+Cu,xu=xu>>>0,!sl){const Rl=Math.pow(2,8*ku-1);ml(this,Cu,xu,ku,Rl-1,-Rl)}let gl=ku-1,El=1,xl=0;for(this[xu+gl]=Cu&255;--gl>=0&&(El*=256);)Cu<0&&xl===0&&this[xu+gl+1]!==0&&(xl=1),this[xu+gl]=(Cu/El>>0)-xl&255;return xu+ku},Zs.prototype.writeInt8=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,1,127,-128),Cu<0&&(Cu=255+Cu+1),this[xu]=Cu&255,xu+1},Zs.prototype.writeInt16LE=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,2,32767,-32768),this[xu]=Cu&255,this[xu+1]=Cu>>>8,xu+2},Zs.prototype.writeInt16BE=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,2,32767,-32768),this[xu]=Cu>>>8,this[xu+1]=Cu&255,xu+2},Zs.prototype.writeInt32LE=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,4,2147483647,-2147483648),this[xu]=Cu&255,this[xu+1]=Cu>>>8,this[xu+2]=Cu>>>16,this[xu+3]=Cu>>>24,xu+4},Zs.prototype.writeInt32BE=function(Cu,xu,ku){return Cu=+Cu,xu=xu>>>0,ku||ml(this,Cu,xu,4,2147483647,-2147483648),Cu<0&&(Cu=4294967295+Cu+1),this[xu]=Cu>>>24,this[xu+1]=Cu>>>16,this[xu+2]=Cu>>>8,this[xu+3]=Cu&255,xu+4},Zs.prototype.writeBigInt64LE=Cl(function(Cu,xu=0){return Il(this,Cu,xu,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),Zs.prototype.writeBigInt64BE=Cl(function(Cu,xu=0){return dl(this,Cu,xu,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function vl(Nu,Cu,xu,ku,sl,gl){if(xu+ku>Nu.length)throw new RangeError("Index out of range");if(xu<0)throw new RangeError("Index out of range")}function nl(Nu,Cu,xu,ku,sl){return Cu=+Cu,xu=xu>>>0,sl||vl(Nu,Cu,xu,4),Z.write(Nu,Cu,xu,ku,23,4),xu+4}Zs.prototype.writeFloatLE=function(Cu,xu,ku){return nl(this,Cu,xu,!0,ku)},Zs.prototype.writeFloatBE=function(Cu,xu,ku){return nl(this,Cu,xu,!1,ku)};function el(Nu,Cu,xu,ku,sl){return Cu=+Cu,xu=xu>>>0,sl||vl(Nu,Cu,xu,8),Z.write(Nu,Cu,xu,ku,52,8),xu+8}Zs.prototype.writeDoubleLE=function(Cu,xu,ku){return el(this,Cu,xu,!0,ku)},Zs.prototype.writeDoubleBE=function(Cu,xu,ku){return el(this,Cu,xu,!1,ku)},Zs.prototype.copy=function(Cu,xu,ku,sl){if(!Zs.isBuffer(Cu))throw new TypeError("argument should be a Buffer");if(ku||(ku=0),!sl&&sl!==0&&(sl=this.length),xu>=Cu.length&&(xu=Cu.length),xu||(xu=0),sl>0&&sl<ku&&(sl=ku),sl===ku||Cu.length===0||this.length===0)return 0;if(xu<0)throw new RangeError("targetStart out of bounds");if(ku<0||ku>=this.length)throw new RangeError("Index out of range");if(sl<0)throw new RangeError("sourceEnd out of bounds");sl>this.length&&(sl=this.length),Cu.length-xu<sl-ku&&(sl=Cu.length-xu+ku);const gl=sl-ku;return this===Cu&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(xu,ku,sl):Uint8Array.prototype.set.call(Cu,this.subarray(ku,sl),xu),gl},Zs.prototype.fill=function(Cu,xu,ku,sl){if(typeof Cu=="string"){if(typeof xu=="string"?(sl=xu,xu=0,ku=this.length):typeof ku=="string"&&(sl=ku,ku=this.length),sl!==void 0&&typeof sl!="string")throw new TypeError("encoding must be a string");if(typeof sl=="string"&&!Zs.isEncoding(sl))throw new TypeError("Unknown encoding: "+sl);if(Cu.length===1){const El=Cu.charCodeAt(0);(sl==="utf8"&&El<128||sl==="latin1")&&(Cu=El)}}else typeof Cu=="number"?Cu=Cu&255:typeof Cu=="boolean"&&(Cu=Number(Cu));if(xu<0||this.length<xu||this.length<ku)throw new RangeError("Out of range index");if(ku<=xu)return this;xu=xu>>>0,ku=ku===void 0?this.length:ku>>>0,Cu||(Cu=0);let gl;if(typeof Cu=="number")for(gl=xu;gl<ku;++gl)this[gl]=Cu;else{const El=Zs.isBuffer(Cu)?Cu:Zs.from(Cu,sl),xl=El.length;if(xl===0)throw new TypeError('The value "'+Cu+'" is invalid for argument "value"');for(gl=0;gl<ku-xu;++gl)this[gl+xu]=El[gl%xl]}return this};const yl={};function bl(Nu,Cu,xu){yl[Nu]=class extends xu{constructor(){super(),Object.defineProperty(this,"message",{value:Cu.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Nu}]`,this.stack,delete this.name}get code(){return Nu}set code(sl){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:sl,writable:!0})}toString(){return`${this.name} [${Nu}]: ${this.message}`}}}bl("ERR_BUFFER_OUT_OF_BOUNDS",function(Nu){return Nu?`${Nu} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),bl("ERR_INVALID_ARG_TYPE",function(Nu,Cu){return`The "${Nu}" argument must be of type number. Received type ${typeof Cu}`},TypeError),bl("ERR_OUT_OF_RANGE",function(Nu,Cu,xu){let ku=`The value of "${Nu}" is out of range.`,sl=xu;return Number.isInteger(xu)&&Math.abs(xu)>2**32?sl=Mu(String(xu)):typeof xu=="bigint"&&(sl=String(xu),(xu>BigInt(2)**BigInt(32)||xu<-(BigInt(2)**BigInt(32)))&&(sl=Mu(sl)),sl+="n"),ku+=` It must be ${Cu}. Received ${sl}`,ku},RangeError);function Mu(Nu){let Cu="",xu=Nu.length;const ku=Nu[0]==="-"?1:0;for(;xu>=ku+4;xu-=3)Cu=`_${Nu.slice(xu-3,xu)}${Cu}`;return`${Nu.slice(0,xu)}${Cu}`}function Ru(Nu,Cu,xu){Vu(Cu,"offset"),(Nu[Cu]===void 0||Nu[Cu+xu]===void 0)&&Gu(Cu,Nu.length-(xu+1))}function Ou(Nu,Cu,xu,ku,sl,gl){if(Nu>xu||Nu<Cu){const El=typeof Cu=="bigint"?"n":"";let xl;throw gl>3?Cu===0||Cu===BigInt(0)?xl=`>= 0${El} and < 2${El} ** ${(gl+1)*8}${El}`:xl=`>= -(2${El} ** ${(gl+1)*8-1}${El}) and < 2 ** ${(gl+1)*8-1}${El}`:xl=`>= ${Cu}${El} and <= ${xu}${El}`,new yl.ERR_OUT_OF_RANGE("value",xl,Nu)}Ru(ku,sl,gl)}function Vu(Nu,Cu){if(typeof Nu!="number")throw new yl.ERR_INVALID_ARG_TYPE(Cu,"number",Nu)}function Gu(Nu,Cu,xu){throw Math.floor(Nu)!==Nu?(Vu(Nu,xu),new yl.ERR_OUT_OF_RANGE(xu||"offset","an integer",Nu)):Cu<0?new yl.ERR_BUFFER_OUT_OF_BOUNDS:new yl.ERR_OUT_OF_RANGE(xu||"offset",`>= ${xu?1:0} and <= ${Cu}`,Nu)}const il=/[^+/0-9A-Za-z-_]/g;function ol(Nu){if(Nu=Nu.split("=")[0],Nu=Nu.trim().replace(il,""),Nu.length<2)return"";for(;Nu.length%4!==0;)Nu=Nu+"=";return Nu}function Ju(Nu,Cu){Cu=Cu||1/0;let xu;const ku=Nu.length;let sl=null;const gl=[];for(let El=0;El<ku;++El){if(xu=Nu.charCodeAt(El),xu>55295&&xu<57344){if(!sl){if(xu>56319){(Cu-=3)>-1&&gl.push(239,191,189);continue}else if(El+1===ku){(Cu-=3)>-1&&gl.push(239,191,189);continue}sl=xu;continue}if(xu<56320){(Cu-=3)>-1&&gl.push(239,191,189),sl=xu;continue}xu=(sl-55296<<10|xu-56320)+65536}else sl&&(Cu-=3)>-1&&gl.push(239,191,189);if(sl=null,xu<128){if((Cu-=1)<0)break;gl.push(xu)}else if(xu<2048){if((Cu-=2)<0)break;gl.push(xu>>6|192,xu&63|128)}else if(xu<65536){if((Cu-=3)<0)break;gl.push(xu>>12|224,xu>>6&63|128,xu&63|128)}else if(xu<1114112){if((Cu-=4)<0)break;gl.push(xu>>18|240,xu>>12&63|128,xu>>6&63|128,xu&63|128)}else throw new Error("Invalid code point")}return gl}function ll(Nu){const Cu=[];for(let xu=0;xu<Nu.length;++xu)Cu.push(Nu.charCodeAt(xu)&255);return Cu}function Ku(Nu,Cu){let xu,ku,sl;const gl=[];for(let El=0;El<Nu.length&&!((Cu-=2)<0);++El)xu=Nu.charCodeAt(El),ku=xu>>8,sl=xu%256,gl.push(sl),gl.push(ku);return gl}function Zu(Nu){return t.toByteArray(ol(Nu))}function fl(Nu,Cu,xu,ku){let sl;for(sl=0;sl<ku&&!(sl+xu>=Cu.length||sl>=Nu.length);++sl)Cu[sl+xu]=Nu[sl];return sl}function $l(Nu,Cu){return Nu instanceof Cu||Nu!=null&&Nu.constructor!=null&&Nu.constructor.name!=null&&Nu.constructor.name===Cu.name}function Al(Nu){return Nu!==Nu}const _l=function(){const Nu="0123456789abcdef",Cu=new Array(256);for(let xu=0;xu<16;++xu){const ku=xu*16;for(let sl=0;sl<16;++sl)Cu[ku+sl]=Nu[xu]+Nu[sl]}return Cu}();function Cl(Nu){return typeof BigInt>"u"?Bl:Nu}function Bl(){throw new Error("BigInt not supported")}})(buffer);var browser$2={},canPromise$1=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},qrcode={},utils$4={};let toSJISFunction;const CODEWORDS_COUNT=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];utils$4.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};utils$4.getSymbolTotalCodewords=function(t){return CODEWORDS_COUNT[t]};utils$4.getBCHDigit=function(F){let t=0;for(;F!==0;)t++,F>>>=1;return t};utils$4.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');toSJISFunction=t};utils$4.isKanjiModeEnabled=function(){return typeof toSJISFunction<"u"};utils$4.toSJIS=function(t){return toSJISFunction(t)};var errorCorrectionLevel={};(function(F){F.L={bit:1},F.M={bit:0},F.Q={bit:3},F.H={bit:2};function t(Z){if(typeof Z!="string")throw new Error("Param is not a string");switch(Z.toLowerCase()){case"l":case"low":return F.L;case"m":case"medium":return F.M;case"q":case"quartile":return F.Q;case"h":case"high":return F.H;default:throw new Error("Unknown EC Level: "+Z)}}F.isValid=function(at){return at&&typeof at.bit<"u"&&at.bit>=0&&at.bit<4},F.from=function(at,Hs){if(F.isValid(at))return at;try{return t(at)}catch{return Hs}}})(errorCorrectionLevel);function BitBuffer$1(){this.buffer=[],this.length=0}BitBuffer$1.prototype={get:function(F){const t=Math.floor(F/8);return(this.buffer[t]>>>7-F%8&1)===1},put:function(F,t){for(let Z=0;Z<t;Z++)this.putBit((F>>>t-Z-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(F){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),F&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var bitBuffer=BitBuffer$1;function BitMatrix$1(F){if(!F||F<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=F,this.data=new Uint8Array(F*F),this.reservedBit=new Uint8Array(F*F)}BitMatrix$1.prototype.set=function(F,t,Z,at){const Hs=F*this.size+t;this.data[Hs]=Z,at&&(this.reservedBit[Hs]=!0)};BitMatrix$1.prototype.get=function(F,t){return this.data[F*this.size+t]};BitMatrix$1.prototype.xor=function(F,t,Z){this.data[F*this.size+t]^=Z};BitMatrix$1.prototype.isReserved=function(F,t){return this.reservedBit[F*this.size+t]};var bitMatrix=BitMatrix$1,alignmentPattern={};(function(F){const t=utils$4.getSymbolSize;F.getRowColCoords=function(at){if(at===1)return[];const Hs=Math.floor(at/7)+2,zs=t(at),Ys=zs===145?26:Math.ceil((zs-13)/(2*Hs-2))*2,Zs=[zs-7];for(let $u=1;$u<Hs-1;$u++)Zs[$u]=Zs[$u-1]-Ys;return Zs.push(6),Zs.reverse()},F.getPositions=function(at){const Hs=[],zs=F.getRowColCoords(at),Ys=zs.length;for(let Zs=0;Zs<Ys;Zs++)for(let $u=0;$u<Ys;$u++)Zs===0&&$u===0||Zs===0&&$u===Ys-1||Zs===Ys-1&&$u===0||Hs.push([zs[Zs],zs[$u]]);return Hs}})(alignmentPattern);var finderPattern={};const getSymbolSize=utils$4.getSymbolSize,FINDER_PATTERN_SIZE=7;finderPattern.getPositions=function(t){const Z=getSymbolSize(t);return[[0,0],[Z-FINDER_PATTERN_SIZE,0],[0,Z-FINDER_PATTERN_SIZE]]};var maskPattern={};(function(F){F.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};F.isValid=function(Hs){return Hs!=null&&Hs!==""&&!isNaN(Hs)&&Hs>=0&&Hs<=7},F.from=function(Hs){return F.isValid(Hs)?parseInt(Hs,10):void 0},F.getPenaltyN1=function(Hs){const zs=Hs.size;let Ys=0,Zs=0,$u=0,Eu=null,Au=null;for(let vu=0;vu<zs;vu++){Zs=$u=0,Eu=Au=null;for(let Iu=0;Iu<zs;Iu++){let _u=Hs.get(vu,Iu);_u===Eu?Zs++:(Zs>=5&&(Ys+=t.N1+(Zs-5)),Eu=_u,Zs=1),_u=Hs.get(Iu,vu),_u===Au?$u++:($u>=5&&(Ys+=t.N1+($u-5)),Au=_u,$u=1)}Zs>=5&&(Ys+=t.N1+(Zs-5)),$u>=5&&(Ys+=t.N1+($u-5))}return Ys},F.getPenaltyN2=function(Hs){const zs=Hs.size;let Ys=0;for(let Zs=0;Zs<zs-1;Zs++)for(let $u=0;$u<zs-1;$u++){const Eu=Hs.get(Zs,$u)+Hs.get(Zs,$u+1)+Hs.get(Zs+1,$u)+Hs.get(Zs+1,$u+1);(Eu===4||Eu===0)&&Ys++}return Ys*t.N2},F.getPenaltyN3=function(Hs){const zs=Hs.size;let Ys=0,Zs=0,$u=0;for(let Eu=0;Eu<zs;Eu++){Zs=$u=0;for(let Au=0;Au<zs;Au++)Zs=Zs<<1&2047|Hs.get(Eu,Au),Au>=10&&(Zs===1488||Zs===93)&&Ys++,$u=$u<<1&2047|Hs.get(Au,Eu),Au>=10&&($u===1488||$u===93)&&Ys++}return Ys*t.N3},F.getPenaltyN4=function(Hs){let zs=0;const Ys=Hs.data.length;for(let $u=0;$u<Ys;$u++)zs+=Hs.data[$u];return Math.abs(Math.ceil(zs*100/Ys/5)-10)*t.N4};function Z(at,Hs,zs){switch(at){case F.Patterns.PATTERN000:return(Hs+zs)%2===0;case F.Patterns.PATTERN001:return Hs%2===0;case F.Patterns.PATTERN010:return zs%3===0;case F.Patterns.PATTERN011:return(Hs+zs)%3===0;case F.Patterns.PATTERN100:return(Math.floor(Hs/2)+Math.floor(zs/3))%2===0;case F.Patterns.PATTERN101:return Hs*zs%2+Hs*zs%3===0;case F.Patterns.PATTERN110:return(Hs*zs%2+Hs*zs%3)%2===0;case F.Patterns.PATTERN111:return(Hs*zs%3+(Hs+zs)%2)%2===0;default:throw new Error("bad maskPattern:"+at)}}F.applyMask=function(Hs,zs){const Ys=zs.size;for(let Zs=0;Zs<Ys;Zs++)for(let $u=0;$u<Ys;$u++)zs.isReserved($u,Zs)||zs.xor($u,Zs,Z(Hs,$u,Zs))},F.getBestMask=function(Hs,zs){const Ys=Object.keys(F.Patterns).length;let Zs=0,$u=1/0;for(let Eu=0;Eu<Ys;Eu++){zs(Eu),F.applyMask(Eu,Hs);const Au=F.getPenaltyN1(Hs)+F.getPenaltyN2(Hs)+F.getPenaltyN3(Hs)+F.getPenaltyN4(Hs);F.applyMask(Eu,Hs),Au<$u&&($u=Au,Zs=Eu)}return Zs}})(maskPattern);var errorCorrectionCode={};const ECLevel$1=errorCorrectionLevel,EC_BLOCKS_TABLE=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],EC_CODEWORDS_TABLE=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];errorCorrectionCode.getBlocksCount=function(t,Z){switch(Z){case ECLevel$1.L:return EC_BLOCKS_TABLE[(t-1)*4+0];case ECLevel$1.M:return EC_BLOCKS_TABLE[(t-1)*4+1];case ECLevel$1.Q:return EC_BLOCKS_TABLE[(t-1)*4+2];case ECLevel$1.H:return EC_BLOCKS_TABLE[(t-1)*4+3];default:return}};errorCorrectionCode.getTotalCodewordsCount=function(t,Z){switch(Z){case ECLevel$1.L:return EC_CODEWORDS_TABLE[(t-1)*4+0];case ECLevel$1.M:return EC_CODEWORDS_TABLE[(t-1)*4+1];case ECLevel$1.Q:return EC_CODEWORDS_TABLE[(t-1)*4+2];case ECLevel$1.H:return EC_CODEWORDS_TABLE[(t-1)*4+3];default:return}};var polynomial={},galoisField={};const EXP_TABLE=new Uint8Array(512),LOG_TABLE=new Uint8Array(256);(function(){let t=1;for(let Z=0;Z<255;Z++)EXP_TABLE[Z]=t,LOG_TABLE[t]=Z,t<<=1,t&256&&(t^=285);for(let Z=255;Z<512;Z++)EXP_TABLE[Z]=EXP_TABLE[Z-255]})();galoisField.log=function(t){if(t<1)throw new Error("log("+t+")");return LOG_TABLE[t]};galoisField.exp=function(t){return EXP_TABLE[t]};galoisField.mul=function(t,Z){return t===0||Z===0?0:EXP_TABLE[LOG_TABLE[t]+LOG_TABLE[Z]]};(function(F){const t=galoisField;F.mul=function(at,Hs){const zs=new Uint8Array(at.length+Hs.length-1);for(let Ys=0;Ys<at.length;Ys++)for(let Zs=0;Zs<Hs.length;Zs++)zs[Ys+Zs]^=t.mul(at[Ys],Hs[Zs]);return zs},F.mod=function(at,Hs){let zs=new Uint8Array(at);for(;zs.length-Hs.length>=0;){const Ys=zs[0];for(let $u=0;$u<Hs.length;$u++)zs[$u]^=t.mul(Hs[$u],Ys);let Zs=0;for(;Zs<zs.length&&zs[Zs]===0;)Zs++;zs=zs.slice(Zs)}return zs},F.generateECPolynomial=function(at){let Hs=new Uint8Array([1]);for(let zs=0;zs<at;zs++)Hs=F.mul(Hs,new Uint8Array([1,t.exp(zs)]));return Hs}})(polynomial);const Polynomial=polynomial;function ReedSolomonEncoder$1(F){this.genPoly=void 0,this.degree=F,this.degree&&this.initialize(this.degree)}ReedSolomonEncoder$1.prototype.initialize=function(t){this.degree=t,this.genPoly=Polynomial.generateECPolynomial(this.degree)};ReedSolomonEncoder$1.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const Z=new Uint8Array(t.length+this.degree);Z.set(t);const at=Polynomial.mod(Z,this.genPoly),Hs=this.degree-at.length;if(Hs>0){const zs=new Uint8Array(this.degree);return zs.set(at,Hs),zs}return at};var reedSolomonEncoder=ReedSolomonEncoder$1,version$1={},mode={},versionCheck={};versionCheck.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var regex={};const numeric="[0-9]+",alphanumeric="[A-Z $%*+\\-./:]+";let kanji="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";kanji=kanji.replace(/u/g,"\\u");const byte="(?:(?![A-Z0-9 $%*+\\-./:]|"+kanji+`)(?:.|[\r
]))+`;regex.KANJI=new RegExp(kanji,"g");regex.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");regex.BYTE=new RegExp(byte,"g");regex.NUMERIC=new RegExp(numeric,"g");regex.ALPHANUMERIC=new RegExp(alphanumeric,"g");const TEST_KANJI=new RegExp("^"+kanji+"$"),TEST_NUMERIC=new RegExp("^"+numeric+"$"),TEST_ALPHANUMERIC=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");regex.testKanji=function(t){return TEST_KANJI.test(t)};regex.testNumeric=function(t){return TEST_NUMERIC.test(t)};regex.testAlphanumeric=function(t){return TEST_ALPHANUMERIC.test(t)};(function(F){const t=versionCheck,Z=regex;F.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},F.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},F.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},F.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},F.MIXED={bit:-1},F.getCharCountIndicator=function(zs,Ys){if(!zs.ccBits)throw new Error("Invalid mode: "+zs);if(!t.isValid(Ys))throw new Error("Invalid version: "+Ys);return Ys>=1&&Ys<10?zs.ccBits[0]:Ys<27?zs.ccBits[1]:zs.ccBits[2]},F.getBestModeForData=function(zs){return Z.testNumeric(zs)?F.NUMERIC:Z.testAlphanumeric(zs)?F.ALPHANUMERIC:Z.testKanji(zs)?F.KANJI:F.BYTE},F.toString=function(zs){if(zs&&zs.id)return zs.id;throw new Error("Invalid mode")},F.isValid=function(zs){return zs&&zs.bit&&zs.ccBits};function at(Hs){if(typeof Hs!="string")throw new Error("Param is not a string");switch(Hs.toLowerCase()){case"numeric":return F.NUMERIC;case"alphanumeric":return F.ALPHANUMERIC;case"kanji":return F.KANJI;case"byte":return F.BYTE;default:throw new Error("Unknown mode: "+Hs)}}F.from=function(zs,Ys){if(F.isValid(zs))return zs;try{return at(zs)}catch{return Ys}}})(mode);(function(F){const t=utils$4,Z=errorCorrectionCode,at=errorCorrectionLevel,Hs=mode,zs=versionCheck,Ys=7973,Zs=t.getBCHDigit(Ys);function $u(Iu,_u,Su){for(let Bu=1;Bu<=40;Bu++)if(_u<=F.getCapacity(Bu,Su,Iu))return Bu}function Eu(Iu,_u){return Hs.getCharCountIndicator(Iu,_u)+4}function Au(Iu,_u){let Su=0;return Iu.forEach(function(Bu){const Du=Eu(Bu.mode,_u);Su+=Du+Bu.getBitsLength()}),Su}function vu(Iu,_u){for(let Su=1;Su<=40;Su++)if(Au(Iu,Su)<=F.getCapacity(Su,_u,Hs.MIXED))return Su}F.from=function(_u,Su){return zs.isValid(_u)?parseInt(_u,10):Su},F.getCapacity=function(_u,Su,Bu){if(!zs.isValid(_u))throw new Error("Invalid QR Code version");typeof Bu>"u"&&(Bu=Hs.BYTE);const Du=t.getSymbolTotalCodewords(_u),Tu=Z.getTotalCodewordsCount(_u,Su),Pu=(Du-Tu)*8;if(Bu===Hs.MIXED)return Pu;const Uu=Pu-Eu(Bu,_u);switch(Bu){case Hs.NUMERIC:return Math.floor(Uu/10*3);case Hs.ALPHANUMERIC:return Math.floor(Uu/11*2);case Hs.KANJI:return Math.floor(Uu/13);case Hs.BYTE:default:return Math.floor(Uu/8)}},F.getBestVersionForData=function(_u,Su){let Bu;const Du=at.from(Su,at.M);if(Array.isArray(_u)){if(_u.length>1)return vu(_u,Du);if(_u.length===0)return 1;Bu=_u[0]}else Bu=_u;return $u(Bu.mode,Bu.getLength(),Du)},F.getEncodedBits=function(_u){if(!zs.isValid(_u)||_u<7)throw new Error("Invalid QR Code version");let Su=_u<<12;for(;t.getBCHDigit(Su)-Zs>=0;)Su^=Ys<<t.getBCHDigit(Su)-Zs;return _u<<12|Su}})(version$1);var formatInfo={};const Utils$3=utils$4,G15=1335,G15_MASK=21522,G15_BCH=Utils$3.getBCHDigit(G15);formatInfo.getEncodedBits=function(t,Z){const at=t.bit<<3|Z;let Hs=at<<10;for(;Utils$3.getBCHDigit(Hs)-G15_BCH>=0;)Hs^=G15<<Utils$3.getBCHDigit(Hs)-G15_BCH;return(at<<10|Hs)^G15_MASK};var segments={};const Mode$4=mode;function NumericData(F){this.mode=Mode$4.NUMERIC,this.data=F.toString()}NumericData.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};NumericData.prototype.getLength=function(){return this.data.length};NumericData.prototype.getBitsLength=function(){return NumericData.getBitsLength(this.data.length)};NumericData.prototype.write=function(t){let Z,at,Hs;for(Z=0;Z+3<=this.data.length;Z+=3)at=this.data.substr(Z,3),Hs=parseInt(at,10),t.put(Hs,10);const zs=this.data.length-Z;zs>0&&(at=this.data.substr(Z),Hs=parseInt(at,10),t.put(Hs,zs*3+1))};var numericData=NumericData;const Mode$3=mode,ALPHA_NUM_CHARS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function AlphanumericData(F){this.mode=Mode$3.ALPHANUMERIC,this.data=F}AlphanumericData.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};AlphanumericData.prototype.getLength=function(){return this.data.length};AlphanumericData.prototype.getBitsLength=function(){return AlphanumericData.getBitsLength(this.data.length)};AlphanumericData.prototype.write=function(t){let Z;for(Z=0;Z+2<=this.data.length;Z+=2){let at=ALPHA_NUM_CHARS.indexOf(this.data[Z])*45;at+=ALPHA_NUM_CHARS.indexOf(this.data[Z+1]),t.put(at,11)}this.data.length%2&&t.put(ALPHA_NUM_CHARS.indexOf(this.data[Z]),6)};var alphanumericData=AlphanumericData;const Mode$2=mode;function ByteData(F){this.mode=Mode$2.BYTE,typeof F=="string"?this.data=new TextEncoder().encode(F):this.data=new Uint8Array(F)}ByteData.getBitsLength=function(t){return t*8};ByteData.prototype.getLength=function(){return this.data.length};ByteData.prototype.getBitsLength=function(){return ByteData.getBitsLength(this.data.length)};ByteData.prototype.write=function(F){for(let t=0,Z=this.data.length;t<Z;t++)F.put(this.data[t],8)};var byteData=ByteData;const Mode$1=mode,Utils$2=utils$4;function KanjiData(F){this.mode=Mode$1.KANJI,this.data=F}KanjiData.getBitsLength=function(t){return t*13};KanjiData.prototype.getLength=function(){return this.data.length};KanjiData.prototype.getBitsLength=function(){return KanjiData.getBitsLength(this.data.length)};KanjiData.prototype.write=function(F){let t;for(t=0;t<this.data.length;t++){let Z=Utils$2.toSJIS(this.data[t]);if(Z>=33088&&Z<=40956)Z-=33088;else if(Z>=57408&&Z<=60351)Z-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);Z=(Z>>>8&255)*192+(Z&255),F.put(Z,13)}};var kanjiData=KanjiData,dijkstra={exports:{}};(function(F){var t={single_source_shortest_paths:function(Z,at,Hs){var zs={},Ys={};Ys[at]=0;var Zs=t.PriorityQueue.make();Zs.push(at,0);for(var $u,Eu,Au,vu,Iu,_u,Su,Bu,Du;!Zs.empty();){$u=Zs.pop(),Eu=$u.value,vu=$u.cost,Iu=Z[Eu]||{};for(Au in Iu)Iu.hasOwnProperty(Au)&&(_u=Iu[Au],Su=vu+_u,Bu=Ys[Au],Du=typeof Ys[Au]>"u",(Du||Bu>Su)&&(Ys[Au]=Su,Zs.push(Au,Su),zs[Au]=Eu))}if(typeof Hs<"u"&&typeof Ys[Hs]>"u"){var Tu=["Could not find a path from ",at," to ",Hs,"."].join("");throw new Error(Tu)}return zs},extract_shortest_path_from_predecessor_list:function(Z,at){for(var Hs=[],zs=at;zs;)Hs.push(zs),Z[zs],zs=Z[zs];return Hs.reverse(),Hs},find_path:function(Z,at,Hs){var zs=t.single_source_shortest_paths(Z,at,Hs);return t.extract_shortest_path_from_predecessor_list(zs,Hs)},PriorityQueue:{make:function(Z){var at=t.PriorityQueue,Hs={},zs;Z=Z||{};for(zs in at)at.hasOwnProperty(zs)&&(Hs[zs]=at[zs]);return Hs.queue=[],Hs.sorter=Z.sorter||at.default_sorter,Hs},default_sorter:function(Z,at){return Z.cost-at.cost},push:function(Z,at){var Hs={value:Z,cost:at};this.queue.push(Hs),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};F.exports=t})(dijkstra);var dijkstraExports=dijkstra.exports;(function(F){const t=mode,Z=numericData,at=alphanumericData,Hs=byteData,zs=kanjiData,Ys=regex,Zs=utils$4,$u=dijkstraExports;function Eu(Tu){return unescape(encodeURIComponent(Tu)).length}function Au(Tu,Pu,Uu){const Fu=[];let Lu;for(;(Lu=Tu.exec(Uu))!==null;)Fu.push({data:Lu[0],index:Lu.index,mode:Pu,length:Lu[0].length});return Fu}function vu(Tu){const Pu=Au(Ys.NUMERIC,t.NUMERIC,Tu),Uu=Au(Ys.ALPHANUMERIC,t.ALPHANUMERIC,Tu);let Fu,Lu;return Zs.isKanjiModeEnabled()?(Fu=Au(Ys.BYTE,t.BYTE,Tu),Lu=Au(Ys.KANJI,t.KANJI,Tu)):(Fu=Au(Ys.BYTE_KANJI,t.BYTE,Tu),Lu=[]),Pu.concat(Uu,Fu,Lu).sort(function(zu,tl){return zu.index-tl.index}).map(function(zu){return{data:zu.data,mode:zu.mode,length:zu.length}})}function Iu(Tu,Pu){switch(Pu){case t.NUMERIC:return Z.getBitsLength(Tu);case t.ALPHANUMERIC:return at.getBitsLength(Tu);case t.KANJI:return zs.getBitsLength(Tu);case t.BYTE:return Hs.getBitsLength(Tu)}}function _u(Tu){return Tu.reduce(function(Pu,Uu){const Fu=Pu.length-1>=0?Pu[Pu.length-1]:null;return Fu&&Fu.mode===Uu.mode?(Pu[Pu.length-1].data+=Uu.data,Pu):(Pu.push(Uu),Pu)},[])}function Su(Tu){const Pu=[];for(let Uu=0;Uu<Tu.length;Uu++){const Fu=Tu[Uu];switch(Fu.mode){case t.NUMERIC:Pu.push([Fu,{data:Fu.data,mode:t.ALPHANUMERIC,length:Fu.length},{data:Fu.data,mode:t.BYTE,length:Fu.length}]);break;case t.ALPHANUMERIC:Pu.push([Fu,{data:Fu.data,mode:t.BYTE,length:Fu.length}]);break;case t.KANJI:Pu.push([Fu,{data:Fu.data,mode:t.BYTE,length:Eu(Fu.data)}]);break;case t.BYTE:Pu.push([{data:Fu.data,mode:t.BYTE,length:Eu(Fu.data)}])}}return Pu}function Bu(Tu,Pu){const Uu={},Fu={start:{}};let Lu=["start"];for(let qu=0;qu<Tu.length;qu++){const zu=Tu[qu],tl=[];for(let Wu=0;Wu<zu.length;Wu++){const cl=zu[Wu],wl=""+qu+Wu;tl.push(wl),Uu[wl]={node:cl,lastCount:0},Fu[wl]={};for(let hl=0;hl<Lu.length;hl++){const Qu=Lu[hl];Uu[Qu]&&Uu[Qu].node.mode===cl.mode?(Fu[Qu][wl]=Iu(Uu[Qu].lastCount+cl.length,cl.mode)-Iu(Uu[Qu].lastCount,cl.mode),Uu[Qu].lastCount+=cl.length):(Uu[Qu]&&(Uu[Qu].lastCount=cl.length),Fu[Qu][wl]=Iu(cl.length,cl.mode)+4+t.getCharCountIndicator(cl.mode,Pu))}}Lu=tl}for(let qu=0;qu<Lu.length;qu++)Fu[Lu[qu]].end=0;return{map:Fu,table:Uu}}function Du(Tu,Pu){let Uu;const Fu=t.getBestModeForData(Tu);if(Uu=t.from(Pu,Fu),Uu!==t.BYTE&&Uu.bit<Fu.bit)throw new Error('"'+Tu+'" cannot be encoded with mode '+t.toString(Uu)+`.
 Suggested mode is: `+t.toString(Fu));switch(Uu===t.KANJI&&!Zs.isKanjiModeEnabled()&&(Uu=t.BYTE),Uu){case t.NUMERIC:return new Z(Tu);case t.ALPHANUMERIC:return new at(Tu);case t.KANJI:return new zs(Tu);case t.BYTE:return new Hs(Tu)}}F.fromArray=function(Pu){return Pu.reduce(function(Uu,Fu){return typeof Fu=="string"?Uu.push(Du(Fu,null)):Fu.data&&Uu.push(Du(Fu.data,Fu.mode)),Uu},[])},F.fromString=function(Pu,Uu){const Fu=vu(Pu,Zs.isKanjiModeEnabled()),Lu=Su(Fu),qu=Bu(Lu,Uu),zu=$u.find_path(qu.map,"start","end"),tl=[];for(let Wu=1;Wu<zu.length-1;Wu++)tl.push(qu.table[zu[Wu]].node);return F.fromArray(_u(tl))},F.rawSplit=function(Pu){return F.fromArray(vu(Pu,Zs.isKanjiModeEnabled()))}})(segments);const Utils$1=utils$4,ECLevel=errorCorrectionLevel,BitBuffer=bitBuffer,BitMatrix=bitMatrix,AlignmentPattern=alignmentPattern,FinderPattern=finderPattern,MaskPattern=maskPattern,ECCode=errorCorrectionCode,ReedSolomonEncoder=reedSolomonEncoder,Version=version$1,FormatInfo=formatInfo,Mode=mode,Segments=segments;function setupFinderPattern(F,t){const Z=F.size,at=FinderPattern.getPositions(t);for(let Hs=0;Hs<at.length;Hs++){const zs=at[Hs][0],Ys=at[Hs][1];for(let Zs=-1;Zs<=7;Zs++)if(!(zs+Zs<=-1||Z<=zs+Zs))for(let $u=-1;$u<=7;$u++)Ys+$u<=-1||Z<=Ys+$u||(Zs>=0&&Zs<=6&&($u===0||$u===6)||$u>=0&&$u<=6&&(Zs===0||Zs===6)||Zs>=2&&Zs<=4&&$u>=2&&$u<=4?F.set(zs+Zs,Ys+$u,!0,!0):F.set(zs+Zs,Ys+$u,!1,!0))}}function setupTimingPattern(F){const t=F.size;for(let Z=8;Z<t-8;Z++){const at=Z%2===0;F.set(Z,6,at,!0),F.set(6,Z,at,!0)}}function setupAlignmentPattern(F,t){const Z=AlignmentPattern.getPositions(t);for(let at=0;at<Z.length;at++){const Hs=Z[at][0],zs=Z[at][1];for(let Ys=-2;Ys<=2;Ys++)for(let Zs=-2;Zs<=2;Zs++)Ys===-2||Ys===2||Zs===-2||Zs===2||Ys===0&&Zs===0?F.set(Hs+Ys,zs+Zs,!0,!0):F.set(Hs+Ys,zs+Zs,!1,!0)}}function setupVersionInfo(F,t){const Z=F.size,at=Version.getEncodedBits(t);let Hs,zs,Ys;for(let Zs=0;Zs<18;Zs++)Hs=Math.floor(Zs/3),zs=Zs%3+Z-8-3,Ys=(at>>Zs&1)===1,F.set(Hs,zs,Ys,!0),F.set(zs,Hs,Ys,!0)}function setupFormatInfo(F,t,Z){const at=F.size,Hs=FormatInfo.getEncodedBits(t,Z);let zs,Ys;for(zs=0;zs<15;zs++)Ys=(Hs>>zs&1)===1,zs<6?F.set(zs,8,Ys,!0):zs<8?F.set(zs+1,8,Ys,!0):F.set(at-15+zs,8,Ys,!0),zs<8?F.set(8,at-zs-1,Ys,!0):zs<9?F.set(8,15-zs-1+1,Ys,!0):F.set(8,15-zs-1,Ys,!0);F.set(at-8,8,1,!0)}function setupData(F,t){const Z=F.size;let at=-1,Hs=Z-1,zs=7,Ys=0;for(let Zs=Z-1;Zs>0;Zs-=2)for(Zs===6&&Zs--;;){for(let $u=0;$u<2;$u++)if(!F.isReserved(Hs,Zs-$u)){let Eu=!1;Ys<t.length&&(Eu=(t[Ys]>>>zs&1)===1),F.set(Hs,Zs-$u,Eu),zs--,zs===-1&&(Ys++,zs=7)}if(Hs+=at,Hs<0||Z<=Hs){Hs-=at,at=-at;break}}}function createData(F,t,Z){const at=new BitBuffer;Z.forEach(function($u){at.put($u.mode.bit,4),at.put($u.getLength(),Mode.getCharCountIndicator($u.mode,F)),$u.write(at)});const Hs=Utils$1.getSymbolTotalCodewords(F),zs=ECCode.getTotalCodewordsCount(F,t),Ys=(Hs-zs)*8;for(at.getLengthInBits()+4<=Ys&&at.put(0,4);at.getLengthInBits()%8!==0;)at.putBit(0);const Zs=(Ys-at.getLengthInBits())/8;for(let $u=0;$u<Zs;$u++)at.put($u%2?17:236,8);return createCodewords(at,F,t)}function createCodewords(F,t,Z){const at=Utils$1.getSymbolTotalCodewords(t),Hs=ECCode.getTotalCodewordsCount(t,Z),zs=at-Hs,Ys=ECCode.getBlocksCount(t,Z),Zs=at%Ys,$u=Ys-Zs,Eu=Math.floor(at/Ys),Au=Math.floor(zs/Ys),vu=Au+1,Iu=Eu-Au,_u=new ReedSolomonEncoder(Iu);let Su=0;const Bu=new Array(Ys),Du=new Array(Ys);let Tu=0;const Pu=new Uint8Array(F.buffer);for(let zu=0;zu<Ys;zu++){const tl=zu<$u?Au:vu;Bu[zu]=Pu.slice(Su,Su+tl),Du[zu]=_u.encode(Bu[zu]),Su+=tl,Tu=Math.max(Tu,tl)}const Uu=new Uint8Array(at);let Fu=0,Lu,qu;for(Lu=0;Lu<Tu;Lu++)for(qu=0;qu<Ys;qu++)Lu<Bu[qu].length&&(Uu[Fu++]=Bu[qu][Lu]);for(Lu=0;Lu<Iu;Lu++)for(qu=0;qu<Ys;qu++)Uu[Fu++]=Du[qu][Lu];return Uu}function createSymbol(F,t,Z,at){let Hs;if(Array.isArray(F))Hs=Segments.fromArray(F);else if(typeof F=="string"){let Eu=t;if(!Eu){const Au=Segments.rawSplit(F);Eu=Version.getBestVersionForData(Au,Z)}Hs=Segments.fromString(F,Eu||40)}else throw new Error("Invalid data");const zs=Version.getBestVersionForData(Hs,Z);if(!zs)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=zs;else if(t<zs)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+zs+`.
`);const Ys=createData(t,Z,Hs),Zs=Utils$1.getSymbolSize(t),$u=new BitMatrix(Zs);return setupFinderPattern($u,t),setupTimingPattern($u),setupAlignmentPattern($u,t),setupFormatInfo($u,Z,0),t>=7&&setupVersionInfo($u,t),setupData($u,Ys),isNaN(at)&&(at=MaskPattern.getBestMask($u,setupFormatInfo.bind(null,$u,Z))),MaskPattern.applyMask(at,$u),setupFormatInfo($u,Z,at),{modules:$u,version:t,errorCorrectionLevel:Z,maskPattern:at,segments:Hs}}qrcode.create=function(t,Z){if(typeof t>"u"||t==="")throw new Error("No input text");let at=ECLevel.M,Hs,zs;return typeof Z<"u"&&(at=ECLevel.from(Z.errorCorrectionLevel,ECLevel.M),Hs=Version.from(Z.version),zs=MaskPattern.from(Z.maskPattern),Z.toSJISFunc&&Utils$1.setToSJISFunction(Z.toSJISFunc)),createSymbol(t,Hs,at,zs)};var canvas={},utils$3={};(function(F){function t(Z){if(typeof Z=="number"&&(Z=Z.toString()),typeof Z!="string")throw new Error("Color should be defined as hex string");let at=Z.slice().replace("#","").split("");if(at.length<3||at.length===5||at.length>8)throw new Error("Invalid hex color: "+Z);(at.length===3||at.length===4)&&(at=Array.prototype.concat.apply([],at.map(function(zs){return[zs,zs]}))),at.length===6&&at.push("F","F");const Hs=parseInt(at.join(""),16);return{r:Hs>>24&255,g:Hs>>16&255,b:Hs>>8&255,a:Hs&255,hex:"#"+at.slice(0,6).join("")}}F.getOptions=function(at){at||(at={}),at.color||(at.color={});const Hs=typeof at.margin>"u"||at.margin===null||at.margin<0?4:at.margin,zs=at.width&&at.width>=21?at.width:void 0,Ys=at.scale||4;return{width:zs,scale:zs?4:Ys,margin:Hs,color:{dark:t(at.color.dark||"#000000ff"),light:t(at.color.light||"#ffffffff")},type:at.type,rendererOpts:at.rendererOpts||{}}},F.getScale=function(at,Hs){return Hs.width&&Hs.width>=at+Hs.margin*2?Hs.width/(at+Hs.margin*2):Hs.scale},F.getImageWidth=function(at,Hs){const zs=F.getScale(at,Hs);return Math.floor((at+Hs.margin*2)*zs)},F.qrToImageData=function(at,Hs,zs){const Ys=Hs.modules.size,Zs=Hs.modules.data,$u=F.getScale(Ys,zs),Eu=Math.floor((Ys+zs.margin*2)*$u),Au=zs.margin*$u,vu=[zs.color.light,zs.color.dark];for(let Iu=0;Iu<Eu;Iu++)for(let _u=0;_u<Eu;_u++){let Su=(Iu*Eu+_u)*4,Bu=zs.color.light;if(Iu>=Au&&_u>=Au&&Iu<Eu-Au&&_u<Eu-Au){const Du=Math.floor((Iu-Au)/$u),Tu=Math.floor((_u-Au)/$u);Bu=vu[Zs[Du*Ys+Tu]?1:0]}at[Su++]=Bu.r,at[Su++]=Bu.g,at[Su++]=Bu.b,at[Su]=Bu.a}}})(utils$3);(function(F){const t=utils$3;function Z(Hs,zs,Ys){Hs.clearRect(0,0,zs.width,zs.height),zs.style||(zs.style={}),zs.height=Ys,zs.width=Ys,zs.style.height=Ys+"px",zs.style.width=Ys+"px"}function at(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}F.render=function(zs,Ys,Zs){let $u=Zs,Eu=Ys;typeof $u>"u"&&(!Ys||!Ys.getContext)&&($u=Ys,Ys=void 0),Ys||(Eu=at()),$u=t.getOptions($u);const Au=t.getImageWidth(zs.modules.size,$u),vu=Eu.getContext("2d"),Iu=vu.createImageData(Au,Au);return t.qrToImageData(Iu.data,zs,$u),Z(vu,Eu,Au),vu.putImageData(Iu,0,0),Eu},F.renderToDataURL=function(zs,Ys,Zs){let $u=Zs;typeof $u>"u"&&(!Ys||!Ys.getContext)&&($u=Ys,Ys=void 0),$u||($u={});const Eu=F.render(zs,Ys,$u),Au=$u.type||"image/png",vu=$u.rendererOpts||{};return Eu.toDataURL(Au,vu.quality)}})(canvas);var svgTag={};const Utils=utils$3;function getColorAttrib(F,t){const Z=F.a/255,at=t+'="'+F.hex+'"';return Z<1?at+" "+t+'-opacity="'+Z.toFixed(2).slice(1)+'"':at}function svgCmd(F,t,Z){let at=F+t;return typeof Z<"u"&&(at+=" "+Z),at}function qrToPath(F,t,Z){let at="",Hs=0,zs=!1,Ys=0;for(let Zs=0;Zs<F.length;Zs++){const $u=Math.floor(Zs%t),Eu=Math.floor(Zs/t);!$u&&!zs&&(zs=!0),F[Zs]?(Ys++,Zs>0&&$u>0&&F[Zs-1]||(at+=zs?svgCmd("M",$u+Z,.5+Eu+Z):svgCmd("m",Hs,0),Hs=0,zs=!1),$u+1<t&&F[Zs+1]||(at+=svgCmd("h",Ys),Ys=0)):Hs++}return at}svgTag.render=function(t,Z,at){const Hs=Utils.getOptions(Z),zs=t.modules.size,Ys=t.modules.data,Zs=zs+Hs.margin*2,$u=Hs.color.light.a?"<path "+getColorAttrib(Hs.color.light,"fill")+' d="M0 0h'+Zs+"v"+Zs+'H0z"/>':"",Eu="<path "+getColorAttrib(Hs.color.dark,"stroke")+' d="'+qrToPath(Ys,zs,Hs.margin)+'"/>',Au='viewBox="0 0 '+Zs+" "+Zs+'"',Iu='<svg xmlns="http://www.w3.org/2000/svg" '+(Hs.width?'width="'+Hs.width+'" height="'+Hs.width+'" ':"")+Au+' shape-rendering="crispEdges">'+$u+Eu+`</svg>
`;return typeof at=="function"&&at(null,Iu),Iu};const canPromise=canPromise$1,QRCode=qrcode,CanvasRenderer=canvas,SvgRenderer=svgTag;function renderCanvas(F,t,Z,at,Hs){const zs=[].slice.call(arguments,1),Ys=zs.length,Zs=typeof zs[Ys-1]=="function";if(!Zs&&!canPromise())throw new Error("Callback required as last argument");if(Zs){if(Ys<2)throw new Error("Too few arguments provided");Ys===2?(Hs=Z,Z=t,t=at=void 0):Ys===3&&(t.getContext&&typeof Hs>"u"?(Hs=at,at=void 0):(Hs=at,at=Z,Z=t,t=void 0))}else{if(Ys<1)throw new Error("Too few arguments provided");return Ys===1?(Z=t,t=at=void 0):Ys===2&&!t.getContext&&(at=Z,Z=t,t=void 0),new Promise(function($u,Eu){try{const Au=QRCode.create(Z,at);$u(F(Au,t,at))}catch(Au){Eu(Au)}})}try{const $u=QRCode.create(Z,at);Hs(null,F($u,t,at))}catch($u){Hs($u)}}browser$2.create=QRCode.create;browser$2.toCanvas=renderCanvas.bind(null,CanvasRenderer.render);browser$2.toDataURL=renderCanvas.bind(null,CanvasRenderer.renderToDataURL);browser$2.toString=renderCanvas.bind(null,function(F,t,Z){return SvgRenderer.render(F,Z)});var out$1={},walletConnectV2Provider={},message={},address={},ALPHABET$1="qpzry9x8gf2tvdw0s3jn54khce6mua7l",ALPHABET_MAP={};for(var z$4=0;z$4<ALPHABET$1.length;z$4++){var x$4=ALPHABET$1.charAt(z$4);if(ALPHABET_MAP[x$4]!==void 0)throw new TypeError(x$4+" is ambiguous");ALPHABET_MAP[x$4]=z$4}function polymodStep(F){var t=F>>25;return(F&33554431)<<5^-(t>>0&1)&996825010^-(t>>1&1)&642813549^-(t>>2&1)&513874426^-(t>>3&1)&1027748829^-(t>>4&1)&705979059}function prefixChk(F){for(var t=1,Z=0;Z<F.length;++Z){var at=F.charCodeAt(Z);if(at<33||at>126)return"Invalid prefix ("+F+")";t=polymodStep(t)^at>>5}for(t=polymodStep(t),Z=0;Z<F.length;++Z){var Hs=F.charCodeAt(Z);t=polymodStep(t)^Hs&31}return t}function encode$3(F,t,Z){if(Z=Z||90,F.length+7+t.length>Z)throw new TypeError("Exceeds length limit");F=F.toLowerCase();var at=prefixChk(F);if(typeof at=="string")throw new Error(at);for(var Hs=F+"1",zs=0;zs<t.length;++zs){var Ys=t[zs];if(Ys>>5)throw new Error("Non 5-bit word");at=polymodStep(at)^Ys,Hs+=ALPHABET$1.charAt(Ys)}for(zs=0;zs<6;++zs)at=polymodStep(at);for(at^=1,zs=0;zs<6;++zs){var Zs=at>>(5-zs)*5&31;Hs+=ALPHABET$1.charAt(Zs)}return Hs}function __decode(F,t){if(t=t||90,F.length<8)return F+" too short";if(F.length>t)return"Exceeds length limit";var Z=F.toLowerCase(),at=F.toUpperCase();if(F!==Z&&F!==at)return"Mixed-case string "+F;F=Z;var Hs=F.lastIndexOf("1");if(Hs===-1)return"No separator character for "+F;if(Hs===0)return"Missing prefix for "+F;var zs=F.slice(0,Hs),Ys=F.slice(Hs+1);if(Ys.length<6)return"Data too short";var Zs=prefixChk(zs);if(typeof Zs=="string")return Zs;for(var $u=[],Eu=0;Eu<Ys.length;++Eu){var Au=Ys.charAt(Eu),vu=ALPHABET_MAP[Au];if(vu===void 0)return"Unknown character "+Au;Zs=polymodStep(Zs)^vu,!(Eu+6>=Ys.length)&&$u.push(vu)}return Zs!==1?"Invalid checksum for "+F:{prefix:zs,words:$u}}function decodeUnsafe(){var F=__decode.apply(null,arguments);if(typeof F=="object")return F}function decode$3(F){var t=__decode.apply(null,arguments);if(typeof t=="object")return t;throw new Error(t)}function convert$1(F,t,Z,at){for(var Hs=0,zs=0,Ys=(1<<Z)-1,Zs=[],$u=0;$u<F.length;++$u)for(Hs=Hs<<t|F[$u],zs+=t;zs>=Z;)zs-=Z,Zs.push(Hs>>zs&Ys);if(at)zs>0&&Zs.push(Hs<<Z-zs&Ys);else{if(zs>=t)return"Excess padding";if(Hs<<Z-zs&Ys)return"Non-zero padding"}return Zs}function toWordsUnsafe(F){var t=convert$1(F,8,5,!0);if(Array.isArray(t))return t}function toWords(F){var t=convert$1(F,8,5,!0);if(Array.isArray(t))return t;throw new Error(t)}function fromWordsUnsafe(F){var t=convert$1(F,5,8,!1);if(Array.isArray(t))return t}function fromWords(F){var t=convert$1(F,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}var bech32$1={decodeUnsafe,decode:decode$3,encode:encode$3,toWordsUnsafe,toWords,fromWordsUnsafe,fromWords},bignumber={exports:{}};(function(F){(function(t){var Z,at=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Hs=Math.ceil,zs=Math.floor,Ys="[BigNumber Error] ",Zs=Ys+"Number primitive has more than 15 significant digits: ",$u=1e14,Eu=14,Au=9007199254740991,vu=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Iu=1e7,_u=1e9;function Su(qu){var zu,tl,Wu,cl=dl.prototype={constructor:dl,toString:null,valueOf:null},wl=new dl(1),hl=20,Qu=4,rl=-7,Hu=21,ju=-1e7,Yu=1e7,ul=!1,Xu=1,al=0,pl={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},ml="0123456789abcdefghijklmnopqrstuvwxyz",Il=!0;function dl(Mu,Ru){var Ou,Vu,Gu,il,ol,Ju,ll,Ku,Zu=this;if(!(Zu instanceof dl))return new dl(Mu,Ru);if(Ru==null){if(Mu&&Mu._isBigNumber===!0){Zu.s=Mu.s,!Mu.c||Mu.e>Yu?Zu.c=Zu.e=null:Mu.e<ju?Zu.c=[Zu.e=0]:(Zu.e=Mu.e,Zu.c=Mu.c.slice());return}if((Ju=typeof Mu=="number")&&Mu*0==0){if(Zu.s=1/Mu<0?(Mu=-Mu,-1):1,Mu===~~Mu){for(il=0,ol=Mu;ol>=10;ol/=10,il++);il>Yu?Zu.c=Zu.e=null:(Zu.e=il,Zu.c=[Mu]);return}Ku=String(Mu)}else{if(!at.test(Ku=String(Mu)))return Wu(Zu,Ku,Ju);Zu.s=Ku.charCodeAt(0)==45?(Ku=Ku.slice(1),-1):1}(il=Ku.indexOf("."))>-1&&(Ku=Ku.replace(".","")),(ol=Ku.search(/e/i))>0?(il<0&&(il=ol),il+=+Ku.slice(ol+1),Ku=Ku.substring(0,ol)):il<0&&(il=Ku.length)}else{if(Pu(Ru,2,ml.length,"Base"),Ru==10&&Il)return Zu=new dl(Mu),yl(Zu,hl+Zu.e+1,Qu);if(Ku=String(Mu),Ju=typeof Mu=="number"){if(Mu*0!=0)return Wu(Zu,Ku,Ju,Ru);if(Zu.s=1/Mu<0?(Ku=Ku.slice(1),-1):1,dl.DEBUG&&Ku.replace(/^0\.0*|\./,"").length>15)throw Error(Zs+Mu)}else Zu.s=Ku.charCodeAt(0)===45?(Ku=Ku.slice(1),-1):1;for(Ou=ml.slice(0,Ru),il=ol=0,ll=Ku.length;ol<ll;ol++)if(Ou.indexOf(Vu=Ku.charAt(ol))<0){if(Vu=="."){if(ol>il){il=ll;continue}}else if(!Gu&&(Ku==Ku.toUpperCase()&&(Ku=Ku.toLowerCase())||Ku==Ku.toLowerCase()&&(Ku=Ku.toUpperCase()))){Gu=!0,ol=-1,il=0;continue}return Wu(Zu,String(Mu),Ju,Ru)}Ju=!1,Ku=tl(Ku,Ru,10,Zu.s),(il=Ku.indexOf("."))>-1?Ku=Ku.replace(".",""):il=Ku.length}for(ol=0;Ku.charCodeAt(ol)===48;ol++);for(ll=Ku.length;Ku.charCodeAt(--ll)===48;);if(Ku=Ku.slice(ol,++ll)){if(ll-=ol,Ju&&dl.DEBUG&&ll>15&&(Mu>Au||Mu!==zs(Mu)))throw Error(Zs+Zu.s*Mu);if((il=il-ol-1)>Yu)Zu.c=Zu.e=null;else if(il<ju)Zu.c=[Zu.e=0];else{if(Zu.e=il,Zu.c=[],ol=(il+1)%Eu,il<0&&(ol+=Eu),ol<ll){for(ol&&Zu.c.push(+Ku.slice(0,ol)),ll-=Eu;ol<ll;)Zu.c.push(+Ku.slice(ol,ol+=Eu));ol=Eu-(Ku=Ku.slice(ol)).length}else ol-=ll;for(;ol--;Ku+="0");Zu.c.push(+Ku)}}else Zu.c=[Zu.e=0]}dl.clone=Su,dl.ROUND_UP=0,dl.ROUND_DOWN=1,dl.ROUND_CEIL=2,dl.ROUND_FLOOR=3,dl.ROUND_HALF_UP=4,dl.ROUND_HALF_DOWN=5,dl.ROUND_HALF_EVEN=6,dl.ROUND_HALF_CEIL=7,dl.ROUND_HALF_FLOOR=8,dl.EUCLID=9,dl.config=dl.set=function(Mu){var Ru,Ou;if(Mu!=null)if(typeof Mu=="object"){if(Mu.hasOwnProperty(Ru="DECIMAL_PLACES")&&(Ou=Mu[Ru],Pu(Ou,0,_u,Ru),hl=Ou),Mu.hasOwnProperty(Ru="ROUNDING_MODE")&&(Ou=Mu[Ru],Pu(Ou,0,8,Ru),Qu=Ou),Mu.hasOwnProperty(Ru="EXPONENTIAL_AT")&&(Ou=Mu[Ru],Ou&&Ou.pop?(Pu(Ou[0],-_u,0,Ru),Pu(Ou[1],0,_u,Ru),rl=Ou[0],Hu=Ou[1]):(Pu(Ou,-_u,_u,Ru),rl=-(Hu=Ou<0?-Ou:Ou))),Mu.hasOwnProperty(Ru="RANGE"))if(Ou=Mu[Ru],Ou&&Ou.pop)Pu(Ou[0],-_u,-1,Ru),Pu(Ou[1],1,_u,Ru),ju=Ou[0],Yu=Ou[1];else if(Pu(Ou,-_u,_u,Ru),Ou)ju=-(Yu=Ou<0?-Ou:Ou);else throw Error(Ys+Ru+" cannot be zero: "+Ou);if(Mu.hasOwnProperty(Ru="CRYPTO"))if(Ou=Mu[Ru],Ou===!!Ou)if(Ou)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ul=Ou;else throw ul=!Ou,Error(Ys+"crypto unavailable");else ul=Ou;else throw Error(Ys+Ru+" not true or false: "+Ou);if(Mu.hasOwnProperty(Ru="MODULO_MODE")&&(Ou=Mu[Ru],Pu(Ou,0,9,Ru),Xu=Ou),Mu.hasOwnProperty(Ru="POW_PRECISION")&&(Ou=Mu[Ru],Pu(Ou,0,_u,Ru),al=Ou),Mu.hasOwnProperty(Ru="FORMAT"))if(Ou=Mu[Ru],typeof Ou=="object")pl=Ou;else throw Error(Ys+Ru+" not an object: "+Ou);if(Mu.hasOwnProperty(Ru="ALPHABET"))if(Ou=Mu[Ru],typeof Ou=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Ou))Il=Ou.slice(0,10)=="0123456789",ml=Ou;else throw Error(Ys+Ru+" invalid: "+Ou)}else throw Error(Ys+"Object expected: "+Mu);return{DECIMAL_PLACES:hl,ROUNDING_MODE:Qu,EXPONENTIAL_AT:[rl,Hu],RANGE:[ju,Yu],CRYPTO:ul,MODULO_MODE:Xu,POW_PRECISION:al,FORMAT:pl,ALPHABET:ml}},dl.isBigNumber=function(Mu){if(!Mu||Mu._isBigNumber!==!0)return!1;if(!dl.DEBUG)return!0;var Ru,Ou,Vu=Mu.c,Gu=Mu.e,il=Mu.s;e:if({}.toString.call(Vu)=="[object Array]"){if((il===1||il===-1)&&Gu>=-_u&&Gu<=_u&&Gu===zs(Gu)){if(Vu[0]===0){if(Gu===0&&Vu.length===1)return!0;break e}if(Ru=(Gu+1)%Eu,Ru<1&&(Ru+=Eu),String(Vu[0]).length==Ru){for(Ru=0;Ru<Vu.length;Ru++)if(Ou=Vu[Ru],Ou<0||Ou>=$u||Ou!==zs(Ou))break e;if(Ou!==0)return!0}}}else if(Vu===null&&Gu===null&&(il===null||il===1||il===-1))return!0;throw Error(Ys+"Invalid BigNumber: "+Mu)},dl.maximum=dl.max=function(){return nl(arguments,-1)},dl.minimum=dl.min=function(){return nl(arguments,1)},dl.random=function(){var Mu=9007199254740992,Ru=Math.random()*Mu&2097151?function(){return zs(Math.random()*Mu)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Ou){var Vu,Gu,il,ol,Ju,ll=0,Ku=[],Zu=new dl(wl);if(Ou==null?Ou=hl:Pu(Ou,0,_u),ol=Hs(Ou/Eu),ul)if(crypto.getRandomValues){for(Vu=crypto.getRandomValues(new Uint32Array(ol*=2));ll<ol;)Ju=Vu[ll]*131072+(Vu[ll+1]>>>11),Ju>=9e15?(Gu=crypto.getRandomValues(new Uint32Array(2)),Vu[ll]=Gu[0],Vu[ll+1]=Gu[1]):(Ku.push(Ju%1e14),ll+=2);ll=ol/2}else if(crypto.randomBytes){for(Vu=crypto.randomBytes(ol*=7);ll<ol;)Ju=(Vu[ll]&31)*281474976710656+Vu[ll+1]*1099511627776+Vu[ll+2]*4294967296+Vu[ll+3]*16777216+(Vu[ll+4]<<16)+(Vu[ll+5]<<8)+Vu[ll+6],Ju>=9e15?crypto.randomBytes(7).copy(Vu,ll):(Ku.push(Ju%1e14),ll+=7);ll=ol/7}else throw ul=!1,Error(Ys+"crypto unavailable");if(!ul)for(;ll<ol;)Ju=Ru(),Ju<9e15&&(Ku[ll++]=Ju%1e14);for(ol=Ku[--ll],Ou%=Eu,ol&&Ou&&(Ju=vu[Eu-Ou],Ku[ll]=zs(ol/Ju)*Ju);Ku[ll]===0;Ku.pop(),ll--);if(ll<0)Ku=[il=0];else{for(il=-1;Ku[0]===0;Ku.splice(0,1),il-=Eu);for(ll=1,Ju=Ku[0];Ju>=10;Ju/=10,ll++);ll<Eu&&(il-=Eu-ll)}return Zu.e=il,Zu.c=Ku,Zu}}(),dl.sum=function(){for(var Mu=1,Ru=arguments,Ou=new dl(Ru[0]);Mu<Ru.length;)Ou=Ou.plus(Ru[Mu++]);return Ou},tl=function(){var Mu="0123456789";function Ru(Ou,Vu,Gu,il){for(var ol,Ju=[0],ll,Ku=0,Zu=Ou.length;Ku<Zu;){for(ll=Ju.length;ll--;Ju[ll]*=Vu);for(Ju[0]+=il.indexOf(Ou.charAt(Ku++)),ol=0;ol<Ju.length;ol++)Ju[ol]>Gu-1&&(Ju[ol+1]==null&&(Ju[ol+1]=0),Ju[ol+1]+=Ju[ol]/Gu|0,Ju[ol]%=Gu)}return Ju.reverse()}return function(Ou,Vu,Gu,il,ol){var Ju,ll,Ku,Zu,fl,$l,Al,_l,Cl=Ou.indexOf("."),Bl=hl,Nu=Qu;for(Cl>=0&&(Zu=al,al=0,Ou=Ou.replace(".",""),_l=new dl(Vu),$l=_l.pow(Ou.length-Cl),al=Zu,_l.c=Ru(Lu(Du($l.c),$l.e,"0"),10,Gu,Mu),_l.e=_l.c.length),Al=Ru(Ou,Vu,Gu,ol?(Ju=ml,Mu):(Ju=Mu,ml)),Ku=Zu=Al.length;Al[--Zu]==0;Al.pop());if(!Al[0])return Ju.charAt(0);if(Cl<0?--Ku:($l.c=Al,$l.e=Ku,$l.s=il,$l=zu($l,_l,Bl,Nu,Gu),Al=$l.c,fl=$l.r,Ku=$l.e),ll=Ku+Bl+1,Cl=Al[ll],Zu=Gu/2,fl=fl||ll<0||Al[ll+1]!=null,fl=Nu<4?(Cl!=null||fl)&&(Nu==0||Nu==($l.s<0?3:2)):Cl>Zu||Cl==Zu&&(Nu==4||fl||Nu==6&&Al[ll-1]&1||Nu==($l.s<0?8:7)),ll<1||!Al[0])Ou=fl?Lu(Ju.charAt(1),-Bl,Ju.charAt(0)):Ju.charAt(0);else{if(Al.length=ll,fl)for(--Gu;++Al[--ll]>Gu;)Al[ll]=0,ll||(++Ku,Al=[1].concat(Al));for(Zu=Al.length;!Al[--Zu];);for(Cl=0,Ou="";Cl<=Zu;Ou+=Ju.charAt(Al[Cl++]));Ou=Lu(Ou,Ku,Ju.charAt(0))}return Ou}}(),zu=function(){function Mu(Vu,Gu,il){var ol,Ju,ll,Ku,Zu=0,fl=Vu.length,$l=Gu%Iu,Al=Gu/Iu|0;for(Vu=Vu.slice();fl--;)ll=Vu[fl]%Iu,Ku=Vu[fl]/Iu|0,ol=Al*ll+Ku*$l,Ju=$l*ll+ol%Iu*Iu+Zu,Zu=(Ju/il|0)+(ol/Iu|0)+Al*Ku,Vu[fl]=Ju%il;return Zu&&(Vu=[Zu].concat(Vu)),Vu}function Ru(Vu,Gu,il,ol){var Ju,ll;if(il!=ol)ll=il>ol?1:-1;else for(Ju=ll=0;Ju<il;Ju++)if(Vu[Ju]!=Gu[Ju]){ll=Vu[Ju]>Gu[Ju]?1:-1;break}return ll}function Ou(Vu,Gu,il,ol){for(var Ju=0;il--;)Vu[il]-=Ju,Ju=Vu[il]<Gu[il]?1:0,Vu[il]=Ju*ol+Vu[il]-Gu[il];for(;!Vu[0]&&Vu.length>1;Vu.splice(0,1));}return function(Vu,Gu,il,ol,Ju){var ll,Ku,Zu,fl,$l,Al,_l,Cl,Bl,Nu,Cu,xu,ku,sl,gl,El,xl,Rl=Vu.s==Gu.s?1:-1,Tl=Vu.c,Sl=Gu.c;if(!Tl||!Tl[0]||!Sl||!Sl[0])return new dl(!Vu.s||!Gu.s||(Tl?Sl&&Tl[0]==Sl[0]:!Sl)?NaN:Tl&&Tl[0]==0||!Sl?Rl*0:Rl/0);for(Cl=new dl(Rl),Bl=Cl.c=[],Ku=Vu.e-Gu.e,Rl=il+Ku+1,Ju||(Ju=$u,Ku=Bu(Vu.e/Eu)-Bu(Gu.e/Eu),Rl=Rl/Eu|0),Zu=0;Sl[Zu]==(Tl[Zu]||0);Zu++);if(Sl[Zu]>(Tl[Zu]||0)&&Ku--,Rl<0)Bl.push(1),fl=!0;else{for(sl=Tl.length,El=Sl.length,Zu=0,Rl+=2,$l=zs(Ju/(Sl[0]+1)),$l>1&&(Sl=Mu(Sl,$l,Ju),Tl=Mu(Tl,$l,Ju),El=Sl.length,sl=Tl.length),ku=El,Nu=Tl.slice(0,El),Cu=Nu.length;Cu<El;Nu[Cu++]=0);xl=Sl.slice(),xl=[0].concat(xl),gl=Sl[0],Sl[1]>=Ju/2&&gl++;do{if($l=0,ll=Ru(Sl,Nu,El,Cu),ll<0){if(xu=Nu[0],El!=Cu&&(xu=xu*Ju+(Nu[1]||0)),$l=zs(xu/gl),$l>1)for($l>=Ju&&($l=Ju-1),Al=Mu(Sl,$l,Ju),_l=Al.length,Cu=Nu.length;Ru(Al,Nu,_l,Cu)==1;)$l--,Ou(Al,El<_l?xl:Sl,_l,Ju),_l=Al.length,ll=1;else $l==0&&(ll=$l=1),Al=Sl.slice(),_l=Al.length;if(_l<Cu&&(Al=[0].concat(Al)),Ou(Nu,Al,Cu,Ju),Cu=Nu.length,ll==-1)for(;Ru(Sl,Nu,El,Cu)<1;)$l++,Ou(Nu,El<Cu?xl:Sl,Cu,Ju),Cu=Nu.length}else ll===0&&($l++,Nu=[0]);Bl[Zu++]=$l,Nu[0]?Nu[Cu++]=Tl[ku]||0:(Nu=[Tl[ku]],Cu=1)}while((ku++<sl||Nu[0]!=null)&&Rl--);fl=Nu[0]!=null,Bl[0]||Bl.splice(0,1)}if(Ju==$u){for(Zu=1,Rl=Bl[0];Rl>=10;Rl/=10,Zu++);yl(Cl,il+(Cl.e=Zu+Ku*Eu-1)+1,ol,fl)}else Cl.e=Ku,Cl.r=+fl;return Cl}}();function vl(Mu,Ru,Ou,Vu){var Gu,il,ol,Ju,ll;if(Ou==null?Ou=Qu:Pu(Ou,0,8),!Mu.c)return Mu.toString();if(Gu=Mu.c[0],ol=Mu.e,Ru==null)ll=Du(Mu.c),ll=Vu==1||Vu==2&&(ol<=rl||ol>=Hu)?Fu(ll,ol):Lu(ll,ol,"0");else if(Mu=yl(new dl(Mu),Ru,Ou),il=Mu.e,ll=Du(Mu.c),Ju=ll.length,Vu==1||Vu==2&&(Ru<=il||il<=rl)){for(;Ju<Ru;ll+="0",Ju++);ll=Fu(ll,il)}else if(Ru-=ol+(Vu===2&&il>ol),ll=Lu(ll,il,"0"),il+1>Ju){if(--Ru>0)for(ll+=".";Ru--;ll+="0");}else if(Ru+=il-Ju,Ru>0)for(il+1==Ju&&(ll+=".");Ru--;ll+="0");return Mu.s<0&&Gu?"-"+ll:ll}function nl(Mu,Ru){for(var Ou,Vu,Gu=1,il=new dl(Mu[0]);Gu<Mu.length;Gu++)Vu=new dl(Mu[Gu]),(!Vu.s||(Ou=Tu(il,Vu))===Ru||Ou===0&&il.s===Ru)&&(il=Vu);return il}function el(Mu,Ru,Ou){for(var Vu=1,Gu=Ru.length;!Ru[--Gu];Ru.pop());for(Gu=Ru[0];Gu>=10;Gu/=10,Vu++);return(Ou=Vu+Ou*Eu-1)>Yu?Mu.c=Mu.e=null:Ou<ju?Mu.c=[Mu.e=0]:(Mu.e=Ou,Mu.c=Ru),Mu}Wu=function(){var Mu=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ru=/^([^.]+)\.$/,Ou=/^\.([^.]+)$/,Vu=/^-?(Infinity|NaN)$/,Gu=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(il,ol,Ju,ll){var Ku,Zu=Ju?ol:ol.replace(Gu,"");if(Vu.test(Zu))il.s=isNaN(Zu)?null:Zu<0?-1:1;else{if(!Ju&&(Zu=Zu.replace(Mu,function(fl,$l,Al){return Ku=(Al=Al.toLowerCase())=="x"?16:Al=="b"?2:8,!ll||ll==Ku?$l:fl}),ll&&(Ku=ll,Zu=Zu.replace(Ru,"$1").replace(Ou,"0.$1")),ol!=Zu))return new dl(Zu,Ku);if(dl.DEBUG)throw Error(Ys+"Not a"+(ll?" base "+ll:"")+" number: "+ol);il.s=null}il.c=il.e=null}}();function yl(Mu,Ru,Ou,Vu){var Gu,il,ol,Ju,ll,Ku,Zu,fl=Mu.c,$l=vu;if(fl){e:{for(Gu=1,Ju=fl[0];Ju>=10;Ju/=10,Gu++);if(il=Ru-Gu,il<0)il+=Eu,ol=Ru,ll=fl[Ku=0],Zu=zs(ll/$l[Gu-ol-1]%10);else if(Ku=Hs((il+1)/Eu),Ku>=fl.length)if(Vu){for(;fl.length<=Ku;fl.push(0));ll=Zu=0,Gu=1,il%=Eu,ol=il-Eu+1}else break e;else{for(ll=Ju=fl[Ku],Gu=1;Ju>=10;Ju/=10,Gu++);il%=Eu,ol=il-Eu+Gu,Zu=ol<0?0:zs(ll/$l[Gu-ol-1]%10)}if(Vu=Vu||Ru<0||fl[Ku+1]!=null||(ol<0?ll:ll%$l[Gu-ol-1]),Vu=Ou<4?(Zu||Vu)&&(Ou==0||Ou==(Mu.s<0?3:2)):Zu>5||Zu==5&&(Ou==4||Vu||Ou==6&&(il>0?ol>0?ll/$l[Gu-ol]:0:fl[Ku-1])%10&1||Ou==(Mu.s<0?8:7)),Ru<1||!fl[0])return fl.length=0,Vu?(Ru-=Mu.e+1,fl[0]=$l[(Eu-Ru%Eu)%Eu],Mu.e=-Ru||0):fl[0]=Mu.e=0,Mu;if(il==0?(fl.length=Ku,Ju=1,Ku--):(fl.length=Ku+1,Ju=$l[Eu-il],fl[Ku]=ol>0?zs(ll/$l[Gu-ol]%$l[ol])*Ju:0),Vu)for(;;)if(Ku==0){for(il=1,ol=fl[0];ol>=10;ol/=10,il++);for(ol=fl[0]+=Ju,Ju=1;ol>=10;ol/=10,Ju++);il!=Ju&&(Mu.e++,fl[0]==$u&&(fl[0]=1));break}else{if(fl[Ku]+=Ju,fl[Ku]!=$u)break;fl[Ku--]=0,Ju=1}for(il=fl.length;fl[--il]===0;fl.pop());}Mu.e>Yu?Mu.c=Mu.e=null:Mu.e<ju&&(Mu.c=[Mu.e=0])}return Mu}function bl(Mu){var Ru,Ou=Mu.e;return Ou===null?Mu.toString():(Ru=Du(Mu.c),Ru=Ou<=rl||Ou>=Hu?Fu(Ru,Ou):Lu(Ru,Ou,"0"),Mu.s<0?"-"+Ru:Ru)}return cl.absoluteValue=cl.abs=function(){var Mu=new dl(this);return Mu.s<0&&(Mu.s=1),Mu},cl.comparedTo=function(Mu,Ru){return Tu(this,new dl(Mu,Ru))},cl.decimalPlaces=cl.dp=function(Mu,Ru){var Ou,Vu,Gu,il=this;if(Mu!=null)return Pu(Mu,0,_u),Ru==null?Ru=Qu:Pu(Ru,0,8),yl(new dl(il),Mu+il.e+1,Ru);if(!(Ou=il.c))return null;if(Vu=((Gu=Ou.length-1)-Bu(this.e/Eu))*Eu,Gu=Ou[Gu])for(;Gu%10==0;Gu/=10,Vu--);return Vu<0&&(Vu=0),Vu},cl.dividedBy=cl.div=function(Mu,Ru){return zu(this,new dl(Mu,Ru),hl,Qu)},cl.dividedToIntegerBy=cl.idiv=function(Mu,Ru){return zu(this,new dl(Mu,Ru),0,1)},cl.exponentiatedBy=cl.pow=function(Mu,Ru){var Ou,Vu,Gu,il,ol,Ju,ll,Ku,Zu,fl=this;if(Mu=new dl(Mu),Mu.c&&!Mu.isInteger())throw Error(Ys+"Exponent not an integer: "+bl(Mu));if(Ru!=null&&(Ru=new dl(Ru)),Ju=Mu.e>14,!fl.c||!fl.c[0]||fl.c[0]==1&&!fl.e&&fl.c.length==1||!Mu.c||!Mu.c[0])return Zu=new dl(Math.pow(+bl(fl),Ju?Mu.s*(2-Uu(Mu)):+bl(Mu))),Ru?Zu.mod(Ru):Zu;if(ll=Mu.s<0,Ru){if(Ru.c?!Ru.c[0]:!Ru.s)return new dl(NaN);Vu=!ll&&fl.isInteger()&&Ru.isInteger(),Vu&&(fl=fl.mod(Ru))}else{if(Mu.e>9&&(fl.e>0||fl.e<-1||(fl.e==0?fl.c[0]>1||Ju&&fl.c[1]>=24e7:fl.c[0]<8e13||Ju&&fl.c[0]<=9999975e7)))return il=fl.s<0&&Uu(Mu)?-0:0,fl.e>-1&&(il=1/il),new dl(ll?1/il:il);al&&(il=Hs(al/Eu+2))}for(Ju?(Ou=new dl(.5),ll&&(Mu.s=1),Ku=Uu(Mu)):(Gu=Math.abs(+bl(Mu)),Ku=Gu%2),Zu=new dl(wl);;){if(Ku){if(Zu=Zu.times(fl),!Zu.c)break;il?Zu.c.length>il&&(Zu.c.length=il):Vu&&(Zu=Zu.mod(Ru))}if(Gu){if(Gu=zs(Gu/2),Gu===0)break;Ku=Gu%2}else if(Mu=Mu.times(Ou),yl(Mu,Mu.e+1,1),Mu.e>14)Ku=Uu(Mu);else{if(Gu=+bl(Mu),Gu===0)break;Ku=Gu%2}fl=fl.times(fl),il?fl.c&&fl.c.length>il&&(fl.c.length=il):Vu&&(fl=fl.mod(Ru))}return Vu?Zu:(ll&&(Zu=wl.div(Zu)),Ru?Zu.mod(Ru):il?yl(Zu,al,Qu,ol):Zu)},cl.integerValue=function(Mu){var Ru=new dl(this);return Mu==null?Mu=Qu:Pu(Mu,0,8),yl(Ru,Ru.e+1,Mu)},cl.isEqualTo=cl.eq=function(Mu,Ru){return Tu(this,new dl(Mu,Ru))===0},cl.isFinite=function(){return!!this.c},cl.isGreaterThan=cl.gt=function(Mu,Ru){return Tu(this,new dl(Mu,Ru))>0},cl.isGreaterThanOrEqualTo=cl.gte=function(Mu,Ru){return(Ru=Tu(this,new dl(Mu,Ru)))===1||Ru===0},cl.isInteger=function(){return!!this.c&&Bu(this.e/Eu)>this.c.length-2},cl.isLessThan=cl.lt=function(Mu,Ru){return Tu(this,new dl(Mu,Ru))<0},cl.isLessThanOrEqualTo=cl.lte=function(Mu,Ru){return(Ru=Tu(this,new dl(Mu,Ru)))===-1||Ru===0},cl.isNaN=function(){return!this.s},cl.isNegative=function(){return this.s<0},cl.isPositive=function(){return this.s>0},cl.isZero=function(){return!!this.c&&this.c[0]==0},cl.minus=function(Mu,Ru){var Ou,Vu,Gu,il,ol=this,Ju=ol.s;if(Mu=new dl(Mu,Ru),Ru=Mu.s,!Ju||!Ru)return new dl(NaN);if(Ju!=Ru)return Mu.s=-Ru,ol.plus(Mu);var ll=ol.e/Eu,Ku=Mu.e/Eu,Zu=ol.c,fl=Mu.c;if(!ll||!Ku){if(!Zu||!fl)return Zu?(Mu.s=-Ru,Mu):new dl(fl?ol:NaN);if(!Zu[0]||!fl[0])return fl[0]?(Mu.s=-Ru,Mu):new dl(Zu[0]?ol:Qu==3?-0:0)}if(ll=Bu(ll),Ku=Bu(Ku),Zu=Zu.slice(),Ju=ll-Ku){for((il=Ju<0)?(Ju=-Ju,Gu=Zu):(Ku=ll,Gu=fl),Gu.reverse(),Ru=Ju;Ru--;Gu.push(0));Gu.reverse()}else for(Vu=(il=(Ju=Zu.length)<(Ru=fl.length))?Ju:Ru,Ju=Ru=0;Ru<Vu;Ru++)if(Zu[Ru]!=fl[Ru]){il=Zu[Ru]<fl[Ru];break}if(il&&(Gu=Zu,Zu=fl,fl=Gu,Mu.s=-Mu.s),Ru=(Vu=fl.length)-(Ou=Zu.length),Ru>0)for(;Ru--;Zu[Ou++]=0);for(Ru=$u-1;Vu>Ju;){if(Zu[--Vu]<fl[Vu]){for(Ou=Vu;Ou&&!Zu[--Ou];Zu[Ou]=Ru);--Zu[Ou],Zu[Vu]+=$u}Zu[Vu]-=fl[Vu]}for(;Zu[0]==0;Zu.splice(0,1),--Ku);return Zu[0]?el(Mu,Zu,Ku):(Mu.s=Qu==3?-1:1,Mu.c=[Mu.e=0],Mu)},cl.modulo=cl.mod=function(Mu,Ru){var Ou,Vu,Gu=this;return Mu=new dl(Mu,Ru),!Gu.c||!Mu.s||Mu.c&&!Mu.c[0]?new dl(NaN):!Mu.c||Gu.c&&!Gu.c[0]?new dl(Gu):(Xu==9?(Vu=Mu.s,Mu.s=1,Ou=zu(Gu,Mu,0,3),Mu.s=Vu,Ou.s*=Vu):Ou=zu(Gu,Mu,0,Xu),Mu=Gu.minus(Ou.times(Mu)),!Mu.c[0]&&Xu==1&&(Mu.s=Gu.s),Mu)},cl.multipliedBy=cl.times=function(Mu,Ru){var Ou,Vu,Gu,il,ol,Ju,ll,Ku,Zu,fl,$l,Al,_l,Cl,Bl,Nu=this,Cu=Nu.c,xu=(Mu=new dl(Mu,Ru)).c;if(!Cu||!xu||!Cu[0]||!xu[0])return!Nu.s||!Mu.s||Cu&&!Cu[0]&&!xu||xu&&!xu[0]&&!Cu?Mu.c=Mu.e=Mu.s=null:(Mu.s*=Nu.s,!Cu||!xu?Mu.c=Mu.e=null:(Mu.c=[0],Mu.e=0)),Mu;for(Vu=Bu(Nu.e/Eu)+Bu(Mu.e/Eu),Mu.s*=Nu.s,ll=Cu.length,fl=xu.length,ll<fl&&(_l=Cu,Cu=xu,xu=_l,Gu=ll,ll=fl,fl=Gu),Gu=ll+fl,_l=[];Gu--;_l.push(0));for(Cl=$u,Bl=Iu,Gu=fl;--Gu>=0;){for(Ou=0,$l=xu[Gu]%Bl,Al=xu[Gu]/Bl|0,ol=ll,il=Gu+ol;il>Gu;)Ku=Cu[--ol]%Bl,Zu=Cu[ol]/Bl|0,Ju=Al*Ku+Zu*$l,Ku=$l*Ku+Ju%Bl*Bl+_l[il]+Ou,Ou=(Ku/Cl|0)+(Ju/Bl|0)+Al*Zu,_l[il--]=Ku%Cl;_l[il]=Ou}return Ou?++Vu:_l.splice(0,1),el(Mu,_l,Vu)},cl.negated=function(){var Mu=new dl(this);return Mu.s=-Mu.s||null,Mu},cl.plus=function(Mu,Ru){var Ou,Vu=this,Gu=Vu.s;if(Mu=new dl(Mu,Ru),Ru=Mu.s,!Gu||!Ru)return new dl(NaN);if(Gu!=Ru)return Mu.s=-Ru,Vu.minus(Mu);var il=Vu.e/Eu,ol=Mu.e/Eu,Ju=Vu.c,ll=Mu.c;if(!il||!ol){if(!Ju||!ll)return new dl(Gu/0);if(!Ju[0]||!ll[0])return ll[0]?Mu:new dl(Ju[0]?Vu:Gu*0)}if(il=Bu(il),ol=Bu(ol),Ju=Ju.slice(),Gu=il-ol){for(Gu>0?(ol=il,Ou=ll):(Gu=-Gu,Ou=Ju),Ou.reverse();Gu--;Ou.push(0));Ou.reverse()}for(Gu=Ju.length,Ru=ll.length,Gu-Ru<0&&(Ou=ll,ll=Ju,Ju=Ou,Ru=Gu),Gu=0;Ru;)Gu=(Ju[--Ru]=Ju[Ru]+ll[Ru]+Gu)/$u|0,Ju[Ru]=$u===Ju[Ru]?0:Ju[Ru]%$u;return Gu&&(Ju=[Gu].concat(Ju),++ol),el(Mu,Ju,ol)},cl.precision=cl.sd=function(Mu,Ru){var Ou,Vu,Gu,il=this;if(Mu!=null&&Mu!==!!Mu)return Pu(Mu,1,_u),Ru==null?Ru=Qu:Pu(Ru,0,8),yl(new dl(il),Mu,Ru);if(!(Ou=il.c))return null;if(Gu=Ou.length-1,Vu=Gu*Eu+1,Gu=Ou[Gu]){for(;Gu%10==0;Gu/=10,Vu--);for(Gu=Ou[0];Gu>=10;Gu/=10,Vu++);}return Mu&&il.e+1>Vu&&(Vu=il.e+1),Vu},cl.shiftedBy=function(Mu){return Pu(Mu,-Au,Au),this.times("1e"+Mu)},cl.squareRoot=cl.sqrt=function(){var Mu,Ru,Ou,Vu,Gu,il=this,ol=il.c,Ju=il.s,ll=il.e,Ku=hl+4,Zu=new dl("0.5");if(Ju!==1||!ol||!ol[0])return new dl(!Ju||Ju<0&&(!ol||ol[0])?NaN:ol?il:1/0);if(Ju=Math.sqrt(+bl(il)),Ju==0||Ju==1/0?(Ru=Du(ol),(Ru.length+ll)%2==0&&(Ru+="0"),Ju=Math.sqrt(+Ru),ll=Bu((ll+1)/2)-(ll<0||ll%2),Ju==1/0?Ru="5e"+ll:(Ru=Ju.toExponential(),Ru=Ru.slice(0,Ru.indexOf("e")+1)+ll),Ou=new dl(Ru)):Ou=new dl(Ju+""),Ou.c[0]){for(ll=Ou.e,Ju=ll+Ku,Ju<3&&(Ju=0);;)if(Gu=Ou,Ou=Zu.times(Gu.plus(zu(il,Gu,Ku,1))),Du(Gu.c).slice(0,Ju)===(Ru=Du(Ou.c)).slice(0,Ju))if(Ou.e<ll&&--Ju,Ru=Ru.slice(Ju-3,Ju+1),Ru=="9999"||!Vu&&Ru=="4999"){if(!Vu&&(yl(Gu,Gu.e+hl+2,0),Gu.times(Gu).eq(il))){Ou=Gu;break}Ku+=4,Ju+=4,Vu=1}else{(!+Ru||!+Ru.slice(1)&&Ru.charAt(0)=="5")&&(yl(Ou,Ou.e+hl+2,1),Mu=!Ou.times(Ou).eq(il));break}}return yl(Ou,Ou.e+hl+1,Qu,Mu)},cl.toExponential=function(Mu,Ru){return Mu!=null&&(Pu(Mu,0,_u),Mu++),vl(this,Mu,Ru,1)},cl.toFixed=function(Mu,Ru){return Mu!=null&&(Pu(Mu,0,_u),Mu=Mu+this.e+1),vl(this,Mu,Ru)},cl.toFormat=function(Mu,Ru,Ou){var Vu,Gu=this;if(Ou==null)Mu!=null&&Ru&&typeof Ru=="object"?(Ou=Ru,Ru=null):Mu&&typeof Mu=="object"?(Ou=Mu,Mu=Ru=null):Ou=pl;else if(typeof Ou!="object")throw Error(Ys+"Argument not an object: "+Ou);if(Vu=Gu.toFixed(Mu,Ru),Gu.c){var il,ol=Vu.split("."),Ju=+Ou.groupSize,ll=+Ou.secondaryGroupSize,Ku=Ou.groupSeparator||"",Zu=ol[0],fl=ol[1],$l=Gu.s<0,Al=$l?Zu.slice(1):Zu,_l=Al.length;if(ll&&(il=Ju,Ju=ll,ll=il,_l-=il),Ju>0&&_l>0){for(il=_l%Ju||Ju,Zu=Al.substr(0,il);il<_l;il+=Ju)Zu+=Ku+Al.substr(il,Ju);ll>0&&(Zu+=Ku+Al.slice(il)),$l&&(Zu="-"+Zu)}Vu=fl?Zu+(Ou.decimalSeparator||"")+((ll=+Ou.fractionGroupSize)?fl.replace(new RegExp("\\d{"+ll+"}\\B","g"),"$&"+(Ou.fractionGroupSeparator||"")):fl):Zu}return(Ou.prefix||"")+Vu+(Ou.suffix||"")},cl.toFraction=function(Mu){var Ru,Ou,Vu,Gu,il,ol,Ju,ll,Ku,Zu,fl,$l,Al=this,_l=Al.c;if(Mu!=null&&(Ju=new dl(Mu),!Ju.isInteger()&&(Ju.c||Ju.s!==1)||Ju.lt(wl)))throw Error(Ys+"Argument "+(Ju.isInteger()?"out of range: ":"not an integer: ")+bl(Ju));if(!_l)return new dl(Al);for(Ru=new dl(wl),Ku=Ou=new dl(wl),Vu=ll=new dl(wl),$l=Du(_l),il=Ru.e=$l.length-Al.e-1,Ru.c[0]=vu[(ol=il%Eu)<0?Eu+ol:ol],Mu=!Mu||Ju.comparedTo(Ru)>0?il>0?Ru:Ku:Ju,ol=Yu,Yu=1/0,Ju=new dl($l),ll.c[0]=0;Zu=zu(Ju,Ru,0,1),Gu=Ou.plus(Zu.times(Vu)),Gu.comparedTo(Mu)!=1;)Ou=Vu,Vu=Gu,Ku=ll.plus(Zu.times(Gu=Ku)),ll=Gu,Ru=Ju.minus(Zu.times(Gu=Ru)),Ju=Gu;return Gu=zu(Mu.minus(Ou),Vu,0,1),ll=ll.plus(Gu.times(Ku)),Ou=Ou.plus(Gu.times(Vu)),ll.s=Ku.s=Al.s,il=il*2,fl=zu(Ku,Vu,il,Qu).minus(Al).abs().comparedTo(zu(ll,Ou,il,Qu).minus(Al).abs())<1?[Ku,Vu]:[ll,Ou],Yu=ol,fl},cl.toNumber=function(){return+bl(this)},cl.toPrecision=function(Mu,Ru){return Mu!=null&&Pu(Mu,1,_u),vl(this,Mu,Ru,2)},cl.toString=function(Mu){var Ru,Ou=this,Vu=Ou.s,Gu=Ou.e;return Gu===null?Vu?(Ru="Infinity",Vu<0&&(Ru="-"+Ru)):Ru="NaN":(Mu==null?Ru=Gu<=rl||Gu>=Hu?Fu(Du(Ou.c),Gu):Lu(Du(Ou.c),Gu,"0"):Mu===10&&Il?(Ou=yl(new dl(Ou),hl+Gu+1,Qu),Ru=Lu(Du(Ou.c),Ou.e,"0")):(Pu(Mu,2,ml.length,"Base"),Ru=tl(Lu(Du(Ou.c),Gu,"0"),10,Mu,Vu,!0)),Vu<0&&Ou.c[0]&&(Ru="-"+Ru)),Ru},cl.valueOf=cl.toJSON=function(){return bl(this)},cl._isBigNumber=!0,qu!=null&&dl.set(qu),dl}function Bu(qu){var zu=qu|0;return qu>0||qu===zu?zu:zu-1}function Du(qu){for(var zu,tl,Wu=1,cl=qu.length,wl=qu[0]+"";Wu<cl;){for(zu=qu[Wu++]+"",tl=Eu-zu.length;tl--;zu="0"+zu);wl+=zu}for(cl=wl.length;wl.charCodeAt(--cl)===48;);return wl.slice(0,cl+1||1)}function Tu(qu,zu){var tl,Wu,cl=qu.c,wl=zu.c,hl=qu.s,Qu=zu.s,rl=qu.e,Hu=zu.e;if(!hl||!Qu)return null;if(tl=cl&&!cl[0],Wu=wl&&!wl[0],tl||Wu)return tl?Wu?0:-Qu:hl;if(hl!=Qu)return hl;if(tl=hl<0,Wu=rl==Hu,!cl||!wl)return Wu?0:!cl^tl?1:-1;if(!Wu)return rl>Hu^tl?1:-1;for(Qu=(rl=cl.length)<(Hu=wl.length)?rl:Hu,hl=0;hl<Qu;hl++)if(cl[hl]!=wl[hl])return cl[hl]>wl[hl]^tl?1:-1;return rl==Hu?0:rl>Hu^tl?1:-1}function Pu(qu,zu,tl,Wu){if(qu<zu||qu>tl||qu!==zs(qu))throw Error(Ys+(Wu||"Argument")+(typeof qu=="number"?qu<zu||qu>tl?" out of range: ":" not an integer: ":" not a primitive number: ")+String(qu))}function Uu(qu){var zu=qu.c.length-1;return Bu(qu.e/Eu)==zu&&qu.c[zu]%2!=0}function Fu(qu,zu){return(qu.length>1?qu.charAt(0)+"."+qu.slice(1):qu)+(zu<0?"e":"e+")+zu}function Lu(qu,zu,tl){var Wu,cl;if(zu<0){for(cl=tl+".";++zu;cl+=tl);qu=cl+qu}else if(Wu=qu.length,++zu>Wu){for(cl=tl,zu-=Wu;--zu;cl+=tl);qu+=cl}else zu<Wu&&(qu=qu.slice(0,zu)+"."+qu.slice(zu));return qu}Z=Su(),Z.default=Z.BigNumber=Z,F.exports?F.exports=Z:(t||(t=typeof self<"u"&&self?self:window),t.BigNumber=Z)})(commonjsGlobal)})(bignumber);var bignumberExports=bignumber.exports,codec={},utils$2={},utils_codec={},hasRequiredUtils_codec;function requireUtils_codec(){if(hasRequiredUtils_codec)return utils_codec;hasRequiredUtils_codec=1;var F=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(_u,Su,Bu,Du){Du===void 0&&(Du=Bu),Object.defineProperty(_u,Du,{enumerable:!0,get:function(){return Su[Bu]}})}:function(_u,Su,Bu,Du){Du===void 0&&(Du=Bu),_u[Du]=Su[Bu]}),t=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(_u,Su){Object.defineProperty(_u,"default",{enumerable:!0,value:Su})}:function(_u,Su){_u.default=Su}),Z=commonjsGlobal&&commonjsGlobal.__importStar||function(_u){if(_u&&_u.__esModule)return _u;var Su={};if(_u!=null)for(var Bu in _u)Bu!=="default"&&Object.prototype.hasOwnProperty.call(_u,Bu)&&F(Su,_u,Bu);return t(Su,_u),Su},at=commonjsGlobal&&commonjsGlobal.__importDefault||function(_u){return _u&&_u.__esModule?_u:{default:_u}};Object.defineProperty(utils_codec,"__esModule",{value:!0}),utils_codec.bigIntToHex=utils_codec.byteArrayToHex=utils_codec.boolToHex=utils_codec.utf8ToHex=utils_codec.zeroPadStringIfOddLength=utils_codec.isPaddedHex=utils_codec.numberToPaddedHex=void 0;const Hs=at(bignumberExports),zs=Z(requireUtils$1());function Ys(_u){let Su;typeof _u=="bigint"||typeof _u=="number"?Su=_u:Su=new Hs.default(_u);const Bu=Su.toString(16);return $u(Bu)}utils_codec.numberToPaddedHex=Ys;function Zs(_u){_u=_u||"";let Su=Buffer.from(_u,"hex").toString("hex");return _u.toUpperCase()==Su.toUpperCase()}utils_codec.isPaddedHex=Zs;function $u(_u){return _u=_u||"",_u.length%2==1?"0"+_u:_u}utils_codec.zeroPadStringIfOddLength=$u;function Eu(_u){const Su=Buffer.from(_u).toString("hex");return $u(Su)}utils_codec.utf8ToHex=Eu;function Au(_u){return Eu(_u.toString())}utils_codec.boolToHex=Au;function vu(_u){const Su=Buffer.from(_u).toString("hex");return $u(Su)}utils_codec.byteArrayToHex=vu;function Iu(_u){return _u==0?"":zs.getHexMagnitudeOfBigInt(_u)}return utils_codec.bigIntToHex=Iu,utils_codec}var hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils$2;hasRequiredUtils$1=1;var F=commonjsGlobal&&commonjsGlobal.__importDefault||function(vu){return vu&&vu.__esModule?vu:{default:vu}};Object.defineProperty(utils$2,"__esModule",{value:!0}),utils$2.prependByteToBuffer=utils$2.flipBufferBitsInPlace=utils$2.getHexMagnitudeOfBigInt=utils$2.bigIntToBuffer=utils$2.bufferToBigInt=utils$2.cloneBuffer=utils$2.isMsbZero=utils$2.isMsbOne=void 0;const t=F(bignumberExports),Z=requireUtils_codec();function at(vu,Iu=0){return vu[Iu]>>7==1}utils$2.isMsbOne=at;function Hs(vu,Iu=0){return!at(vu,Iu)}utils$2.isMsbZero=Hs;function zs(vu){let Iu=Buffer.alloc(vu.length);return vu.copy(Iu),Iu}utils$2.cloneBuffer=zs;function Ys(vu){let Iu=vu.toString("hex");return new t.default(`0x${Iu}`,16)}utils$2.bufferToBigInt=Ys;function Zs(vu){let Iu=$u(vu);return Buffer.from(Iu,"hex")}utils$2.bigIntToBuffer=Zs;function $u(vu){return vu=new t.default(vu),vu?(vu.isNegative()&&(vu=vu.multipliedBy(new t.default(-1))),Z.numberToPaddedHex(vu)):""}utils$2.getHexMagnitudeOfBigInt=$u;function Eu(vu){for(let Iu=0;Iu<vu.length;Iu++)vu[Iu]=~vu[Iu]}utils$2.flipBufferBitsInPlace=Eu;function Au(vu,Iu){return Buffer.concat([Buffer.from([Iu]),vu])}return utils$2.prependByteToBuffer=Au,utils$2}(function(F){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(_u,Su,Bu,Du){Du===void 0&&(Du=Bu),Object.defineProperty(_u,Du,{enumerable:!0,get:function(){return Su[Bu]}})}:function(_u,Su,Bu,Du){Du===void 0&&(Du=Bu),_u[Du]=Su[Bu]}),Z=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(_u,Su){Object.defineProperty(_u,"default",{enumerable:!0,value:Su})}:function(_u,Su){_u.default=Su}),at=commonjsGlobal&&commonjsGlobal.__importStar||function(_u){if(_u&&_u.__esModule)return _u;var Su={};if(_u!=null)for(var Bu in _u)Bu!=="default"&&Object.prototype.hasOwnProperty.call(_u,Bu)&&t(Su,_u,Bu);return Z(Su,_u),Su},Hs=commonjsGlobal&&commonjsGlobal.__importDefault||function(_u){return _u&&_u.__esModule?_u:{default:_u}};Object.defineProperty(F,"__esModule",{value:!0}),F.bufferToHex=F.utf8ToHex=F.bigIntToHex=F.bigIntToBuffer=F.bufferToBigInt=F.stringToBuffer=void 0;const zs=Hs(bignumberExports),Ys=at(requireUtils$1()),Zs=at(requireUtils_codec());function $u(_u){return Buffer.from(_u)}F.stringToBuffer=$u;function Eu(_u){return _u.length==0?new zs.default(0):Ys.bufferToBigInt(_u)}F.bufferToBigInt=Eu;function Au(_u){return _u==0?Buffer.from([]):Ys.bigIntToBuffer(_u)}F.bigIntToBuffer=Au;var vu=requireUtils_codec();Object.defineProperty(F,"bigIntToHex",{enumerable:!0,get:function(){return vu.bigIntToHex}}),Object.defineProperty(F,"utf8ToHex",{enumerable:!0,get:function(){return vu.utf8ToHex}});function Iu(_u){const Su=_u.toString("hex");return Zs.zeroPadStringIfOddLength(Su)}F.bufferToHex=Iu})(codec);var config$1={};Object.defineProperty(config$1,"__esModule",{value:!0});config$1.LibraryConfig=void 0;class LibraryConfig{}config$1.LibraryConfig=LibraryConfig;LibraryConfig.DefaultAddressHrp="erd";var constants$2={};Object.defineProperty(constants$2,"__esModule",{value:!0});constants$2.EXTRA_GAS_LIMIT_FOR_RELAYED_TRANSACTIONS=constants$2.EXTRA_GAS_LIMIT_FOR_GUARDED_TRANSACTIONS=constants$2.EGLD_IDENTIFIER_FOR_MULTI_ESDTNFT_TRANSFER=constants$2.UNKNOWN_SIGNER=constants$2.SDK_JS_SIGNER=constants$2.METACHAIN_ID=constants$2.WasmVirtualMachine=constants$2.CURRENT_NUMBER_OF_SHARDS_WITHOUT_META=constants$2.HEX_TRANSACTION_HASH_LENGTH=constants$2.MESSAGE_PREFIX=constants$2.DEFAULT_MESSAGE_VERSION=constants$2.STAKING_SMART_CONTRACT_ADDRESS_HEX=constants$2.GOVERNANCE_CONTRACT_ADDRESS_HEX=constants$2.ESDT_CONTRACT_ADDRESS_HEX=constants$2.DELEGATION_MANAGER_SC_ADDRESS_HEX=constants$2.CONTRACT_DEPLOY_ADDRESS_HEX=constants$2.VM_TYPE_WASM_VM=constants$2.ARGUMENTS_SEPARATOR=constants$2.ESDT_TRANSFER_VALUE=constants$2.MULTI_ESDTNFT_TRANSFER_FUNCTION_NAME=constants$2.ESDTNFT_TRANSFER_FUNCTION_NAME=constants$2.ESDT_TRANSFER_FUNCTION_NAME=constants$2.ESDT_TRANSFER_GAS_LIMIT=constants$2.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS=constants$2.TRANSACTION_VERSION_DEFAULT=constants$2.TRANSACTION_OPTIONS_TX_GUARDED=constants$2.TRANSACTION_OPTIONS_TX_HASH_SIGN=constants$2.TRANSACTION_OPTIONS_DEFAULT=constants$2.TRANSACTION_MIN_GAS_PRICE=void 0;constants$2.TRANSACTION_MIN_GAS_PRICE=1e9;constants$2.TRANSACTION_OPTIONS_DEFAULT=0;constants$2.TRANSACTION_OPTIONS_TX_HASH_SIGN=1;constants$2.TRANSACTION_OPTIONS_TX_GUARDED=2;constants$2.TRANSACTION_VERSION_DEFAULT=2;constants$2.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS=2;constants$2.ESDT_TRANSFER_GAS_LIMIT=5e5;constants$2.ESDT_TRANSFER_FUNCTION_NAME="ESDTTransfer";constants$2.ESDTNFT_TRANSFER_FUNCTION_NAME="ESDTNFTTransfer";constants$2.MULTI_ESDTNFT_TRANSFER_FUNCTION_NAME="MultiESDTNFTTransfer";constants$2.ESDT_TRANSFER_VALUE="0";constants$2.ARGUMENTS_SEPARATOR="@";constants$2.VM_TYPE_WASM_VM=new Uint8Array([5,0]);constants$2.CONTRACT_DEPLOY_ADDRESS_HEX="0000000000000000000000000000000000000000000000000000000000000000";constants$2.DELEGATION_MANAGER_SC_ADDRESS_HEX="000000000000000000010000000000000000000000000000000000000004ffff";constants$2.ESDT_CONTRACT_ADDRESS_HEX="000000000000000000010000000000000000000000000000000000000002ffff";constants$2.GOVERNANCE_CONTRACT_ADDRESS_HEX="000000000000000000010000000000000000000000000000000000000003ffff";constants$2.STAKING_SMART_CONTRACT_ADDRESS_HEX="000000000000000000010000000000000000000000000000000000000001ffff";constants$2.DEFAULT_MESSAGE_VERSION=1;constants$2.MESSAGE_PREFIX=`Elrond Signed Message:
`;constants$2.HEX_TRANSACTION_HASH_LENGTH=64;constants$2.CURRENT_NUMBER_OF_SHARDS_WITHOUT_META=3;constants$2.WasmVirtualMachine="0500";constants$2.METACHAIN_ID=4294967295;constants$2.SDK_JS_SIGNER="sdk-js";constants$2.UNKNOWN_SIGNER="unknown";constants$2.EGLD_IDENTIFIER_FOR_MULTI_ESDTNFT_TRANSFER="EGLD-000000";constants$2.EXTRA_GAS_LIMIT_FOR_GUARDED_TRANSACTIONS=5e4;constants$2.EXTRA_GAS_LIMIT_FOR_RELAYED_TRANSACTIONS=5e4;var errors$5={};Object.defineProperty(errors$5,"__esModule",{value:!0});errors$5.ErrEstimateTransactionCost=errors$5.ErrGasLimitCannotBeEstimated=errors$5.ExpectedAccountConditionNotReachedError=errors$5.ErrInvalidNetworkProviderKind=errors$5.ErrContractQuery=errors$5.ErrNetworkProvider=errors$5.ErrBadAddress=errors$5.ErrSignerCannotSign=errors$5.ErrBadPEM=errors$5.ErrBadMnemonicEntropy=errors$5.ErrWrongMnemonic=errors$5.ErrSmartContractQuery=errors$5.ErrParseTransactionOutcome=errors$5.ErrInvalidInnerTransaction=errors$5.ErrBadUsage=errors$5.ErrInvalidTokenIdentifier=errors$5.ErrIsCompletedFieldIsMissingOnTransaction=errors$5.ErrNotImplemented=errors$5.ErrContractInteraction=errors$5.ErrCodec=errors$5.ErrCannotParseTransactionOutcome=errors$5.ErrCannotParseContractResults=errors$5.ErrMissingFieldOnEnum=errors$5.ErrMissingFieldOnStruct=errors$5.ErrTypingSystem=errors$5.ErrMock=errors$5.ErrContractHasNoAddress=errors$5.ErrContract=errors$5.ErrExpectedTransactionEventsNotFound=errors$5.ErrExpectedTransactionStatusNotReached=errors$5.ErrTransactionWatcherTimeout=errors$5.ErrAsyncTimerAborted=errors$5.ErrAsyncTimerAlreadyRunning=errors$5.ErrInvalidFunctionName=errors$5.ErrSignatureCannotCreate=errors$5.ErrTransactionOptionsInvalid=errors$5.ErrTransactionVersionInvalid=errors$5.ErrNonceInvalid=errors$5.ErrNotEnoughGas=errors$5.ErrAddressEmpty=errors$5.ErrAddressBadHrp=errors$5.ErrAddressCannotCreate=errors$5.ErrUnexpectedCondition=errors$5.ErrInvariantFailed=errors$5.ErrBadType=errors$5.ErrUnsupportedOperation=errors$5.ErrInvalidArgument=errors$5.Err=void 0;let Err$2=class extends Error{constructor(t,Z){super(t),this.inner=void 0,this.inner=Z}summary(){const t=[];t.push({name:this.name,message:this.message});let Z=this.inner;for(;Z;)t.push({name:Z.name,message:Z.message}),Z=Z.inner;return t}};errors$5.Err=Err$2;class ErrInvalidArgument extends Err$2{constructor(t,Z){super(`Invalid argument: ${t}`,Z)}}errors$5.ErrInvalidArgument=ErrInvalidArgument;class ErrUnsupportedOperation extends Err$2{constructor(t,Z="not specified"){super(`Operation "${t}" not supported. Reason: ${Z}`)}}errors$5.ErrUnsupportedOperation=ErrUnsupportedOperation;class ErrBadType extends Err$2{constructor(t,Z,at){super(`Bad type of "${t}": ${at}. Expected type: ${Z}`)}}errors$5.ErrBadType=ErrBadType;class ErrInvariantFailed extends Err$2{constructor(t){super(`Invariant failed: [${t}]`)}}errors$5.ErrInvariantFailed=ErrInvariantFailed;class ErrUnexpectedCondition extends Err$2{constructor(t){super(`Unexpected condition: [${t}]`)}}errors$5.ErrUnexpectedCondition=ErrUnexpectedCondition;class ErrAddressCannotCreate extends Err$2{constructor(t,Z){const at=`Cannot create address from: ${t}`;super(at,Z)}}errors$5.ErrAddressCannotCreate=ErrAddressCannotCreate;class ErrAddressBadHrp extends Err$2{constructor(t,Z){super(`Wrong address HRP. Expected: ${t}, got ${Z}`)}}errors$5.ErrAddressBadHrp=ErrAddressBadHrp;class ErrAddressEmpty extends Err$2{constructor(){super("Address is empty")}}errors$5.ErrAddressEmpty=ErrAddressEmpty;class ErrNotEnoughGas extends Err$2{constructor(t){super(`Not enough gas provided: ${t}`)}}errors$5.ErrNotEnoughGas=ErrNotEnoughGas;class ErrNonceInvalid extends Err$2{constructor(t){super(`Invalid nonce: ${t}`)}}errors$5.ErrNonceInvalid=ErrNonceInvalid;class ErrTransactionVersionInvalid extends Err$2{constructor(t){super(`Invalid transaction version: ${t}`)}}errors$5.ErrTransactionVersionInvalid=ErrTransactionVersionInvalid;class ErrTransactionOptionsInvalid extends Err$2{constructor(t){super(`Invalid transaction options: ${t}`)}}errors$5.ErrTransactionOptionsInvalid=ErrTransactionOptionsInvalid;class ErrSignatureCannotCreate extends Err$2{constructor(t,Z){const at=`Cannot create signature from: ${t}`;super(at,Z)}}errors$5.ErrSignatureCannotCreate=ErrSignatureCannotCreate;class ErrInvalidFunctionName extends Err$2{constructor(){super("Invalid function name")}}errors$5.ErrInvalidFunctionName=ErrInvalidFunctionName;class ErrAsyncTimerAlreadyRunning extends Err$2{constructor(){super("Async timer already running")}}errors$5.ErrAsyncTimerAlreadyRunning=ErrAsyncTimerAlreadyRunning;class ErrAsyncTimerAborted extends Err$2{constructor(){super("Async timer aborted")}}errors$5.ErrAsyncTimerAborted=ErrAsyncTimerAborted;class ErrTransactionWatcherTimeout extends Err$2{constructor(){super("TransactionWatcher has timed out")}}errors$5.ErrTransactionWatcherTimeout=ErrTransactionWatcherTimeout;class ErrExpectedTransactionStatusNotReached extends Err$2{constructor(){super("Expected transaction status not reached")}}errors$5.ErrExpectedTransactionStatusNotReached=ErrExpectedTransactionStatusNotReached;class ErrExpectedTransactionEventsNotFound extends Err$2{constructor(){super("Expected transaction events not found")}}errors$5.ErrExpectedTransactionEventsNotFound=ErrExpectedTransactionEventsNotFound;class ErrContract extends Err$2{constructor(t){super(t)}}errors$5.ErrContract=ErrContract;class ErrContractHasNoAddress extends ErrContract{constructor(){super(`
The smart contract has no address set. Make sure you provide the address in the constructor, or call setAddress() appropriately.
If you need to recompute the address of the contract, make use of SmartContract.computeAddress() (static method).
`)}}errors$5.ErrContractHasNoAddress=ErrContractHasNoAddress;class ErrMock extends Err$2{constructor(t){super(t)}}errors$5.ErrMock=ErrMock;class ErrTypingSystem extends Err$2{constructor(t){super(t)}}errors$5.ErrTypingSystem=ErrTypingSystem;class ErrMissingFieldOnStruct extends Err$2{constructor(t,Z){super(`field ${t} does not exist on struct ${Z}`)}}errors$5.ErrMissingFieldOnStruct=ErrMissingFieldOnStruct;class ErrMissingFieldOnEnum extends Err$2{constructor(t,Z){super(`field ${t} does not exist on enum ${Z}`)}}errors$5.ErrMissingFieldOnEnum=ErrMissingFieldOnEnum;class ErrCannotParseContractResults extends Err$2{constructor(t){super(`cannot parse contract results: ${t}`)}}errors$5.ErrCannotParseContractResults=ErrCannotParseContractResults;class ErrCannotParseTransactionOutcome extends Err$2{constructor(t,Z){super(`cannot parse outcome of transaction ${t}: ${Z}`)}}errors$5.ErrCannotParseTransactionOutcome=ErrCannotParseTransactionOutcome;class ErrCodec extends Err$2{constructor(t){super(t)}}errors$5.ErrCodec=ErrCodec;class ErrContractInteraction extends Err$2{constructor(t){super(t)}}errors$5.ErrContractInteraction=ErrContractInteraction;let ErrNotImplemented$1=class extends Err$2{constructor(){super("Method not yet implemented")}};errors$5.ErrNotImplemented=ErrNotImplemented$1;class ErrIsCompletedFieldIsMissingOnTransaction extends Err$2{constructor(){super("The transaction watcher requires the `isCompleted` property to be defined on the transaction object. Perhaps you've used the sdk-network-provider's `ProxyNetworkProvider.getTransaction()` and in that case you should also pass `withProcessStatus=true`.")}}errors$5.ErrIsCompletedFieldIsMissingOnTransaction=ErrIsCompletedFieldIsMissingOnTransaction;class ErrInvalidTokenIdentifier extends Err$2{constructor(t){super(t)}}errors$5.ErrInvalidTokenIdentifier=ErrInvalidTokenIdentifier;class ErrBadUsage extends Err$2{constructor(t){super(t)}}errors$5.ErrBadUsage=ErrBadUsage;class ErrInvalidInnerTransaction extends Err$2{constructor(t){super(t)}}errors$5.ErrInvalidInnerTransaction=ErrInvalidInnerTransaction;class ErrParseTransactionOutcome extends Err$2{constructor(t){super(t)}}errors$5.ErrParseTransactionOutcome=ErrParseTransactionOutcome;class ErrSmartContractQuery extends Err$2{constructor(t,Z){super(Z),this.returnCode=t}}errors$5.ErrSmartContractQuery=ErrSmartContractQuery;class ErrWrongMnemonic extends Err$2{constructor(){super("Wrong mnemonic format")}}errors$5.ErrWrongMnemonic=ErrWrongMnemonic;class ErrBadMnemonicEntropy extends Err$2{constructor(t){super("Bad mnemonic entropy",t)}}errors$5.ErrBadMnemonicEntropy=ErrBadMnemonicEntropy;class ErrBadPEM extends Err$2{constructor(t){super(t?`Bad PEM: ${t}`:"Bad PEM")}}errors$5.ErrBadPEM=ErrBadPEM;class ErrSignerCannotSign extends Err$2{constructor(t){super("Cannot sign",t)}}errors$5.ErrSignerCannotSign=ErrSignerCannotSign;let ErrBadAddress$1=class extends Err$2{constructor(t,Z){super(`Bad address: ${t}`,Z)}};errors$5.ErrBadAddress=ErrBadAddress$1;class ErrNetworkProvider extends Err$2{constructor(t,Z,at){const Hs=`Request error on url [${t}]: [${Z}]`;super(Hs,at)}}errors$5.ErrNetworkProvider=ErrNetworkProvider;class ErrContractQuery extends Err$2{constructor(t){super(t.message.replace("executeQuery:",""))}}errors$5.ErrContractQuery=ErrContractQuery;class ErrInvalidNetworkProviderKind extends Err$2{constructor(){super("Invalid network provider kind. Choose between `api` and `proxy`.")}}errors$5.ErrInvalidNetworkProviderKind=ErrInvalidNetworkProviderKind;class ExpectedAccountConditionNotReachedError extends Err$2{constructor(){super("The expected account condition was not reached.")}}errors$5.ExpectedAccountConditionNotReachedError=ExpectedAccountConditionNotReachedError;class ErrGasLimitCannotBeEstimated extends Err$2{constructor(t){super(`Failed to estimate gas limit: [${t}]`,t)}}errors$5.ErrGasLimitCannotBeEstimated=ErrGasLimitCannotBeEstimated;class ErrEstimateTransactionCost extends Err$2{constructor(t){super(t)}}errors$5.ErrEstimateTransactionCost=ErrEstimateTransactionCost;var readableBrowser={exports:{}},events={exports:{}},R$3=typeof Reflect=="object"?Reflect:null,ReflectApply=R$3&&typeof R$3.apply=="function"?R$3.apply:function(t,Z,at){return Function.prototype.apply.call(t,Z,at)},ReflectOwnKeys;R$3&&typeof R$3.ownKeys=="function"?ReflectOwnKeys=R$3.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:ReflectOwnKeys=function(t){return Object.getOwnPropertyNames(t)};function ProcessEmitWarning(F){console&&console.warn&&console.warn(F)}var NumberIsNaN=Number.isNaN||function(t){return t!==t};function EventEmitter(){EventEmitter.init.call(this)}events.exports=EventEmitter;events.exports.once=once$2;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=void 0;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(F){if(typeof F!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof F)}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(F){if(typeof F!="number"||F<0||NumberIsNaN(F))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+F+".");defaultMaxListeners=F}});EventEmitter.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||NumberIsNaN(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function _getMaxListeners(F){return F._maxListeners===void 0?EventEmitter.defaultMaxListeners:F._maxListeners}EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function(t){for(var Z=[],at=1;at<arguments.length;at++)Z.push(arguments[at]);var Hs=t==="error",zs=this._events;if(zs!==void 0)Hs=Hs&&zs.error===void 0;else if(!Hs)return!1;if(Hs){var Ys;if(Z.length>0&&(Ys=Z[0]),Ys instanceof Error)throw Ys;var Zs=new Error("Unhandled error."+(Ys?" ("+Ys.message+")":""));throw Zs.context=Ys,Zs}var $u=zs[t];if($u===void 0)return!1;if(typeof $u=="function")ReflectApply($u,this,Z);else for(var Eu=$u.length,Au=arrayClone($u,Eu),at=0;at<Eu;++at)ReflectApply(Au[at],this,Z);return!0};function _addListener(F,t,Z,at){var Hs,zs,Ys;if(checkListener(Z),zs=F._events,zs===void 0?(zs=F._events=Object.create(null),F._eventsCount=0):(zs.newListener!==void 0&&(F.emit("newListener",t,Z.listener?Z.listener:Z),zs=F._events),Ys=zs[t]),Ys===void 0)Ys=zs[t]=Z,++F._eventsCount;else if(typeof Ys=="function"?Ys=zs[t]=at?[Z,Ys]:[Ys,Z]:at?Ys.unshift(Z):Ys.push(Z),Hs=_getMaxListeners(F),Hs>0&&Ys.length>Hs&&!Ys.warned){Ys.warned=!0;var Zs=new Error("Possible EventEmitter memory leak detected. "+Ys.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");Zs.name="MaxListenersExceededWarning",Zs.emitter=F,Zs.type=t,Zs.count=Ys.length,ProcessEmitWarning(Zs)}return F}EventEmitter.prototype.addListener=function(t,Z){return _addListener(this,t,Z,!1)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function(t,Z){return _addListener(this,t,Z,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(F,t,Z){var at={fired:!1,wrapFn:void 0,target:F,type:t,listener:Z},Hs=onceWrapper.bind(at);return Hs.listener=Z,at.wrapFn=Hs,Hs}EventEmitter.prototype.once=function(t,Z){return checkListener(Z),this.on(t,_onceWrap(this,t,Z)),this};EventEmitter.prototype.prependOnceListener=function(t,Z){return checkListener(Z),this.prependListener(t,_onceWrap(this,t,Z)),this};EventEmitter.prototype.removeListener=function(t,Z){var at,Hs,zs,Ys,Zs;if(checkListener(Z),Hs=this._events,Hs===void 0)return this;if(at=Hs[t],at===void 0)return this;if(at===Z||at.listener===Z)--this._eventsCount===0?this._events=Object.create(null):(delete Hs[t],Hs.removeListener&&this.emit("removeListener",t,at.listener||Z));else if(typeof at!="function"){for(zs=-1,Ys=at.length-1;Ys>=0;Ys--)if(at[Ys]===Z||at[Ys].listener===Z){Zs=at[Ys].listener,zs=Ys;break}if(zs<0)return this;zs===0?at.shift():spliceOne(at,zs),at.length===1&&(Hs[t]=at[0]),Hs.removeListener!==void 0&&this.emit("removeListener",t,Zs||Z)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function(t){var Z,at,Hs;if(at=this._events,at===void 0)return this;if(at.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):at[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete at[t]),this;if(arguments.length===0){var zs=Object.keys(at),Ys;for(Hs=0;Hs<zs.length;++Hs)Ys=zs[Hs],Ys!=="removeListener"&&this.removeAllListeners(Ys);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(Z=at[t],typeof Z=="function")this.removeListener(t,Z);else if(Z!==void 0)for(Hs=Z.length-1;Hs>=0;Hs--)this.removeListener(t,Z[Hs]);return this};function _listeners(F,t,Z){var at=F._events;if(at===void 0)return[];var Hs=at[t];return Hs===void 0?[]:typeof Hs=="function"?Z?[Hs.listener||Hs]:[Hs]:Z?unwrapListeners(Hs):arrayClone(Hs,Hs.length)}EventEmitter.prototype.listeners=function(t){return _listeners(this,t,!0)};EventEmitter.prototype.rawListeners=function(t){return _listeners(this,t,!1)};EventEmitter.listenerCount=function(F,t){return typeof F.listenerCount=="function"?F.listenerCount(t):listenerCount.call(F,t)};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(F){var t=this._events;if(t!==void 0){var Z=t[F];if(typeof Z=="function")return 1;if(Z!==void 0)return Z.length}return 0}EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(F,t){for(var Z=new Array(t),at=0;at<t;++at)Z[at]=F[at];return Z}function spliceOne(F,t){for(;t+1<F.length;t++)F[t]=F[t+1];F.pop()}function unwrapListeners(F){for(var t=new Array(F.length),Z=0;Z<t.length;++Z)t[Z]=F[Z].listener||F[Z];return t}function once$2(F,t){return new Promise(function(Z,at){function Hs(Ys){F.removeListener(t,zs),at(Ys)}function zs(){typeof F.removeListener=="function"&&F.removeListener("error",Hs),Z([].slice.call(arguments))}eventTargetAgnosticAddListener(F,t,zs,{once:!0}),t!=="error"&&addErrorHandlerIfEventEmitter(F,Hs,{once:!0})})}function addErrorHandlerIfEventEmitter(F,t,Z){typeof F.on=="function"&&eventTargetAgnosticAddListener(F,"error",t,Z)}function eventTargetAgnosticAddListener(F,t,Z,at){if(typeof F.on=="function")at.once?F.once(t,Z):F.on(t,Z);else if(typeof F.addEventListener=="function")F.addEventListener(t,function Hs(zs){at.once&&F.removeEventListener(t,Hs),Z(zs)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof F)}var eventsExports=events.exports;const Nt$3=getDefaultExportFromCjs(eventsExports);var streamBrowser=eventsExports.EventEmitter;const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$3$1=getAugmentedNamespace(__viteBrowserExternal$1);var buffer_list,hasRequiredBuffer_list;function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;function F(Su,Bu){var Du=Object.keys(Su);if(Object.getOwnPropertySymbols){var Tu=Object.getOwnPropertySymbols(Su);Bu&&(Tu=Tu.filter(function(Pu){return Object.getOwnPropertyDescriptor(Su,Pu).enumerable})),Du.push.apply(Du,Tu)}return Du}function t(Su){for(var Bu=1;Bu<arguments.length;Bu++){var Du=arguments[Bu]!=null?arguments[Bu]:{};Bu%2?F(Object(Du),!0).forEach(function(Tu){Z(Su,Tu,Du[Tu])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Su,Object.getOwnPropertyDescriptors(Du)):F(Object(Du)).forEach(function(Tu){Object.defineProperty(Su,Tu,Object.getOwnPropertyDescriptor(Du,Tu))})}return Su}function Z(Su,Bu,Du){return Bu=Ys(Bu),Bu in Su?Object.defineProperty(Su,Bu,{value:Du,enumerable:!0,configurable:!0,writable:!0}):Su[Bu]=Du,Su}function at(Su,Bu){if(!(Su instanceof Bu))throw new TypeError("Cannot call a class as a function")}function Hs(Su,Bu){for(var Du=0;Du<Bu.length;Du++){var Tu=Bu[Du];Tu.enumerable=Tu.enumerable||!1,Tu.configurable=!0,"value"in Tu&&(Tu.writable=!0),Object.defineProperty(Su,Ys(Tu.key),Tu)}}function zs(Su,Bu,Du){return Bu&&Hs(Su.prototype,Bu),Du&&Hs(Su,Du),Object.defineProperty(Su,"prototype",{writable:!1}),Su}function Ys(Su){var Bu=Zs(Su,"string");return typeof Bu=="symbol"?Bu:String(Bu)}function Zs(Su,Bu){if(typeof Su!="object"||Su===null)return Su;var Du=Su[Symbol.toPrimitive];if(Du!==void 0){var Tu=Du.call(Su,Bu||"default");if(typeof Tu!="object")return Tu;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Bu==="string"?String:Number)(Su)}var $u=buffer,Eu=$u.Buffer,Au=require$$3$1,vu=Au.inspect,Iu=vu&&vu.custom||"inspect";function _u(Su,Bu,Du){Eu.prototype.copy.call(Su,Bu,Du)}return buffer_list=function(){function Su(){at(this,Su),this.head=null,this.tail=null,this.length=0}return zs(Su,[{key:"push",value:function(Du){var Tu={data:Du,next:null};this.length>0?this.tail.next=Tu:this.head=Tu,this.tail=Tu,++this.length}},{key:"unshift",value:function(Du){var Tu={data:Du,next:this.head};this.length===0&&(this.tail=Tu),this.head=Tu,++this.length}},{key:"shift",value:function(){if(this.length!==0){var Du=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,Du}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(Du){if(this.length===0)return"";for(var Tu=this.head,Pu=""+Tu.data;Tu=Tu.next;)Pu+=Du+Tu.data;return Pu}},{key:"concat",value:function(Du){if(this.length===0)return Eu.alloc(0);for(var Tu=Eu.allocUnsafe(Du>>>0),Pu=this.head,Uu=0;Pu;)_u(Pu.data,Tu,Uu),Uu+=Pu.data.length,Pu=Pu.next;return Tu}},{key:"consume",value:function(Du,Tu){var Pu;return Du<this.head.data.length?(Pu=this.head.data.slice(0,Du),this.head.data=this.head.data.slice(Du)):Du===this.head.data.length?Pu=this.shift():Pu=Tu?this._getString(Du):this._getBuffer(Du),Pu}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(Du){var Tu=this.head,Pu=1,Uu=Tu.data;for(Du-=Uu.length;Tu=Tu.next;){var Fu=Tu.data,Lu=Du>Fu.length?Fu.length:Du;if(Lu===Fu.length?Uu+=Fu:Uu+=Fu.slice(0,Du),Du-=Lu,Du===0){Lu===Fu.length?(++Pu,Tu.next?this.head=Tu.next:this.head=this.tail=null):(this.head=Tu,Tu.data=Fu.slice(Lu));break}++Pu}return this.length-=Pu,Uu}},{key:"_getBuffer",value:function(Du){var Tu=Eu.allocUnsafe(Du),Pu=this.head,Uu=1;for(Pu.data.copy(Tu),Du-=Pu.data.length;Pu=Pu.next;){var Fu=Pu.data,Lu=Du>Fu.length?Fu.length:Du;if(Fu.copy(Tu,Tu.length-Du,0,Lu),Du-=Lu,Du===0){Lu===Fu.length?(++Uu,Pu.next?this.head=Pu.next:this.head=this.tail=null):(this.head=Pu,Pu.data=Fu.slice(Lu));break}++Uu}return this.length-=Uu,Tu}},{key:Iu,value:function(Du,Tu){return vu(this,t(t({},Tu),{},{depth:0,customInspect:!1}))}}]),Su}(),buffer_list}function destroy(F,t){var Z=this,at=this._readableState&&this._readableState.destroyed,Hs=this._writableState&&this._writableState.destroyed;return at||Hs?(t?t(F):F&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(emitErrorNT,this,F)):process.nextTick(emitErrorNT,this,F)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(F||null,function(zs){!t&&zs?Z._writableState?Z._writableState.errorEmitted?process.nextTick(emitCloseNT,Z):(Z._writableState.errorEmitted=!0,process.nextTick(emitErrorAndCloseNT,Z,zs)):process.nextTick(emitErrorAndCloseNT,Z,zs):t?(process.nextTick(emitCloseNT,Z),t(zs)):process.nextTick(emitCloseNT,Z)}),this)}function emitErrorAndCloseNT(F,t){emitErrorNT(F,t),emitCloseNT(F)}function emitCloseNT(F){F._writableState&&!F._writableState.emitClose||F._readableState&&!F._readableState.emitClose||F.emit("close")}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(F,t){F.emit("error",t)}function errorOrDestroy(F,t){var Z=F._readableState,at=F._writableState;Z&&Z.autoDestroy||at&&at.autoDestroy?F.destroy(t):F.emit("error",t)}var destroy_1={destroy,undestroy,errorOrDestroy},errorsBrowser={};function _inheritsLoose(F,t){F.prototype=Object.create(t.prototype),F.prototype.constructor=F,F.__proto__=t}var codes={};function createErrorType(F,t,Z){Z||(Z=Error);function at(zs,Ys,Zs){return typeof t=="string"?t:t(zs,Ys,Zs)}var Hs=function(zs){_inheritsLoose(Ys,zs);function Ys(Zs,$u,Eu){return zs.call(this,at(Zs,$u,Eu))||this}return Ys}(Z);Hs.prototype.name=Z.name,Hs.prototype.code=F,codes[F]=Hs}function oneOf(F,t){if(Array.isArray(F)){var Z=F.length;return F=F.map(function(at){return String(at)}),Z>2?"one of ".concat(t," ").concat(F.slice(0,Z-1).join(", "),", or ")+F[Z-1]:Z===2?"one of ".concat(t," ").concat(F[0]," or ").concat(F[1]):"of ".concat(t," ").concat(F[0])}else return"of ".concat(t," ").concat(String(F))}function startsWith(F,t,Z){return F.substr(!Z||Z<0?0:+Z,t.length)===t}function endsWith(F,t,Z){return(Z===void 0||Z>F.length)&&(Z=F.length),F.substring(Z-t.length,Z)===t}function includes(F,t,Z){return typeof Z!="number"&&(Z=0),Z+t.length>F.length?!1:F.indexOf(t,Z)!==-1}createErrorType("ERR_INVALID_OPT_VALUE",function(F,t){return'The value "'+t+'" is invalid for option "'+F+'"'},TypeError);createErrorType("ERR_INVALID_ARG_TYPE",function(F,t,Z){var at;typeof t=="string"&&startsWith(t,"not ")?(at="must not be",t=t.replace(/^not /,"")):at="must be";var Hs;if(endsWith(F," argument"))Hs="The ".concat(F," ").concat(at," ").concat(oneOf(t,"type"));else{var zs=includes(F,".")?"property":"argument";Hs='The "'.concat(F,'" ').concat(zs," ").concat(at," ").concat(oneOf(t,"type"))}return Hs+=". Received type ".concat(typeof Z),Hs},TypeError);createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");createErrorType("ERR_METHOD_NOT_IMPLEMENTED",function(F){return"The "+F+" method is not implemented"});createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close");createErrorType("ERR_STREAM_DESTROYED",function(F){return"Cannot call "+F+" after a stream was destroyed"});createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times");createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);createErrorType("ERR_UNKNOWN_ENCODING",function(F){return"Unknown encoding: "+F},TypeError);createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");errorsBrowser.codes=codes;var ERR_INVALID_OPT_VALUE=errorsBrowser.codes.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom(F,t,Z){return F.highWaterMark!=null?F.highWaterMark:t?F[Z]:null}function getHighWaterMark(F,t,Z,at){var Hs=highWaterMarkFrom(t,at,Z);if(Hs!=null){if(!(isFinite(Hs)&&Math.floor(Hs)===Hs)||Hs<0){var zs=at?Z:"highWaterMark";throw new ERR_INVALID_OPT_VALUE(zs,Hs)}return Math.floor(Hs)}return F.objectMode?16:16*1024}var state={getHighWaterMark},inherits_browser={exports:{}};typeof Object.create=="function"?inherits_browser.exports=function(t,Z){Z&&(t.super_=Z,t.prototype=Object.create(Z.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(t,Z){if(Z){t.super_=Z;var at=function(){};at.prototype=Z.prototype,t.prototype=new at,t.prototype.constructor=t}};var inherits_browserExports=inherits_browser.exports,browser$1=deprecate;function deprecate(F,t){if(config("noDeprecation"))return F;var Z=!1;function at(){if(!Z){if(config("throwDeprecation"))throw new Error(t);config("traceDeprecation")?console.trace(t):console.warn(t),Z=!0}return F.apply(this,arguments)}return at}function config(F){try{if(!commonjsGlobal.localStorage)return!1}catch{return!1}var t=commonjsGlobal.localStorage[F];return t==null?!1:String(t).toLowerCase()==="true"}var _stream_writable,hasRequired_stream_writable;function require_stream_writable(){if(hasRequired_stream_writable)return _stream_writable;hasRequired_stream_writable=1,_stream_writable=tl;function F(nl){var el=this;this.next=null,this.entry=null,this.finish=function(){vl(el,nl)}}var t;tl.WritableState=qu;var Z={deprecate:browser$1},at=streamBrowser,Hs=buffer.Buffer,zs=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Ys(nl){return Hs.from(nl)}function Zs(nl){return Hs.isBuffer(nl)||nl instanceof zs}var $u=destroy_1,Eu=state,Au=Eu.getHighWaterMark,vu=errorsBrowser.codes,Iu=vu.ERR_INVALID_ARG_TYPE,_u=vu.ERR_METHOD_NOT_IMPLEMENTED,Su=vu.ERR_MULTIPLE_CALLBACK,Bu=vu.ERR_STREAM_CANNOT_PIPE,Du=vu.ERR_STREAM_DESTROYED,Tu=vu.ERR_STREAM_NULL_VALUES,Pu=vu.ERR_STREAM_WRITE_AFTER_END,Uu=vu.ERR_UNKNOWN_ENCODING,Fu=$u.errorOrDestroy;inherits_browserExports(tl,at);function Lu(){}function qu(nl,el,yl){t=t||require_stream_duplex(),nl=nl||{},typeof yl!="boolean"&&(yl=el instanceof t),this.objectMode=!!nl.objectMode,yl&&(this.objectMode=this.objectMode||!!nl.writableObjectMode),this.highWaterMark=Au(this,nl,"writableHighWaterMark",yl),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var bl=nl.decodeStrings===!1;this.decodeStrings=!bl,this.defaultEncoding=nl.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Mu){ju(el,Mu)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=nl.emitClose!==!1,this.autoDestroy=!!nl.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new F(this)}qu.prototype.getBuffer=function(){for(var el=this.bufferedRequest,yl=[];el;)yl.push(el),el=el.next;return yl},function(){try{Object.defineProperty(qu.prototype,"buffer",{get:Z.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var zu;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(zu=Function.prototype[Symbol.hasInstance],Object.defineProperty(tl,Symbol.hasInstance,{value:function(el){return zu.call(this,el)?!0:this!==tl?!1:el&&el._writableState instanceof qu}})):zu=function(el){return el instanceof this};function tl(nl){t=t||require_stream_duplex();var el=this instanceof t;if(!el&&!zu.call(tl,this))return new tl(nl);this._writableState=new qu(nl,this,el),this.writable=!0,nl&&(typeof nl.write=="function"&&(this._write=nl.write),typeof nl.writev=="function"&&(this._writev=nl.writev),typeof nl.destroy=="function"&&(this._destroy=nl.destroy),typeof nl.final=="function"&&(this._final=nl.final)),at.call(this)}tl.prototype.pipe=function(){Fu(this,new Bu)};function Wu(nl,el){var yl=new Pu;Fu(nl,yl),process.nextTick(el,yl)}function cl(nl,el,yl,bl){var Mu;return yl===null?Mu=new Tu:typeof yl!="string"&&!el.objectMode&&(Mu=new Iu("chunk",["string","Buffer"],yl)),Mu?(Fu(nl,Mu),process.nextTick(bl,Mu),!1):!0}tl.prototype.write=function(nl,el,yl){var bl=this._writableState,Mu=!1,Ru=!bl.objectMode&&Zs(nl);return Ru&&!Hs.isBuffer(nl)&&(nl=Ys(nl)),typeof el=="function"&&(yl=el,el=null),Ru?el="buffer":el||(el=bl.defaultEncoding),typeof yl!="function"&&(yl=Lu),bl.ending?Wu(this,yl):(Ru||cl(this,bl,nl,yl))&&(bl.pendingcb++,Mu=hl(this,bl,Ru,nl,el,yl)),Mu},tl.prototype.cork=function(){this._writableState.corked++},tl.prototype.uncork=function(){var nl=this._writableState;nl.corked&&(nl.corked--,!nl.writing&&!nl.corked&&!nl.bufferProcessing&&nl.bufferedRequest&&Xu(this,nl))},tl.prototype.setDefaultEncoding=function(el){if(typeof el=="string"&&(el=el.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((el+"").toLowerCase())>-1))throw new Uu(el);return this._writableState.defaultEncoding=el,this},Object.defineProperty(tl.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function wl(nl,el,yl){return!nl.objectMode&&nl.decodeStrings!==!1&&typeof el=="string"&&(el=Hs.from(el,yl)),el}Object.defineProperty(tl.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function hl(nl,el,yl,bl,Mu,Ru){if(!yl){var Ou=wl(el,bl,Mu);bl!==Ou&&(yl=!0,Mu="buffer",bl=Ou)}var Vu=el.objectMode?1:bl.length;el.length+=Vu;var Gu=el.length<el.highWaterMark;if(Gu||(el.needDrain=!0),el.writing||el.corked){var il=el.lastBufferedRequest;el.lastBufferedRequest={chunk:bl,encoding:Mu,isBuf:yl,callback:Ru,next:null},il?il.next=el.lastBufferedRequest:el.bufferedRequest=el.lastBufferedRequest,el.bufferedRequestCount+=1}else Qu(nl,el,!1,Vu,bl,Mu,Ru);return Gu}function Qu(nl,el,yl,bl,Mu,Ru,Ou){el.writelen=bl,el.writecb=Ou,el.writing=!0,el.sync=!0,el.destroyed?el.onwrite(new Du("write")):yl?nl._writev(Mu,el.onwrite):nl._write(Mu,Ru,el.onwrite),el.sync=!1}function rl(nl,el,yl,bl,Mu){--el.pendingcb,yl?(process.nextTick(Mu,bl),process.nextTick(Il,nl,el),nl._writableState.errorEmitted=!0,Fu(nl,bl)):(Mu(bl),nl._writableState.errorEmitted=!0,Fu(nl,bl),Il(nl,el))}function Hu(nl){nl.writing=!1,nl.writecb=null,nl.length-=nl.writelen,nl.writelen=0}function ju(nl,el){var yl=nl._writableState,bl=yl.sync,Mu=yl.writecb;if(typeof Mu!="function")throw new Su;if(Hu(yl),el)rl(nl,yl,bl,el,Mu);else{var Ru=al(yl)||nl.destroyed;!Ru&&!yl.corked&&!yl.bufferProcessing&&yl.bufferedRequest&&Xu(nl,yl),bl?process.nextTick(Yu,nl,yl,Ru,Mu):Yu(nl,yl,Ru,Mu)}}function Yu(nl,el,yl,bl){yl||ul(nl,el),el.pendingcb--,bl(),Il(nl,el)}function ul(nl,el){el.length===0&&el.needDrain&&(el.needDrain=!1,nl.emit("drain"))}function Xu(nl,el){el.bufferProcessing=!0;var yl=el.bufferedRequest;if(nl._writev&&yl&&yl.next){var bl=el.bufferedRequestCount,Mu=new Array(bl),Ru=el.corkedRequestsFree;Ru.entry=yl;for(var Ou=0,Vu=!0;yl;)Mu[Ou]=yl,yl.isBuf||(Vu=!1),yl=yl.next,Ou+=1;Mu.allBuffers=Vu,Qu(nl,el,!0,el.length,Mu,"",Ru.finish),el.pendingcb++,el.lastBufferedRequest=null,Ru.next?(el.corkedRequestsFree=Ru.next,Ru.next=null):el.corkedRequestsFree=new F(el),el.bufferedRequestCount=0}else{for(;yl;){var Gu=yl.chunk,il=yl.encoding,ol=yl.callback,Ju=el.objectMode?1:Gu.length;if(Qu(nl,el,!1,Ju,Gu,il,ol),yl=yl.next,el.bufferedRequestCount--,el.writing)break}yl===null&&(el.lastBufferedRequest=null)}el.bufferedRequest=yl,el.bufferProcessing=!1}tl.prototype._write=function(nl,el,yl){yl(new _u("_write()"))},tl.prototype._writev=null,tl.prototype.end=function(nl,el,yl){var bl=this._writableState;return typeof nl=="function"?(yl=nl,nl=null,el=null):typeof el=="function"&&(yl=el,el=null),nl!=null&&this.write(nl,el),bl.corked&&(bl.corked=1,this.uncork()),bl.ending||dl(this,bl,yl),this},Object.defineProperty(tl.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function al(nl){return nl.ending&&nl.length===0&&nl.bufferedRequest===null&&!nl.finished&&!nl.writing}function pl(nl,el){nl._final(function(yl){el.pendingcb--,yl&&Fu(nl,yl),el.prefinished=!0,nl.emit("prefinish"),Il(nl,el)})}function ml(nl,el){!el.prefinished&&!el.finalCalled&&(typeof nl._final=="function"&&!el.destroyed?(el.pendingcb++,el.finalCalled=!0,process.nextTick(pl,nl,el)):(el.prefinished=!0,nl.emit("prefinish")))}function Il(nl,el){var yl=al(el);if(yl&&(ml(nl,el),el.pendingcb===0&&(el.finished=!0,nl.emit("finish"),el.autoDestroy))){var bl=nl._readableState;(!bl||bl.autoDestroy&&bl.endEmitted)&&nl.destroy()}return yl}function dl(nl,el,yl){el.ending=!0,Il(nl,el),yl&&(el.finished?process.nextTick(yl):nl.once("finish",yl)),el.ended=!0,nl.writable=!1}function vl(nl,el,yl){var bl=nl.entry;for(nl.entry=null;bl;){var Mu=bl.callback;el.pendingcb--,Mu(yl),bl=bl.next}el.corkedRequestsFree.next=nl}return Object.defineProperty(tl.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(el){this._writableState&&(this._writableState.destroyed=el)}}),tl.prototype.destroy=$u.destroy,tl.prototype._undestroy=$u.undestroy,tl.prototype._destroy=function(nl,el){el(nl)},_stream_writable}var _stream_duplex,hasRequired_stream_duplex;function require_stream_duplex(){if(hasRequired_stream_duplex)return _stream_duplex;hasRequired_stream_duplex=1;var F=Object.keys||function(Eu){var Au=[];for(var vu in Eu)Au.push(vu);return Au};_stream_duplex=Ys;var t=require_stream_readable(),Z=require_stream_writable();inherits_browserExports(Ys,t);for(var at=F(Z.prototype),Hs=0;Hs<at.length;Hs++){var zs=at[Hs];Ys.prototype[zs]||(Ys.prototype[zs]=Z.prototype[zs])}function Ys(Eu){if(!(this instanceof Ys))return new Ys(Eu);t.call(this,Eu),Z.call(this,Eu),this.allowHalfOpen=!0,Eu&&(Eu.readable===!1&&(this.readable=!1),Eu.writable===!1&&(this.writable=!1),Eu.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",Zs)))}Object.defineProperty(Ys.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Ys.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Ys.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Zs(){this._writableState.ended||process.nextTick($u,this)}function $u(Eu){Eu.end()}return Object.defineProperty(Ys.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(Au){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=Au,this._writableState.destroyed=Au)}}),_stream_duplex}var string_decoder={},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredSafeBuffer;function requireSafeBuffer(){return hasRequiredSafeBuffer||(hasRequiredSafeBuffer=1,function(F,t){var Z=buffer,at=Z.Buffer;function Hs(Ys,Zs){for(var $u in Ys)Zs[$u]=Ys[$u]}at.from&&at.alloc&&at.allocUnsafe&&at.allocUnsafeSlow?F.exports=Z:(Hs(Z,t),t.Buffer=zs);function zs(Ys,Zs,$u){return at(Ys,Zs,$u)}zs.prototype=Object.create(at.prototype),Hs(at,zs),zs.from=function(Ys,Zs,$u){if(typeof Ys=="number")throw new TypeError("Argument must not be a number");return at(Ys,Zs,$u)},zs.alloc=function(Ys,Zs,$u){if(typeof Ys!="number")throw new TypeError("Argument must be a number");var Eu=at(Ys);return Zs!==void 0?typeof $u=="string"?Eu.fill(Zs,$u):Eu.fill(Zs):Eu.fill(0),Eu},zs.allocUnsafe=function(Ys){if(typeof Ys!="number")throw new TypeError("Argument must be a number");return at(Ys)},zs.allocUnsafeSlow=function(Ys){if(typeof Ys!="number")throw new TypeError("Argument must be a number");return Z.SlowBuffer(Ys)}}(safeBuffer,safeBuffer.exports)),safeBuffer.exports}var hasRequiredString_decoder;function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder;hasRequiredString_decoder=1;var F=requireSafeBuffer().Buffer,t=F.isEncoding||function(Tu){switch(Tu=""+Tu,Tu&&Tu.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Z(Tu){if(!Tu)return"utf8";for(var Pu;;)switch(Tu){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return Tu;default:if(Pu)return;Tu=(""+Tu).toLowerCase(),Pu=!0}}function at(Tu){var Pu=Z(Tu);if(typeof Pu!="string"&&(F.isEncoding===t||!t(Tu)))throw new Error("Unknown encoding: "+Tu);return Pu||Tu}string_decoder.StringDecoder=Hs;function Hs(Tu){this.encoding=at(Tu);var Pu;switch(this.encoding){case"utf16le":this.text=vu,this.end=Iu,Pu=4;break;case"utf8":this.fillLast=$u,Pu=4;break;case"base64":this.text=_u,this.end=Su,Pu=3;break;default:this.write=Bu,this.end=Du;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=F.allocUnsafe(Pu)}Hs.prototype.write=function(Tu){if(Tu.length===0)return"";var Pu,Uu;if(this.lastNeed){if(Pu=this.fillLast(Tu),Pu===void 0)return"";Uu=this.lastNeed,this.lastNeed=0}else Uu=0;return Uu<Tu.length?Pu?Pu+this.text(Tu,Uu):this.text(Tu,Uu):Pu||""},Hs.prototype.end=Au,Hs.prototype.text=Eu,Hs.prototype.fillLast=function(Tu){if(this.lastNeed<=Tu.length)return Tu.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);Tu.copy(this.lastChar,this.lastTotal-this.lastNeed,0,Tu.length),this.lastNeed-=Tu.length};function zs(Tu){return Tu<=127?0:Tu>>5===6?2:Tu>>4===14?3:Tu>>3===30?4:Tu>>6===2?-1:-2}function Ys(Tu,Pu,Uu){var Fu=Pu.length-1;if(Fu<Uu)return 0;var Lu=zs(Pu[Fu]);return Lu>=0?(Lu>0&&(Tu.lastNeed=Lu-1),Lu):--Fu<Uu||Lu===-2?0:(Lu=zs(Pu[Fu]),Lu>=0?(Lu>0&&(Tu.lastNeed=Lu-2),Lu):--Fu<Uu||Lu===-2?0:(Lu=zs(Pu[Fu]),Lu>=0?(Lu>0&&(Lu===2?Lu=0:Tu.lastNeed=Lu-3),Lu):0))}function Zs(Tu,Pu,Uu){if((Pu[0]&192)!==128)return Tu.lastNeed=0,"";if(Tu.lastNeed>1&&Pu.length>1){if((Pu[1]&192)!==128)return Tu.lastNeed=1,"";if(Tu.lastNeed>2&&Pu.length>2&&(Pu[2]&192)!==128)return Tu.lastNeed=2,""}}function $u(Tu){var Pu=this.lastTotal-this.lastNeed,Uu=Zs(this,Tu);if(Uu!==void 0)return Uu;if(this.lastNeed<=Tu.length)return Tu.copy(this.lastChar,Pu,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);Tu.copy(this.lastChar,Pu,0,Tu.length),this.lastNeed-=Tu.length}function Eu(Tu,Pu){var Uu=Ys(this,Tu,Pu);if(!this.lastNeed)return Tu.toString("utf8",Pu);this.lastTotal=Uu;var Fu=Tu.length-(Uu-this.lastNeed);return Tu.copy(this.lastChar,0,Fu),Tu.toString("utf8",Pu,Fu)}function Au(Tu){var Pu=Tu&&Tu.length?this.write(Tu):"";return this.lastNeed?Pu+"":Pu}function vu(Tu,Pu){if((Tu.length-Pu)%2===0){var Uu=Tu.toString("utf16le",Pu);if(Uu){var Fu=Uu.charCodeAt(Uu.length-1);if(Fu>=55296&&Fu<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=Tu[Tu.length-2],this.lastChar[1]=Tu[Tu.length-1],Uu.slice(0,-1)}return Uu}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=Tu[Tu.length-1],Tu.toString("utf16le",Pu,Tu.length-1)}function Iu(Tu){var Pu=Tu&&Tu.length?this.write(Tu):"";if(this.lastNeed){var Uu=this.lastTotal-this.lastNeed;return Pu+this.lastChar.toString("utf16le",0,Uu)}return Pu}function _u(Tu,Pu){var Uu=(Tu.length-Pu)%3;return Uu===0?Tu.toString("base64",Pu):(this.lastNeed=3-Uu,this.lastTotal=3,Uu===1?this.lastChar[0]=Tu[Tu.length-1]:(this.lastChar[0]=Tu[Tu.length-2],this.lastChar[1]=Tu[Tu.length-1]),Tu.toString("base64",Pu,Tu.length-Uu))}function Su(Tu){var Pu=Tu&&Tu.length?this.write(Tu):"";return this.lastNeed?Pu+this.lastChar.toString("base64",0,3-this.lastNeed):Pu}function Bu(Tu){return Tu.toString(this.encoding)}function Du(Tu){return Tu&&Tu.length?this.write(Tu):""}return string_decoder}var ERR_STREAM_PREMATURE_CLOSE=errorsBrowser.codes.ERR_STREAM_PREMATURE_CLOSE;function once$1(F){var t=!1;return function(){if(!t){t=!0;for(var Z=arguments.length,at=new Array(Z),Hs=0;Hs<Z;Hs++)at[Hs]=arguments[Hs];F.apply(this,at)}}}function noop$3(){}function isRequest$1(F){return F.setHeader&&typeof F.abort=="function"}function eos$1(F,t,Z){if(typeof t=="function")return eos$1(F,null,t);t||(t={}),Z=once$1(Z||noop$3);var at=t.readable||t.readable!==!1&&F.readable,Hs=t.writable||t.writable!==!1&&F.writable,zs=function(){F.writable||Zs()},Ys=F._writableState&&F._writableState.finished,Zs=function(){Hs=!1,Ys=!0,at||Z.call(F)},$u=F._readableState&&F._readableState.endEmitted,Eu=function(){at=!1,$u=!0,Hs||Z.call(F)},Au=function(Su){Z.call(F,Su)},vu=function(){var Su;if(at&&!$u)return(!F._readableState||!F._readableState.ended)&&(Su=new ERR_STREAM_PREMATURE_CLOSE),Z.call(F,Su);if(Hs&&!Ys)return(!F._writableState||!F._writableState.ended)&&(Su=new ERR_STREAM_PREMATURE_CLOSE),Z.call(F,Su)},Iu=function(){F.req.on("finish",Zs)};return isRequest$1(F)?(F.on("complete",Zs),F.on("abort",vu),F.req?Iu():F.on("request",Iu)):Hs&&!F._writableState&&(F.on("end",zs),F.on("close",zs)),F.on("end",Eu),F.on("finish",Zs),t.error!==!1&&F.on("error",Au),F.on("close",vu),function(){F.removeListener("complete",Zs),F.removeListener("abort",vu),F.removeListener("request",Iu),F.req&&F.req.removeListener("finish",Zs),F.removeListener("end",zs),F.removeListener("close",zs),F.removeListener("finish",Zs),F.removeListener("end",Eu),F.removeListener("error",Au),F.removeListener("close",vu)}}var endOfStream=eos$1,async_iterator,hasRequiredAsync_iterator;function requireAsync_iterator(){if(hasRequiredAsync_iterator)return async_iterator;hasRequiredAsync_iterator=1;var F;function t(Uu,Fu,Lu){return Fu=Z(Fu),Fu in Uu?Object.defineProperty(Uu,Fu,{value:Lu,enumerable:!0,configurable:!0,writable:!0}):Uu[Fu]=Lu,Uu}function Z(Uu){var Fu=at(Uu,"string");return typeof Fu=="symbol"?Fu:String(Fu)}function at(Uu,Fu){if(typeof Uu!="object"||Uu===null)return Uu;var Lu=Uu[Symbol.toPrimitive];if(Lu!==void 0){var qu=Lu.call(Uu,Fu||"default");if(typeof qu!="object")return qu;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Fu==="string"?String:Number)(Uu)}var Hs=endOfStream,zs=Symbol("lastResolve"),Ys=Symbol("lastReject"),Zs=Symbol("error"),$u=Symbol("ended"),Eu=Symbol("lastPromise"),Au=Symbol("handlePromise"),vu=Symbol("stream");function Iu(Uu,Fu){return{value:Uu,done:Fu}}function _u(Uu){var Fu=Uu[zs];if(Fu!==null){var Lu=Uu[vu].read();Lu!==null&&(Uu[Eu]=null,Uu[zs]=null,Uu[Ys]=null,Fu(Iu(Lu,!1)))}}function Su(Uu){process.nextTick(_u,Uu)}function Bu(Uu,Fu){return function(Lu,qu){Uu.then(function(){if(Fu[$u]){Lu(Iu(void 0,!0));return}Fu[Au](Lu,qu)},qu)}}var Du=Object.getPrototypeOf(function(){}),Tu=Object.setPrototypeOf((F={get stream(){return this[vu]},next:function(){var Fu=this,Lu=this[Zs];if(Lu!==null)return Promise.reject(Lu);if(this[$u])return Promise.resolve(Iu(void 0,!0));if(this[vu].destroyed)return new Promise(function(Wu,cl){process.nextTick(function(){Fu[Zs]?cl(Fu[Zs]):Wu(Iu(void 0,!0))})});var qu=this[Eu],zu;if(qu)zu=new Promise(Bu(qu,this));else{var tl=this[vu].read();if(tl!==null)return Promise.resolve(Iu(tl,!1));zu=new Promise(this[Au])}return this[Eu]=zu,zu}},t(F,Symbol.asyncIterator,function(){return this}),t(F,"return",function(){var Fu=this;return new Promise(function(Lu,qu){Fu[vu].destroy(null,function(zu){if(zu){qu(zu);return}Lu(Iu(void 0,!0))})})}),F),Du),Pu=function(Fu){var Lu,qu=Object.create(Tu,(Lu={},t(Lu,vu,{value:Fu,writable:!0}),t(Lu,zs,{value:null,writable:!0}),t(Lu,Ys,{value:null,writable:!0}),t(Lu,Zs,{value:null,writable:!0}),t(Lu,$u,{value:Fu._readableState.endEmitted,writable:!0}),t(Lu,Au,{value:function(tl,Wu){var cl=qu[vu].read();cl?(qu[Eu]=null,qu[zs]=null,qu[Ys]=null,tl(Iu(cl,!1))):(qu[zs]=tl,qu[Ys]=Wu)},writable:!0}),Lu));return qu[Eu]=null,Hs(Fu,function(zu){if(zu&&zu.code!=="ERR_STREAM_PREMATURE_CLOSE"){var tl=qu[Ys];tl!==null&&(qu[Eu]=null,qu[zs]=null,qu[Ys]=null,tl(zu)),qu[Zs]=zu;return}var Wu=qu[zs];Wu!==null&&(qu[Eu]=null,qu[zs]=null,qu[Ys]=null,Wu(Iu(void 0,!0))),qu[$u]=!0}),Fu.on("readable",Su.bind(null,qu)),qu};return async_iterator=Pu,async_iterator}var fromBrowser,hasRequiredFromBrowser;function requireFromBrowser(){return hasRequiredFromBrowser||(hasRequiredFromBrowser=1,fromBrowser=function(){throw new Error("Readable.from is not available in the browser")}),fromBrowser}var _stream_readable,hasRequired_stream_readable;function require_stream_readable(){if(hasRequired_stream_readable)return _stream_readable;hasRequired_stream_readable=1,_stream_readable=Wu;var F;Wu.ReadableState=tl,eventsExports.EventEmitter;var t=function(Ou,Vu){return Ou.listeners(Vu).length},Z=streamBrowser,at=buffer.Buffer,Hs=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function zs(Ru){return at.from(Ru)}function Ys(Ru){return at.isBuffer(Ru)||Ru instanceof Hs}var Zs=require$$3$1,$u;Zs&&Zs.debuglog?$u=Zs.debuglog("stream"):$u=function(){};var Eu=requireBuffer_list(),Au=destroy_1,vu=state,Iu=vu.getHighWaterMark,_u=errorsBrowser.codes,Su=_u.ERR_INVALID_ARG_TYPE,Bu=_u.ERR_STREAM_PUSH_AFTER_EOF,Du=_u.ERR_METHOD_NOT_IMPLEMENTED,Tu=_u.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Pu,Uu,Fu;inherits_browserExports(Wu,Z);var Lu=Au.errorOrDestroy,qu=["error","close","destroy","pause","resume"];function zu(Ru,Ou,Vu){if(typeof Ru.prependListener=="function")return Ru.prependListener(Ou,Vu);!Ru._events||!Ru._events[Ou]?Ru.on(Ou,Vu):Array.isArray(Ru._events[Ou])?Ru._events[Ou].unshift(Vu):Ru._events[Ou]=[Vu,Ru._events[Ou]]}function tl(Ru,Ou,Vu){F=F||require_stream_duplex(),Ru=Ru||{},typeof Vu!="boolean"&&(Vu=Ou instanceof F),this.objectMode=!!Ru.objectMode,Vu&&(this.objectMode=this.objectMode||!!Ru.readableObjectMode),this.highWaterMark=Iu(this,Ru,"readableHighWaterMark",Vu),this.buffer=new Eu,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Ru.emitClose!==!1,this.autoDestroy=!!Ru.autoDestroy,this.destroyed=!1,this.defaultEncoding=Ru.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Ru.encoding&&(Pu||(Pu=requireString_decoder().StringDecoder),this.decoder=new Pu(Ru.encoding),this.encoding=Ru.encoding)}function Wu(Ru){if(F=F||require_stream_duplex(),!(this instanceof Wu))return new Wu(Ru);var Ou=this instanceof F;this._readableState=new tl(Ru,this,Ou),this.readable=!0,Ru&&(typeof Ru.read=="function"&&(this._read=Ru.read),typeof Ru.destroy=="function"&&(this._destroy=Ru.destroy)),Z.call(this)}Object.defineProperty(Wu.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Ou){this._readableState&&(this._readableState.destroyed=Ou)}}),Wu.prototype.destroy=Au.destroy,Wu.prototype._undestroy=Au.undestroy,Wu.prototype._destroy=function(Ru,Ou){Ou(Ru)},Wu.prototype.push=function(Ru,Ou){var Vu=this._readableState,Gu;return Vu.objectMode?Gu=!0:typeof Ru=="string"&&(Ou=Ou||Vu.defaultEncoding,Ou!==Vu.encoding&&(Ru=at.from(Ru,Ou),Ou=""),Gu=!0),cl(this,Ru,Ou,!1,Gu)},Wu.prototype.unshift=function(Ru){return cl(this,Ru,null,!0,!1)};function cl(Ru,Ou,Vu,Gu,il){$u("readableAddChunk",Ou);var ol=Ru._readableState;if(Ou===null)ol.reading=!1,ju(Ru,ol);else{var Ju;if(il||(Ju=hl(ol,Ou)),Ju)Lu(Ru,Ju);else if(ol.objectMode||Ou&&Ou.length>0)if(typeof Ou!="string"&&!ol.objectMode&&Object.getPrototypeOf(Ou)!==at.prototype&&(Ou=zs(Ou)),Gu)ol.endEmitted?Lu(Ru,new Tu):wl(Ru,ol,Ou,!0);else if(ol.ended)Lu(Ru,new Bu);else{if(ol.destroyed)return!1;ol.reading=!1,ol.decoder&&!Vu?(Ou=ol.decoder.write(Ou),ol.objectMode||Ou.length!==0?wl(Ru,ol,Ou,!1):Xu(Ru,ol)):wl(Ru,ol,Ou,!1)}else Gu||(ol.reading=!1,Xu(Ru,ol))}return!ol.ended&&(ol.length<ol.highWaterMark||ol.length===0)}function wl(Ru,Ou,Vu,Gu){Ou.flowing&&Ou.length===0&&!Ou.sync?(Ou.awaitDrain=0,Ru.emit("data",Vu)):(Ou.length+=Ou.objectMode?1:Vu.length,Gu?Ou.buffer.unshift(Vu):Ou.buffer.push(Vu),Ou.needReadable&&Yu(Ru)),Xu(Ru,Ou)}function hl(Ru,Ou){var Vu;return!Ys(Ou)&&typeof Ou!="string"&&Ou!==void 0&&!Ru.objectMode&&(Vu=new Su("chunk",["string","Buffer","Uint8Array"],Ou)),Vu}Wu.prototype.isPaused=function(){return this._readableState.flowing===!1},Wu.prototype.setEncoding=function(Ru){Pu||(Pu=requireString_decoder().StringDecoder);var Ou=new Pu(Ru);this._readableState.decoder=Ou,this._readableState.encoding=this._readableState.decoder.encoding;for(var Vu=this._readableState.buffer.head,Gu="";Vu!==null;)Gu+=Ou.write(Vu.data),Vu=Vu.next;return this._readableState.buffer.clear(),Gu!==""&&this._readableState.buffer.push(Gu),this._readableState.length=Gu.length,this};var Qu=1073741824;function rl(Ru){return Ru>=Qu?Ru=Qu:(Ru--,Ru|=Ru>>>1,Ru|=Ru>>>2,Ru|=Ru>>>4,Ru|=Ru>>>8,Ru|=Ru>>>16,Ru++),Ru}function Hu(Ru,Ou){return Ru<=0||Ou.length===0&&Ou.ended?0:Ou.objectMode?1:Ru!==Ru?Ou.flowing&&Ou.length?Ou.buffer.head.data.length:Ou.length:(Ru>Ou.highWaterMark&&(Ou.highWaterMark=rl(Ru)),Ru<=Ou.length?Ru:Ou.ended?Ou.length:(Ou.needReadable=!0,0))}Wu.prototype.read=function(Ru){$u("read",Ru),Ru=parseInt(Ru,10);var Ou=this._readableState,Vu=Ru;if(Ru!==0&&(Ou.emittedReadable=!1),Ru===0&&Ou.needReadable&&((Ou.highWaterMark!==0?Ou.length>=Ou.highWaterMark:Ou.length>0)||Ou.ended))return $u("read: emitReadable",Ou.length,Ou.ended),Ou.length===0&&Ou.ended?yl(this):Yu(this),null;if(Ru=Hu(Ru,Ou),Ru===0&&Ou.ended)return Ou.length===0&&yl(this),null;var Gu=Ou.needReadable;$u("need readable",Gu),(Ou.length===0||Ou.length-Ru<Ou.highWaterMark)&&(Gu=!0,$u("length less than watermark",Gu)),Ou.ended||Ou.reading?(Gu=!1,$u("reading or ended",Gu)):Gu&&($u("do read"),Ou.reading=!0,Ou.sync=!0,Ou.length===0&&(Ou.needReadable=!0),this._read(Ou.highWaterMark),Ou.sync=!1,Ou.reading||(Ru=Hu(Vu,Ou)));var il;return Ru>0?il=el(Ru,Ou):il=null,il===null?(Ou.needReadable=Ou.length<=Ou.highWaterMark,Ru=0):(Ou.length-=Ru,Ou.awaitDrain=0),Ou.length===0&&(Ou.ended||(Ou.needReadable=!0),Vu!==Ru&&Ou.ended&&yl(this)),il!==null&&this.emit("data",il),il};function ju(Ru,Ou){if($u("onEofChunk"),!Ou.ended){if(Ou.decoder){var Vu=Ou.decoder.end();Vu&&Vu.length&&(Ou.buffer.push(Vu),Ou.length+=Ou.objectMode?1:Vu.length)}Ou.ended=!0,Ou.sync?Yu(Ru):(Ou.needReadable=!1,Ou.emittedReadable||(Ou.emittedReadable=!0,ul(Ru)))}}function Yu(Ru){var Ou=Ru._readableState;$u("emitReadable",Ou.needReadable,Ou.emittedReadable),Ou.needReadable=!1,Ou.emittedReadable||($u("emitReadable",Ou.flowing),Ou.emittedReadable=!0,process.nextTick(ul,Ru))}function ul(Ru){var Ou=Ru._readableState;$u("emitReadable_",Ou.destroyed,Ou.length,Ou.ended),!Ou.destroyed&&(Ou.length||Ou.ended)&&(Ru.emit("readable"),Ou.emittedReadable=!1),Ou.needReadable=!Ou.flowing&&!Ou.ended&&Ou.length<=Ou.highWaterMark,nl(Ru)}function Xu(Ru,Ou){Ou.readingMore||(Ou.readingMore=!0,process.nextTick(al,Ru,Ou))}function al(Ru,Ou){for(;!Ou.reading&&!Ou.ended&&(Ou.length<Ou.highWaterMark||Ou.flowing&&Ou.length===0);){var Vu=Ou.length;if($u("maybeReadMore read 0"),Ru.read(0),Vu===Ou.length)break}Ou.readingMore=!1}Wu.prototype._read=function(Ru){Lu(this,new Du("_read()"))},Wu.prototype.pipe=function(Ru,Ou){var Vu=this,Gu=this._readableState;switch(Gu.pipesCount){case 0:Gu.pipes=Ru;break;case 1:Gu.pipes=[Gu.pipes,Ru];break;default:Gu.pipes.push(Ru);break}Gu.pipesCount+=1,$u("pipe count=%d opts=%j",Gu.pipesCount,Ou);var il=(!Ou||Ou.end!==!1)&&Ru!==process.stdout&&Ru!==process.stderr,ol=il?ll:Bl;Gu.endEmitted?process.nextTick(ol):Vu.once("end",ol),Ru.on("unpipe",Ju);function Ju(Nu,Cu){$u("onunpipe"),Nu===Vu&&Cu&&Cu.hasUnpiped===!1&&(Cu.hasUnpiped=!0,fl())}function ll(){$u("onend"),Ru.end()}var Ku=pl(Vu);Ru.on("drain",Ku);var Zu=!1;function fl(){$u("cleanup"),Ru.removeListener("close",_l),Ru.removeListener("finish",Cl),Ru.removeListener("drain",Ku),Ru.removeListener("error",Al),Ru.removeListener("unpipe",Ju),Vu.removeListener("end",ll),Vu.removeListener("end",Bl),Vu.removeListener("data",$l),Zu=!0,Gu.awaitDrain&&(!Ru._writableState||Ru._writableState.needDrain)&&Ku()}Vu.on("data",$l);function $l(Nu){$u("ondata");var Cu=Ru.write(Nu);$u("dest.write",Cu),Cu===!1&&((Gu.pipesCount===1&&Gu.pipes===Ru||Gu.pipesCount>1&&Mu(Gu.pipes,Ru)!==-1)&&!Zu&&($u("false write response, pause",Gu.awaitDrain),Gu.awaitDrain++),Vu.pause())}function Al(Nu){$u("onerror",Nu),Bl(),Ru.removeListener("error",Al),t(Ru,"error")===0&&Lu(Ru,Nu)}zu(Ru,"error",Al);function _l(){Ru.removeListener("finish",Cl),Bl()}Ru.once("close",_l);function Cl(){$u("onfinish"),Ru.removeListener("close",_l),Bl()}Ru.once("finish",Cl);function Bl(){$u("unpipe"),Vu.unpipe(Ru)}return Ru.emit("pipe",Vu),Gu.flowing||($u("pipe resume"),Vu.resume()),Ru};function pl(Ru){return function(){var Vu=Ru._readableState;$u("pipeOnDrain",Vu.awaitDrain),Vu.awaitDrain&&Vu.awaitDrain--,Vu.awaitDrain===0&&t(Ru,"data")&&(Vu.flowing=!0,nl(Ru))}}Wu.prototype.unpipe=function(Ru){var Ou=this._readableState,Vu={hasUnpiped:!1};if(Ou.pipesCount===0)return this;if(Ou.pipesCount===1)return Ru&&Ru!==Ou.pipes?this:(Ru||(Ru=Ou.pipes),Ou.pipes=null,Ou.pipesCount=0,Ou.flowing=!1,Ru&&Ru.emit("unpipe",this,Vu),this);if(!Ru){var Gu=Ou.pipes,il=Ou.pipesCount;Ou.pipes=null,Ou.pipesCount=0,Ou.flowing=!1;for(var ol=0;ol<il;ol++)Gu[ol].emit("unpipe",this,{hasUnpiped:!1});return this}var Ju=Mu(Ou.pipes,Ru);return Ju===-1?this:(Ou.pipes.splice(Ju,1),Ou.pipesCount-=1,Ou.pipesCount===1&&(Ou.pipes=Ou.pipes[0]),Ru.emit("unpipe",this,Vu),this)},Wu.prototype.on=function(Ru,Ou){var Vu=Z.prototype.on.call(this,Ru,Ou),Gu=this._readableState;return Ru==="data"?(Gu.readableListening=this.listenerCount("readable")>0,Gu.flowing!==!1&&this.resume()):Ru==="readable"&&!Gu.endEmitted&&!Gu.readableListening&&(Gu.readableListening=Gu.needReadable=!0,Gu.flowing=!1,Gu.emittedReadable=!1,$u("on readable",Gu.length,Gu.reading),Gu.length?Yu(this):Gu.reading||process.nextTick(Il,this)),Vu},Wu.prototype.addListener=Wu.prototype.on,Wu.prototype.removeListener=function(Ru,Ou){var Vu=Z.prototype.removeListener.call(this,Ru,Ou);return Ru==="readable"&&process.nextTick(ml,this),Vu},Wu.prototype.removeAllListeners=function(Ru){var Ou=Z.prototype.removeAllListeners.apply(this,arguments);return(Ru==="readable"||Ru===void 0)&&process.nextTick(ml,this),Ou};function ml(Ru){var Ou=Ru._readableState;Ou.readableListening=Ru.listenerCount("readable")>0,Ou.resumeScheduled&&!Ou.paused?Ou.flowing=!0:Ru.listenerCount("data")>0&&Ru.resume()}function Il(Ru){$u("readable nexttick read 0"),Ru.read(0)}Wu.prototype.resume=function(){var Ru=this._readableState;return Ru.flowing||($u("resume"),Ru.flowing=!Ru.readableListening,dl(this,Ru)),Ru.paused=!1,this};function dl(Ru,Ou){Ou.resumeScheduled||(Ou.resumeScheduled=!0,process.nextTick(vl,Ru,Ou))}function vl(Ru,Ou){$u("resume",Ou.reading),Ou.reading||Ru.read(0),Ou.resumeScheduled=!1,Ru.emit("resume"),nl(Ru),Ou.flowing&&!Ou.reading&&Ru.read(0)}Wu.prototype.pause=function(){return $u("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&($u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function nl(Ru){var Ou=Ru._readableState;for($u("flow",Ou.flowing);Ou.flowing&&Ru.read()!==null;);}Wu.prototype.wrap=function(Ru){var Ou=this,Vu=this._readableState,Gu=!1;Ru.on("end",function(){if($u("wrapped end"),Vu.decoder&&!Vu.ended){var Ju=Vu.decoder.end();Ju&&Ju.length&&Ou.push(Ju)}Ou.push(null)}),Ru.on("data",function(Ju){if($u("wrapped data"),Vu.decoder&&(Ju=Vu.decoder.write(Ju)),!(Vu.objectMode&&Ju==null)&&!(!Vu.objectMode&&(!Ju||!Ju.length))){var ll=Ou.push(Ju);ll||(Gu=!0,Ru.pause())}});for(var il in Ru)this[il]===void 0&&typeof Ru[il]=="function"&&(this[il]=function(ll){return function(){return Ru[ll].apply(Ru,arguments)}}(il));for(var ol=0;ol<qu.length;ol++)Ru.on(qu[ol],this.emit.bind(this,qu[ol]));return this._read=function(Ju){$u("wrapped _read",Ju),Gu&&(Gu=!1,Ru.resume())},this},typeof Symbol=="function"&&(Wu.prototype[Symbol.asyncIterator]=function(){return Uu===void 0&&(Uu=requireAsync_iterator()),Uu(this)}),Object.defineProperty(Wu.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Wu.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Wu.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Ou){this._readableState&&(this._readableState.flowing=Ou)}}),Wu._fromList=el,Object.defineProperty(Wu.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function el(Ru,Ou){if(Ou.length===0)return null;var Vu;return Ou.objectMode?Vu=Ou.buffer.shift():!Ru||Ru>=Ou.length?(Ou.decoder?Vu=Ou.buffer.join(""):Ou.buffer.length===1?Vu=Ou.buffer.first():Vu=Ou.buffer.concat(Ou.length),Ou.buffer.clear()):Vu=Ou.buffer.consume(Ru,Ou.decoder),Vu}function yl(Ru){var Ou=Ru._readableState;$u("endReadable",Ou.endEmitted),Ou.endEmitted||(Ou.ended=!0,process.nextTick(bl,Ou,Ru))}function bl(Ru,Ou){if($u("endReadableNT",Ru.endEmitted,Ru.length),!Ru.endEmitted&&Ru.length===0&&(Ru.endEmitted=!0,Ou.readable=!1,Ou.emit("end"),Ru.autoDestroy)){var Vu=Ou._writableState;(!Vu||Vu.autoDestroy&&Vu.finished)&&Ou.destroy()}}typeof Symbol=="function"&&(Wu.from=function(Ru,Ou){return Fu===void 0&&(Fu=requireFromBrowser()),Fu(Wu,Ru,Ou)});function Mu(Ru,Ou){for(var Vu=0,Gu=Ru.length;Vu<Gu;Vu++)if(Ru[Vu]===Ou)return Vu;return-1}return _stream_readable}var _stream_transform=Transform$3,_require$codes$1=errorsBrowser.codes,ERR_METHOD_NOT_IMPLEMENTED=_require$codes$1.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes$1.ERR_MULTIPLE_CALLBACK,ERR_TRANSFORM_ALREADY_TRANSFORMING=_require$codes$1.ERR_TRANSFORM_ALREADY_TRANSFORMING,ERR_TRANSFORM_WITH_LENGTH_0=_require$codes$1.ERR_TRANSFORM_WITH_LENGTH_0,Duplex=require_stream_duplex();inherits_browserExports(Transform$3,Duplex);function afterTransform(F,t){var Z=this._transformState;Z.transforming=!1;var at=Z.writecb;if(at===null)return this.emit("error",new ERR_MULTIPLE_CALLBACK);Z.writechunk=null,Z.writecb=null,t!=null&&this.push(t),at(F);var Hs=this._readableState;Hs.reading=!1,(Hs.needReadable||Hs.length<Hs.highWaterMark)&&this._read(Hs.highWaterMark)}function Transform$3(F){if(!(this instanceof Transform$3))return new Transform$3(F);Duplex.call(this,F),this._transformState={afterTransform:afterTransform.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,F&&(typeof F.transform=="function"&&(this._transform=F.transform),typeof F.flush=="function"&&(this._flush=F.flush)),this.on("prefinish",prefinish)}function prefinish(){var F=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(t,Z){done(F,t,Z)}):done(this,null,null)}Transform$3.prototype.push=function(F,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,F,t)};Transform$3.prototype._transform=function(F,t,Z){Z(new ERR_METHOD_NOT_IMPLEMENTED("_transform()"))};Transform$3.prototype._write=function(F,t,Z){var at=this._transformState;if(at.writecb=Z,at.writechunk=F,at.writeencoding=t,!at.transforming){var Hs=this._readableState;(at.needTransform||Hs.needReadable||Hs.length<Hs.highWaterMark)&&this._read(Hs.highWaterMark)}};Transform$3.prototype._read=function(F){var t=this._transformState;t.writechunk!==null&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};Transform$3.prototype._destroy=function(F,t){Duplex.prototype._destroy.call(this,F,function(Z){t(Z)})};function done(F,t,Z){if(t)return F.emit("error",t);if(Z!=null&&F.push(Z),F._writableState.length)throw new ERR_TRANSFORM_WITH_LENGTH_0;if(F._transformState.transforming)throw new ERR_TRANSFORM_ALREADY_TRANSFORMING;return F.push(null)}var _stream_passthrough=PassThrough,Transform$2=_stream_transform;inherits_browserExports(PassThrough,Transform$2);function PassThrough(F){if(!(this instanceof PassThrough))return new PassThrough(F);Transform$2.call(this,F)}PassThrough.prototype._transform=function(F,t,Z){Z(null,F)};var eos;function once(F){var t=!1;return function(){t||(t=!0,F.apply(void 0,arguments))}}var _require$codes=errorsBrowser.codes,ERR_MISSING_ARGS=_require$codes.ERR_MISSING_ARGS,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED;function noop$2(F){if(F)throw F}function isRequest(F){return F.setHeader&&typeof F.abort=="function"}function destroyer(F,t,Z,at){at=once(at);var Hs=!1;F.on("close",function(){Hs=!0}),eos===void 0&&(eos=endOfStream),eos(F,{readable:t,writable:Z},function(Ys){if(Ys)return at(Ys);Hs=!0,at()});var zs=!1;return function(Ys){if(!Hs&&!zs){if(zs=!0,isRequest(F))return F.abort();if(typeof F.destroy=="function")return F.destroy();at(Ys||new ERR_STREAM_DESTROYED("pipe"))}}}function call(F){F()}function pipe(F,t){return F.pipe(t)}function popCallback(F){return!F.length||typeof F[F.length-1]!="function"?noop$2:F.pop()}function pipeline(){for(var F=arguments.length,t=new Array(F),Z=0;Z<F;Z++)t[Z]=arguments[Z];var at=popCallback(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new ERR_MISSING_ARGS("streams");var Hs,zs=t.map(function(Ys,Zs){var $u=Zs<t.length-1,Eu=Zs>0;return destroyer(Ys,$u,Eu,function(Au){Hs||(Hs=Au),Au&&zs.forEach(call),!$u&&(zs.forEach(call),at(Hs))})});return t.reduce(pipe)}var pipeline_1=pipeline;(function(F,t){t=F.exports=require_stream_readable(),t.Stream=t,t.Readable=t,t.Writable=require_stream_writable(),t.Duplex=require_stream_duplex(),t.Transform=_stream_transform,t.PassThrough=_stream_passthrough,t.finished=endOfStream,t.pipeline=pipeline_1})(readableBrowser,readableBrowser.exports);var readableBrowserExports=readableBrowser.exports;const{Transform:Transform$1}=readableBrowserExports;var keccak$1=F=>class wh extends Transform$1{constructor(Z,at,Hs,zs,Ys){super(Ys),this._rate=Z,this._capacity=at,this._delimitedSuffix=Hs,this._hashBitLength=zs,this._options=Ys,this._state=new F,this._state.initialize(Z,at),this._finalized=!1}_transform(Z,at,Hs){let zs=null;try{this.update(Z,at)}catch(Ys){zs=Ys}Hs(zs)}_flush(Z){let at=null;try{this.push(this.digest())}catch(Hs){at=Hs}Z(at)}update(Z,at){if(!Buffer.isBuffer(Z)&&typeof Z!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");return Buffer.isBuffer(Z)||(Z=Buffer.from(Z,at)),this._state.absorb(Z),this}digest(Z){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);let at=this._state.squeeze(this._hashBitLength/8);return Z!==void 0&&(at=at.toString(Z)),this._resetState(),at}_resetState(){return this._state.initialize(this._rate,this._capacity),this}_clone(){const Z=new wh(this._rate,this._capacity,this._delimitedSuffix,this._hashBitLength,this._options);return this._state.copy(Z._state),Z._finalized=this._finalized,Z}};const{Transform}=readableBrowserExports;var shake=F=>class Eh extends Transform{constructor(Z,at,Hs,zs){super(zs),this._rate=Z,this._capacity=at,this._delimitedSuffix=Hs,this._options=zs,this._state=new F,this._state.initialize(Z,at),this._finalized=!1}_transform(Z,at,Hs){let zs=null;try{this.update(Z,at)}catch(Ys){zs=Ys}Hs(zs)}_flush(){}_read(Z){this.push(this.squeeze(Z))}update(Z,at){if(!Buffer.isBuffer(Z)&&typeof Z!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Squeeze already called");return Buffer.isBuffer(Z)||(Z=Buffer.from(Z,at)),this._state.absorb(Z),this}squeeze(Z,at){this._finalized||(this._finalized=!0,this._state.absorbLastFewBits(this._delimitedSuffix));let Hs=this._state.squeeze(Z);return at!==void 0&&(Hs=Hs.toString(at)),Hs}_resetState(){return this._state.initialize(this._rate,this._capacity),this}_clone(){const Z=new Eh(this._rate,this._capacity,this._delimitedSuffix,this._options);return this._state.copy(Z._state),Z._finalized=this._finalized,Z}};const createKeccak=keccak$1,createShake=shake;var api=function(F){const t=createKeccak(F),Z=createShake(F);return function(at,Hs){switch(typeof at=="string"?at.toLowerCase():at){case"keccak224":return new t(1152,448,null,224,Hs);case"keccak256":return new t(1088,512,null,256,Hs);case"keccak384":return new t(832,768,null,384,Hs);case"keccak512":return new t(576,1024,null,512,Hs);case"sha3-224":return new t(1152,448,6,224,Hs);case"sha3-256":return new t(1088,512,6,256,Hs);case"sha3-384":return new t(832,768,6,384,Hs);case"sha3-512":return new t(576,1024,6,512,Hs);case"shake128":return new Z(1344,256,31,Hs);case"shake256":return new Z(1088,512,31,Hs);default:throw new Error("Invald algorithm: "+at)}}},keccakStateUnroll={};const P1600_ROUND_CONSTANTS=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];keccakStateUnroll.p1600=function(F){for(let t=0;t<24;++t){const Z=F[0]^F[10]^F[20]^F[30]^F[40],at=F[1]^F[11]^F[21]^F[31]^F[41],Hs=F[2]^F[12]^F[22]^F[32]^F[42],zs=F[3]^F[13]^F[23]^F[33]^F[43],Ys=F[4]^F[14]^F[24]^F[34]^F[44],Zs=F[5]^F[15]^F[25]^F[35]^F[45],$u=F[6]^F[16]^F[26]^F[36]^F[46],Eu=F[7]^F[17]^F[27]^F[37]^F[47],Au=F[8]^F[18]^F[28]^F[38]^F[48],vu=F[9]^F[19]^F[29]^F[39]^F[49];let Iu=Au^(Hs<<1|zs>>>31),_u=vu^(zs<<1|Hs>>>31);const Su=F[0]^Iu,Bu=F[1]^_u,Du=F[10]^Iu,Tu=F[11]^_u,Pu=F[20]^Iu,Uu=F[21]^_u,Fu=F[30]^Iu,Lu=F[31]^_u,qu=F[40]^Iu,zu=F[41]^_u;Iu=Z^(Ys<<1|Zs>>>31),_u=at^(Zs<<1|Ys>>>31);const tl=F[2]^Iu,Wu=F[3]^_u,cl=F[12]^Iu,wl=F[13]^_u,hl=F[22]^Iu,Qu=F[23]^_u,rl=F[32]^Iu,Hu=F[33]^_u,ju=F[42]^Iu,Yu=F[43]^_u;Iu=Hs^($u<<1|Eu>>>31),_u=zs^(Eu<<1|$u>>>31);const ul=F[4]^Iu,Xu=F[5]^_u,al=F[14]^Iu,pl=F[15]^_u,ml=F[24]^Iu,Il=F[25]^_u,dl=F[34]^Iu,vl=F[35]^_u,nl=F[44]^Iu,el=F[45]^_u;Iu=Ys^(Au<<1|vu>>>31),_u=Zs^(vu<<1|Au>>>31);const yl=F[6]^Iu,bl=F[7]^_u,Mu=F[16]^Iu,Ru=F[17]^_u,Ou=F[26]^Iu,Vu=F[27]^_u,Gu=F[36]^Iu,il=F[37]^_u,ol=F[46]^Iu,Ju=F[47]^_u;Iu=$u^(Z<<1|at>>>31),_u=Eu^(at<<1|Z>>>31);const ll=F[8]^Iu,Ku=F[9]^_u,Zu=F[18]^Iu,fl=F[19]^_u,$l=F[28]^Iu,Al=F[29]^_u,_l=F[38]^Iu,Cl=F[39]^_u,Bl=F[48]^Iu,Nu=F[49]^_u,Cu=Su,xu=Bu,ku=Tu<<4|Du>>>28,sl=Du<<4|Tu>>>28,gl=Pu<<3|Uu>>>29,El=Uu<<3|Pu>>>29,xl=Lu<<9|Fu>>>23,Rl=Fu<<9|Lu>>>23,Tl=qu<<18|zu>>>14,Sl=zu<<18|qu>>>14,Dl=tl<<1|Wu>>>31,Nl=Wu<<1|tl>>>31,Ol=wl<<12|cl>>>20,Pl=cl<<12|wl>>>20,Ul=hl<<10|Qu>>>22,Ml=Qu<<10|hl>>>22,Fl=Hu<<13|rl>>>19,Ll=rl<<13|Hu>>>19,kl=ju<<2|Yu>>>30,ql=Yu<<2|ju>>>30,jl=Xu<<30|ul>>>2,Hl=ul<<30|Xu>>>2,Vl=al<<6|pl>>>26,Gl=pl<<6|al>>>26,zl=Il<<11|ml>>>21,Kl=ml<<11|Il>>>21,Ql=dl<<15|vl>>>17,Wl=vl<<15|dl>>>17,Yl=el<<29|nl>>>3,Jl=nl<<29|el>>>3,Xl=yl<<28|bl>>>4,Zl=bl<<28|yl>>>4,eh=Ru<<23|Mu>>>9,th=Mu<<23|Ru>>>9,rh=Ou<<25|Vu>>>7,nh=Vu<<25|Ou>>>7,ih=Gu<<21|il>>>11,sh=il<<21|Gu>>>11,oh=Ju<<24|ol>>>8,ah=ol<<24|Ju>>>8,ch=ll<<27|Ku>>>5,uh=Ku<<27|ll>>>5,lh=Zu<<20|fl>>>12,fh=fl<<20|Zu>>>12,hh=Al<<7|$l>>>25,dh=$l<<7|Al>>>25,ph=_l<<8|Cl>>>24,gh=Cl<<8|_l>>>24,yh=Bl<<14|Nu>>>18,mh=Nu<<14|Bl>>>18;F[0]=Cu^~Ol&zl,F[1]=xu^~Pl&Kl,F[10]=Xl^~lh&gl,F[11]=Zl^~fh&El,F[20]=Dl^~Vl&rh,F[21]=Nl^~Gl&nh,F[30]=ch^~ku&Ul,F[31]=uh^~sl&Ml,F[40]=jl^~eh&hh,F[41]=Hl^~th&dh,F[2]=Ol^~zl&ih,F[3]=Pl^~Kl&sh,F[12]=lh^~gl&Fl,F[13]=fh^~El&Ll,F[22]=Vl^~rh&ph,F[23]=Gl^~nh&gh,F[32]=ku^~Ul&Ql,F[33]=sl^~Ml&Wl,F[42]=eh^~hh&xl,F[43]=th^~dh&Rl,F[4]=zl^~ih&yh,F[5]=Kl^~sh&mh,F[14]=gl^~Fl&Yl,F[15]=El^~Ll&Jl,F[24]=rh^~ph&Tl,F[25]=nh^~gh&Sl,F[34]=Ul^~Ql&oh,F[35]=Ml^~Wl&ah,F[44]=hh^~xl&kl,F[45]=dh^~Rl&ql,F[6]=ih^~yh&Cu,F[7]=sh^~mh&xu,F[16]=Fl^~Yl&Xl,F[17]=Ll^~Jl&Zl,F[26]=ph^~Tl&Dl,F[27]=gh^~Sl&Nl,F[36]=Ql^~oh&ch,F[37]=Wl^~ah&uh,F[46]=xl^~kl&jl,F[47]=Rl^~ql&Hl,F[8]=yh^~Cu&Ol,F[9]=mh^~xu&Pl,F[18]=Yl^~Xl&lh,F[19]=Jl^~Zl&fh,F[28]=Tl^~Dl&Vl,F[29]=Sl^~Nl&Gl,F[38]=oh^~ch&ku,F[39]=ah^~uh&sl,F[48]=kl^~jl&eh,F[49]=ql^~Hl&th,F[0]^=P1600_ROUND_CONSTANTS[t*2],F[1]^=P1600_ROUND_CONSTANTS[t*2+1]}};const keccakState=keccakStateUnroll;function Keccak$1(){this.state=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.blockSize=null,this.count=0,this.squeezing=!1}Keccak$1.prototype.initialize=function(F,t){for(let Z=0;Z<50;++Z)this.state[Z]=0;this.blockSize=F/8,this.count=0,this.squeezing=!1};Keccak$1.prototype.absorb=function(F){for(let t=0;t<F.length;++t)this.state[~~(this.count/4)]^=F[t]<<8*(this.count%4),this.count+=1,this.count===this.blockSize&&(keccakState.p1600(this.state),this.count=0)};Keccak$1.prototype.absorbLastFewBits=function(F){this.state[~~(this.count/4)]^=F<<8*(this.count%4),F&128&&this.count===this.blockSize-1&&keccakState.p1600(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<8*((this.blockSize-1)%4),keccakState.p1600(this.state),this.count=0,this.squeezing=!0};Keccak$1.prototype.squeeze=function(F){this.squeezing||this.absorbLastFewBits(1);const t=Buffer.alloc(F);for(let Z=0;Z<F;++Z)t[Z]=this.state[~~(this.count/4)]>>>8*(this.count%4)&255,this.count+=1,this.count===this.blockSize&&(keccakState.p1600(this.state),this.count=0);return t};Keccak$1.prototype.copy=function(F){for(let t=0;t<50;++t)F.state[t]=this.state[t];F.blockSize=this.blockSize,F.count=this.count,F.squeezing=this.squeezing};var keccak=Keccak$1,js$2=api(keccak),__createBinding$3=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(F,t,Z,at){at===void 0&&(at=Z),Object.defineProperty(F,at,{enumerable:!0,get:function(){return t[Z]}})}:function(F,t,Z,at){at===void 0&&(at=Z),F[at]=t[Z]}),__setModuleDefault$2=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(F,t){Object.defineProperty(F,"default",{enumerable:!0,value:t})}:function(F,t){F.default=t}),__importStar$3=commonjsGlobal&&commonjsGlobal.__importStar||function(F){if(F&&F.__esModule)return F;var t={};if(F!=null)for(var Z in F)Z!=="default"&&Object.prototype.hasOwnProperty.call(F,Z)&&__createBinding$3(t,F,Z);return __setModuleDefault$2(t,F),t},__importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(address,"__esModule",{value:!0});address.AddressComputer=address.Address=void 0;const bech32=__importStar$3(bech32$1),bignumber_js_1$2=__importDefault$3(bignumberExports),codec_1=codec,config_1=config$1,constants_1$5=constants$2,errors$4=__importStar$3(errors$5),createKeccakHash$2=js$2,PUBKEY_LENGTH=32,SMART_CONTRACT_HEX_PUBKEY_PREFIX="0".repeat(16);class Address{constructor(t,Z){if(!t){this.publicKey=Buffer.from([]),this.hrp=Z||config_1.LibraryConfig.DefaultAddressHrp;return}if(ArrayBuffer.isView(t)){if(t.length!=PUBKEY_LENGTH)throw new errors$4.ErrAddressCannotCreate(t);this.publicKey=Buffer.from(t),this.hrp=Z||config_1.LibraryConfig.DefaultAddressHrp;return}if(t instanceof Address){if(Z)throw new errors$4.ErrInvalidArgument("this variant of the Address constructor does not accept the 'hrp' argument");this.publicKey=t.publicKey,this.hrp=t.hrp;return}if(typeof t=="string"){if(Address.isValidHex(t)){this.publicKey=Buffer.from(t,"hex"),this.hrp=Z||config_1.LibraryConfig.DefaultAddressHrp;return}if(Z)throw new errors$4.ErrInvalidArgument("this variant of the Address constructor does not accept the 'hrp' argument");const{hrp:at,pubkey:Hs}=decodeFromBech32({value:t,allowCustomHrp:!1});this.publicKey=Hs,this.hrp=at;return}throw new errors$4.ErrAddressCannotCreate(t)}static newFromBech32(t){const{hrp:Z,pubkey:at}=decodeFromBech32({value:t,allowCustomHrp:!0});return new Address(at,Z)}static newFromHex(t,Z){if(!Address.isValidHex(t))throw new errors$4.ErrAddressCannotCreate(t);return new Address(Buffer.from(t,"hex"),Z)}toHex(){return this.isEmpty()?"":this.publicKey.toString("hex")}toBech32(){if(this.isEmpty())return"";let t=bech32.toWords(this.getPublicKey());return bech32.encode(this.hrp,t)}getPublicKey(){return this.publicKey}getHrp(){return this.hrp}static empty(){return new Address("")}static isValid(t){const Z=bech32.decodeUnsafe(t),at=Z==null?void 0:Z.prefix,Hs=Z?Buffer.from(bech32.fromWords(Z.words)):void 0;return!(at!==config_1.LibraryConfig.DefaultAddressHrp||(Hs==null?void 0:Hs.length)!==PUBKEY_LENGTH)}static isValidHex(t){return Buffer.from(t,"hex").length==PUBKEY_LENGTH}isEmpty(){return this.publicKey.length==0}equals(t){return t?this.publicKey.toString()==t.publicKey.toString():!1}toString(){return this.toBech32()}toJSON(){return{bech32:this.toBech32(),pubkey:this.toHex()}}static Zero(){return new Address("0".repeat(64))}isSmartContract(){return this.toHex().startsWith(SMART_CONTRACT_HEX_PUBKEY_PREFIX)}}address.Address=Address;class AddressComputer{constructor(t){this.numberOfShardsWithoutMeta=t||constants_1$5.CURRENT_NUMBER_OF_SHARDS_WITHOUT_META}computeContractAddress(t,Z){const at=Buffer.alloc(8,0),Hs=t.getPublicKey(),zs=Hs.slice(30),Ys=Buffer.alloc(8),Zs=new bignumber_js_1$2.default(Z.toString()),$u=codec_1.bigIntToBuffer(Zs);Ys.write($u.reverse().toString("hex"),"hex");const Eu=Buffer.concat([Hs,Ys]),Au=createKeccakHash$2("keccak256").update(Eu).digest(),vu=Buffer.from(constants_1$5.WasmVirtualMachine,"hex"),Iu=Buffer.concat([at,vu,Au.slice(10,30),zs]);return new Address(Iu)}getShardOfAddress(t){return this.getShardOfPubkey(t.getPublicKey(),this.numberOfShardsWithoutMeta)}getShardOfPubkey(t,Z){const at=parseInt("11",2),Hs=parseInt("01",2),zs=t[31];if(this.isPubkeyOfMetachain(t))return constants_1$5.METACHAIN_ID;let Ys=zs&at;return Ys>Z-1&&(Ys=zs&Hs),Ys}isPubkeyOfMetachain(t){const Z=Buffer.from([0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),at=Buffer.from(t).slice(0,Z.length);return!!(Z.equals(at)||Buffer.alloc(32).equals(Buffer.from(t)))}}address.AddressComputer=AddressComputer;function decodeFromBech32(F){const t=F.value,Z=F.allowCustomHrp;let at,Hs;try{const zs=bech32.decode(t);at=zs.prefix,Hs=Buffer.from(bech32.fromWords(zs.words))}catch(zs){throw new errors$4.ErrAddressCannotCreate(t,zs)}if(!Z&&at!=config_1.LibraryConfig.DefaultAddressHrp)throw new errors$4.ErrAddressBadHrp(config_1.LibraryConfig.DefaultAddressHrp,at);return{hrp:at,pubkey:Hs}}Object.defineProperty(message,"__esModule",{value:!0});message.MessageComputer=message.Message=void 0;const address_1$4=address,constants_1$4=constants$2,createKeccakHash$1=js$2;class Message{constructor(t){this.data=t.data,this.signature=t.signature,this.address=t.address,this.version=t.version||constants_1$4.DEFAULT_MESSAGE_VERSION,this.signer=t.signer||constants_1$4.SDK_JS_SIGNER}}message.Message=Message;class MessageComputer{constructor(){}computeBytesForSigning(t){const Z=Buffer.from(t.data.length.toString()),at=Buffer.concat([Z,t.data]);let Hs=Buffer.concat([Buffer.from(constants_1$4.MESSAGE_PREFIX),at]);return createKeccakHash$1("keccak256").update(Hs).digest()}computeBytesForVerifying(t){return this.computeBytesForSigning(t)}packMessage(t){return{message:Buffer.from(t.data).toString("hex"),signature:t.signature?Buffer.from(t.signature).toString("hex"):"",address:t.address?t.address.toBech32():"",version:t.version,signer:t.signer}}unpackMessage(t){const Z=this.trimHexPrefix(t.message),at=Buffer.from(Z,"hex"),Hs=this.trimHexPrefix(t.signature||""),zs=Buffer.from(Hs,"hex");let Ys;t.address&&(Ys=address_1$4.Address.newFromBech32(t.address));const Zs=t.version||constants_1$4.DEFAULT_MESSAGE_VERSION,$u=t.signer||constants_1$4.UNKNOWN_SIGNER;return new Message({data:at,signature:zs,address:Ys,version:Zs,signer:$u})}trimHexPrefix(t){return t.startsWith("0x")||t.startsWith("0X")?t.slice(2):t}}message.MessageComputer=MessageComputer;var cjs$3={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(F,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Z,at){Z.__proto__=at}||function(Z,at){for(var Hs in at)at.hasOwnProperty(Hs)&&(Z[Hs]=at[Hs])},extendStatics(F,t)};function __extends(F,t){extendStatics(F,t);function Z(){this.constructor=F}F.prototype=t===null?Object.create(t):(Z.prototype=t.prototype,new Z)}var __assign=function(){return __assign=Object.assign||function(t){for(var Z,at=1,Hs=arguments.length;at<Hs;at++){Z=arguments[at];for(var zs in Z)Object.prototype.hasOwnProperty.call(Z,zs)&&(t[zs]=Z[zs])}return t},__assign.apply(this,arguments)};function __rest(F,t){var Z={};for(var at in F)Object.prototype.hasOwnProperty.call(F,at)&&t.indexOf(at)<0&&(Z[at]=F[at]);if(F!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Hs=0,at=Object.getOwnPropertySymbols(F);Hs<at.length;Hs++)t.indexOf(at[Hs])<0&&Object.prototype.propertyIsEnumerable.call(F,at[Hs])&&(Z[at[Hs]]=F[at[Hs]]);return Z}function __decorate(F,t,Z,at){var Hs=arguments.length,zs=Hs<3?t:at===null?at=Object.getOwnPropertyDescriptor(t,Z):at,Ys;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")zs=Reflect.decorate(F,t,Z,at);else for(var Zs=F.length-1;Zs>=0;Zs--)(Ys=F[Zs])&&(zs=(Hs<3?Ys(zs):Hs>3?Ys(t,Z,zs):Ys(t,Z))||zs);return Hs>3&&zs&&Object.defineProperty(t,Z,zs),zs}function __param(F,t){return function(Z,at){t(Z,at,F)}}function __metadata(F,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(F,t)}function __awaiter$2(F,t,Z,at){function Hs(zs){return zs instanceof Z?zs:new Z(function(Ys){Ys(zs)})}return new(Z||(Z=Promise))(function(zs,Ys){function Zs(Au){try{Eu(at.next(Au))}catch(vu){Ys(vu)}}function $u(Au){try{Eu(at.throw(Au))}catch(vu){Ys(vu)}}function Eu(Au){Au.done?zs(Au.value):Hs(Au.value).then(Zs,$u)}Eu((at=at.apply(F,t||[])).next())})}function __generator(F,t){var Z={label:0,sent:function(){if(zs[0]&1)throw zs[1];return zs[1]},trys:[],ops:[]},at,Hs,zs,Ys;return Ys={next:Zs(0),throw:Zs(1),return:Zs(2)},typeof Symbol=="function"&&(Ys[Symbol.iterator]=function(){return this}),Ys;function Zs(Eu){return function(Au){return $u([Eu,Au])}}function $u(Eu){if(at)throw new TypeError("Generator is already executing.");for(;Z;)try{if(at=1,Hs&&(zs=Eu[0]&2?Hs.return:Eu[0]?Hs.throw||((zs=Hs.return)&&zs.call(Hs),0):Hs.next)&&!(zs=zs.call(Hs,Eu[1])).done)return zs;switch(Hs=0,zs&&(Eu=[Eu[0]&2,zs.value]),Eu[0]){case 0:case 1:zs=Eu;break;case 4:return Z.label++,{value:Eu[1],done:!1};case 5:Z.label++,Hs=Eu[1],Eu=[0];continue;case 7:Eu=Z.ops.pop(),Z.trys.pop();continue;default:if(zs=Z.trys,!(zs=zs.length>0&&zs[zs.length-1])&&(Eu[0]===6||Eu[0]===2)){Z=0;continue}if(Eu[0]===3&&(!zs||Eu[1]>zs[0]&&Eu[1]<zs[3])){Z.label=Eu[1];break}if(Eu[0]===6&&Z.label<zs[1]){Z.label=zs[1],zs=Eu;break}if(zs&&Z.label<zs[2]){Z.label=zs[2],Z.ops.push(Eu);break}zs[2]&&Z.ops.pop(),Z.trys.pop();continue}Eu=t.call(F,Z)}catch(Au){Eu=[6,Au],Hs=0}finally{at=zs=0}if(Eu[0]&5)throw Eu[1];return{value:Eu[0]?Eu[1]:void 0,done:!0}}}function __createBinding$2(F,t,Z,at){at===void 0&&(at=Z),F[at]=t[Z]}function __exportStar(F,t){for(var Z in F)Z!=="default"&&!t.hasOwnProperty(Z)&&(t[Z]=F[Z])}function __values(F){var t=typeof Symbol=="function"&&Symbol.iterator,Z=t&&F[t],at=0;if(Z)return Z.call(F);if(F&&typeof F.length=="number")return{next:function(){return F&&at>=F.length&&(F=void 0),{value:F&&F[at++],done:!F}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(F,t){var Z=typeof Symbol=="function"&&F[Symbol.iterator];if(!Z)return F;var at=Z.call(F),Hs,zs=[],Ys;try{for(;(t===void 0||t-- >0)&&!(Hs=at.next()).done;)zs.push(Hs.value)}catch(Zs){Ys={error:Zs}}finally{try{Hs&&!Hs.done&&(Z=at.return)&&Z.call(at)}finally{if(Ys)throw Ys.error}}return zs}function __spread(){for(var F=[],t=0;t<arguments.length;t++)F=F.concat(__read(arguments[t]));return F}function __spreadArrays(){for(var F=0,t=0,Z=arguments.length;t<Z;t++)F+=arguments[t].length;for(var at=Array(F),Hs=0,t=0;t<Z;t++)for(var zs=arguments[t],Ys=0,Zs=zs.length;Ys<Zs;Ys++,Hs++)at[Hs]=zs[Ys];return at}function __await(F){return this instanceof __await?(this.v=F,this):new __await(F)}function __asyncGenerator(F,t,Z){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var at=Z.apply(F,t||[]),Hs,zs=[];return Hs={},Ys("next"),Ys("throw"),Ys("return"),Hs[Symbol.asyncIterator]=function(){return this},Hs;function Ys(Iu){at[Iu]&&(Hs[Iu]=function(_u){return new Promise(function(Su,Bu){zs.push([Iu,_u,Su,Bu])>1||Zs(Iu,_u)})})}function Zs(Iu,_u){try{$u(at[Iu](_u))}catch(Su){vu(zs[0][3],Su)}}function $u(Iu){Iu.value instanceof __await?Promise.resolve(Iu.value.v).then(Eu,Au):vu(zs[0][2],Iu)}function Eu(Iu){Zs("next",Iu)}function Au(Iu){Zs("throw",Iu)}function vu(Iu,_u){Iu(_u),zs.shift(),zs.length&&Zs(zs[0][0],zs[0][1])}}function __asyncDelegator(F){var t,Z;return t={},at("next"),at("throw",function(Hs){throw Hs}),at("return"),t[Symbol.iterator]=function(){return this},t;function at(Hs,zs){t[Hs]=F[Hs]?function(Ys){return(Z=!Z)?{value:__await(F[Hs](Ys)),done:Hs==="return"}:zs?zs(Ys):Ys}:zs}}function __asyncValues(F){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=F[Symbol.asyncIterator],Z;return t?t.call(F):(F=typeof __values=="function"?__values(F):F[Symbol.iterator](),Z={},at("next"),at("throw"),at("return"),Z[Symbol.asyncIterator]=function(){return this},Z);function at(zs){Z[zs]=F[zs]&&function(Ys){return new Promise(function(Zs,$u){Ys=F[zs](Ys),Hs(Zs,$u,Ys.done,Ys.value)})}}function Hs(zs,Ys,Zs,$u){Promise.resolve($u).then(function(Eu){zs({value:Eu,done:Zs})},Ys)}}function __makeTemplateObject(F,t){return Object.defineProperty?Object.defineProperty(F,"raw",{value:t}):F.raw=t,F}function __importStar$2(F){if(F&&F.__esModule)return F;var t={};if(F!=null)for(var Z in F)Object.hasOwnProperty.call(F,Z)&&(t[Z]=F[Z]);return t.default=F,t}function __importDefault$2(F){return F&&F.__esModule?F:{default:F}}function __classPrivateFieldGet(F,t){if(!t.has(F))throw new TypeError("attempted to get private field on non-instance");return t.get(F)}function __classPrivateFieldSet(F,t,Z){if(!t.has(F))throw new TypeError("attempted to set private field on non-instance");return t.set(F,Z),Z}const tslib_es6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return __assign},__asyncDelegator,__asyncGenerator,__asyncValues,__await,__awaiter:__awaiter$2,__classPrivateFieldGet,__classPrivateFieldSet,__createBinding:__createBinding$2,__decorate,__exportStar,__extends,__generator,__importDefault:__importDefault$2,__importStar:__importStar$2,__makeTemplateObject,__metadata,__param,__read,__rest,__spread,__spreadArrays,__values},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(tslib_es6);var utils$1={},delay={},hasRequiredDelay;function requireDelay(){if(hasRequiredDelay)return delay;hasRequiredDelay=1,Object.defineProperty(delay,"__esModule",{value:!0}),delay.delay=void 0;function F(t){return new Promise(Z=>{setTimeout(()=>{Z(!0)},t)})}return delay.delay=F,delay}var convert={},constants$1={},misc={},hasRequiredMisc;function requireMisc(){return hasRequiredMisc||(hasRequiredMisc=1,Object.defineProperty(misc,"__esModule",{value:!0}),misc.ONE_THOUSAND=misc.ONE_HUNDRED=void 0,misc.ONE_HUNDRED=100,misc.ONE_THOUSAND=1e3),misc}var time={},hasRequiredTime;function requireTime(){return hasRequiredTime||(hasRequiredTime=1,function(F){Object.defineProperty(F,"__esModule",{value:!0}),F.ONE_YEAR=F.FOUR_WEEKS=F.THREE_WEEKS=F.TWO_WEEKS=F.ONE_WEEK=F.THIRTY_DAYS=F.SEVEN_DAYS=F.FIVE_DAYS=F.THREE_DAYS=F.ONE_DAY=F.TWENTY_FOUR_HOURS=F.TWELVE_HOURS=F.SIX_HOURS=F.THREE_HOURS=F.ONE_HOUR=F.SIXTY_MINUTES=F.THIRTY_MINUTES=F.TEN_MINUTES=F.FIVE_MINUTES=F.ONE_MINUTE=F.SIXTY_SECONDS=F.THIRTY_SECONDS=F.TEN_SECONDS=F.FIVE_SECONDS=F.ONE_SECOND=void 0,F.ONE_SECOND=1,F.FIVE_SECONDS=5,F.TEN_SECONDS=10,F.THIRTY_SECONDS=30,F.SIXTY_SECONDS=60,F.ONE_MINUTE=F.SIXTY_SECONDS,F.FIVE_MINUTES=F.ONE_MINUTE*5,F.TEN_MINUTES=F.ONE_MINUTE*10,F.THIRTY_MINUTES=F.ONE_MINUTE*30,F.SIXTY_MINUTES=F.ONE_MINUTE*60,F.ONE_HOUR=F.SIXTY_MINUTES,F.THREE_HOURS=F.ONE_HOUR*3,F.SIX_HOURS=F.ONE_HOUR*6,F.TWELVE_HOURS=F.ONE_HOUR*12,F.TWENTY_FOUR_HOURS=F.ONE_HOUR*24,F.ONE_DAY=F.TWENTY_FOUR_HOURS,F.THREE_DAYS=F.ONE_DAY*3,F.FIVE_DAYS=F.ONE_DAY*5,F.SEVEN_DAYS=F.ONE_DAY*7,F.THIRTY_DAYS=F.ONE_DAY*30,F.ONE_WEEK=F.SEVEN_DAYS,F.TWO_WEEKS=F.ONE_WEEK*2,F.THREE_WEEKS=F.ONE_WEEK*3,F.FOUR_WEEKS=F.ONE_WEEK*4,F.ONE_YEAR=F.ONE_DAY*365}(time)),time}var hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,function(F){Object.defineProperty(F,"__esModule",{value:!0});const t=require$$0;t.__exportStar(requireMisc(),F),t.__exportStar(requireTime(),F)}(constants$1)),constants$1}var hasRequiredConvert;function requireConvert(){if(hasRequiredConvert)return convert;hasRequiredConvert=1,Object.defineProperty(convert,"__esModule",{value:!0}),convert.fromMiliseconds=convert.toMiliseconds=void 0;const F=requireConstants();function t(at){return at*F.ONE_THOUSAND}convert.toMiliseconds=t;function Z(at){return Math.floor(at/F.ONE_THOUSAND)}return convert.fromMiliseconds=Z,convert}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,function(F){Object.defineProperty(F,"__esModule",{value:!0});const t=require$$0;t.__exportStar(requireDelay(),F),t.__exportStar(requireConvert(),F)}(utils$1)),utils$1}var watch$2={},hasRequiredWatch$1;function requireWatch$1(){if(hasRequiredWatch$1)return watch$2;hasRequiredWatch$1=1,Object.defineProperty(watch$2,"__esModule",{value:!0}),watch$2.Watch=void 0;class F{constructor(){this.timestamps=new Map}start(Z){if(this.timestamps.has(Z))throw new Error(`Watch already started for label: ${Z}`);this.timestamps.set(Z,{started:Date.now()})}stop(Z){const at=this.get(Z);if(typeof at.elapsed<"u")throw new Error(`Watch already stopped for label: ${Z}`);const Hs=Date.now()-at.started;this.timestamps.set(Z,{started:at.started,elapsed:Hs})}get(Z){const at=this.timestamps.get(Z);if(typeof at>"u")throw new Error(`No timestamp found for label: ${Z}`);return at}elapsed(Z){const at=this.get(Z);return at.elapsed||Date.now()-at.started}}return watch$2.Watch=F,watch$2.default=F,watch$2}var types={},watch$1={},hasRequiredWatch;function requireWatch(){if(hasRequiredWatch)return watch$1;hasRequiredWatch=1,Object.defineProperty(watch$1,"__esModule",{value:!0}),watch$1.IWatch=void 0;class F{}return watch$1.IWatch=F,watch$1}var hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,function(F){Object.defineProperty(F,"__esModule",{value:!0}),require$$0.__exportStar(requireWatch(),F)}(types)),types}(function(F){Object.defineProperty(F,"__esModule",{value:!0});const t=require$$0;t.__exportStar(requireUtils(),F),t.__exportStar(requireWatch$1(),F),t.__exportStar(requireTypes(),F),t.__exportStar(requireConstants(),F)})(cjs$3);class IEvents{}let n$1=class extends IEvents{constructor(t){super()}};const s$1=cjs$3.FIVE_SECONDS,r$1={pulse:"heartbeat_pulse"};let i$2=class bh extends n$1{constructor(t){super(t),this.events=new eventsExports.EventEmitter,this.interval=s$1,this.interval=(t==null?void 0:t.interval)||s$1}static async init(t){const Z=new bh(t);return await Z.init(),Z}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(t,Z){this.events.on(t,Z)}once(t,Z){this.events.once(t,Z)}off(t,Z){this.events.off(t,Z)}removeListener(t,Z){this.events.removeListener(t,Z)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),cjs$3.toMiliseconds(this.interval))}pulse(){this.events.emit(r$1.pulse)}};const suspectProtoRx=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,suspectConstructorRx=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,JsonSigRx=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jsonParseTransform(F,t){if(F==="__proto__"||F==="constructor"&&t&&typeof t=="object"&&"prototype"in t){warnKeyDropped(F);return}return t}function warnKeyDropped(F){console.warn(`[destr] Dropping "${F}" key to prevent prototype pollution.`)}function destr(F,t={}){if(typeof F!="string")return F;if(F[0]==='"'&&F[F.length-1]==='"'&&F.indexOf("\\")===-1)return F.slice(1,-1);const Z=F.trim();if(Z.length<=9)switch(Z.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!JsonSigRx.test(F)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return F}try{if(suspectProtoRx.test(F)||suspectConstructorRx.test(F)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(F,jsonParseTransform)}return JSON.parse(F)}catch(at){if(t.strict)throw at;return F}}function wrapToPromise(F){return!F||typeof F.then!="function"?Promise.resolve(F):F}function asyncCall(F,...t){try{return wrapToPromise(F(...t))}catch(Z){return Promise.reject(Z)}}function isPrimitive(F){const t=typeof F;return F===null||t!=="object"&&t!=="function"}function isPureObject(F){const t=Object.getPrototypeOf(F);return!t||t.isPrototypeOf(Object)}function stringify$1(F){if(isPrimitive(F))return String(F);if(isPureObject(F)||Array.isArray(F))return JSON.stringify(F);if(typeof F.toJSON=="function")return stringify$1(F.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const BASE64_PREFIX="base64:";function serializeRaw(F){return typeof F=="string"?F:BASE64_PREFIX+base64Encode(F)}function deserializeRaw(F){return typeof F!="string"||!F.startsWith(BASE64_PREFIX)?F:base64Decode(F.slice(BASE64_PREFIX.length))}function base64Decode(F){return globalThis.Buffer?Buffer.from(F,"base64"):Uint8Array.from(globalThis.atob(F),t=>t.codePointAt(0))}function base64Encode(F){return globalThis.Buffer?Buffer.from(F).toString("base64"):globalThis.btoa(String.fromCodePoint(...F))}function normalizeKey(F){var t;return F&&((t=F.split("?")[0])==null?void 0:t.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function joinKeys(...F){return normalizeKey(F.join(":"))}function normalizeBaseKey(F){return F=normalizeKey(F),F?F+":":""}function filterKeyByDepth(F,t){if(t===void 0)return!0;let Z=0,at=F.indexOf(":");for(;at>-1;)Z++,at=F.indexOf(":",at+1);return Z<=t}function filterKeyByBase(F,t){return t?F.startsWith(t)&&F[F.length-1]!=="$":F[F.length-1]!=="$"}function defineDriver(F){return F}const DRIVER_NAME="memory",memory=()=>{const F=new Map;return{name:DRIVER_NAME,getInstance:()=>F,hasItem(t){return F.has(t)},getItem(t){return F.get(t)??null},getItemRaw(t){return F.get(t)??null},setItem(t,Z){F.set(t,Z)},setItemRaw(t,Z){F.set(t,Z)},removeItem(t){F.delete(t)},getKeys(){return[...F.keys()]},clear(){F.clear()},dispose(){F.clear()}}};function createStorage(F={}){const t={mounts:{"":F.driver||memory()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},Z=Eu=>{for(const Au of t.mountpoints)if(Eu.startsWith(Au))return{base:Au,relativeKey:Eu.slice(Au.length),driver:t.mounts[Au]};return{base:"",relativeKey:Eu,driver:t.mounts[""]}},at=(Eu,Au)=>t.mountpoints.filter(vu=>vu.startsWith(Eu)||Au&&Eu.startsWith(vu)).map(vu=>({relativeBase:Eu.length>vu.length?Eu.slice(vu.length):void 0,mountpoint:vu,driver:t.mounts[vu]})),Hs=(Eu,Au)=>{if(t.watching){Au=normalizeKey(Au);for(const vu of t.watchListeners)vu(Eu,Au)}},zs=async()=>{if(!t.watching){t.watching=!0;for(const Eu in t.mounts)t.unwatch[Eu]=await watch(t.mounts[Eu],Hs,Eu)}},Ys=async()=>{if(t.watching){for(const Eu in t.unwatch)await t.unwatch[Eu]();t.unwatch={},t.watching=!1}},Zs=(Eu,Au,vu)=>{const Iu=new Map,_u=Su=>{let Bu=Iu.get(Su.base);return Bu||(Bu={driver:Su.driver,base:Su.base,items:[]},Iu.set(Su.base,Bu)),Bu};for(const Su of Eu){const Bu=typeof Su=="string",Du=normalizeKey(Bu?Su:Su.key),Tu=Bu?void 0:Su.value,Pu=Bu||!Su.options?Au:{...Au,...Su.options},Uu=Z(Du);_u(Uu).items.push({key:Du,value:Tu,relativeKey:Uu.relativeKey,options:Pu})}return Promise.all([...Iu.values()].map(Su=>vu(Su))).then(Su=>Su.flat())},$u={hasItem(Eu,Au={}){Eu=normalizeKey(Eu);const{relativeKey:vu,driver:Iu}=Z(Eu);return asyncCall(Iu.hasItem,vu,Au)},getItem(Eu,Au={}){Eu=normalizeKey(Eu);const{relativeKey:vu,driver:Iu}=Z(Eu);return asyncCall(Iu.getItem,vu,Au).then(_u=>destr(_u))},getItems(Eu,Au={}){return Zs(Eu,Au,vu=>vu.driver.getItems?asyncCall(vu.driver.getItems,vu.items.map(Iu=>({key:Iu.relativeKey,options:Iu.options})),Au).then(Iu=>Iu.map(_u=>({key:joinKeys(vu.base,_u.key),value:destr(_u.value)}))):Promise.all(vu.items.map(Iu=>asyncCall(vu.driver.getItem,Iu.relativeKey,Iu.options).then(_u=>({key:Iu.key,value:destr(_u)})))))},getItemRaw(Eu,Au={}){Eu=normalizeKey(Eu);const{relativeKey:vu,driver:Iu}=Z(Eu);return Iu.getItemRaw?asyncCall(Iu.getItemRaw,vu,Au):asyncCall(Iu.getItem,vu,Au).then(_u=>deserializeRaw(_u))},async setItem(Eu,Au,vu={}){if(Au===void 0)return $u.removeItem(Eu);Eu=normalizeKey(Eu);const{relativeKey:Iu,driver:_u}=Z(Eu);_u.setItem&&(await asyncCall(_u.setItem,Iu,stringify$1(Au),vu),_u.watch||Hs("update",Eu))},async setItems(Eu,Au){await Zs(Eu,Au,async vu=>{if(vu.driver.setItems)return asyncCall(vu.driver.setItems,vu.items.map(Iu=>({key:Iu.relativeKey,value:stringify$1(Iu.value),options:Iu.options})),Au);vu.driver.setItem&&await Promise.all(vu.items.map(Iu=>asyncCall(vu.driver.setItem,Iu.relativeKey,stringify$1(Iu.value),Iu.options)))})},async setItemRaw(Eu,Au,vu={}){if(Au===void 0)return $u.removeItem(Eu,vu);Eu=normalizeKey(Eu);const{relativeKey:Iu,driver:_u}=Z(Eu);if(_u.setItemRaw)await asyncCall(_u.setItemRaw,Iu,Au,vu);else if(_u.setItem)await asyncCall(_u.setItem,Iu,serializeRaw(Au),vu);else return;_u.watch||Hs("update",Eu)},async removeItem(Eu,Au={}){typeof Au=="boolean"&&(Au={removeMeta:Au}),Eu=normalizeKey(Eu);const{relativeKey:vu,driver:Iu}=Z(Eu);Iu.removeItem&&(await asyncCall(Iu.removeItem,vu,Au),(Au.removeMeta||Au.removeMata)&&await asyncCall(Iu.removeItem,vu+"$",Au),Iu.watch||Hs("remove",Eu))},async getMeta(Eu,Au={}){typeof Au=="boolean"&&(Au={nativeOnly:Au}),Eu=normalizeKey(Eu);const{relativeKey:vu,driver:Iu}=Z(Eu),_u=Object.create(null);if(Iu.getMeta&&Object.assign(_u,await asyncCall(Iu.getMeta,vu,Au)),!Au.nativeOnly){const Su=await asyncCall(Iu.getItem,vu+"$",Au).then(Bu=>destr(Bu));Su&&typeof Su=="object"&&(typeof Su.atime=="string"&&(Su.atime=new Date(Su.atime)),typeof Su.mtime=="string"&&(Su.mtime=new Date(Su.mtime)),Object.assign(_u,Su))}return _u},setMeta(Eu,Au,vu={}){return this.setItem(Eu+"$",Au,vu)},removeMeta(Eu,Au={}){return this.removeItem(Eu+"$",Au)},async getKeys(Eu,Au={}){var Du;Eu=normalizeBaseKey(Eu);const vu=at(Eu,!0);let Iu=[];const _u=[];let Su=!0;for(const Tu of vu){(Du=Tu.driver.flags)!=null&&Du.maxDepth||(Su=!1);const Pu=await asyncCall(Tu.driver.getKeys,Tu.relativeBase,Au);for(const Uu of Pu){const Fu=Tu.mountpoint+normalizeKey(Uu);Iu.some(Lu=>Fu.startsWith(Lu))||_u.push(Fu)}Iu=[Tu.mountpoint,...Iu.filter(Uu=>!Uu.startsWith(Tu.mountpoint))]}const Bu=Au.maxDepth!==void 0&&!Su;return _u.filter(Tu=>(!Bu||filterKeyByDepth(Tu,Au.maxDepth))&&filterKeyByBase(Tu,Eu))},async clear(Eu,Au={}){Eu=normalizeBaseKey(Eu),await Promise.all(at(Eu,!1).map(async vu=>{if(vu.driver.clear)return asyncCall(vu.driver.clear,vu.relativeBase,Au);if(vu.driver.removeItem){const Iu=await vu.driver.getKeys(vu.relativeBase||"",Au);return Promise.all(Iu.map(_u=>vu.driver.removeItem(_u,Au)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(Eu=>dispose(Eu)))},async watch(Eu){return await zs(),t.watchListeners.push(Eu),async()=>{t.watchListeners=t.watchListeners.filter(Au=>Au!==Eu),t.watchListeners.length===0&&await Ys()}},async unwatch(){t.watchListeners=[],await Ys()},mount(Eu,Au){if(Eu=normalizeBaseKey(Eu),Eu&&t.mounts[Eu])throw new Error(`already mounted at ${Eu}`);return Eu&&(t.mountpoints.push(Eu),t.mountpoints.sort((vu,Iu)=>Iu.length-vu.length)),t.mounts[Eu]=Au,t.watching&&Promise.resolve(watch(Au,Hs,Eu)).then(vu=>{t.unwatch[Eu]=vu}).catch(console.error),$u},async unmount(Eu,Au=!0){var vu,Iu;Eu=normalizeBaseKey(Eu),!(!Eu||!t.mounts[Eu])&&(t.watching&&Eu in t.unwatch&&((Iu=(vu=t.unwatch)[Eu])==null||Iu.call(vu),delete t.unwatch[Eu]),Au&&await dispose(t.mounts[Eu]),t.mountpoints=t.mountpoints.filter(_u=>_u!==Eu),delete t.mounts[Eu])},getMount(Eu=""){Eu=normalizeKey(Eu)+":";const Au=Z(Eu);return{driver:Au.driver,base:Au.base}},getMounts(Eu="",Au={}){return Eu=normalizeKey(Eu),at(Eu,Au.parents).map(Iu=>({driver:Iu.driver,base:Iu.mountpoint}))},keys:(Eu,Au={})=>$u.getKeys(Eu,Au),get:(Eu,Au={})=>$u.getItem(Eu,Au),set:(Eu,Au,vu={})=>$u.setItem(Eu,Au,vu),has:(Eu,Au={})=>$u.hasItem(Eu,Au),del:(Eu,Au={})=>$u.removeItem(Eu,Au),remove:(Eu,Au={})=>$u.removeItem(Eu,Au)};return $u}function watch(F,t,Z){return F.watch?F.watch((at,Hs)=>t(at,Z+Hs)):()=>{}}async function dispose(F){typeof F.dispose=="function"&&await asyncCall(F.dispose)}function promisifyRequest(F){return new Promise((t,Z)=>{F.oncomplete=F.onsuccess=()=>t(F.result),F.onabort=F.onerror=()=>Z(F.error)})}function createStore(F,t){let Z;const at=()=>{if(Z)return Z;const Hs=indexedDB.open(F);return Hs.onupgradeneeded=()=>Hs.result.createObjectStore(t),Z=promisifyRequest(Hs),Z.then(zs=>{zs.onclose=()=>Z=void 0},()=>{}),Z};return(Hs,zs)=>at().then(Ys=>zs(Ys.transaction(t,Hs).objectStore(t)))}let defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=createStore("keyval-store","keyval")),defaultGetStoreFunc}function get(F,t=defaultGetStore()){return t("readonly",Z=>promisifyRequest(Z.get(F)))}function set$1(F,t,Z=defaultGetStore()){return Z("readwrite",at=>(at.put(t,F),promisifyRequest(at.transaction)))}function del(F,t=defaultGetStore()){return t("readwrite",Z=>(Z.delete(F),promisifyRequest(Z.transaction)))}function clear(F=defaultGetStore()){return F("readwrite",t=>(t.clear(),promisifyRequest(t.transaction)))}function eachCursor(F,t){return F.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},promisifyRequest(F.transaction)}function keys(F=defaultGetStore()){return F("readonly",t=>{if(t.getAllKeys)return promisifyRequest(t.getAllKeys());const Z=[];return eachCursor(t,at=>Z.push(at.key)).then(()=>Z)})}const JSONStringify=F=>JSON.stringify(F,(t,Z)=>typeof Z=="bigint"?Z.toString()+"n":Z),JSONParse=F=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,Z=F.replace(t,'$1"$2n"$3');return JSON.parse(Z,(at,Hs)=>typeof Hs=="string"&&Hs.match(/^\d+n$/)?BigInt(Hs.substring(0,Hs.length-1)):Hs)};function safeJsonParse(F){if(typeof F!="string")throw new Error(`Cannot safe json parse value of type ${typeof F}`);try{return JSONParse(F)}catch{return F}}function safeJsonStringify(F){return typeof F=="string"?F:JSONStringify(F)||""}const x$3="idb-keyval";var z$3=(F={})=>{const t=F.base&&F.base.length>0?`${F.base}:`:"",Z=Hs=>t+Hs;let at;return F.dbName&&F.storeName&&(at=createStore(F.dbName,F.storeName)),{name:x$3,options:F,async hasItem(Hs){return!(typeof await get(Z(Hs),at)>"u")},async getItem(Hs){return await get(Z(Hs),at)??null},setItem(Hs,zs){return set$1(Z(Hs),zs,at)},removeItem(Hs){return del(Z(Hs),at)},getKeys(){return keys(at)},clear(){return clear(at)}}};const D$1="WALLET_CONNECT_V2_INDEXED_DB",E$1="keyvaluestorage";let _$1=class{constructor(){this.indexedDb=createStorage({driver:z$3({dbName:D$1,storeName:E$1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const Z=await this.indexedDb.getItem(t);if(Z!==null)return Z}async setItem(t,Z){await this.indexedDb.setItem(t,safeJsonStringify(Z))}async removeItem(t){await this.indexedDb.removeItem(t)}};var l$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},c$3={exports:{}};(function(){let F;function t(){}F=t,F.prototype.getItem=function(Z){return this.hasOwnProperty(Z)?String(this[Z]):null},F.prototype.setItem=function(Z,at){this[Z]=String(at)},F.prototype.removeItem=function(Z){delete this[Z]},F.prototype.clear=function(){const Z=this;Object.keys(Z).forEach(function(at){Z[at]=void 0,delete Z[at]})},F.prototype.key=function(Z){return Z=Z||0,Object.keys(this)[Z]},F.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof l$1<"u"&&l$1.localStorage?c$3.exports=l$1.localStorage:typeof window<"u"&&window.localStorage?c$3.exports=window.localStorage:c$3.exports=new t})();function k$3(F){var t;return[F[0],safeJsonParse((t=F[1])!=null?t:"")]}let K$3=class{constructor(){this.localStorage=c$3.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(k$3)}async getItem(t){const Z=this.localStorage.getItem(t);if(Z!==null)return safeJsonParse(Z)}async setItem(t,Z){this.localStorage.setItem(t,safeJsonStringify(Z))}async removeItem(t){this.localStorage.removeItem(t)}};const N$3="wc_storage_version",y$2=1,O$3=async(F,t,Z)=>{const at=N$3,Hs=await t.getItem(at);if(Hs&&Hs>=y$2){Z(t);return}const zs=await F.getKeys();if(!zs.length){Z(t);return}const Ys=[];for(;zs.length;){const Zs=zs.shift();if(!Zs)continue;const $u=Zs.toLowerCase();if($u.includes("wc@")||$u.includes("walletconnect")||$u.includes("wc_")||$u.includes("wallet_connect")){const Eu=await F.getItem(Zs);await t.setItem(Zs,Eu),Ys.push(Zs)}}await t.setItem(at,y$2),Z(t),j$3(F,Ys)},j$3=async(F,t)=>{t.length&&t.forEach(async Z=>{await F.removeItem(Z)})};let h$3=class{constructor(){this.initialized=!1,this.setInitialized=Z=>{this.storage=Z,this.initialized=!0};const t=new K$3;this.storage=t;try{const Z=new _$1;O$3(t,Z,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,Z){return await this.initialize(),this.storage.setItem(t,Z)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const Z=setInterval(()=>{this.initialized&&(clearInterval(Z),t())},20)})}};var browser={exports:{}};function tryStringify(F){try{return JSON.stringify(F)}catch{return'"[Circular]"'}}var quickFormatUnescaped=format$1;function format$1(F,t,Z){var at=Z&&Z.stringify||tryStringify,Hs=1;if(typeof F=="object"&&F!==null){var zs=t.length+Hs;if(zs===1)return F;var Ys=new Array(zs);Ys[0]=at(F);for(var Zs=1;Zs<zs;Zs++)Ys[Zs]=at(t[Zs]);return Ys.join(" ")}if(typeof F!="string")return F;var $u=t.length;if($u===0)return F;for(var Eu="",Au=1-Hs,vu=-1,Iu=F&&F.length||0,_u=0;_u<Iu;){if(F.charCodeAt(_u)===37&&_u+1<Iu){switch(vu=vu>-1?vu:0,F.charCodeAt(_u+1)){case 100:case 102:if(Au>=$u||t[Au]==null)break;vu<_u&&(Eu+=F.slice(vu,_u)),Eu+=Number(t[Au]),vu=_u+2,_u++;break;case 105:if(Au>=$u||t[Au]==null)break;vu<_u&&(Eu+=F.slice(vu,_u)),Eu+=Math.floor(Number(t[Au])),vu=_u+2,_u++;break;case 79:case 111:case 106:if(Au>=$u||t[Au]===void 0)break;vu<_u&&(Eu+=F.slice(vu,_u));var Su=typeof t[Au];if(Su==="string"){Eu+="'"+t[Au]+"'",vu=_u+2,_u++;break}if(Su==="function"){Eu+=t[Au].name||"<anonymous>",vu=_u+2,_u++;break}Eu+=at(t[Au]),vu=_u+2,_u++;break;case 115:if(Au>=$u)break;vu<_u&&(Eu+=F.slice(vu,_u)),Eu+=String(t[Au]),vu=_u+2,_u++;break;case 37:vu<_u&&(Eu+=F.slice(vu,_u)),Eu+="%",vu=_u+2,_u++,Au--;break}++Au}++_u}return vu===-1?F:(vu<Iu&&(Eu+=F.slice(vu)),Eu)}const format=quickFormatUnescaped;browser.exports=pino;const _console=pfGlobalThisOrFallback().console||{},stdSerializers={mapHttpRequest:mock,mapHttpResponse:mock,wrapRequestSerializer:passthrough,wrapResponseSerializer:passthrough,wrapErrorSerializer:passthrough,req:mock,res:mock,err:asErrValue,errWithCause:asErrValue};function levelToValue(F,t){return F==="silent"?1/0:t.levels.values[F]}const baseLogFunctionSymbol=Symbol("pino.logFuncs"),hierarchySymbol=Symbol("pino.hierarchy"),logFallbackMap={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function appendChildLogger(F,t){const Z={logger:t,parent:F[hierarchySymbol]};t[hierarchySymbol]=Z}function setupBaseLogFunctions(F,t,Z){const at={};t.forEach(Hs=>{at[Hs]=Z[Hs]?Z[Hs]:_console[Hs]||_console[logFallbackMap[Hs]||"log"]||noop$1}),F[baseLogFunctionSymbol]=at}function shouldSerialize(F,t){return Array.isArray(F)?F.filter(function(at){return at!=="!stdSerializers.err"}):F===!0?Object.keys(t):!1}function pino(F){F=F||{},F.browser=F.browser||{};const t=F.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const Z=F.browser.write||_console;F.browser.write&&(F.browser.asObject=!0);const at=F.serializers||{},Hs=shouldSerialize(F.browser.serialize,at);let zs=F.browser.serialize;Array.isArray(F.browser.serialize)&&F.browser.serialize.indexOf("!stdSerializers.err")>-1&&(zs=!1);const Ys=Object.keys(F.customLevels||{}),Zs=["error","fatal","warn","info","debug","trace"].concat(Ys);typeof Z=="function"&&Zs.forEach(function(Bu){Z[Bu]=Z}),(F.enabled===!1||F.browser.disabled)&&(F.level="silent");const $u=F.level||"info",Eu=Object.create(Z);Eu.log||(Eu.log=noop$1),setupBaseLogFunctions(Eu,Zs,Z),appendChildLogger({},Eu),Object.defineProperty(Eu,"levelVal",{get:vu}),Object.defineProperty(Eu,"level",{get:Iu,set:_u});const Au={transmit:t,serialize:Hs,asObject:F.browser.asObject,asObjectBindingsOnly:F.browser.asObjectBindingsOnly,formatters:F.browser.formatters,levels:Zs,timestamp:getTimeFunction(F),messageKey:F.messageKey||"msg",onChild:F.onChild||noop$1};Eu.levels=getLevels(F),Eu.level=$u,Eu.isLevelEnabled=function(Bu){return this.levels.values[Bu]?this.levels.values[Bu]>=this.levels.values[this.level]:!1},Eu.setMaxListeners=Eu.getMaxListeners=Eu.emit=Eu.addListener=Eu.on=Eu.prependListener=Eu.once=Eu.prependOnceListener=Eu.removeListener=Eu.removeAllListeners=Eu.listeners=Eu.listenerCount=Eu.eventNames=Eu.write=Eu.flush=noop$1,Eu.serializers=at,Eu._serialize=Hs,Eu._stdErrSerialize=zs,Eu.child=function(...Bu){return Su.call(this,Au,...Bu)},t&&(Eu._logEvent=createLogEventShape());function vu(){return levelToValue(this.level,this)}function Iu(){return this._level}function _u(Bu){if(Bu!=="silent"&&!this.levels.values[Bu])throw Error("unknown level "+Bu);this._level=Bu,set(this,Au,Eu,"error"),set(this,Au,Eu,"fatal"),set(this,Au,Eu,"warn"),set(this,Au,Eu,"info"),set(this,Au,Eu,"debug"),set(this,Au,Eu,"trace"),Ys.forEach(Du=>{set(this,Au,Eu,Du)})}function Su(Bu,Du,Tu){if(!Du)throw new Error("missing bindings for child Pino");Tu=Tu||{},Hs&&Du.serializers&&(Tu.serializers=Du.serializers);const Pu=Tu.serializers;if(Hs&&Pu){var Uu=Object.assign({},at,Pu),Fu=F.browser.serialize===!0?Object.keys(Uu):Hs;delete Du.serializers,applySerializers([Du],Fu,Uu,this._stdErrSerialize)}function Lu(zu){this._childLevel=(zu._childLevel|0)+1,this.bindings=Du,Uu&&(this.serializers=Uu,this._serialize=Fu),t&&(this._logEvent=createLogEventShape([].concat(zu._logEvent.bindings,Du)))}Lu.prototype=this;const qu=new Lu(this);return appendChildLogger(this,qu),qu.child=function(...zu){return Su.call(this,Bu,...zu)},qu.level=Tu.level||this.level,Bu.onChild(qu),qu}return Eu}function getLevels(F){const t=F.customLevels||{},Z=Object.assign({},pino.levels.values,t),at=Object.assign({},pino.levels.labels,invertObject(t));return{values:Z,labels:at}}function invertObject(F){const t={};return Object.keys(F).forEach(function(Z){t[F[Z]]=Z}),t}pino.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};pino.stdSerializers=stdSerializers;pino.stdTimeFunctions=Object.assign({},{nullTime,epochTime,unixTime,isoTime});function getBindingChain(F){const t=[];F.bindings&&t.push(F.bindings);let Z=F[hierarchySymbol];for(;Z.parent;)Z=Z.parent,Z.logger.bindings&&t.push(Z.logger.bindings);return t.reverse()}function set(F,t,Z,at){if(Object.defineProperty(F,at,{value:levelToValue(F.level,Z)>levelToValue(at,Z)?noop$1:Z[baseLogFunctionSymbol][at],writable:!0,enumerable:!0,configurable:!0}),F[at]===noop$1){if(!t.transmit)return;const zs=t.transmit.level||F.level,Ys=levelToValue(zs,Z);if(levelToValue(at,Z)<Ys)return}F[at]=createWrap(F,t,Z,at);const Hs=getBindingChain(F);Hs.length!==0&&(F[at]=prependBindingsInArguments(Hs,F[at]))}function prependBindingsInArguments(F,t){return function(){return t.apply(this,[...F,...arguments])}}function createWrap(F,t,Z,at){return function(Hs){return function(){const Ys=t.timestamp(),Zs=new Array(arguments.length),$u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===_console?_console:this;for(var Eu=0;Eu<Zs.length;Eu++)Zs[Eu]=arguments[Eu];var Au=!1;if(t.serialize&&(applySerializers(Zs,this._serialize,this.serializers,this._stdErrSerialize),Au=!0),t.asObject||t.formatters?Hs.call($u,...asObject(this,at,Zs,Ys,t)):Hs.apply($u,Zs),t.transmit){const vu=t.transmit.level||F._level,Iu=levelToValue(vu,Z),_u=levelToValue(at,Z);if(_u<Iu)return;transmit(this,{ts:Ys,methodLevel:at,methodValue:_u,transmitLevel:vu,transmitValue:Z.levels.values[t.transmit.level||F._level],send:t.transmit.send,val:levelToValue(F._level,Z)},Zs,Au)}}}(F[baseLogFunctionSymbol][at])}function asObject(F,t,Z,at,Hs){const{level:zs,log:Ys=vu=>vu}=Hs.formatters||{},Zs=Z.slice();let $u=Zs[0];const Eu={};let Au=(F._childLevel|0)+1;if(Au<1&&(Au=1),at&&(Eu.time=at),zs){const vu=zs(t,F.levels.values[t]);Object.assign(Eu,vu)}else Eu.level=F.levels.values[t];if(Hs.asObjectBindingsOnly){if($u!==null&&typeof $u=="object")for(;Au--&&typeof Zs[0]=="object";)Object.assign(Eu,Zs.shift());return[Ys(Eu),...Zs]}else{if($u!==null&&typeof $u=="object"){for(;Au--&&typeof Zs[0]=="object";)Object.assign(Eu,Zs.shift());$u=Zs.length?format(Zs.shift(),Zs):void 0}else typeof $u=="string"&&($u=format(Zs.shift(),Zs));return $u!==void 0&&(Eu[Hs.messageKey]=$u),[Ys(Eu)]}}function applySerializers(F,t,Z,at){for(const Hs in F)if(at&&F[Hs]instanceof Error)F[Hs]=pino.stdSerializers.err(F[Hs]);else if(typeof F[Hs]=="object"&&!Array.isArray(F[Hs])&&t)for(const zs in F[Hs])t.indexOf(zs)>-1&&zs in Z&&(F[Hs][zs]=Z[zs](F[Hs][zs]))}function transmit(F,t,Z,at=!1){const Hs=t.send,zs=t.ts,Ys=t.methodLevel,Zs=t.methodValue,$u=t.val,Eu=F._logEvent.bindings;at||applySerializers(Z,F._serialize||Object.keys(F.serializers),F.serializers,F._stdErrSerialize===void 0?!0:F._stdErrSerialize),F._logEvent.ts=zs,F._logEvent.messages=Z.filter(function(Au){return Eu.indexOf(Au)===-1}),F._logEvent.level.label=Ys,F._logEvent.level.value=Zs,Hs(Ys,F._logEvent,$u),F._logEvent=createLogEventShape(Eu)}function createLogEventShape(F){return{ts:0,messages:[],bindings:F||[],level:{label:"",value:0}}}function asErrValue(F){const t={type:F.constructor.name,msg:F.message,stack:F.stack};for(const Z in F)t[Z]===void 0&&(t[Z]=F[Z]);return t}function getTimeFunction(F){return typeof F.timestamp=="function"?F.timestamp:F.timestamp===!1?nullTime:epochTime}function mock(){return{}}function passthrough(F){return F}function noop$1(){}function nullTime(){return!1}function epochTime(){return Date.now()}function unixTime(){return Math.round(Date.now()/1e3)}function isoTime(){return new Date(Date.now()).toISOString()}function pfGlobalThisOrFallback(){function F(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return F(self)||F(window)||F(this)||{}}}browser.exports.default=pino;browser.exports.pino=pino;var browserExports=browser.exports;const c$2=getDefaultExportFromCjs(browserExports),b$2={level:"info"},l="custom_context",i$1=1e3*1024;var C$2=Object.defineProperty,B=(F,t,Z)=>t in F?C$2(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,s=(F,t,Z)=>B(F,typeof t!="symbol"?t+"":t,Z);let S$2=class{constructor(t){s(this,"nodeValue"),s(this,"sizeInBytes"),s(this,"next"),this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},v$6=class{constructor(t){s(this,"lengthInNodes"),s(this,"sizeInBytes"),s(this,"head"),s(this,"tail"),s(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){const Z=new S$2(t);if(Z.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${Z.size}`);for(;this.size+Z.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=Z),this.tail=Z):(this.head=Z,this.tail=Z),this.lengthInNodes++,this.sizeInBytes+=Z.size}shift(){if(!this.head)return;const t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){const t=[];let Z=this.head;for(;Z!==null;)t.push(Z.value),Z=Z.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};const Z=t.value;return t=t.next,{done:!1,value:Z}}}}};var _=Object.defineProperty,x$2=(F,t,Z)=>t in F?_(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,a$1=(F,t,Z)=>x$2(F,typeof t!="symbol"?t+"":t,Z);class L{constructor(t,Z=i$1){a$1(this,"logs"),a$1(this,"level"),a$1(this,"levelValue"),a$1(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=t??"error",this.levelValue=browserExports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=Z,this.logs=new v$6(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,Z){Z===browserExports.levels.values.error?console.error(t):Z===browserExports.levels.values.warn?console.warn(t):Z===browserExports.levels.values.debug?console.debug(t):Z===browserExports.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(safeJsonStringify({timestamp:new Date().toISOString(),log:t}));const Z=typeof t=="string"?JSON.parse(t).level:t.level;Z>=this.levelValue&&this.forwardToConsole(t,Z)}getLogs(){return this.logs}clearLogs(){this.logs=new v$6(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){const Z=this.getLogArray();return Z.push(safeJsonStringify({extraMetadata:t})),new Blob(Z,{type:"application/json"})}}var z$2=Object.defineProperty,T$1=(F,t,Z)=>t in F?z$2(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,k$2=(F,t,Z)=>T$1(F,typeof t!="symbol"?t+"":t,Z);class E{constructor(t,Z=i$1){k$2(this,"baseChunkLogger"),this.baseChunkLogger=new L(t,Z)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){const Z=URL.createObjectURL(this.logsToBlob(t)),at=document.createElement("a");at.href=Z,at.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(at),at.click(),document.body.removeChild(at),URL.revokeObjectURL(Z)}}var A$1=Object.defineProperty,$$1=(F,t,Z)=>t in F?A$1(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,N$2=(F,t,Z)=>$$1(F,typeof t!="symbol"?t+"":t,Z);let j$2=class{constructor(t,Z=i$1){N$2(this,"baseChunkLogger"),this.baseChunkLogger=new L(t,Z)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}};var P$4=Object.defineProperty,V$2=Object.defineProperties,G$2=Object.getOwnPropertyDescriptors,p$2=Object.getOwnPropertySymbols,M$3=Object.prototype.hasOwnProperty,U$1=Object.prototype.propertyIsEnumerable,f$4=(F,t,Z)=>t in F?P$4(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,g=(F,t)=>{for(var Z in t||(t={}))M$3.call(t,Z)&&f$4(F,Z,t[Z]);if(p$2)for(var Z of p$2(t))U$1.call(t,Z)&&f$4(F,Z,t[Z]);return F},h$2=(F,t)=>V$2(F,G$2(t));function D(F){return h$2(g({},F),{level:(F==null?void 0:F.level)||b$2.level})}function y$1(F,t,Z=l){return F[Z]=t,F}function w$1(F,t=l){return F[t]||""}function m$4(F,t,Z=l){const at=w$1(F,Z);return at.trim()?`${at}/${t}`:t}function X$2(F,t,Z=l){const at=m$4(F,t,Z),Hs=F.child({context:at});return y$1(Hs,at,Z)}function I$1(F){var t,Z;const at=new E((t=F.opts)==null?void 0:t.level,F.maxSizeInBytes);return{logger:c$2(h$2(g({},F.opts),{level:"trace",browser:h$2(g({},(Z=F.opts)==null?void 0:Z.browser),{write:Hs=>at.write(Hs)})})),chunkLoggerController:at}}function O$2(F){var t;const Z=new j$2((t=F.opts)==null?void 0:t.level,F.maxSizeInBytes);return{logger:c$2(h$2(g({},F.opts),{level:"trace"}),Z),chunkLoggerController:Z}}function Y$1(F){return typeof F.loggerOverride<"u"&&typeof F.loggerOverride!="string"?{logger:F.loggerOverride,chunkLoggerController:null}:typeof window<"u"?I$1(F):O$2(F)}var a=Object.defineProperty,u=(F,t,Z)=>t in F?a(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,c$1=(F,t,Z)=>u(F,typeof t!="symbol"?t+"":t,Z);let h$1=class extends IEvents{constructor(t){super(),this.opts=t,c$1(this,"protocol","wc"),c$1(this,"version",2)}};var p$1=Object.defineProperty,b$1=(F,t,Z)=>t in F?p$1(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,v$5=(F,t,Z)=>b$1(F,typeof t!="symbol"?t+"":t,Z);class I extends IEvents{constructor(t,Z){super(),this.core=t,this.logger=Z,v$5(this,"records",new Map)}}class y{constructor(t,Z){this.logger=t,this.core=Z}}let m$3=class extends IEvents{constructor(t,Z){super(),this.relayer=t,this.logger=Z}},d$2=class extends IEvents{constructor(t){super()}},f$3=class{constructor(t,Z,at,Hs){this.core=t,this.logger=Z,this.name=at}},P$3=class extends IEvents{constructor(t,Z){super(),this.relayer=t,this.logger=Z}},S$1=class extends IEvents{constructor(t,Z){super(),this.core=t,this.logger=Z}},M$2=class{constructor(t,Z,at){this.core=t,this.logger=Z,this.store=at}},O$1=class{constructor(t,Z){this.projectId=t,this.logger=Z}},R$2=class{constructor(t,Z,at){this.core=t,this.logger=Z,this.telemetryEnabled=at}};var T=Object.defineProperty,k$1=(F,t,Z)=>t in F?T(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,i=(F,t,Z)=>k$1(F,typeof t!="symbol"?t+"":t,Z);let J$3=class{constructor(t){this.opts=t,i(this,"protocol","wc"),i(this,"version",2)}},V$1=class{constructor(t){this.client=t}};function En$2(F){return F instanceof Uint8Array||ArrayBuffer.isView(F)&&F.constructor.name==="Uint8Array"}function fe$2(F,...t){if(!En$2(F))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(F.length))throw new Error("Uint8Array expected of length "+t+", got length="+F.length)}function De$3(F,t=!0){if(F.destroyed)throw new Error("Hash instance has been destroyed");if(t&&F.finished)throw new Error("Hash#digest() has already been called")}function gn$2(F,t){fe$2(F);const Z=t.outputLen;if(F.length<Z)throw new Error("digestInto() expects output buffer of length at least "+Z)}const it=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _t$2=F=>new DataView(F.buffer,F.byteOffset,F.byteLength);function yn$2(F){if(typeof F!="string")throw new Error("utf8ToBytes expected string, got "+typeof F);return new Uint8Array(new TextEncoder().encode(F))}function de$1(F){return typeof F=="string"&&(F=yn$2(F)),fe$2(F),F}let xn$2=class{clone(){return this._cloneInto()}};function Bn$2(F){const t=at=>F().update(de$1(at)).digest(),Z=F();return t.outputLen=Z.outputLen,t.blockLen=Z.blockLen,t.create=()=>F(),t}function he$2(F=32){if(it&&typeof it.getRandomValues=="function")return it.getRandomValues(new Uint8Array(F));if(it&&typeof it.randomBytes=="function")return it.randomBytes(F);throw new Error("crypto.getRandomValues must be defined")}function Cn$2(F,t,Z,at){if(typeof F.setBigUint64=="function")return F.setBigUint64(t,Z,at);const Hs=BigInt(32),zs=BigInt(4294967295),Ys=Number(Z>>Hs&zs),Zs=Number(Z&zs),$u=at?4:0,Eu=at?0:4;F.setUint32(t+$u,Ys,at),F.setUint32(t+Eu,Zs,at)}let An$2=class extends xn$2{constructor(t,Z,at,Hs){super(),this.blockLen=t,this.outputLen=Z,this.padOffset=at,this.isLE=Hs,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=_t$2(this.buffer)}update(t){De$3(this);const{view:Z,buffer:at,blockLen:Hs}=this;t=de$1(t);const zs=t.length;for(let Ys=0;Ys<zs;){const Zs=Math.min(Hs-this.pos,zs-Ys);if(Zs===Hs){const $u=_t$2(t);for(;Hs<=zs-Ys;Ys+=Hs)this.process($u,Ys);continue}at.set(t.subarray(Ys,Ys+Zs),this.pos),this.pos+=Zs,Ys+=Zs,this.pos===Hs&&(this.process(Z,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){De$3(this),gn$2(t,this),this.finished=!0;const{buffer:Z,view:at,blockLen:Hs,isLE:zs}=this;let{pos:Ys}=this;Z[Ys++]=128,this.buffer.subarray(Ys).fill(0),this.padOffset>Hs-Ys&&(this.process(at,0),Ys=0);for(let vu=Ys;vu<Hs;vu++)Z[vu]=0;Cn$2(at,Hs-8,BigInt(this.length*8),zs),this.process(at,0);const Zs=_t$2(t),$u=this.outputLen;if($u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const Eu=$u/4,Au=this.get();if(Eu>Au.length)throw new Error("_sha2: outputLen bigger than state");for(let vu=0;vu<Eu;vu++)Zs.setUint32(4*vu,Au[vu],zs)}digest(){const{buffer:t,outputLen:Z}=this;this.digestInto(t);const at=t.slice(0,Z);return this.destroy(),at}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:Z,buffer:at,length:Hs,finished:zs,destroyed:Ys,pos:Zs}=this;return t.length=Hs,t.pos=Zs,t.finished=zs,t.destroyed=Ys,Hs%Z&&t.buffer.set(at),t}};const wt$2=BigInt(2**32-1),St$3=BigInt(32);function le$1(F,t=!1){return t?{h:Number(F&wt$2),l:Number(F>>St$3&wt$2)}:{h:Number(F>>St$3&wt$2)|0,l:Number(F&wt$2)|0}}function mn$2(F,t=!1){let Z=new Uint32Array(F.length),at=new Uint32Array(F.length);for(let Hs=0;Hs<F.length;Hs++){const{h:zs,l:Ys}=le$1(F[Hs],t);[Z[Hs],at[Hs]]=[zs,Ys]}return[Z,at]}const _n$2=(F,t)=>BigInt(F>>>0)<<St$3|BigInt(t>>>0),Sn$2=(F,t,Z)=>F>>>Z,vn$2=(F,t,Z)=>F<<32-Z|t>>>Z,In$2=(F,t,Z)=>F>>>Z|t<<32-Z,Un$2=(F,t,Z)=>F<<32-Z|t>>>Z,Tn$2=(F,t,Z)=>F<<64-Z|t>>>Z-32,Fn$2=(F,t,Z)=>F>>>Z-32|t<<64-Z,Nn$2=(F,t)=>t,Ln$2=(F,t)=>F,On$2=(F,t,Z)=>F<<Z|t>>>32-Z,Hn$2=(F,t,Z)=>t<<Z|F>>>32-Z,zn$2=(F,t,Z)=>t<<Z-32|F>>>64-Z,Mn$2=(F,t,Z)=>F<<Z-32|t>>>64-Z;function qn$2(F,t,Z,at){const Hs=(t>>>0)+(at>>>0);return{h:F+Z+(Hs/2**32|0)|0,l:Hs|0}}const $n$2=(F,t,Z)=>(F>>>0)+(t>>>0)+(Z>>>0),kn$2=(F,t,Z,at)=>t+Z+at+(F/2**32|0)|0,Rn$2=(F,t,Z,at)=>(F>>>0)+(t>>>0)+(Z>>>0)+(at>>>0),jn$2=(F,t,Z,at,Hs)=>t+Z+at+Hs+(F/2**32|0)|0,Zn$2=(F,t,Z,at,Hs)=>(F>>>0)+(t>>>0)+(Z>>>0)+(at>>>0)+(Hs>>>0),Gn$2=(F,t,Z,at,Hs,zs)=>t+Z+at+Hs+zs+(F/2**32|0)|0,x$1={fromBig:le$1,split:mn$2,toBig:_n$2,shrSH:Sn$2,shrSL:vn$2,rotrSH:In$2,rotrSL:Un$2,rotrBH:Tn$2,rotrBL:Fn$2,rotr32H:Nn$2,rotr32L:Ln$2,rotlSH:On$2,rotlSL:Hn$2,rotlBH:zn$2,rotlBL:Mn$2,add:qn$2,add3L:$n$2,add3H:kn$2,add4L:Rn$2,add4H:jn$2,add5H:Gn$2,add5L:Zn$2},[Vn$2,Yn$2]=(()=>x$1.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(F=>BigInt(F))))(),P$2=new Uint32Array(80),Q$1=new Uint32Array(80);let Jn$2=class extends An$2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:Z,Bh:at,Bl:Hs,Ch:zs,Cl:Ys,Dh:Zs,Dl:$u,Eh:Eu,El:Au,Fh:vu,Fl:Iu,Gh:_u,Gl:Su,Hh:Bu,Hl:Du}=this;return[t,Z,at,Hs,zs,Ys,Zs,$u,Eu,Au,vu,Iu,_u,Su,Bu,Du]}set(t,Z,at,Hs,zs,Ys,Zs,$u,Eu,Au,vu,Iu,_u,Su,Bu,Du){this.Ah=t|0,this.Al=Z|0,this.Bh=at|0,this.Bl=Hs|0,this.Ch=zs|0,this.Cl=Ys|0,this.Dh=Zs|0,this.Dl=$u|0,this.Eh=Eu|0,this.El=Au|0,this.Fh=vu|0,this.Fl=Iu|0,this.Gh=_u|0,this.Gl=Su|0,this.Hh=Bu|0,this.Hl=Du|0}process(t,Z){for(let Uu=0;Uu<16;Uu++,Z+=4)P$2[Uu]=t.getUint32(Z),Q$1[Uu]=t.getUint32(Z+=4);for(let Uu=16;Uu<80;Uu++){const Fu=P$2[Uu-15]|0,Lu=Q$1[Uu-15]|0,qu=x$1.rotrSH(Fu,Lu,1)^x$1.rotrSH(Fu,Lu,8)^x$1.shrSH(Fu,Lu,7),zu=x$1.rotrSL(Fu,Lu,1)^x$1.rotrSL(Fu,Lu,8)^x$1.shrSL(Fu,Lu,7),tl=P$2[Uu-2]|0,Wu=Q$1[Uu-2]|0,cl=x$1.rotrSH(tl,Wu,19)^x$1.rotrBH(tl,Wu,61)^x$1.shrSH(tl,Wu,6),wl=x$1.rotrSL(tl,Wu,19)^x$1.rotrBL(tl,Wu,61)^x$1.shrSL(tl,Wu,6),hl=x$1.add4L(zu,wl,Q$1[Uu-7],Q$1[Uu-16]),Qu=x$1.add4H(hl,qu,cl,P$2[Uu-7],P$2[Uu-16]);P$2[Uu]=Qu|0,Q$1[Uu]=hl|0}let{Ah:at,Al:Hs,Bh:zs,Bl:Ys,Ch:Zs,Cl:$u,Dh:Eu,Dl:Au,Eh:vu,El:Iu,Fh:_u,Fl:Su,Gh:Bu,Gl:Du,Hh:Tu,Hl:Pu}=this;for(let Uu=0;Uu<80;Uu++){const Fu=x$1.rotrSH(vu,Iu,14)^x$1.rotrSH(vu,Iu,18)^x$1.rotrBH(vu,Iu,41),Lu=x$1.rotrSL(vu,Iu,14)^x$1.rotrSL(vu,Iu,18)^x$1.rotrBL(vu,Iu,41),qu=vu&_u^~vu&Bu,zu=Iu&Su^~Iu&Du,tl=x$1.add5L(Pu,Lu,zu,Yn$2[Uu],Q$1[Uu]),Wu=x$1.add5H(tl,Tu,Fu,qu,Vn$2[Uu],P$2[Uu]),cl=tl|0,wl=x$1.rotrSH(at,Hs,28)^x$1.rotrBH(at,Hs,34)^x$1.rotrBH(at,Hs,39),hl=x$1.rotrSL(at,Hs,28)^x$1.rotrBL(at,Hs,34)^x$1.rotrBL(at,Hs,39),Qu=at&zs^at&Zs^zs&Zs,rl=Hs&Ys^Hs&$u^Ys&$u;Tu=Bu|0,Pu=Du|0,Bu=_u|0,Du=Su|0,_u=vu|0,Su=Iu|0,{h:vu,l:Iu}=x$1.add(Eu|0,Au|0,Wu|0,cl|0),Eu=Zs|0,Au=$u|0,Zs=zs|0,$u=Ys|0,zs=at|0,Ys=Hs|0;const Hu=x$1.add3L(cl,hl,rl);at=x$1.add3H(Hu,Wu,wl,Qu),Hs=Hu|0}({h:at,l:Hs}=x$1.add(this.Ah|0,this.Al|0,at|0,Hs|0)),{h:zs,l:Ys}=x$1.add(this.Bh|0,this.Bl|0,zs|0,Ys|0),{h:Zs,l:$u}=x$1.add(this.Ch|0,this.Cl|0,Zs|0,$u|0),{h:Eu,l:Au}=x$1.add(this.Dh|0,this.Dl|0,Eu|0,Au|0),{h:vu,l:Iu}=x$1.add(this.Eh|0,this.El|0,vu|0,Iu|0),{h:_u,l:Su}=x$1.add(this.Fh|0,this.Fl|0,_u|0,Su|0),{h:Bu,l:Du}=x$1.add(this.Gh|0,this.Gl|0,Bu|0,Du|0),{h:Tu,l:Pu}=x$1.add(this.Hh|0,this.Hl|0,Tu|0,Pu|0),this.set(at,Hs,zs,Ys,Zs,$u,Eu,Au,vu,Iu,_u,Su,Bu,Du,Tu,Pu)}roundClean(){P$2.fill(0),Q$1.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const Kn$2=Bn$2(()=>new Jn$2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const vt$2=BigInt(0),be$2=BigInt(1),Wn$2=BigInt(2);function It$3(F){return F instanceof Uint8Array||ArrayBuffer.isView(F)&&F.constructor.name==="Uint8Array"}function Ut$2(F){if(!It$3(F))throw new Error("Uint8Array expected")}function Tt$2(F,t){if(typeof t!="boolean")throw new Error(F+" boolean expected, got "+t)}const Xn$2=Array.from({length:256},(F,t)=>t.toString(16).padStart(2,"0"));function Ft$2(F){Ut$2(F);let t="";for(let Z=0;Z<F.length;Z++)t+=Xn$2[F[Z]];return t}function pe$2(F){if(typeof F!="string")throw new Error("hex string expected, got "+typeof F);return F===""?vt$2:BigInt("0x"+F)}const K$2={_0:48,_9:57,A:65,F:70,a:97,f:102};function we$2(F){if(F>=K$2._0&&F<=K$2._9)return F-K$2._0;if(F>=K$2.A&&F<=K$2.F)return F-(K$2.A-10);if(F>=K$2.a&&F<=K$2.f)return F-(K$2.a-10)}function Ee$1(F){if(typeof F!="string")throw new Error("hex string expected, got "+typeof F);const t=F.length,Z=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const at=new Uint8Array(Z);for(let Hs=0,zs=0;Hs<Z;Hs++,zs+=2){const Ys=we$2(F.charCodeAt(zs)),Zs=we$2(F.charCodeAt(zs+1));if(Ys===void 0||Zs===void 0){const $u=F[zs]+F[zs+1];throw new Error('hex string expected, got non-hex character "'+$u+'" at index '+zs)}at[Hs]=Ys*16+Zs}return at}function Pn$2(F){return pe$2(Ft$2(F))}function Et$3(F){return Ut$2(F),pe$2(Ft$2(Uint8Array.from(F).reverse()))}function ge$2(F,t){return Ee$1(F.toString(16).padStart(t*2,"0"))}function Nt$2(F,t){return ge$2(F,t).reverse()}function W$3(F,t,Z){let at;if(typeof t=="string")try{at=Ee$1(t)}catch(zs){throw new Error(F+" must be hex string or Uint8Array, cause: "+zs)}else if(It$3(t))at=Uint8Array.from(t);else throw new Error(F+" must be hex string or Uint8Array");const Hs=at.length;if(typeof Z=="number"&&Hs!==Z)throw new Error(F+" of length "+Z+" expected, got "+Hs);return at}function ye$2(...F){let t=0;for(let at=0;at<F.length;at++){const Hs=F[at];Ut$2(Hs),t+=Hs.length}const Z=new Uint8Array(t);for(let at=0,Hs=0;at<F.length;at++){const zs=F[at];Z.set(zs,Hs),Hs+=zs.length}return Z}const Lt$2=F=>typeof F=="bigint"&&vt$2<=F;function Qn$1(F,t,Z){return Lt$2(F)&&Lt$2(t)&&Lt$2(Z)&&t<=F&&F<Z}function ft$2(F,t,Z,at){if(!Qn$1(t,Z,at))throw new Error("expected valid "+F+": "+Z+" <= n < "+at+", got "+t)}function tr(F){let t;for(t=0;F>vt$2;F>>=be$2,t+=1);return t}const er=F=>(Wn$2<<BigInt(F-1))-be$2,nr$1={bigint:F=>typeof F=="bigint",function:F=>typeof F=="function",boolean:F=>typeof F=="boolean",string:F=>typeof F=="string",stringOrUint8Array:F=>typeof F=="string"||It$3(F),isSafeInteger:F=>Number.isSafeInteger(F),array:F=>Array.isArray(F),field:(F,t)=>t.Fp.isValid(F),hash:F=>typeof F=="function"&&Number.isSafeInteger(F.outputLen)};function Ot$2(F,t,Z={}){const at=(Hs,zs,Ys)=>{const Zs=nr$1[zs];if(typeof Zs!="function")throw new Error("invalid validator function");const $u=F[Hs];if(!(Ys&&$u===void 0)&&!Zs($u,F))throw new Error("param "+String(Hs)+" is invalid. Expected "+zs+", got "+$u)};for(const[Hs,zs]of Object.entries(t))at(Hs,zs,!1);for(const[Hs,zs]of Object.entries(Z))at(Hs,zs,!0);return F}function xe$1(F){const t=new WeakMap;return(Z,...at)=>{const Hs=t.get(Z);if(Hs!==void 0)return Hs;const zs=F(Z,...at);return t.set(Z,zs),zs}}const M$1=BigInt(0),N$1=BigInt(1),nt$1=BigInt(2),rr$1=BigInt(3),Ht$2=BigInt(4),Be$2=BigInt(5),Ce$1=BigInt(8);function H(F,t){const Z=F%t;return Z>=M$1?Z:t+Z}function or$3(F,t,Z){if(t<M$1)throw new Error("invalid exponent, negatives unsupported");if(Z<=M$1)throw new Error("invalid modulus");if(Z===N$1)return M$1;let at=N$1;for(;t>M$1;)t&N$1&&(at=at*F%Z),F=F*F%Z,t>>=N$1;return at}function J$2(F,t,Z){let at=F;for(;t-- >M$1;)at*=at,at%=Z;return at}function Ae$1(F,t){if(F===M$1)throw new Error("invert: expected non-zero number");if(t<=M$1)throw new Error("invert: expected positive modulus, got "+t);let Z=H(F,t),at=t,Hs=M$1,zs=N$1;for(;Z!==M$1;){const Ys=at/Z,Zs=at%Z,$u=Hs-zs*Ys;at=Z,Z=Zs,Hs=zs,zs=$u}if(at!==N$1)throw new Error("invert: does not exist");return H(Hs,t)}function sr$1(F){const t=(F-N$1)/nt$1;let Z,at,Hs;for(Z=F-N$1,at=0;Z%nt$1===M$1;Z/=nt$1,at++);for(Hs=nt$1;Hs<F&&or$3(Hs,t,F)!==F-N$1;Hs++)if(Hs>1e3)throw new Error("Cannot find square root: likely non-prime P");if(at===1){const Ys=(F+N$1)/Ht$2;return function(Zs,$u){const Eu=Zs.pow($u,Ys);if(!Zs.eql(Zs.sqr(Eu),$u))throw new Error("Cannot find square root");return Eu}}const zs=(Z+N$1)/nt$1;return function(Ys,Zs){if(Ys.pow(Zs,t)===Ys.neg(Ys.ONE))throw new Error("Cannot find square root");let $u=at,Eu=Ys.pow(Ys.mul(Ys.ONE,Hs),Z),Au=Ys.pow(Zs,zs),vu=Ys.pow(Zs,Z);for(;!Ys.eql(vu,Ys.ONE);){if(Ys.eql(vu,Ys.ZERO))return Ys.ZERO;let Iu=1;for(let Su=Ys.sqr(vu);Iu<$u&&!Ys.eql(Su,Ys.ONE);Iu++)Su=Ys.sqr(Su);const _u=Ys.pow(Eu,N$1<<BigInt($u-Iu-1));Eu=Ys.sqr(_u),Au=Ys.mul(Au,_u),vu=Ys.mul(vu,Eu),$u=Iu}return Au}}function ir$2(F){if(F%Ht$2===rr$1){const t=(F+N$1)/Ht$2;return function(Z,at){const Hs=Z.pow(at,t);if(!Z.eql(Z.sqr(Hs),at))throw new Error("Cannot find square root");return Hs}}if(F%Ce$1===Be$2){const t=(F-Be$2)/Ce$1;return function(Z,at){const Hs=Z.mul(at,nt$1),zs=Z.pow(Hs,t),Ys=Z.mul(at,zs),Zs=Z.mul(Z.mul(Ys,nt$1),zs),$u=Z.mul(Ys,Z.sub(Zs,Z.ONE));if(!Z.eql(Z.sqr($u),at))throw new Error("Cannot find square root");return $u}}return sr$1(F)}const ur$2=(F,t)=>(H(F,t)&N$1)===N$1,cr$2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ar$2(F){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},Z=cr$2.reduce((at,Hs)=>(at[Hs]="function",at),t);return Ot$2(F,Z)}function fr$2(F,t,Z){if(Z<M$1)throw new Error("invalid exponent, negatives unsupported");if(Z===M$1)return F.ONE;if(Z===N$1)return t;let at=F.ONE,Hs=t;for(;Z>M$1;)Z&N$1&&(at=F.mul(at,Hs)),Hs=F.sqr(Hs),Z>>=N$1;return at}function Dr$2(F,t){const Z=new Array(t.length),at=t.reduce((zs,Ys,Zs)=>F.is0(Ys)?zs:(Z[Zs]=zs,F.mul(zs,Ys)),F.ONE),Hs=F.inv(at);return t.reduceRight((zs,Ys,Zs)=>F.is0(Ys)?zs:(Z[Zs]=F.mul(zs,Z[Zs]),F.mul(zs,Ys)),Hs),Z}function me$3(F,t){const Z=t!==void 0?t:F.toString(2).length,at=Math.ceil(Z/8);return{nBitLength:Z,nByteLength:at}}function _e$3(F,t,Z=!1,at={}){if(F<=M$1)throw new Error("invalid field: expected ORDER > 0, got "+F);const{nBitLength:Hs,nByteLength:zs}=me$3(F,t);if(zs>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let Ys;const Zs=Object.freeze({ORDER:F,isLE:Z,BITS:Hs,BYTES:zs,MASK:er(Hs),ZERO:M$1,ONE:N$1,create:$u=>H($u,F),isValid:$u=>{if(typeof $u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof $u);return M$1<=$u&&$u<F},is0:$u=>$u===M$1,isOdd:$u=>($u&N$1)===N$1,neg:$u=>H(-$u,F),eql:($u,Eu)=>$u===Eu,sqr:$u=>H($u*$u,F),add:($u,Eu)=>H($u+Eu,F),sub:($u,Eu)=>H($u-Eu,F),mul:($u,Eu)=>H($u*Eu,F),pow:($u,Eu)=>fr$2(Zs,$u,Eu),div:($u,Eu)=>H($u*Ae$1(Eu,F),F),sqrN:$u=>$u*$u,addN:($u,Eu)=>$u+Eu,subN:($u,Eu)=>$u-Eu,mulN:($u,Eu)=>$u*Eu,inv:$u=>Ae$1($u,F),sqrt:at.sqrt||($u=>(Ys||(Ys=ir$2(F)),Ys(Zs,$u))),invertBatch:$u=>Dr$2(Zs,$u),cmov:($u,Eu,Au)=>Au?Eu:$u,toBytes:$u=>Z?Nt$2($u,zs):ge$2($u,zs),fromBytes:$u=>{if($u.length!==zs)throw new Error("Field.fromBytes: expected "+zs+" bytes, got "+$u.length);return Z?Et$3($u):Pn$2($u)}});return Object.freeze(Zs)}const Se$2=BigInt(0),gt$2=BigInt(1);function zt$2(F,t){const Z=t.negate();return F?Z:t}function ve$2(F,t){if(!Number.isSafeInteger(F)||F<=0||F>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+F)}function Mt$2(F,t){ve$2(F,t);const Z=Math.ceil(t/F)+1,at=2**(F-1);return{windows:Z,windowSize:at}}function dr$2(F,t){if(!Array.isArray(F))throw new Error("array expected");F.forEach((Z,at)=>{if(!(Z instanceof t))throw new Error("invalid point at index "+at)})}function hr$2(F,t){if(!Array.isArray(F))throw new Error("array of scalars expected");F.forEach((Z,at)=>{if(!t.isValid(Z))throw new Error("invalid scalar at index "+at)})}const qt$2=new WeakMap,Ie$1=new WeakMap;function $t$2(F){return Ie$1.get(F)||1}function lr$2(F,t){return{constTimeNegate:zt$2,hasPrecomputes(Z){return $t$2(Z)!==1},unsafeLadder(Z,at,Hs=F.ZERO){let zs=Z;for(;at>Se$2;)at&gt$2&&(Hs=Hs.add(zs)),zs=zs.double(),at>>=gt$2;return Hs},precomputeWindow(Z,at){const{windows:Hs,windowSize:zs}=Mt$2(at,t),Ys=[];let Zs=Z,$u=Zs;for(let Eu=0;Eu<Hs;Eu++){$u=Zs,Ys.push($u);for(let Au=1;Au<zs;Au++)$u=$u.add(Zs),Ys.push($u);Zs=$u.double()}return Ys},wNAF(Z,at,Hs){const{windows:zs,windowSize:Ys}=Mt$2(Z,t);let Zs=F.ZERO,$u=F.BASE;const Eu=BigInt(2**Z-1),Au=2**Z,vu=BigInt(Z);for(let Iu=0;Iu<zs;Iu++){const _u=Iu*Ys;let Su=Number(Hs&Eu);Hs>>=vu,Su>Ys&&(Su-=Au,Hs+=gt$2);const Bu=_u,Du=_u+Math.abs(Su)-1,Tu=Iu%2!==0,Pu=Su<0;Su===0?$u=$u.add(zt$2(Tu,at[Bu])):Zs=Zs.add(zt$2(Pu,at[Du]))}return{p:Zs,f:$u}},wNAFUnsafe(Z,at,Hs,zs=F.ZERO){const{windows:Ys,windowSize:Zs}=Mt$2(Z,t),$u=BigInt(2**Z-1),Eu=2**Z,Au=BigInt(Z);for(let vu=0;vu<Ys;vu++){const Iu=vu*Zs;if(Hs===Se$2)break;let _u=Number(Hs&$u);if(Hs>>=Au,_u>Zs&&(_u-=Eu,Hs+=gt$2),_u===0)continue;let Su=at[Iu+Math.abs(_u)-1];_u<0&&(Su=Su.negate()),zs=zs.add(Su)}return zs},getPrecomputes(Z,at,Hs){let zs=qt$2.get(at);return zs||(zs=this.precomputeWindow(at,Z),Z!==1&&qt$2.set(at,Hs(zs))),zs},wNAFCached(Z,at,Hs){const zs=$t$2(Z);return this.wNAF(zs,this.getPrecomputes(zs,Z,Hs),at)},wNAFCachedUnsafe(Z,at,Hs,zs){const Ys=$t$2(Z);return Ys===1?this.unsafeLadder(Z,at,zs):this.wNAFUnsafe(Ys,this.getPrecomputes(Ys,Z,Hs),at,zs)},setWindowSize(Z,at){ve$2(at,t),Ie$1.set(Z,at),qt$2.delete(Z)}}}function br$2(F,t,Z,at){if(dr$2(Z,F),hr$2(at,t),Z.length!==at.length)throw new Error("arrays of points and scalars must have equal length");const Hs=F.ZERO,zs=tr(BigInt(Z.length)),Ys=zs>12?zs-3:zs>4?zs-2:zs?2:1,Zs=(1<<Ys)-1,$u=new Array(Zs+1).fill(Hs),Eu=Math.floor((t.BITS-1)/Ys)*Ys;let Au=Hs;for(let vu=Eu;vu>=0;vu-=Ys){$u.fill(Hs);for(let _u=0;_u<at.length;_u++){const Su=at[_u],Bu=Number(Su>>BigInt(vu)&BigInt(Zs));$u[Bu]=$u[Bu].add(Z[_u])}let Iu=Hs;for(let _u=$u.length-1,Su=Hs;_u>0;_u--)Su=Su.add($u[_u]),Iu=Iu.add(Su);if(Au=Au.add(Iu),vu!==0)for(let _u=0;_u<Ys;_u++)Au=Au.double()}return Au}function pr$2(F){return ar$2(F.Fp),Ot$2(F,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...me$3(F.n,F.nBitLength),...F,p:F.Fp.ORDER})}const G$1=BigInt(0),j$1=BigInt(1),yt$2=BigInt(2),wr$2=BigInt(8),Er$2={zip215:!0};function gr$2(F){const t=pr$2(F);return Ot$2(F,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function yr$2(F){const t=gr$2(F),{Fp:Z,n:at,prehash:Hs,hash:zs,randomBytes:Ys,nByteLength:Zs,h:$u}=t,Eu=yt$2<<BigInt(Zs*8)-j$1,Au=Z.create,vu=_e$3(t.n,t.nBitLength),Iu=t.uvRatio||((Hu,ju)=>{try{return{isValid:!0,value:Z.sqrt(Hu*Z.inv(ju))}}catch{return{isValid:!1,value:G$1}}}),_u=t.adjustScalarBytes||(Hu=>Hu),Su=t.domain||((Hu,ju,Yu)=>{if(Tt$2("phflag",Yu),ju.length||Yu)throw new Error("Contexts/pre-hash are not supported");return Hu});function Bu(Hu,ju){ft$2("coordinate "+Hu,ju,G$1,Eu)}function Du(Hu){if(!(Hu instanceof Uu))throw new Error("ExtendedPoint expected")}const Tu=xe$1((Hu,ju)=>{const{ex:Yu,ey:ul,ez:Xu}=Hu,al=Hu.is0();ju==null&&(ju=al?wr$2:Z.inv(Xu));const pl=Au(Yu*ju),ml=Au(ul*ju),Il=Au(Xu*ju);if(al)return{x:G$1,y:j$1};if(Il!==j$1)throw new Error("invZ was invalid");return{x:pl,y:ml}}),Pu=xe$1(Hu=>{const{a:ju,d:Yu}=t;if(Hu.is0())throw new Error("bad point: ZERO");const{ex:ul,ey:Xu,ez:al,et:pl}=Hu,ml=Au(ul*ul),Il=Au(Xu*Xu),dl=Au(al*al),vl=Au(dl*dl),nl=Au(ml*ju),el=Au(dl*Au(nl+Il)),yl=Au(vl+Au(Yu*Au(ml*Il)));if(el!==yl)throw new Error("bad point: equation left != right (1)");const bl=Au(ul*Xu),Mu=Au(al*pl);if(bl!==Mu)throw new Error("bad point: equation left != right (2)");return!0});class Uu{constructor(ju,Yu,ul,Xu){this.ex=ju,this.ey=Yu,this.ez=ul,this.et=Xu,Bu("x",ju),Bu("y",Yu),Bu("z",ul),Bu("t",Xu),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(ju){if(ju instanceof Uu)throw new Error("extended point not allowed");const{x:Yu,y:ul}=ju||{};return Bu("x",Yu),Bu("y",ul),new Uu(Yu,ul,j$1,Au(Yu*ul))}static normalizeZ(ju){const Yu=Z.invertBatch(ju.map(ul=>ul.ez));return ju.map((ul,Xu)=>ul.toAffine(Yu[Xu])).map(Uu.fromAffine)}static msm(ju,Yu){return br$2(Uu,vu,ju,Yu)}_setWindowSize(ju){qu.setWindowSize(this,ju)}assertValidity(){Pu(this)}equals(ju){Du(ju);const{ex:Yu,ey:ul,ez:Xu}=this,{ex:al,ey:pl,ez:ml}=ju,Il=Au(Yu*ml),dl=Au(al*Xu),vl=Au(ul*ml),nl=Au(pl*Xu);return Il===dl&&vl===nl}is0(){return this.equals(Uu.ZERO)}negate(){return new Uu(Au(-this.ex),this.ey,this.ez,Au(-this.et))}double(){const{a:ju}=t,{ex:Yu,ey:ul,ez:Xu}=this,al=Au(Yu*Yu),pl=Au(ul*ul),ml=Au(yt$2*Au(Xu*Xu)),Il=Au(ju*al),dl=Yu+ul,vl=Au(Au(dl*dl)-al-pl),nl=Il+pl,el=nl-ml,yl=Il-pl,bl=Au(vl*el),Mu=Au(nl*yl),Ru=Au(vl*yl),Ou=Au(el*nl);return new Uu(bl,Mu,Ou,Ru)}add(ju){Du(ju);const{a:Yu,d:ul}=t,{ex:Xu,ey:al,ez:pl,et:ml}=this,{ex:Il,ey:dl,ez:vl,et:nl}=ju;if(Yu===BigInt(-1)){const Ku=Au((al-Xu)*(dl+Il)),Zu=Au((al+Xu)*(dl-Il)),fl=Au(Zu-Ku);if(fl===G$1)return this.double();const $l=Au(pl*yt$2*nl),Al=Au(ml*yt$2*vl),_l=Al+$l,Cl=Zu+Ku,Bl=Al-$l,Nu=Au(_l*fl),Cu=Au(Cl*Bl),xu=Au(_l*Bl),ku=Au(fl*Cl);return new Uu(Nu,Cu,ku,xu)}const el=Au(Xu*Il),yl=Au(al*dl),bl=Au(ml*ul*nl),Mu=Au(pl*vl),Ru=Au((Xu+al)*(Il+dl)-el-yl),Ou=Mu-bl,Vu=Mu+bl,Gu=Au(yl-Yu*el),il=Au(Ru*Ou),ol=Au(Vu*Gu),Ju=Au(Ru*Gu),ll=Au(Ou*Vu);return new Uu(il,ol,ll,Ju)}subtract(ju){return this.add(ju.negate())}wNAF(ju){return qu.wNAFCached(this,ju,Uu.normalizeZ)}multiply(ju){const Yu=ju;ft$2("scalar",Yu,j$1,at);const{p:ul,f:Xu}=this.wNAF(Yu);return Uu.normalizeZ([ul,Xu])[0]}multiplyUnsafe(ju,Yu=Uu.ZERO){const ul=ju;return ft$2("scalar",ul,G$1,at),ul===G$1?Lu:this.is0()||ul===j$1?this:qu.wNAFCachedUnsafe(this,ul,Uu.normalizeZ,Yu)}isSmallOrder(){return this.multiplyUnsafe($u).is0()}isTorsionFree(){return qu.unsafeLadder(this,at).is0()}toAffine(ju){return Tu(this,ju)}clearCofactor(){const{h:ju}=t;return ju===j$1?this:this.multiplyUnsafe(ju)}static fromHex(ju,Yu=!1){const{d:ul,a:Xu}=t,al=Z.BYTES;ju=W$3("pointHex",ju,al),Tt$2("zip215",Yu);const pl=ju.slice(),ml=ju[al-1];pl[al-1]=ml&-129;const Il=Et$3(pl),dl=Yu?Eu:Z.ORDER;ft$2("pointHex.y",Il,G$1,dl);const vl=Au(Il*Il),nl=Au(vl-j$1),el=Au(ul*vl-Xu);let{isValid:yl,value:bl}=Iu(nl,el);if(!yl)throw new Error("Point.fromHex: invalid y coordinate");const Mu=(bl&j$1)===j$1,Ru=(ml&128)!==0;if(!Yu&&bl===G$1&&Ru)throw new Error("Point.fromHex: x=0 and x_0=1");return Ru!==Mu&&(bl=Au(-bl)),Uu.fromAffine({x:bl,y:Il})}static fromPrivateKey(ju){return Wu(ju).point}toRawBytes(){const{x:ju,y:Yu}=this.toAffine(),ul=Nt$2(Yu,Z.BYTES);return ul[ul.length-1]|=ju&j$1?128:0,ul}toHex(){return Ft$2(this.toRawBytes())}}Uu.BASE=new Uu(t.Gx,t.Gy,j$1,Au(t.Gx*t.Gy)),Uu.ZERO=new Uu(G$1,j$1,j$1,G$1);const{BASE:Fu,ZERO:Lu}=Uu,qu=lr$2(Uu,Zs*8);function zu(Hu){return H(Hu,at)}function tl(Hu){return zu(Et$3(Hu))}function Wu(Hu){const ju=Z.BYTES;Hu=W$3("private key",Hu,ju);const Yu=W$3("hashed private key",zs(Hu),2*ju),ul=_u(Yu.slice(0,ju)),Xu=Yu.slice(ju,2*ju),al=tl(ul),pl=Fu.multiply(al),ml=pl.toRawBytes();return{head:ul,prefix:Xu,scalar:al,point:pl,pointBytes:ml}}function cl(Hu){return Wu(Hu).pointBytes}function wl(Hu=new Uint8Array,...ju){const Yu=ye$2(...ju);return tl(zs(Su(Yu,W$3("context",Hu),!!Hs)))}function hl(Hu,ju,Yu={}){Hu=W$3("message",Hu),Hs&&(Hu=Hs(Hu));const{prefix:ul,scalar:Xu,pointBytes:al}=Wu(ju),pl=wl(Yu.context,ul,Hu),ml=Fu.multiply(pl).toRawBytes(),Il=wl(Yu.context,ml,al,Hu),dl=zu(pl+Il*Xu);ft$2("signature.s",dl,G$1,at);const vl=ye$2(ml,Nt$2(dl,Z.BYTES));return W$3("result",vl,Z.BYTES*2)}const Qu=Er$2;function rl(Hu,ju,Yu,ul=Qu){const{context:Xu,zip215:al}=ul,pl=Z.BYTES;Hu=W$3("signature",Hu,2*pl),ju=W$3("message",ju),Yu=W$3("publicKey",Yu,pl),al!==void 0&&Tt$2("zip215",al),Hs&&(ju=Hs(ju));const ml=Et$3(Hu.slice(pl,2*pl));let Il,dl,vl;try{Il=Uu.fromHex(Yu,al),dl=Uu.fromHex(Hu.slice(0,pl),al),vl=Fu.multiplyUnsafe(ml)}catch{return!1}if(!al&&Il.isSmallOrder())return!1;const nl=wl(Xu,dl.toRawBytes(),Il.toRawBytes(),ju);return dl.add(Il.multiplyUnsafe(nl)).subtract(vl).clearCofactor().equals(Uu.ZERO)}return Fu._setWindowSize(8),{CURVE:t,getPublicKey:cl,sign:hl,verify:rl,ExtendedPoint:Uu,utils:{getExtendedPublicKey:Wu,randomPrivateKey:()=>Ys(Z.BYTES),precompute(Hu=8,ju=Uu.BASE){return ju._setWindowSize(Hu),ju.multiply(BigInt(3)),ju}}}}BigInt(0),BigInt(1);const kt$2=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Ue$2=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const xr$2=BigInt(1),Te$1=BigInt(2);BigInt(3);const Br$2=BigInt(5),Cr$2=BigInt(8);function Ar$2(F){const t=BigInt(10),Z=BigInt(20),at=BigInt(40),Hs=BigInt(80),zs=kt$2,Ys=F*F%zs*F%zs,Zs=J$2(Ys,Te$1,zs)*Ys%zs,$u=J$2(Zs,xr$2,zs)*F%zs,Eu=J$2($u,Br$2,zs)*$u%zs,Au=J$2(Eu,t,zs)*Eu%zs,vu=J$2(Au,Z,zs)*Au%zs,Iu=J$2(vu,at,zs)*vu%zs,_u=J$2(Iu,Hs,zs)*Iu%zs,Su=J$2(_u,Hs,zs)*Iu%zs,Bu=J$2(Su,t,zs)*Eu%zs;return{pow_p_5_8:J$2(Bu,Te$1,zs)*F%zs,b2:Ys}}function mr$2(F){return F[0]&=248,F[31]&=127,F[31]|=64,F}function _r$2(F,t){const Z=kt$2,at=H(t*t*t,Z),Hs=H(at*at*t,Z),zs=Ar$2(F*Hs).pow_p_5_8;let Ys=H(F*at*zs,Z);const Zs=H(t*Ys*Ys,Z),$u=Ys,Eu=H(Ys*Ue$2,Z),Au=Zs===F,vu=Zs===H(-F,Z),Iu=Zs===H(-F*Ue$2,Z);return Au&&(Ys=$u),(vu||Iu)&&(Ys=Eu),ur$2(Ys,Z)&&(Ys=H(-Ys,Z)),{isValid:Au||vu,value:Ys}}const Sr$2=(()=>_e$3(kt$2,void 0,!0))(),vr$2=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Sr$2,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Cr$2,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Kn$2,randomBytes:he$2,adjustScalarBytes:mr$2,uvRatio:_r$2}))(),Rt$3=(()=>yr$2(vr$2))(),jt$2="EdDSA",Zt$2="JWT",ut$2=".",Dt$1="base64url",Gt$2="utf8",xt$2="utf8",Vt$2=":",Yt$1="did",Jt$2="key",dt$2="base58btc",Kt$2="z",Wt$2="K36",Ne$1=32;function Xt$2(F){return globalThis.Buffer!=null?new Uint8Array(F.buffer,F.byteOffset,F.byteLength):F}function Le$2(F=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Xt$2(globalThis.Buffer.allocUnsafe(F)):new Uint8Array(F)}function Oe$2(F,t){t||(t=F.reduce((Hs,zs)=>Hs+zs.length,0));const Z=Le$2(t);let at=0;for(const Hs of F)Z.set(Hs,at),at+=Hs.length;return Xt$2(Z)}function Ir$2(F,t){if(F.length>=255)throw new TypeError("Alphabet too long");for(var Z=new Uint8Array(256),at=0;at<Z.length;at++)Z[at]=255;for(var Hs=0;Hs<F.length;Hs++){var zs=F.charAt(Hs),Ys=zs.charCodeAt(0);if(Z[Ys]!==255)throw new TypeError(zs+" is ambiguous");Z[Ys]=Hs}var Zs=F.length,$u=F.charAt(0),Eu=Math.log(Zs)/Math.log(256),Au=Math.log(256)/Math.log(Zs);function vu(Su){if(Su instanceof Uint8Array||(ArrayBuffer.isView(Su)?Su=new Uint8Array(Su.buffer,Su.byteOffset,Su.byteLength):Array.isArray(Su)&&(Su=Uint8Array.from(Su))),!(Su instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Su.length===0)return"";for(var Bu=0,Du=0,Tu=0,Pu=Su.length;Tu!==Pu&&Su[Tu]===0;)Tu++,Bu++;for(var Uu=(Pu-Tu)*Au+1>>>0,Fu=new Uint8Array(Uu);Tu!==Pu;){for(var Lu=Su[Tu],qu=0,zu=Uu-1;(Lu!==0||qu<Du)&&zu!==-1;zu--,qu++)Lu+=256*Fu[zu]>>>0,Fu[zu]=Lu%Zs>>>0,Lu=Lu/Zs>>>0;if(Lu!==0)throw new Error("Non-zero carry");Du=qu,Tu++}for(var tl=Uu-Du;tl!==Uu&&Fu[tl]===0;)tl++;for(var Wu=$u.repeat(Bu);tl<Uu;++tl)Wu+=F.charAt(Fu[tl]);return Wu}function Iu(Su){if(typeof Su!="string")throw new TypeError("Expected String");if(Su.length===0)return new Uint8Array;var Bu=0;if(Su[Bu]!==" "){for(var Du=0,Tu=0;Su[Bu]===$u;)Du++,Bu++;for(var Pu=(Su.length-Bu)*Eu+1>>>0,Uu=new Uint8Array(Pu);Su[Bu];){var Fu=Z[Su.charCodeAt(Bu)];if(Fu===255)return;for(var Lu=0,qu=Pu-1;(Fu!==0||Lu<Tu)&&qu!==-1;qu--,Lu++)Fu+=Zs*Uu[qu]>>>0,Uu[qu]=Fu%256>>>0,Fu=Fu/256>>>0;if(Fu!==0)throw new Error("Non-zero carry");Tu=Lu,Bu++}if(Su[Bu]!==" "){for(var zu=Pu-Tu;zu!==Pu&&Uu[zu]===0;)zu++;for(var tl=new Uint8Array(Du+(Pu-zu)),Wu=Du;zu!==Pu;)tl[Wu++]=Uu[zu++];return tl}}}function _u(Su){var Bu=Iu(Su);if(Bu)return Bu;throw new Error(`Non-${t} character`)}return{encode:vu,decodeUnsafe:Iu,decode:_u}}var Ur$2=Ir$2,Tr$2=Ur$2;const He$2=F=>{if(F instanceof Uint8Array&&F.constructor.name==="Uint8Array")return F;if(F instanceof ArrayBuffer)return new Uint8Array(F);if(ArrayBuffer.isView(F))return new Uint8Array(F.buffer,F.byteOffset,F.byteLength);throw new Error("Unknown type, must be binary type")},Fr$2=F=>new TextEncoder().encode(F),Nr$2=F=>new TextDecoder().decode(F);let Lr$2=class{constructor(t,Z,at){this.name=t,this.prefix=Z,this.baseEncode=at}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Or$2=class{constructor(t,Z,at){if(this.name=t,this.prefix=Z,Z.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=Z.codePointAt(0),this.baseDecode=at}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ze$1(this,t)}},Hr$2=class{constructor(t){this.decoders=t}or(t){return ze$1(this,t)}decode(t){const Z=t[0],at=this.decoders[Z];if(at)return at.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const ze$1=(F,t)=>new Hr$2({...F.decoders||{[F.prefix]:F},...t.decoders||{[t.prefix]:t}});let zr$2=class{constructor(t,Z,at,Hs){this.name=t,this.prefix=Z,this.baseEncode=at,this.baseDecode=Hs,this.encoder=new Lr$2(t,Z,at),this.decoder=new Or$2(t,Z,Hs)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};const Bt$2=({name:F,prefix:t,encode:Z,decode:at})=>new zr$2(F,t,Z,at),ht$1=({prefix:F,name:t,alphabet:Z})=>{const{encode:at,decode:Hs}=Tr$2(Z,t);return Bt$2({prefix:F,name:t,encode:at,decode:zs=>He$2(Hs(zs))})},Mr$2=(F,t,Z,at)=>{const Hs={};for(let Au=0;Au<t.length;++Au)Hs[t[Au]]=Au;let zs=F.length;for(;F[zs-1]==="=";)--zs;const Ys=new Uint8Array(zs*Z/8|0);let Zs=0,$u=0,Eu=0;for(let Au=0;Au<zs;++Au){const vu=Hs[F[Au]];if(vu===void 0)throw new SyntaxError(`Non-${at} character`);$u=$u<<Z|vu,Zs+=Z,Zs>=8&&(Zs-=8,Ys[Eu++]=255&$u>>Zs)}if(Zs>=Z||255&$u<<8-Zs)throw new SyntaxError("Unexpected end of data");return Ys},qr$2=(F,t,Z)=>{const at=t[t.length-1]==="=",Hs=(1<<Z)-1;let zs="",Ys=0,Zs=0;for(let $u=0;$u<F.length;++$u)for(Zs=Zs<<8|F[$u],Ys+=8;Ys>Z;)Ys-=Z,zs+=t[Hs&Zs>>Ys];if(Ys&&(zs+=t[Hs&Zs<<Z-Ys]),at)for(;zs.length*Z&7;)zs+="=";return zs},k=({name:F,prefix:t,bitsPerChar:Z,alphabet:at})=>Bt$2({prefix:t,name:F,encode(Hs){return qr$2(Hs,at,Z)},decode(Hs){return Mr$2(Hs,at,Z,F)}}),$r$2=Bt$2({prefix:"\0",name:"identity",encode:F=>Nr$2(F),decode:F=>Fr$2(F)});var kr$2=Object.freeze({__proto__:null,identity:$r$2});const Rr$2=k({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var jr$2=Object.freeze({__proto__:null,base2:Rr$2});const Zr$2=k({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Gr$2=Object.freeze({__proto__:null,base8:Zr$2});const Vr$2=ht$1({prefix:"9",name:"base10",alphabet:"0123456789"});var Yr$2=Object.freeze({__proto__:null,base10:Vr$2});const Jr$2=k({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Kr$2=k({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Wr$2=Object.freeze({__proto__:null,base16:Jr$2,base16upper:Kr$2});const Xr$2=k({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Pr$2=k({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Qr$2=k({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),to$2=k({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),eo$2=k({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),no$2=k({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ro$2=k({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),oo$2=k({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),so$2=k({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var io$2=Object.freeze({__proto__:null,base32:Xr$2,base32upper:Pr$2,base32pad:Qr$2,base32padupper:to$2,base32hex:eo$2,base32hexupper:no$2,base32hexpad:ro$2,base32hexpadupper:oo$2,base32z:so$2});const uo$2=ht$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),co$2=ht$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ao$2=Object.freeze({__proto__:null,base36:uo$2,base36upper:co$2});const fo$2=ht$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Do$2=ht$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ho$2=Object.freeze({__proto__:null,base58btc:fo$2,base58flickr:Do$2});const lo$2=k({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),bo$2=k({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),po$2=k({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),wo$2=k({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Eo$2=Object.freeze({__proto__:null,base64:lo$2,base64pad:bo$2,base64url:po$2,base64urlpad:wo$2});const Me$3=Array.from(""),go$2=Me$3.reduce((F,t,Z)=>(F[Z]=t,F),[]),yo$2=Me$3.reduce((F,t,Z)=>(F[t.codePointAt(0)]=Z,F),[]);function xo$2(F){return F.reduce((t,Z)=>(t+=go$2[Z],t),"")}function Bo$2(F){const t=[];for(const Z of F){const at=yo$2[Z.codePointAt(0)];if(at===void 0)throw new Error(`Non-base256emoji character: ${Z}`);t.push(at)}return new Uint8Array(t)}const Co$2=Bt$2({prefix:"",name:"base256emoji",encode:xo$2,decode:Bo$2});var Ao$2=Object.freeze({__proto__:null,base256emoji:Co$2}),mo$2=$e$2,qe$2=128,_o$2=127,So$2=~_o$2,vo$2=Math.pow(2,31);function $e$2(F,t,Z){t=t||[],Z=Z||0;for(var at=Z;F>=vo$2;)t[Z++]=F&255|qe$2,F/=128;for(;F&So$2;)t[Z++]=F&255|qe$2,F>>>=7;return t[Z]=F|0,$e$2.bytes=Z-at+1,t}var Io$2=Pt$2,Uo$2=128,ke$2=127;function Pt$2(F,at){var Z=0,at=at||0,Hs=0,zs=at,Ys,Zs=F.length;do{if(zs>=Zs)throw Pt$2.bytes=0,new RangeError("Could not decode varint");Ys=F[zs++],Z+=Hs<28?(Ys&ke$2)<<Hs:(Ys&ke$2)*Math.pow(2,Hs),Hs+=7}while(Ys>=Uo$2);return Pt$2.bytes=zs-at,Z}var To$2=Math.pow(2,7),Fo$2=Math.pow(2,14),No$2=Math.pow(2,21),Lo$2=Math.pow(2,28),Oo$2=Math.pow(2,35),Ho$2=Math.pow(2,42),zo$2=Math.pow(2,49),Mo$2=Math.pow(2,56),qo$2=Math.pow(2,63),$o$2=function(F){return F<To$2?1:F<Fo$2?2:F<No$2?3:F<Lo$2?4:F<Oo$2?5:F<Ho$2?6:F<zo$2?7:F<Mo$2?8:F<qo$2?9:10},ko$2={encode:mo$2,decode:Io$2,encodingLength:$o$2},Re$1=ko$2;const je$1=(F,t,Z=0)=>(Re$1.encode(F,t,Z),t),Ze$2=F=>Re$1.encodingLength(F),Qt$2=(F,t)=>{const Z=t.byteLength,at=Ze$2(F),Hs=at+Ze$2(Z),zs=new Uint8Array(Hs+Z);return je$1(F,zs,0),je$1(Z,zs,at),zs.set(t,Hs),new Ro$2(F,Z,t,zs)};let Ro$2=class{constructor(t,Z,at,Hs){this.code=t,this.size=Z,this.digest=at,this.bytes=Hs}};const Ge$2=({name:F,code:t,encode:Z})=>new jo$2(F,t,Z);let jo$2=class{constructor(t,Z,at){this.name=t,this.code=Z,this.encode=at}digest(t){if(t instanceof Uint8Array){const Z=this.encode(t);return Z instanceof Uint8Array?Qt$2(this.code,Z):Z.then(at=>Qt$2(this.code,at))}else throw Error("Unknown type, must be binary type")}};const Ve$3=F=>async t=>new Uint8Array(await crypto.subtle.digest(F,t)),Zo$2=Ge$2({name:"sha2-256",code:18,encode:Ve$3("SHA-256")}),Go$2=Ge$2({name:"sha2-512",code:19,encode:Ve$3("SHA-512")});var Vo$2=Object.freeze({__proto__:null,sha256:Zo$2,sha512:Go$2});const Ye$2=0,Yo$2="identity",Je$2=He$2,Jo$2=F=>Qt$2(Ye$2,Je$2(F)),Ko$2={code:Ye$2,name:Yo$2,encode:Je$2,digest:Jo$2};var Wo$2=Object.freeze({__proto__:null,identity:Ko$2});new TextEncoder,new TextDecoder;const Ke$3={...kr$2,...jr$2,...Gr$2,...Yr$2,...Wr$2,...io$2,...ao$2,...ho$2,...Eo$2,...Ao$2};({...Vo$2,...Wo$2});function We$2(F,t,Z,at){return{name:F,prefix:t,encoder:{name:F,prefix:t,encode:Z},decoder:{decode:at}}}const Xe$1=We$2("utf8","u",F=>"u"+new TextDecoder("utf8").decode(F),F=>new TextEncoder().encode(F.substring(1))),te$1=We$2("ascii","a",F=>{let t="a";for(let Z=0;Z<F.length;Z++)t+=String.fromCharCode(F[Z]);return t},F=>{F=F.substring(1);const t=Le$2(F.length);for(let Z=0;Z<F.length;Z++)t[Z]=F.charCodeAt(Z);return t}),Pe$2={utf8:Xe$1,"utf-8":Xe$1,hex:Ke$3.base16,latin1:te$1,ascii:te$1,binary:te$1,...Ke$3};function ct$1(F,t="utf8"){const Z=Pe$2[t];if(!Z)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(F.buffer,F.byteOffset,F.byteLength).toString("utf8"):Z.encoder.encode(F).substring(1)}function rt$1(F,t="utf8"){const Z=Pe$2[t];if(!Z)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Xt$2(globalThis.Buffer.from(F,"utf-8")):Z.decoder.decode(`${Z.prefix}${F}`)}function lt$1(F){return safeJsonParse(ct$1(rt$1(F,Dt$1),Gt$2))}function bt$1(F){return ct$1(rt$1(safeJsonStringify(F),Gt$2),Dt$1)}function Qe$2(F){const t=rt$1(Wt$2,dt$2),Z=Kt$2+ct$1(Oe$2([t,F]),dt$2);return[Yt$1,Jt$2,Z].join(Vt$2)}function en$2(F){return ct$1(F,Dt$1)}function nn$2(F){return rt$1(F,Dt$1)}function rn$2(F){return rt$1([bt$1(F.header),bt$1(F.payload)].join(ut$2),xt$2)}function on$2(F){return[bt$1(F.header),bt$1(F.payload),en$2(F.signature)].join(ut$2)}function sn$2(F){const t=F.split(ut$2),Z=lt$1(t[0]),at=lt$1(t[1]),Hs=nn$2(t[2]),zs=rt$1(t.slice(0,2).join(ut$2),xt$2);return{header:Z,payload:at,signature:Hs,data:zs}}function Po$2(F=he$2(Ne$1)){const t=Rt$3.getPublicKey(F);return{secretKey:Oe$2([F,t]),publicKey:t}}async function Qo$2(F,t,Z,at,Hs=cjs$3.fromMiliseconds(Date.now())){const zs={alg:jt$2,typ:Zt$2},Ys=Qe$2(at.publicKey),Zs=Hs+Z,$u={iss:Ys,sub:F,aud:t,iat:Hs,exp:Zs},Eu=rn$2({header:zs,payload:$u}),Au=Rt$3.sign(Eu,at.secretKey.slice(0,32));return on$2({header:zs,payload:$u,signature:Au})}var __spreadArray=globalThis&&globalThis.__spreadArray||function(F,t,Z){if(Z||arguments.length===2)for(var at=0,Hs=t.length,zs;at<Hs;at++)(zs||!(at in t))&&(zs||(zs=Array.prototype.slice.call(t,0,at)),zs[at]=t[at]);return F.concat(zs||Array.prototype.slice.call(t))},BrowserInfo=function(){function F(t,Z,at){this.name=t,this.version=Z,this.os=at,this.type="browser"}return F}(),NodeInfo=function(){function F(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return F}(),SearchBotDeviceInfo=function(){function F(t,Z,at,Hs){this.name=t,this.version=Z,this.os=at,this.bot=Hs,this.type="bot-device"}return F}(),BotInfo=function(){function F(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return F}(),ReactNativeInfo=function(){function F(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return F}(),SEARCHBOX_UA_REGEX=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,SEARCHBOT_OS_REGEX=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,REQUIRED_VERSION_PARTS=3,userAgentRules=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",SEARCHBOX_UA_REGEX]],operatingSystemRules=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function detect(F){return F?parseUserAgent(F):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new ReactNativeInfo:typeof navigator<"u"?parseUserAgent(navigator.userAgent):getNodeVersion()}function matchUserAgent(F){return F!==""&&userAgentRules.reduce(function(t,Z){var at=Z[0],Hs=Z[1];if(t)return t;var zs=Hs.exec(F);return!!zs&&[at,zs]},!1)}function parseUserAgent(F){var t=matchUserAgent(F);if(!t)return null;var Z=t[0],at=t[1];if(Z==="searchbot")return new BotInfo;var Hs=at[1]&&at[1].split(".").join("_").split("_").slice(0,3);Hs?Hs.length<REQUIRED_VERSION_PARTS&&(Hs=__spreadArray(__spreadArray([],Hs,!0),createVersionParts(REQUIRED_VERSION_PARTS-Hs.length),!0)):Hs=[];var zs=Hs.join("."),Ys=detectOS(F),Zs=SEARCHBOT_OS_REGEX.exec(F);return Zs&&Zs[1]?new SearchBotDeviceInfo(Z,zs,Ys,Zs[1]):new BrowserInfo(Z,zs,Ys)}function detectOS(F){for(var t=0,Z=operatingSystemRules.length;t<Z;t++){var at=operatingSystemRules[t],Hs=at[0],zs=at[1],Ys=zs.exec(F);if(Ys)return Hs}return null}function getNodeVersion(){var F=typeof process<"u"&&process.version;return F?new NodeInfo(process.version.slice(1)):null}function createVersionParts(F){for(var t=[],Z=0;Z<F;Z++)t.push("0");return t}var cjs$2={};Object.defineProperty(cjs$2,"__esModule",{value:!0});cjs$2.getLocalStorage=cjs$2.getLocalStorageOrThrow=cjs$2.getCrypto=cjs$2.getCryptoOrThrow=getLocation_1=cjs$2.getLocation=cjs$2.getLocationOrThrow=getNavigator_1=cjs$2.getNavigator=cjs$2.getNavigatorOrThrow=getDocument_1=cjs$2.getDocument=cjs$2.getDocumentOrThrow=cjs$2.getFromWindowOrThrow=cjs$2.getFromWindow=void 0;function getFromWindow(F){let t;return typeof window<"u"&&typeof window[F]<"u"&&(t=window[F]),t}cjs$2.getFromWindow=getFromWindow;function getFromWindowOrThrow(F){const t=getFromWindow(F);if(!t)throw new Error(`${F} is not defined in Window`);return t}cjs$2.getFromWindowOrThrow=getFromWindowOrThrow;function getDocumentOrThrow(){return getFromWindowOrThrow("document")}cjs$2.getDocumentOrThrow=getDocumentOrThrow;function getDocument(){return getFromWindow("document")}var getDocument_1=cjs$2.getDocument=getDocument;function getNavigatorOrThrow(){return getFromWindowOrThrow("navigator")}cjs$2.getNavigatorOrThrow=getNavigatorOrThrow;function getNavigator(){return getFromWindow("navigator")}var getNavigator_1=cjs$2.getNavigator=getNavigator;function getLocationOrThrow(){return getFromWindowOrThrow("location")}cjs$2.getLocationOrThrow=getLocationOrThrow;function getLocation(){return getFromWindow("location")}var getLocation_1=cjs$2.getLocation=getLocation;function getCryptoOrThrow(){return getFromWindowOrThrow("crypto")}cjs$2.getCryptoOrThrow=getCryptoOrThrow;function getCrypto(){return getFromWindow("crypto")}cjs$2.getCrypto=getCrypto;function getLocalStorageOrThrow(){return getFromWindowOrThrow("localStorage")}cjs$2.getLocalStorageOrThrow=getLocalStorageOrThrow;function getLocalStorage(){return getFromWindow("localStorage")}cjs$2.getLocalStorage=getLocalStorage;var cjs$1={};Object.defineProperty(cjs$1,"__esModule",{value:!0});var getWindowMetadata_1=cjs$1.getWindowMetadata=void 0;const window_getters_1=cjs$2;function getWindowMetadata(){let F,t;try{F=window_getters_1.getDocumentOrThrow(),t=window_getters_1.getLocationOrThrow()}catch{return null}function Z(){const vu=F.getElementsByTagName("link"),Iu=[];for(let _u=0;_u<vu.length;_u++){const Su=vu[_u],Bu=Su.getAttribute("rel");if(Bu&&Bu.toLowerCase().indexOf("icon")>-1){const Du=Su.getAttribute("href");if(Du)if(Du.toLowerCase().indexOf("https:")===-1&&Du.toLowerCase().indexOf("http:")===-1&&Du.indexOf("//")!==0){let Tu=t.protocol+"//"+t.host;if(Du.indexOf("/")===0)Tu+=Du;else{const Pu=t.pathname.split("/");Pu.pop();const Uu=Pu.join("/");Tu+=Uu+"/"+Du}Iu.push(Tu)}else if(Du.indexOf("//")===0){const Tu=t.protocol+Du;Iu.push(Tu)}else Iu.push(Du)}}return Iu}function at(...vu){const Iu=F.getElementsByTagName("meta");for(let _u=0;_u<Iu.length;_u++){const Su=Iu[_u],Bu=["itemprop","property","name"].map(Du=>Su.getAttribute(Du)).filter(Du=>Du?vu.includes(Du):!1);if(Bu.length&&Bu){const Du=Su.getAttribute("content");if(Du)return Du}}return""}function Hs(){let vu=at("name","og:site_name","og:title","twitter:title");return vu||(vu=F.title),vu}function zs(){return at("description","og:description","twitter:description","keywords")}const Ys=Hs(),Zs=zs(),$u=t.origin,Eu=Z();return{description:Zs,url:$u,icons:Eu,name:Ys}}getWindowMetadata_1=cjs$1.getWindowMetadata=getWindowMetadata;const version="0.1.1";function getVersion(){return version}class BaseError extends Error{constructor(t,Z={}){const at=(()=>{var $u;if(Z.cause instanceof BaseError){if(Z.cause.details)return Z.cause.details;if(Z.cause.shortMessage)return Z.cause.shortMessage}return Z.cause&&"details"in Z.cause&&typeof Z.cause.details=="string"?Z.cause.details:($u=Z.cause)!=null&&$u.message?Z.cause.message:Z.details})(),Hs=(()=>Z.cause instanceof BaseError&&Z.cause.docsPath||Z.docsPath)(),Ys=`https://oxlib.sh${Hs??""}`,Zs=[t||"An error occurred.",...Z.metaMessages?["",...Z.metaMessages]:[],...at||Hs?["",at?`Details: ${at}`:void 0,Hs?`See: ${Ys}`:void 0]:[]].filter($u=>typeof $u=="string").join(`
`);super(Zs,Z.cause?{cause:Z.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${getVersion()}`}),this.cause=Z.cause,this.details=at,this.docs=Ys,this.docsPath=Hs,this.shortMessage=t}walk(t){return walk(this,t)}}function walk(F,t){return t!=null&&t(F)?F:F&&typeof F=="object"&&"cause"in F&&F.cause?walk(F.cause,t):t?null:F}const crypto$2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes$2(F){return F instanceof Uint8Array||ArrayBuffer.isView(F)&&F.constructor.name==="Uint8Array"}function anumber$1(F){if(!Number.isSafeInteger(F)||F<0)throw new Error("positive integer expected, got "+F)}function abytes$1(F,...t){if(!isBytes$2(F))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(F.length))throw new Error("Uint8Array expected of length "+t+", got length="+F.length)}function ahash(F){if(typeof F!="function"||typeof F.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");anumber$1(F.outputLen),anumber$1(F.blockLen)}function aexists(F,t=!0){if(F.destroyed)throw new Error("Hash instance has been destroyed");if(t&&F.finished)throw new Error("Hash#digest() has already been called")}function aoutput(F,t){abytes$1(F);const Z=t.outputLen;if(F.length<Z)throw new Error("digestInto() expects output buffer of length at least "+Z)}function u32(F){return new Uint32Array(F.buffer,F.byteOffset,Math.floor(F.byteLength/4))}function clean(...F){for(let t=0;t<F.length;t++)F[t].fill(0)}function createView(F){return new DataView(F.buffer,F.byteOffset,F.byteLength)}function rotr(F,t){return F<<32-t|F>>>t}const isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function byteSwap(F){return F<<24&4278190080|F<<8&16711680|F>>>8&65280|F>>>24&255}function byteSwap32(F){for(let t=0;t<F.length;t++)F[t]=byteSwap(F[t]);return F}const swap32IfBE=isLE?F=>F:byteSwap32;function utf8ToBytes(F){if(typeof F!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(F))}function toBytes(F){return typeof F=="string"&&(F=utf8ToBytes(F)),abytes$1(F),F}function concatBytes$1(...F){let t=0;for(let at=0;at<F.length;at++){const Hs=F[at];abytes$1(Hs),t+=Hs.length}const Z=new Uint8Array(t);for(let at=0,Hs=0;at<F.length;at++){const zs=F[at];Z.set(zs,Hs),Hs+=zs.length}return Z}class Hash{}function createHasher(F){const t=at=>F().update(toBytes(at)).digest(),Z=F();return t.outputLen=Z.outputLen,t.blockLen=Z.blockLen,t.create=()=>F(),t}function randomBytes(F=32){if(crypto$2&&typeof crypto$2.getRandomValues=="function")return crypto$2.getRandomValues(new Uint8Array(F));if(crypto$2&&typeof crypto$2.randomBytes=="function")return Uint8Array.from(crypto$2.randomBytes(F));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64(F,t,Z,at){if(typeof F.setBigUint64=="function")return F.setBigUint64(t,Z,at);const Hs=BigInt(32),zs=BigInt(4294967295),Ys=Number(Z>>Hs&zs),Zs=Number(Z&zs),$u=at?4:0,Eu=at?0:4;F.setUint32(t+$u,Ys,at),F.setUint32(t+Eu,Zs,at)}function Chi(F,t,Z){return F&t^~F&Z}function Maj(F,t,Z){return F&t^F&Z^t&Z}class HashMD extends Hash{constructor(t,Z,at,Hs){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=Z,this.padOffset=at,this.isLE=Hs,this.buffer=new Uint8Array(t),this.view=createView(this.buffer)}update(t){aexists(this),t=toBytes(t),abytes$1(t);const{view:Z,buffer:at,blockLen:Hs}=this,zs=t.length;for(let Ys=0;Ys<zs;){const Zs=Math.min(Hs-this.pos,zs-Ys);if(Zs===Hs){const $u=createView(t);for(;Hs<=zs-Ys;Ys+=Hs)this.process($u,Ys);continue}at.set(t.subarray(Ys,Ys+Zs),this.pos),this.pos+=Zs,Ys+=Zs,this.pos===Hs&&(this.process(Z,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists(this),aoutput(t,this),this.finished=!0;const{buffer:Z,view:at,blockLen:Hs,isLE:zs}=this;let{pos:Ys}=this;Z[Ys++]=128,clean(this.buffer.subarray(Ys)),this.padOffset>Hs-Ys&&(this.process(at,0),Ys=0);for(let vu=Ys;vu<Hs;vu++)Z[vu]=0;setBigUint64(at,Hs-8,BigInt(this.length*8),zs),this.process(at,0);const Zs=createView(t),$u=this.outputLen;if($u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const Eu=$u/4,Au=this.get();if(Eu>Au.length)throw new Error("_sha2: outputLen bigger than state");for(let vu=0;vu<Eu;vu++)Zs.setUint32(4*vu,Au[vu],zs)}digest(){const{buffer:t,outputLen:Z}=this;this.digestInto(t);const at=t.slice(0,Z);return this.destroy(),at}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:Z,buffer:at,length:Hs,finished:zs,destroyed:Ys,pos:Zs}=this;return t.destroyed=Ys,t.finished=zs,t.length=Hs,t.pos=Zs,Hs%Z&&t.buffer.set(at),t}clone(){return this._cloneInto()}}const SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),U32_MASK64=BigInt(2**32-1),_32n=BigInt(32);function fromBig(F,t=!1){return t?{h:Number(F&U32_MASK64),l:Number(F>>_32n&U32_MASK64)}:{h:Number(F>>_32n&U32_MASK64)|0,l:Number(F&U32_MASK64)|0}}function split(F,t=!1){const Z=F.length;let at=new Uint32Array(Z),Hs=new Uint32Array(Z);for(let zs=0;zs<Z;zs++){const{h:Ys,l:Zs}=fromBig(F[zs],t);[at[zs],Hs[zs]]=[Ys,Zs]}return[at,Hs]}const rotlSH=(F,t,Z)=>F<<Z|t>>>32-Z,rotlSL=(F,t,Z)=>t<<Z|F>>>32-Z,rotlBH=(F,t,Z)=>t<<Z-32|F>>>64-Z,rotlBL=(F,t,Z)=>F<<Z-32|t>>>64-Z,_0n$5=BigInt(0),_1n$5=BigInt(1),_2n$2=BigInt(2),_7n=BigInt(7),_256n=BigInt(256),_0x71n=BigInt(113),SHA3_PI=[],SHA3_ROTL=[],_SHA3_IOTA=[];for(let F=0,t=_1n$5,Z=1,at=0;F<24;F++){[Z,at]=[at,(2*Z+3*at)%5],SHA3_PI.push(2*(5*at+Z)),SHA3_ROTL.push((F+1)*(F+2)/2%64);let Hs=_0n$5;for(let zs=0;zs<7;zs++)t=(t<<_1n$5^(t>>_7n)*_0x71n)%_256n,t&_2n$2&&(Hs^=_1n$5<<(_1n$5<<BigInt(zs))-_1n$5);_SHA3_IOTA.push(Hs)}const IOTAS=split(_SHA3_IOTA,!0),SHA3_IOTA_H=IOTAS[0],SHA3_IOTA_L=IOTAS[1],rotlH=(F,t,Z)=>Z>32?rotlBH(F,t,Z):rotlSH(F,t,Z),rotlL=(F,t,Z)=>Z>32?rotlBL(F,t,Z):rotlSL(F,t,Z);function keccakP(F,t=24){const Z=new Uint32Array(10);for(let at=24-t;at<24;at++){for(let Ys=0;Ys<10;Ys++)Z[Ys]=F[Ys]^F[Ys+10]^F[Ys+20]^F[Ys+30]^F[Ys+40];for(let Ys=0;Ys<10;Ys+=2){const Zs=(Ys+8)%10,$u=(Ys+2)%10,Eu=Z[$u],Au=Z[$u+1],vu=rotlH(Eu,Au,1)^Z[Zs],Iu=rotlL(Eu,Au,1)^Z[Zs+1];for(let _u=0;_u<50;_u+=10)F[Ys+_u]^=vu,F[Ys+_u+1]^=Iu}let Hs=F[2],zs=F[3];for(let Ys=0;Ys<24;Ys++){const Zs=SHA3_ROTL[Ys],$u=rotlH(Hs,zs,Zs),Eu=rotlL(Hs,zs,Zs),Au=SHA3_PI[Ys];Hs=F[Au],zs=F[Au+1],F[Au]=$u,F[Au+1]=Eu}for(let Ys=0;Ys<50;Ys+=10){for(let Zs=0;Zs<10;Zs++)Z[Zs]=F[Ys+Zs];for(let Zs=0;Zs<10;Zs++)F[Ys+Zs]^=~Z[(Zs+2)%10]&Z[(Zs+4)%10]}F[0]^=SHA3_IOTA_H[at],F[1]^=SHA3_IOTA_L[at]}clean(Z)}class Keccak extends Hash{constructor(t,Z,at,Hs=!1,zs=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=Z,this.outputLen=at,this.enableXOF=Hs,this.rounds=zs,anumber$1(at),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=u32(this.state)}clone(){return this._cloneInto()}keccak(){swap32IfBE(this.state32),keccakP(this.state32,this.rounds),swap32IfBE(this.state32),this.posOut=0,this.pos=0}update(t){aexists(this),t=toBytes(t),abytes$1(t);const{blockLen:Z,state:at}=this,Hs=t.length;for(let zs=0;zs<Hs;){const Ys=Math.min(Z-this.pos,Hs-zs);for(let Zs=0;Zs<Ys;Zs++)at[this.pos++]^=t[zs++];this.pos===Z&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:Z,pos:at,blockLen:Hs}=this;t[at]^=Z,Z&128&&at===Hs-1&&this.keccak(),t[Hs-1]^=128,this.keccak()}writeInto(t){aexists(this,!1),abytes$1(t),this.finish();const Z=this.state,{blockLen:at}=this;for(let Hs=0,zs=t.length;Hs<zs;){this.posOut>=at&&this.keccak();const Ys=Math.min(at-this.posOut,zs-Hs);t.set(Z.subarray(this.posOut,this.posOut+Ys),Hs),this.posOut+=Ys,Hs+=Ys}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return anumber$1(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(aoutput(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,clean(this.state)}_cloneInto(t){const{blockLen:Z,suffix:at,outputLen:Hs,rounds:zs,enableXOF:Ys}=this;return t||(t=new Keccak(Z,at,Hs,Ys,zs)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=zs,t.suffix=at,t.outputLen=Hs,t.enableXOF=Ys,t.destroyed=this.destroyed,t}}const gen=(F,t,Z)=>createHasher(()=>new Keccak(t,F,Z)),keccak_256=(()=>gen(1,136,256/8))(),SHA256_K=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor(t=32){super(64,t,8,!1),this.A=SHA256_IV[0]|0,this.B=SHA256_IV[1]|0,this.C=SHA256_IV[2]|0,this.D=SHA256_IV[3]|0,this.E=SHA256_IV[4]|0,this.F=SHA256_IV[5]|0,this.G=SHA256_IV[6]|0,this.H=SHA256_IV[7]|0}get(){const{A:t,B:Z,C:at,D:Hs,E:zs,F:Ys,G:Zs,H:$u}=this;return[t,Z,at,Hs,zs,Ys,Zs,$u]}set(t,Z,at,Hs,zs,Ys,Zs,$u){this.A=t|0,this.B=Z|0,this.C=at|0,this.D=Hs|0,this.E=zs|0,this.F=Ys|0,this.G=Zs|0,this.H=$u|0}process(t,Z){for(let vu=0;vu<16;vu++,Z+=4)SHA256_W[vu]=t.getUint32(Z,!1);for(let vu=16;vu<64;vu++){const Iu=SHA256_W[vu-15],_u=SHA256_W[vu-2],Su=rotr(Iu,7)^rotr(Iu,18)^Iu>>>3,Bu=rotr(_u,17)^rotr(_u,19)^_u>>>10;SHA256_W[vu]=Bu+SHA256_W[vu-7]+Su+SHA256_W[vu-16]|0}let{A:at,B:Hs,C:zs,D:Ys,E:Zs,F:$u,G:Eu,H:Au}=this;for(let vu=0;vu<64;vu++){const Iu=rotr(Zs,6)^rotr(Zs,11)^rotr(Zs,25),_u=Au+Iu+Chi(Zs,$u,Eu)+SHA256_K[vu]+SHA256_W[vu]|0,Bu=(rotr(at,2)^rotr(at,13)^rotr(at,22))+Maj(at,Hs,zs)|0;Au=Eu,Eu=$u,$u=Zs,Zs=Ys+_u|0,Ys=zs,zs=Hs,Hs=at,at=_u+Bu|0}at=at+this.A|0,Hs=Hs+this.B|0,zs=zs+this.C|0,Ys=Ys+this.D|0,Zs=Zs+this.E|0,$u=$u+this.F|0,Eu=Eu+this.G|0,Au=Au+this.H|0,this.set(at,Hs,zs,Ys,Zs,$u,Eu,Au)}roundClean(){clean(SHA256_W)}destroy(){this.set(0,0,0,0,0,0,0,0),clean(this.buffer)}}const sha256=createHasher(()=>new SHA256);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$4=BigInt(0),_1n$4=BigInt(1);function isBytes$1(F){return F instanceof Uint8Array||ArrayBuffer.isView(F)&&F.constructor.name==="Uint8Array"}function abytes(F){if(!isBytes$1(F))throw new Error("Uint8Array expected")}function abool(F,t){if(typeof t!="boolean")throw new Error(F+" boolean expected, got "+t)}function numberToHexUnpadded(F){const t=F.toString(16);return t.length&1?"0"+t:t}function hexToNumber(F){if(typeof F!="string")throw new Error("hex string expected, got "+typeof F);return F===""?_0n$4:BigInt("0x"+F)}const hasHexBuiltin=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes$1=Array.from({length:256},(F,t)=>t.toString(16).padStart(2,"0"));function bytesToHex(F){if(abytes(F),hasHexBuiltin)return F.toHex();let t="";for(let Z=0;Z<F.length;Z++)t+=hexes$1[F[Z]];return t}const asciis={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16(F){if(F>=asciis._0&&F<=asciis._9)return F-asciis._0;if(F>=asciis.A&&F<=asciis.F)return F-(asciis.A-10);if(F>=asciis.a&&F<=asciis.f)return F-(asciis.a-10)}function hexToBytes(F){if(typeof F!="string")throw new Error("hex string expected, got "+typeof F);if(hasHexBuiltin)return Uint8Array.fromHex(F);const t=F.length,Z=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const at=new Uint8Array(Z);for(let Hs=0,zs=0;Hs<Z;Hs++,zs+=2){const Ys=asciiToBase16(F.charCodeAt(zs)),Zs=asciiToBase16(F.charCodeAt(zs+1));if(Ys===void 0||Zs===void 0){const $u=F[zs]+F[zs+1];throw new Error('hex string expected, got non-hex character "'+$u+'" at index '+zs)}at[Hs]=Ys*16+Zs}return at}function bytesToNumberBE(F){return hexToNumber(bytesToHex(F))}function bytesToNumberLE(F){return abytes(F),hexToNumber(bytesToHex(Uint8Array.from(F).reverse()))}function numberToBytesBE(F,t){return hexToBytes(F.toString(16).padStart(t*2,"0"))}function numberToBytesLE(F,t){return numberToBytesBE(F,t).reverse()}function ensureBytes(F,t,Z){let at;if(typeof t=="string")try{at=hexToBytes(t)}catch(zs){throw new Error(F+" must be hex string or Uint8Array, cause: "+zs)}else if(isBytes$1(t))at=Uint8Array.from(t);else throw new Error(F+" must be hex string or Uint8Array");const Hs=at.length;if(typeof Z=="number"&&Hs!==Z)throw new Error(F+" of length "+Z+" expected, got "+Hs);return at}function concatBytes(...F){let t=0;for(let at=0;at<F.length;at++){const Hs=F[at];abytes(Hs),t+=Hs.length}const Z=new Uint8Array(t);for(let at=0,Hs=0;at<F.length;at++){const zs=F[at];Z.set(zs,Hs),Hs+=zs.length}return Z}const isPosBig=F=>typeof F=="bigint"&&_0n$4<=F;function inRange(F,t,Z){return isPosBig(F)&&isPosBig(t)&&isPosBig(Z)&&t<=F&&F<Z}function aInRange(F,t,Z,at){if(!inRange(t,Z,at))throw new Error("expected valid "+F+": "+Z+" <= n < "+at+", got "+t)}function bitLen(F){let t;for(t=0;F>_0n$4;F>>=_1n$4,t+=1);return t}const bitMask=F=>(_1n$4<<BigInt(F))-_1n$4,u8n=F=>new Uint8Array(F),u8fr=F=>Uint8Array.from(F);function createHmacDrbg(F,t,Z){if(typeof F!="number"||F<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof Z!="function")throw new Error("hmacFn must be a function");let at=u8n(F),Hs=u8n(F),zs=0;const Ys=()=>{at.fill(1),Hs.fill(0),zs=0},Zs=(...vu)=>Z(Hs,at,...vu),$u=(vu=u8n(0))=>{Hs=Zs(u8fr([0]),vu),at=Zs(),vu.length!==0&&(Hs=Zs(u8fr([1]),vu),at=Zs())},Eu=()=>{if(zs++>=1e3)throw new Error("drbg: tried 1000 values");let vu=0;const Iu=[];for(;vu<t;){at=Zs();const _u=at.slice();Iu.push(_u),vu+=at.length}return concatBytes(...Iu)};return(vu,Iu)=>{Ys(),$u(vu);let _u;for(;!(_u=Iu(Eu()));)$u();return Ys(),_u}}const validatorFns={bigint:F=>typeof F=="bigint",function:F=>typeof F=="function",boolean:F=>typeof F=="boolean",string:F=>typeof F=="string",stringOrUint8Array:F=>typeof F=="string"||isBytes$1(F),isSafeInteger:F=>Number.isSafeInteger(F),array:F=>Array.isArray(F),field:(F,t)=>t.Fp.isValid(F),hash:F=>typeof F=="function"&&Number.isSafeInteger(F.outputLen)};function validateObject(F,t,Z={}){const at=(Hs,zs,Ys)=>{const Zs=validatorFns[zs];if(typeof Zs!="function")throw new Error("invalid validator function");const $u=F[Hs];if(!(Ys&&$u===void 0)&&!Zs($u,F))throw new Error("param "+String(Hs)+" is invalid. Expected "+zs+", got "+$u)};for(const[Hs,zs]of Object.entries(t))at(Hs,zs,!1);for(const[Hs,zs]of Object.entries(Z))at(Hs,zs,!0);return F}function memoized(F){const t=new WeakMap;return(Z,...at)=>{const Hs=t.get(Z);if(Hs!==void 0)return Hs;const zs=F(Z,...at);return t.set(Z,zs),zs}}function assertSize$1(F,t){if(size(F)>t)throw new SizeOverflowError({givenSize:size(F),maxSize:t})}const charCodeMap={zero:48,nine:57,A:65,F:70,a:97,f:102};function charCodeToBase16(F){if(F>=charCodeMap.zero&&F<=charCodeMap.nine)return F-charCodeMap.zero;if(F>=charCodeMap.A&&F<=charCodeMap.F)return F-(charCodeMap.A-10);if(F>=charCodeMap.a&&F<=charCodeMap.f)return F-(charCodeMap.a-10)}function pad$1(F,t={}){const{dir:Z,size:at=32}=t;if(at===0)return F;if(F.length>at)throw new SizeExceedsPaddingSizeError({size:F.length,targetSize:at,type:"Bytes"});const Hs=new Uint8Array(at);for(let zs=0;zs<at;zs++){const Ys=Z==="right";Hs[Ys?zs:at-zs-1]=F[Ys?zs:F.length-zs-1]}return Hs}function assertSize(F,t){if(size$1(F)>t)throw new SizeOverflowError$1({givenSize:size$1(F),maxSize:t})}function assertStartOffset(F,t){if(typeof t=="number"&&t>0&&t>size$1(F)-1)throw new SliceOffsetOutOfBoundsError({offset:t,position:"start",size:size$1(F)})}function assertEndOffset(F,t,Z){if(typeof t=="number"&&typeof Z=="number"&&size$1(F)!==Z-t)throw new SliceOffsetOutOfBoundsError({offset:Z,position:"end",size:size$1(F)})}function pad(F,t={}){const{dir:Z,size:at=32}=t;if(at===0)return F;const Hs=F.replace("0x","");if(Hs.length>at*2)throw new SizeExceedsPaddingSizeError$1({size:Math.ceil(Hs.length/2),targetSize:at,type:"Hex"});return`0x${Hs[Z==="right"?"padEnd":"padStart"](at*2,"0")}`}const bigIntSuffix="#__bigint";function stringify(F,t,Z){return JSON.stringify(F,(at,Hs)=>typeof t=="function"?t(at,Hs):typeof Hs=="bigint"?Hs.toString()+bigIntSuffix:Hs,Z)}const hexes=Array.from({length:256},(F,t)=>t.toString(16).padStart(2,"0"));function assert$6(F,t={}){const{strict:Z=!1}=t;if(!F)throw new InvalidHexTypeError(F);if(typeof F!="string")throw new InvalidHexTypeError(F);if(Z&&!/^0x[0-9a-fA-F]*$/.test(F))throw new InvalidHexValueError(F);if(!F.startsWith("0x"))throw new InvalidHexValueError(F)}function concat$1(...F){return`0x${F.reduce((t,Z)=>t+Z.replace("0x",""),"")}`}function from$4(F){return F instanceof Uint8Array?fromBytes$1(F):Array.isArray(F)?fromBytes$1(new Uint8Array(F)):F}function fromBytes$1(F,t={}){let Z="";for(let Hs=0;Hs<F.length;Hs++)Z+=hexes[F[Hs]];const at=`0x${Z}`;return typeof t.size=="number"?(assertSize(at,t.size),padRight$1(at,t.size)):at}function fromNumber(F,t={}){const{signed:Z,size:at}=t,Hs=BigInt(F);let zs;at?Z?zs=(1n<<BigInt(at)*8n-1n)-1n:zs=2n**(BigInt(at)*8n)-1n:typeof F=="number"&&(zs=BigInt(Number.MAX_SAFE_INTEGER));const Ys=typeof zs=="bigint"&&Z?-zs-1n:0;if(zs&&Hs>zs||Hs<Ys){const Eu=typeof F=="bigint"?"n":"";throw new IntegerOutOfRangeError({max:zs?`${zs}${Eu}`:void 0,min:`${Ys}${Eu}`,signed:Z,size:at,value:`${F}${Eu}`})}const $u=`0x${(Z&&Hs<0?(1n<<BigInt(at*8))+BigInt(Hs):Hs).toString(16)}`;return at?padLeft($u,at):$u}function padLeft(F,t){return pad(F,{dir:"left",size:t})}function padRight$1(F,t){return pad(F,{dir:"right",size:t})}function slice(F,t,Z,at={}){const{strict:Hs}=at;assertStartOffset(F,t);const zs=`0x${F.replace("0x","").slice((t??0)*2,(Z??F.length)*2)}`;return Hs&&assertEndOffset(zs,t,Z),zs}function size$1(F){return Math.ceil((F.length-2)/2)}function validate$1(F,t={}){const{strict:Z=!1}=t;try{return assert$6(F,{strict:Z}),!0}catch{return!1}}class IntegerOutOfRangeError extends BaseError{constructor({max:t,min:Z,signed:at,size:Hs,value:zs}){super(`Number \`${zs}\` is not in safe${Hs?` ${Hs*8}-bit`:""}${at?" signed":" unsigned"} integer range ${t?`(\`${Z}\` to \`${t}\`)`:`(above \`${Z}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class InvalidHexTypeError extends BaseError{constructor(t){super(`Value \`${typeof t=="object"?stringify(t):t}\` of type \`${typeof t}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class InvalidHexValueError extends BaseError{constructor(t){super(`Value \`${t}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let SizeOverflowError$1=class extends BaseError{constructor({givenSize:t,maxSize:Z}){super(`Size cannot exceed \`${Z}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class SliceOffsetOutOfBoundsError extends BaseError{constructor({offset:t,position:Z,size:at}){super(`Slice ${Z==="start"?"starting":"ending"} at offset \`${t}\` is out-of-bounds (size: \`${at}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let SizeExceedsPaddingSizeError$1=class extends BaseError{constructor({size:t,targetSize:Z,type:at}){super(`${at.charAt(0).toUpperCase()}${at.slice(1).toLowerCase()} size (\`${t}\`) exceeds padding size (\`${Z}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const encoder=new TextEncoder;function assert$5(F){if(!(F instanceof Uint8Array)){if(!F)throw new InvalidBytesTypeError(F);if(typeof F!="object")throw new InvalidBytesTypeError(F);if(!("BYTES_PER_ELEMENT"in F))throw new InvalidBytesTypeError(F);if(F.BYTES_PER_ELEMENT!==1||F.constructor.name!=="Uint8Array")throw new InvalidBytesTypeError(F)}}function from$3(F){return F instanceof Uint8Array?F:typeof F=="string"?fromHex$2(F):fromArray(F)}function fromArray(F){return F instanceof Uint8Array?F:new Uint8Array(F)}function fromHex$2(F,t={}){const{size:Z}=t;let at=F;Z&&(assertSize(F,Z),at=padRight$1(F,Z));let Hs=at.slice(2);Hs.length%2&&(Hs=`0${Hs}`);const zs=Hs.length/2,Ys=new Uint8Array(zs);for(let Zs=0,$u=0;Zs<zs;Zs++){const Eu=charCodeToBase16(Hs.charCodeAt($u++)),Au=charCodeToBase16(Hs.charCodeAt($u++));if(Eu===void 0||Au===void 0)throw new BaseError(`Invalid byte sequence ("${Hs[$u-2]}${Hs[$u-1]}" in "${Hs}").`);Ys[Zs]=Eu*16+Au}return Ys}function fromString$2(F,t={}){const{size:Z}=t,at=encoder.encode(F);return typeof Z=="number"?(assertSize$1(at,Z),padRight(at,Z)):at}function padRight(F,t){return pad$1(F,{dir:"right",size:t})}function size(F){return F.length}function validate(F){try{return assert$5(F),!0}catch{return!1}}class InvalidBytesTypeError extends BaseError{constructor(t){super(`Value \`${typeof t=="object"?stringify(t):t}\` of type \`${typeof t}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class SizeOverflowError extends BaseError{constructor({givenSize:t,maxSize:Z}){super(`Size cannot exceed \`${Z}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class SizeExceedsPaddingSizeError extends BaseError{constructor({size:t,targetSize:Z,type:at}){super(`${at.charAt(0).toUpperCase()}${at.slice(1).toLowerCase()} size (\`${t}\`) exceeds padding size (\`${Z}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function keccak256(F,t={}){const{as:Z=typeof F=="string"?"Hex":"Bytes"}=t,at=keccak_256(from$3(F));return Z==="Bytes"?at:fromBytes$1(at)}class LruMap extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const Z=super.get(t);return super.has(t)&&Z!==void 0&&(this.delete(t),super.set(t,Z)),Z}set(t,Z){if(super.set(t,Z),this.maxSize&&this.size>this.maxSize){const at=this.keys().next().value;at&&this.delete(at)}return this}}const caches={checksum:new LruMap(8192)},checksum$1=caches.checksum;function assert$4(F,t={}){const{compressed:Z}=t,{prefix:at,x:Hs,y:zs}=F;if(Z===!1||typeof Hs=="bigint"&&typeof zs=="bigint"){if(at!==4)throw new InvalidPrefixError({prefix:at,cause:new InvalidUncompressedPrefixError});return}if(Z===!0||typeof Hs=="bigint"&&typeof zs>"u"){if(at!==3&&at!==2)throw new InvalidPrefixError({prefix:at,cause:new InvalidCompressedPrefixError});return}throw new InvalidError({publicKey:F})}function from$2(F){const t=(()=>{if(validate$1(F))return fromHex$1(F);if(validate(F))return fromBytes(F);const{prefix:Z,x:at,y:Hs}=F;return typeof at=="bigint"&&typeof Hs=="bigint"?{prefix:Z??4,x:at,y:Hs}:{prefix:Z,x:at}})();return assert$4(t),t}function fromBytes(F){return fromHex$1(fromBytes$1(F))}function fromHex$1(F){if(F.length!==132&&F.length!==130&&F.length!==68)throw new InvalidSerializedSizeError$1({publicKey:F});if(F.length===130){const at=BigInt(slice(F,0,32)),Hs=BigInt(slice(F,32,64));return{prefix:4,x:at,y:Hs}}if(F.length===132){const at=Number(slice(F,0,1)),Hs=BigInt(slice(F,1,33)),zs=BigInt(slice(F,33,65));return{prefix:at,x:Hs,y:zs}}const t=Number(slice(F,0,1)),Z=BigInt(slice(F,1,33));return{prefix:t,x:Z}}function toHex$3(F,t={}){assert$4(F);const{prefix:Z,x:at,y:Hs}=F,{includePrefix:zs=!0}=t;return concat$1(zs?fromNumber(Z,{size:1}):"0x",fromNumber(at,{size:32}),typeof Hs=="bigint"?fromNumber(Hs,{size:32}):"0x")}class InvalidError extends BaseError{constructor({publicKey:t}){super(`Value \`${stringify(t)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class InvalidPrefixError extends BaseError{constructor({prefix:t,cause:Z}){super(`Prefix "${t}" is invalid.`,{cause:Z}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class InvalidCompressedPrefixError extends BaseError{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class InvalidUncompressedPrefixError extends BaseError{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let InvalidSerializedSizeError$1=class extends BaseError{constructor({publicKey:t}){super(`Value \`${t}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${size$1(from$4(t))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const addressRegex=/^0x[a-fA-F0-9]{40}$/;function assert$3(F,t={}){const{strict:Z=!0}=t;if(!addressRegex.test(F))throw new InvalidAddressError({address:F,cause:new InvalidInputError});if(Z){if(F.toLowerCase()===F)return;if(checksum(F)!==F)throw new InvalidAddressError({address:F,cause:new InvalidChecksumError})}}function checksum(F){if(checksum$1.has(F))return checksum$1.get(F);assert$3(F,{strict:!1});const t=F.substring(2).toLowerCase(),Z=keccak256(fromString$2(t),{as:"Bytes"}),at=t.split("");for(let zs=0;zs<40;zs+=2)Z[zs>>1]>>4>=8&&at[zs]&&(at[zs]=at[zs].toUpperCase()),(Z[zs>>1]&15)>=8&&at[zs+1]&&(at[zs+1]=at[zs+1].toUpperCase());const Hs=`0x${at.join("")}`;return checksum$1.set(F,Hs),Hs}function from$1(F,t={}){const{checksum:Z=!1}=t;return assert$3(F),Z?checksum(F):F}function fromPublicKey(F,t={}){const Z=keccak256(`0x${toHex$3(F).slice(4)}`).substring(26);return from$1(`0x${Z}`,t)}class InvalidAddressError extends BaseError{constructor({address:t,cause:Z}){super(`Address "${t}" is invalid.`,{cause:Z}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class InvalidInputError extends BaseError{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class InvalidChecksumError extends BaseError{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}class HMAC extends Hash{constructor(t,Z){super(),this.finished=!1,this.destroyed=!1,ahash(t);const at=toBytes(Z);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const Hs=this.blockLen,zs=new Uint8Array(Hs);zs.set(at.length>Hs?t.create().update(at).digest():at);for(let Ys=0;Ys<zs.length;Ys++)zs[Ys]^=54;this.iHash.update(zs),this.oHash=t.create();for(let Ys=0;Ys<zs.length;Ys++)zs[Ys]^=106;this.oHash.update(zs),clean(zs)}update(t){return aexists(this),this.iHash.update(t),this}digestInto(t){aexists(this),abytes$1(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:Z,iHash:at,finished:Hs,destroyed:zs,blockLen:Ys,outputLen:Zs}=this;return t=t,t.finished=Hs,t.destroyed=zs,t.blockLen=Ys,t.outputLen=Zs,t.oHash=Z._cloneInto(t.oHash),t.iHash=at._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac=(F,t,Z)=>new HMAC(F,t).update(Z).digest();hmac.create=(F,t)=>new HMAC(F,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$3=BigInt(0),_1n$3=BigInt(1),_2n$1=BigInt(2),_3n$1=BigInt(3),_4n$1=BigInt(4),_5n=BigInt(5),_8n=BigInt(8);function mod(F,t){const Z=F%t;return Z>=_0n$3?Z:t+Z}function pow2(F,t,Z){let at=F;for(;t-- >_0n$3;)at*=at,at%=Z;return at}function invert(F,t){if(F===_0n$3)throw new Error("invert: expected non-zero number");if(t<=_0n$3)throw new Error("invert: expected positive modulus, got "+t);let Z=mod(F,t),at=t,Hs=_0n$3,zs=_1n$3;for(;Z!==_0n$3;){const Zs=at/Z,$u=at%Z,Eu=Hs-zs*Zs;at=Z,Z=$u,Hs=zs,zs=Eu}if(at!==_1n$3)throw new Error("invert: does not exist");return mod(Hs,t)}function sqrt3mod4(F,t){const Z=(F.ORDER+_1n$3)/_4n$1,at=F.pow(t,Z);if(!F.eql(F.sqr(at),t))throw new Error("Cannot find square root");return at}function sqrt5mod8(F,t){const Z=(F.ORDER-_5n)/_8n,at=F.mul(t,_2n$1),Hs=F.pow(at,Z),zs=F.mul(t,Hs),Ys=F.mul(F.mul(zs,_2n$1),Hs),Zs=F.mul(zs,F.sub(Ys,F.ONE));if(!F.eql(F.sqr(Zs),t))throw new Error("Cannot find square root");return Zs}function tonelliShanks(F){if(F<BigInt(3))throw new Error("sqrt is not defined for small field");let t=F-_1n$3,Z=0;for(;t%_2n$1===_0n$3;)t/=_2n$1,Z++;let at=_2n$1;const Hs=Field(F);for(;FpLegendre(Hs,at)===1;)if(at++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(Z===1)return sqrt3mod4;let zs=Hs.pow(at,t);const Ys=(t+_1n$3)/_2n$1;return function($u,Eu){if($u.is0(Eu))return Eu;if(FpLegendre($u,Eu)!==1)throw new Error("Cannot find square root");let Au=Z,vu=$u.mul($u.ONE,zs),Iu=$u.pow(Eu,t),_u=$u.pow(Eu,Ys);for(;!$u.eql(Iu,$u.ONE);){if($u.is0(Iu))return $u.ZERO;let Su=1,Bu=$u.sqr(Iu);for(;!$u.eql(Bu,$u.ONE);)if(Su++,Bu=$u.sqr(Bu),Su===Au)throw new Error("Cannot find square root");const Du=_1n$3<<BigInt(Au-Su-1),Tu=$u.pow(vu,Du);Au=Su,vu=$u.sqr(Tu),Iu=$u.mul(Iu,vu),_u=$u.mul(_u,Tu)}return _u}}function FpSqrt(F){return F%_4n$1===_3n$1?sqrt3mod4:F%_8n===_5n?sqrt5mod8:tonelliShanks(F)}const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(F){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},Z=FIELD_FIELDS.reduce((at,Hs)=>(at[Hs]="function",at),t);return validateObject(F,Z)}function FpPow(F,t,Z){if(Z<_0n$3)throw new Error("invalid exponent, negatives unsupported");if(Z===_0n$3)return F.ONE;if(Z===_1n$3)return t;let at=F.ONE,Hs=t;for(;Z>_0n$3;)Z&_1n$3&&(at=F.mul(at,Hs)),Hs=F.sqr(Hs),Z>>=_1n$3;return at}function FpInvertBatch(F,t,Z=!1){const at=new Array(t.length).fill(Z?F.ZERO:void 0),Hs=t.reduce((Ys,Zs,$u)=>F.is0(Zs)?Ys:(at[$u]=Ys,F.mul(Ys,Zs)),F.ONE),zs=F.inv(Hs);return t.reduceRight((Ys,Zs,$u)=>F.is0(Zs)?Ys:(at[$u]=F.mul(Ys,at[$u]),F.mul(Ys,Zs)),zs),at}function FpLegendre(F,t){const Z=(F.ORDER-_1n$3)/_2n$1,at=F.pow(t,Z),Hs=F.eql(at,F.ONE),zs=F.eql(at,F.ZERO),Ys=F.eql(at,F.neg(F.ONE));if(!Hs&&!zs&&!Ys)throw new Error("invalid Legendre symbol result");return Hs?1:zs?0:-1}function nLength(F,t){t!==void 0&&anumber$1(t);const Z=t!==void 0?t:F.toString(2).length,at=Math.ceil(Z/8);return{nBitLength:Z,nByteLength:at}}function Field(F,t,Z=!1,at={}){if(F<=_0n$3)throw new Error("invalid field: expected ORDER > 0, got "+F);const{nBitLength:Hs,nByteLength:zs}=nLength(F,t);if(zs>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let Ys;const Zs=Object.freeze({ORDER:F,isLE:Z,BITS:Hs,BYTES:zs,MASK:bitMask(Hs),ZERO:_0n$3,ONE:_1n$3,create:$u=>mod($u,F),isValid:$u=>{if(typeof $u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof $u);return _0n$3<=$u&&$u<F},is0:$u=>$u===_0n$3,isOdd:$u=>($u&_1n$3)===_1n$3,neg:$u=>mod(-$u,F),eql:($u,Eu)=>$u===Eu,sqr:$u=>mod($u*$u,F),add:($u,Eu)=>mod($u+Eu,F),sub:($u,Eu)=>mod($u-Eu,F),mul:($u,Eu)=>mod($u*Eu,F),pow:($u,Eu)=>FpPow(Zs,$u,Eu),div:($u,Eu)=>mod($u*invert(Eu,F),F),sqrN:$u=>$u*$u,addN:($u,Eu)=>$u+Eu,subN:($u,Eu)=>$u-Eu,mulN:($u,Eu)=>$u*Eu,inv:$u=>invert($u,F),sqrt:at.sqrt||($u=>(Ys||(Ys=FpSqrt(F)),Ys(Zs,$u))),toBytes:$u=>Z?numberToBytesLE($u,zs):numberToBytesBE($u,zs),fromBytes:$u=>{if($u.length!==zs)throw new Error("Field.fromBytes: expected "+zs+" bytes, got "+$u.length);return Z?bytesToNumberLE($u):bytesToNumberBE($u)},invertBatch:$u=>FpInvertBatch(Zs,$u),cmov:($u,Eu,Au)=>Au?Eu:$u});return Object.freeze(Zs)}function getFieldBytesLength(F){if(typeof F!="bigint")throw new Error("field order must be bigint");const t=F.toString(2).length;return Math.ceil(t/8)}function getMinHashLength(F){const t=getFieldBytesLength(F);return t+Math.ceil(t/2)}function mapHashToField(F,t,Z=!1){const at=F.length,Hs=getFieldBytesLength(t),zs=getMinHashLength(t);if(at<16||at<zs||at>1024)throw new Error("expected "+zs+"-1024 bytes of input, got "+at);const Ys=Z?bytesToNumberLE(F):bytesToNumberBE(F),Zs=mod(Ys,t-_1n$3)+_1n$3;return Z?numberToBytesLE(Zs,Hs):numberToBytesBE(Zs,Hs)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$2=BigInt(0),_1n$2=BigInt(1);function constTimeNegate(F,t){const Z=t.negate();return F?Z:t}function validateW(F,t){if(!Number.isSafeInteger(F)||F<=0||F>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+F)}function calcWOpts(F,t){validateW(F,t);const Z=Math.ceil(t/F)+1,at=2**(F-1),Hs=2**F,zs=bitMask(F),Ys=BigInt(F);return{windows:Z,windowSize:at,mask:zs,maxNumber:Hs,shiftBy:Ys}}function calcOffsets(F,t,Z){const{windowSize:at,mask:Hs,maxNumber:zs,shiftBy:Ys}=Z;let Zs=Number(F&Hs),$u=F>>Ys;Zs>at&&(Zs-=zs,$u+=_1n$2);const Eu=t*at,Au=Eu+Math.abs(Zs)-1,vu=Zs===0,Iu=Zs<0,_u=t%2!==0;return{nextN:$u,offset:Au,isZero:vu,isNeg:Iu,isNegF:_u,offsetF:Eu}}function validateMSMPoints(F,t){if(!Array.isArray(F))throw new Error("array expected");F.forEach((Z,at)=>{if(!(Z instanceof t))throw new Error("invalid point at index "+at)})}function validateMSMScalars(F,t){if(!Array.isArray(F))throw new Error("array of scalars expected");F.forEach((Z,at)=>{if(!t.isValid(Z))throw new Error("invalid scalar at index "+at)})}const pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function getW(F){return pointWindowSizes.get(F)||1}function wNAF(F,t){return{constTimeNegate,hasPrecomputes(Z){return getW(Z)!==1},unsafeLadder(Z,at,Hs=F.ZERO){let zs=Z;for(;at>_0n$2;)at&_1n$2&&(Hs=Hs.add(zs)),zs=zs.double(),at>>=_1n$2;return Hs},precomputeWindow(Z,at){const{windows:Hs,windowSize:zs}=calcWOpts(at,t),Ys=[];let Zs=Z,$u=Zs;for(let Eu=0;Eu<Hs;Eu++){$u=Zs,Ys.push($u);for(let Au=1;Au<zs;Au++)$u=$u.add(Zs),Ys.push($u);Zs=$u.double()}return Ys},wNAF(Z,at,Hs){let zs=F.ZERO,Ys=F.BASE;const Zs=calcWOpts(Z,t);for(let $u=0;$u<Zs.windows;$u++){const{nextN:Eu,offset:Au,isZero:vu,isNeg:Iu,isNegF:_u,offsetF:Su}=calcOffsets(Hs,$u,Zs);Hs=Eu,vu?Ys=Ys.add(constTimeNegate(_u,at[Su])):zs=zs.add(constTimeNegate(Iu,at[Au]))}return{p:zs,f:Ys}},wNAFUnsafe(Z,at,Hs,zs=F.ZERO){const Ys=calcWOpts(Z,t);for(let Zs=0;Zs<Ys.windows&&Hs!==_0n$2;Zs++){const{nextN:$u,offset:Eu,isZero:Au,isNeg:vu}=calcOffsets(Hs,Zs,Ys);if(Hs=$u,!Au){const Iu=at[Eu];zs=zs.add(vu?Iu.negate():Iu)}}return zs},getPrecomputes(Z,at,Hs){let zs=pointPrecomputes.get(at);return zs||(zs=this.precomputeWindow(at,Z),Z!==1&&pointPrecomputes.set(at,Hs(zs))),zs},wNAFCached(Z,at,Hs){const zs=getW(Z);return this.wNAF(zs,this.getPrecomputes(zs,Z,Hs),at)},wNAFCachedUnsafe(Z,at,Hs,zs){const Ys=getW(Z);return Ys===1?this.unsafeLadder(Z,at,zs):this.wNAFUnsafe(Ys,this.getPrecomputes(Ys,Z,Hs),at,zs)},setWindowSize(Z,at){validateW(at,t),pointWindowSizes.set(Z,at),pointPrecomputes.delete(Z)}}}function pippenger(F,t,Z,at){validateMSMPoints(Z,F),validateMSMScalars(at,t);const Hs=Z.length,zs=at.length;if(Hs!==zs)throw new Error("arrays of points and scalars must have equal length");const Ys=F.ZERO,Zs=bitLen(BigInt(Hs));let $u=1;Zs>12?$u=Zs-3:Zs>4?$u=Zs-2:Zs>0&&($u=2);const Eu=bitMask($u),Au=new Array(Number(Eu)+1).fill(Ys),vu=Math.floor((t.BITS-1)/$u)*$u;let Iu=Ys;for(let _u=vu;_u>=0;_u-=$u){Au.fill(Ys);for(let Bu=0;Bu<zs;Bu++){const Du=at[Bu],Tu=Number(Du>>BigInt(_u)&Eu);Au[Tu]=Au[Tu].add(Z[Bu])}let Su=Ys;for(let Bu=Au.length-1,Du=Ys;Bu>0;Bu--)Du=Du.add(Au[Bu]),Su=Su.add(Du);if(Iu=Iu.add(Su),_u!==0)for(let Bu=0;Bu<$u;Bu++)Iu=Iu.double()}return Iu}function validateBasic(F){return validateField(F.Fp),validateObject(F,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength(F.n,F.nBitLength),...F,p:F.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validateSigVerOpts(F){F.lowS!==void 0&&abool("lowS",F.lowS),F.prehash!==void 0&&abool("prehash",F.prehash)}function validatePointOpts(F){const t=validateBasic(F);validateObject(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:Z,Fp:at,a:Hs}=t;if(Z){if(!at.eql(Hs,at.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof Z!="object"||typeof Z.beta!="bigint"||typeof Z.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}class DERErr extends Error{constructor(t=""){super(t)}}const DER={Err:DERErr,_tlv:{encode:(F,t)=>{const{Err:Z}=DER;if(F<0||F>256)throw new Z("tlv.encode: wrong tag");if(t.length&1)throw new Z("tlv.encode: unpadded data");const at=t.length/2,Hs=numberToHexUnpadded(at);if(Hs.length/2&128)throw new Z("tlv.encode: long form length too big");const zs=at>127?numberToHexUnpadded(Hs.length/2|128):"";return numberToHexUnpadded(F)+zs+Hs+t},decode(F,t){const{Err:Z}=DER;let at=0;if(F<0||F>256)throw new Z("tlv.encode: wrong tag");if(t.length<2||t[at++]!==F)throw new Z("tlv.decode: wrong tlv");const Hs=t[at++],zs=!!(Hs&128);let Ys=0;if(!zs)Ys=Hs;else{const $u=Hs&127;if(!$u)throw new Z("tlv.decode(long): indefinite length not supported");if($u>4)throw new Z("tlv.decode(long): byte length is too big");const Eu=t.subarray(at,at+$u);if(Eu.length!==$u)throw new Z("tlv.decode: length bytes not complete");if(Eu[0]===0)throw new Z("tlv.decode(long): zero leftmost byte");for(const Au of Eu)Ys=Ys<<8|Au;if(at+=$u,Ys<128)throw new Z("tlv.decode(long): not minimal encoding")}const Zs=t.subarray(at,at+Ys);if(Zs.length!==Ys)throw new Z("tlv.decode: wrong value length");return{v:Zs,l:t.subarray(at+Ys)}}},_int:{encode(F){const{Err:t}=DER;if(F<_0n$1)throw new t("integer: negative integers are not allowed");let Z=numberToHexUnpadded(F);if(Number.parseInt(Z[0],16)&8&&(Z="00"+Z),Z.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return Z},decode(F){const{Err:t}=DER;if(F[0]&128)throw new t("invalid signature integer: negative");if(F[0]===0&&!(F[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return bytesToNumberBE(F)}},toSig(F){const{Err:t,_int:Z,_tlv:at}=DER,Hs=ensureBytes("signature",F),{v:zs,l:Ys}=at.decode(48,Hs);if(Ys.length)throw new t("invalid signature: left bytes after parsing");const{v:Zs,l:$u}=at.decode(2,zs),{v:Eu,l:Au}=at.decode(2,$u);if(Au.length)throw new t("invalid signature: left bytes after parsing");return{r:Z.decode(Zs),s:Z.decode(Eu)}},hexFromSig(F){const{_tlv:t,_int:Z}=DER,at=t.encode(2,Z.encode(F.r)),Hs=t.encode(2,Z.encode(F.s)),zs=at+Hs;return t.encode(48,zs)}};function numToSizedHex(F,t){return bytesToHex(numberToBytesBE(F,t))}const _0n$1=BigInt(0),_1n$1=BigInt(1);BigInt(2);const _3n=BigInt(3),_4n=BigInt(4);function weierstrassPoints(F){const t=validatePointOpts(F),{Fp:Z}=t,at=Field(t.n,t.nBitLength),Hs=t.toBytes||((Uu,Fu,Lu)=>{const qu=Fu.toAffine();return concatBytes(Uint8Array.from([4]),Z.toBytes(qu.x),Z.toBytes(qu.y))}),zs=t.fromBytes||(Uu=>{const Fu=Uu.subarray(1),Lu=Z.fromBytes(Fu.subarray(0,Z.BYTES)),qu=Z.fromBytes(Fu.subarray(Z.BYTES,2*Z.BYTES));return{x:Lu,y:qu}});function Ys(Uu){const{a:Fu,b:Lu}=t,qu=Z.sqr(Uu),zu=Z.mul(qu,Uu);return Z.add(Z.add(zu,Z.mul(Uu,Fu)),Lu)}function Zs(Uu,Fu){const Lu=Z.sqr(Fu),qu=Ys(Uu);return Z.eql(Lu,qu)}if(!Zs(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const $u=Z.mul(Z.pow(t.a,_3n),_4n),Eu=Z.mul(Z.sqr(t.b),BigInt(27));if(Z.is0(Z.add($u,Eu)))throw new Error("bad curve params: a or b");function Au(Uu){return inRange(Uu,_1n$1,t.n)}function vu(Uu){const{allowedPrivateKeyLengths:Fu,nByteLength:Lu,wrapPrivateKey:qu,n:zu}=t;if(Fu&&typeof Uu!="bigint"){if(isBytes$1(Uu)&&(Uu=bytesToHex(Uu)),typeof Uu!="string"||!Fu.includes(Uu.length))throw new Error("invalid private key");Uu=Uu.padStart(Lu*2,"0")}let tl;try{tl=typeof Uu=="bigint"?Uu:bytesToNumberBE(ensureBytes("private key",Uu,Lu))}catch{throw new Error("invalid private key, expected hex or "+Lu+" bytes, got "+typeof Uu)}return qu&&(tl=mod(tl,zu)),aInRange("private key",tl,_1n$1,zu),tl}function Iu(Uu){if(!(Uu instanceof Bu))throw new Error("ProjectivePoint expected")}const _u=memoized((Uu,Fu)=>{const{px:Lu,py:qu,pz:zu}=Uu;if(Z.eql(zu,Z.ONE))return{x:Lu,y:qu};const tl=Uu.is0();Fu==null&&(Fu=tl?Z.ONE:Z.inv(zu));const Wu=Z.mul(Lu,Fu),cl=Z.mul(qu,Fu),wl=Z.mul(zu,Fu);if(tl)return{x:Z.ZERO,y:Z.ZERO};if(!Z.eql(wl,Z.ONE))throw new Error("invZ was invalid");return{x:Wu,y:cl}}),Su=memoized(Uu=>{if(Uu.is0()){if(t.allowInfinityPoint&&!Z.is0(Uu.py))return;throw new Error("bad point: ZERO")}const{x:Fu,y:Lu}=Uu.toAffine();if(!Z.isValid(Fu)||!Z.isValid(Lu))throw new Error("bad point: x or y not FE");if(!Zs(Fu,Lu))throw new Error("bad point: equation left != right");if(!Uu.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class Bu{constructor(Fu,Lu,qu){if(Fu==null||!Z.isValid(Fu))throw new Error("x required");if(Lu==null||!Z.isValid(Lu)||Z.is0(Lu))throw new Error("y required");if(qu==null||!Z.isValid(qu))throw new Error("z required");this.px=Fu,this.py=Lu,this.pz=qu,Object.freeze(this)}static fromAffine(Fu){const{x:Lu,y:qu}=Fu||{};if(!Fu||!Z.isValid(Lu)||!Z.isValid(qu))throw new Error("invalid affine point");if(Fu instanceof Bu)throw new Error("projective point not allowed");const zu=tl=>Z.eql(tl,Z.ZERO);return zu(Lu)&&zu(qu)?Bu.ZERO:new Bu(Lu,qu,Z.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(Fu){const Lu=FpInvertBatch(Z,Fu.map(qu=>qu.pz));return Fu.map((qu,zu)=>qu.toAffine(Lu[zu])).map(Bu.fromAffine)}static fromHex(Fu){const Lu=Bu.fromAffine(zs(ensureBytes("pointHex",Fu)));return Lu.assertValidity(),Lu}static fromPrivateKey(Fu){return Bu.BASE.multiply(vu(Fu))}static msm(Fu,Lu){return pippenger(Bu,at,Fu,Lu)}_setWindowSize(Fu){Pu.setWindowSize(this,Fu)}assertValidity(){Su(this)}hasEvenY(){const{y:Fu}=this.toAffine();if(Z.isOdd)return!Z.isOdd(Fu);throw new Error("Field doesn't support isOdd")}equals(Fu){Iu(Fu);const{px:Lu,py:qu,pz:zu}=this,{px:tl,py:Wu,pz:cl}=Fu,wl=Z.eql(Z.mul(Lu,cl),Z.mul(tl,zu)),hl=Z.eql(Z.mul(qu,cl),Z.mul(Wu,zu));return wl&&hl}negate(){return new Bu(this.px,Z.neg(this.py),this.pz)}double(){const{a:Fu,b:Lu}=t,qu=Z.mul(Lu,_3n),{px:zu,py:tl,pz:Wu}=this;let cl=Z.ZERO,wl=Z.ZERO,hl=Z.ZERO,Qu=Z.mul(zu,zu),rl=Z.mul(tl,tl),Hu=Z.mul(Wu,Wu),ju=Z.mul(zu,tl);return ju=Z.add(ju,ju),hl=Z.mul(zu,Wu),hl=Z.add(hl,hl),cl=Z.mul(Fu,hl),wl=Z.mul(qu,Hu),wl=Z.add(cl,wl),cl=Z.sub(rl,wl),wl=Z.add(rl,wl),wl=Z.mul(cl,wl),cl=Z.mul(ju,cl),hl=Z.mul(qu,hl),Hu=Z.mul(Fu,Hu),ju=Z.sub(Qu,Hu),ju=Z.mul(Fu,ju),ju=Z.add(ju,hl),hl=Z.add(Qu,Qu),Qu=Z.add(hl,Qu),Qu=Z.add(Qu,Hu),Qu=Z.mul(Qu,ju),wl=Z.add(wl,Qu),Hu=Z.mul(tl,Wu),Hu=Z.add(Hu,Hu),Qu=Z.mul(Hu,ju),cl=Z.sub(cl,Qu),hl=Z.mul(Hu,rl),hl=Z.add(hl,hl),hl=Z.add(hl,hl),new Bu(cl,wl,hl)}add(Fu){Iu(Fu);const{px:Lu,py:qu,pz:zu}=this,{px:tl,py:Wu,pz:cl}=Fu;let wl=Z.ZERO,hl=Z.ZERO,Qu=Z.ZERO;const rl=t.a,Hu=Z.mul(t.b,_3n);let ju=Z.mul(Lu,tl),Yu=Z.mul(qu,Wu),ul=Z.mul(zu,cl),Xu=Z.add(Lu,qu),al=Z.add(tl,Wu);Xu=Z.mul(Xu,al),al=Z.add(ju,Yu),Xu=Z.sub(Xu,al),al=Z.add(Lu,zu);let pl=Z.add(tl,cl);return al=Z.mul(al,pl),pl=Z.add(ju,ul),al=Z.sub(al,pl),pl=Z.add(qu,zu),wl=Z.add(Wu,cl),pl=Z.mul(pl,wl),wl=Z.add(Yu,ul),pl=Z.sub(pl,wl),Qu=Z.mul(rl,al),wl=Z.mul(Hu,ul),Qu=Z.add(wl,Qu),wl=Z.sub(Yu,Qu),Qu=Z.add(Yu,Qu),hl=Z.mul(wl,Qu),Yu=Z.add(ju,ju),Yu=Z.add(Yu,ju),ul=Z.mul(rl,ul),al=Z.mul(Hu,al),Yu=Z.add(Yu,ul),ul=Z.sub(ju,ul),ul=Z.mul(rl,ul),al=Z.add(al,ul),ju=Z.mul(Yu,al),hl=Z.add(hl,ju),ju=Z.mul(pl,al),wl=Z.mul(Xu,wl),wl=Z.sub(wl,ju),ju=Z.mul(Xu,Yu),Qu=Z.mul(pl,Qu),Qu=Z.add(Qu,ju),new Bu(wl,hl,Qu)}subtract(Fu){return this.add(Fu.negate())}is0(){return this.equals(Bu.ZERO)}wNAF(Fu){return Pu.wNAFCached(this,Fu,Bu.normalizeZ)}multiplyUnsafe(Fu){const{endo:Lu,n:qu}=t;aInRange("scalar",Fu,_0n$1,qu);const zu=Bu.ZERO;if(Fu===_0n$1)return zu;if(this.is0()||Fu===_1n$1)return this;if(!Lu||Pu.hasPrecomputes(this))return Pu.wNAFCachedUnsafe(this,Fu,Bu.normalizeZ);let{k1neg:tl,k1:Wu,k2neg:cl,k2:wl}=Lu.splitScalar(Fu),hl=zu,Qu=zu,rl=this;for(;Wu>_0n$1||wl>_0n$1;)Wu&_1n$1&&(hl=hl.add(rl)),wl&_1n$1&&(Qu=Qu.add(rl)),rl=rl.double(),Wu>>=_1n$1,wl>>=_1n$1;return tl&&(hl=hl.negate()),cl&&(Qu=Qu.negate()),Qu=new Bu(Z.mul(Qu.px,Lu.beta),Qu.py,Qu.pz),hl.add(Qu)}multiply(Fu){const{endo:Lu,n:qu}=t;aInRange("scalar",Fu,_1n$1,qu);let zu,tl;if(Lu){const{k1neg:Wu,k1:cl,k2neg:wl,k2:hl}=Lu.splitScalar(Fu);let{p:Qu,f:rl}=this.wNAF(cl),{p:Hu,f:ju}=this.wNAF(hl);Qu=Pu.constTimeNegate(Wu,Qu),Hu=Pu.constTimeNegate(wl,Hu),Hu=new Bu(Z.mul(Hu.px,Lu.beta),Hu.py,Hu.pz),zu=Qu.add(Hu),tl=rl.add(ju)}else{const{p:Wu,f:cl}=this.wNAF(Fu);zu=Wu,tl=cl}return Bu.normalizeZ([zu,tl])[0]}multiplyAndAddUnsafe(Fu,Lu,qu){const zu=Bu.BASE,tl=(cl,wl)=>wl===_0n$1||wl===_1n$1||!cl.equals(zu)?cl.multiplyUnsafe(wl):cl.multiply(wl),Wu=tl(this,Lu).add(tl(Fu,qu));return Wu.is0()?void 0:Wu}toAffine(Fu){return _u(this,Fu)}isTorsionFree(){const{h:Fu,isTorsionFree:Lu}=t;if(Fu===_1n$1)return!0;if(Lu)return Lu(Bu,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:Fu,clearCofactor:Lu}=t;return Fu===_1n$1?this:Lu?Lu(Bu,this):this.multiplyUnsafe(t.h)}toRawBytes(Fu=!0){return abool("isCompressed",Fu),this.assertValidity(),Hs(Bu,this,Fu)}toHex(Fu=!0){return abool("isCompressed",Fu),bytesToHex(this.toRawBytes(Fu))}}Bu.BASE=new Bu(t.Gx,t.Gy,Z.ONE),Bu.ZERO=new Bu(Z.ZERO,Z.ONE,Z.ZERO);const{endo:Du,nBitLength:Tu}=t,Pu=wNAF(Bu,Du?Math.ceil(Tu/2):Tu);return{CURVE:t,ProjectivePoint:Bu,normPrivateKeyToScalar:vu,weierstrassEquation:Ys,isWithinCurveOrder:Au}}function validateOpts(F){const t=validateBasic(F);return validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function weierstrass(F){const t=validateOpts(F),{Fp:Z,n:at,nByteLength:Hs,nBitLength:zs}=t,Ys=Z.BYTES+1,Zs=2*Z.BYTES+1;function $u(Hu){return mod(Hu,at)}function Eu(Hu){return invert(Hu,at)}const{ProjectivePoint:Au,normPrivateKeyToScalar:vu,weierstrassEquation:Iu,isWithinCurveOrder:_u}=weierstrassPoints({...t,toBytes(Hu,ju,Yu){const ul=ju.toAffine(),Xu=Z.toBytes(ul.x),al=concatBytes;return abool("isCompressed",Yu),Yu?al(Uint8Array.from([ju.hasEvenY()?2:3]),Xu):al(Uint8Array.from([4]),Xu,Z.toBytes(ul.y))},fromBytes(Hu){const ju=Hu.length,Yu=Hu[0],ul=Hu.subarray(1);if(ju===Ys&&(Yu===2||Yu===3)){const Xu=bytesToNumberBE(ul);if(!inRange(Xu,_1n$1,Z.ORDER))throw new Error("Point is not on curve");const al=Iu(Xu);let pl;try{pl=Z.sqrt(al)}catch(dl){const vl=dl instanceof Error?": "+dl.message:"";throw new Error("Point is not on curve"+vl)}const ml=(pl&_1n$1)===_1n$1;return(Yu&1)===1!==ml&&(pl=Z.neg(pl)),{x:Xu,y:pl}}else if(ju===Zs&&Yu===4){const Xu=Z.fromBytes(ul.subarray(0,Z.BYTES)),al=Z.fromBytes(ul.subarray(Z.BYTES,2*Z.BYTES));return{x:Xu,y:al}}else{const Xu=Ys,al=Zs;throw new Error("invalid Point, expected length of "+Xu+", or uncompressed "+al+", got "+ju)}}});function Su(Hu){const ju=at>>_1n$1;return Hu>ju}function Bu(Hu){return Su(Hu)?$u(-Hu):Hu}const Du=(Hu,ju,Yu)=>bytesToNumberBE(Hu.slice(ju,Yu));class Tu{constructor(ju,Yu,ul){aInRange("r",ju,_1n$1,at),aInRange("s",Yu,_1n$1,at),this.r=ju,this.s=Yu,ul!=null&&(this.recovery=ul),Object.freeze(this)}static fromCompact(ju){const Yu=Hs;return ju=ensureBytes("compactSignature",ju,Yu*2),new Tu(Du(ju,0,Yu),Du(ju,Yu,2*Yu))}static fromDER(ju){const{r:Yu,s:ul}=DER.toSig(ensureBytes("DER",ju));return new Tu(Yu,ul)}assertValidity(){}addRecoveryBit(ju){return new Tu(this.r,this.s,ju)}recoverPublicKey(ju){const{r:Yu,s:ul,recovery:Xu}=this,al=zu(ensureBytes("msgHash",ju));if(Xu==null||![0,1,2,3].includes(Xu))throw new Error("recovery id invalid");const pl=Xu===2||Xu===3?Yu+t.n:Yu;if(pl>=Z.ORDER)throw new Error("recovery id 2 or 3 invalid");const ml=Xu&1?"03":"02",Il=Au.fromHex(ml+numToSizedHex(pl,Z.BYTES)),dl=Eu(pl),vl=$u(-al*dl),nl=$u(ul*dl),el=Au.BASE.multiplyAndAddUnsafe(Il,vl,nl);if(!el)throw new Error("point at infinify");return el.assertValidity(),el}hasHighS(){return Su(this.s)}normalizeS(){return this.hasHighS()?new Tu(this.r,$u(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes(this.toDERHex())}toDERHex(){return DER.hexFromSig(this)}toCompactRawBytes(){return hexToBytes(this.toCompactHex())}toCompactHex(){const ju=Hs;return numToSizedHex(this.r,ju)+numToSizedHex(this.s,ju)}}const Pu={isValidPrivateKey(Hu){try{return vu(Hu),!0}catch{return!1}},normPrivateKeyToScalar:vu,randomPrivateKey:()=>{const Hu=getMinHashLength(t.n);return mapHashToField(t.randomBytes(Hu),t.n)},precompute(Hu=8,ju=Au.BASE){return ju._setWindowSize(Hu),ju.multiply(BigInt(3)),ju}};function Uu(Hu,ju=!0){return Au.fromPrivateKey(Hu).toRawBytes(ju)}function Fu(Hu){if(typeof Hu=="bigint")return!1;if(Hu instanceof Au)return!0;const Yu=ensureBytes("key",Hu).length,ul=Z.BYTES,Xu=ul+1,al=2*ul+1;if(!(t.allowedPrivateKeyLengths||Hs===Xu))return Yu===Xu||Yu===al}function Lu(Hu,ju,Yu=!0){if(Fu(Hu)===!0)throw new Error("first arg must be private key");if(Fu(ju)===!1)throw new Error("second arg must be public key");return Au.fromHex(ju).multiply(vu(Hu)).toRawBytes(Yu)}const qu=t.bits2int||function(Hu){if(Hu.length>8192)throw new Error("input is too large");const ju=bytesToNumberBE(Hu),Yu=Hu.length*8-zs;return Yu>0?ju>>BigInt(Yu):ju},zu=t.bits2int_modN||function(Hu){return $u(qu(Hu))},tl=bitMask(zs);function Wu(Hu){return aInRange("num < 2^"+zs,Hu,_0n$1,tl),numberToBytesBE(Hu,Hs)}function cl(Hu,ju,Yu=wl){if(["recovered","canonical"].some(bl=>bl in Yu))throw new Error("sign() legacy options not supported");const{hash:ul,randomBytes:Xu}=t;let{lowS:al,prehash:pl,extraEntropy:ml}=Yu;al==null&&(al=!0),Hu=ensureBytes("msgHash",Hu),validateSigVerOpts(Yu),pl&&(Hu=ensureBytes("prehashed msgHash",ul(Hu)));const Il=zu(Hu),dl=vu(ju),vl=[Wu(dl),Wu(Il)];if(ml!=null&&ml!==!1){const bl=ml===!0?Xu(Z.BYTES):ml;vl.push(ensureBytes("extraEntropy",bl))}const nl=concatBytes(...vl),el=Il;function yl(bl){const Mu=qu(bl);if(!_u(Mu))return;const Ru=Eu(Mu),Ou=Au.BASE.multiply(Mu).toAffine(),Vu=$u(Ou.x);if(Vu===_0n$1)return;const Gu=$u(Ru*$u(el+Vu*dl));if(Gu===_0n$1)return;let il=(Ou.x===Vu?0:2)|Number(Ou.y&_1n$1),ol=Gu;return al&&Su(Gu)&&(ol=Bu(Gu),il^=1),new Tu(Vu,ol,il)}return{seed:nl,k2sig:yl}}const wl={lowS:t.lowS,prehash:!1},hl={lowS:t.lowS,prehash:!1};function Qu(Hu,ju,Yu=wl){const{seed:ul,k2sig:Xu}=cl(Hu,ju,Yu),al=t;return createHmacDrbg(al.hash.outputLen,al.nByteLength,al.hmac)(ul,Xu)}Au.BASE._setWindowSize(8);function rl(Hu,ju,Yu,ul=hl){var il;const Xu=Hu;ju=ensureBytes("msgHash",ju),Yu=ensureBytes("publicKey",Yu);const{lowS:al,prehash:pl,format:ml}=ul;if(validateSigVerOpts(ul),"strict"in ul)throw new Error("options.strict was renamed to lowS");if(ml!==void 0&&ml!=="compact"&&ml!=="der")throw new Error("format must be compact or der");const Il=typeof Xu=="string"||isBytes$1(Xu),dl=!Il&&!ml&&typeof Xu=="object"&&Xu!==null&&typeof Xu.r=="bigint"&&typeof Xu.s=="bigint";if(!Il&&!dl)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let vl,nl;try{if(dl&&(vl=new Tu(Xu.r,Xu.s)),Il){try{ml!=="compact"&&(vl=Tu.fromDER(Xu))}catch(ol){if(!(ol instanceof DER.Err))throw ol}!vl&&ml!=="der"&&(vl=Tu.fromCompact(Xu))}nl=Au.fromHex(Yu)}catch{return!1}if(!vl||al&&vl.hasHighS())return!1;pl&&(ju=t.hash(ju));const{r:el,s:yl}=vl,bl=zu(ju),Mu=Eu(yl),Ru=$u(bl*Mu),Ou=$u(el*Mu),Vu=(il=Au.BASE.multiplyAndAddUnsafe(nl,Ru,Ou))==null?void 0:il.toAffine();return Vu?$u(Vu.x)===el:!1}return{CURVE:t,getPublicKey:Uu,getSharedSecret:Lu,sign:Qu,verify:rl,ProjectivePoint:Au,Signature:Tu,utils:Pu}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function getHash(F){return{hash:F,hmac:(t,...Z)=>hmac(F,t,concatBytes$1(...Z)),randomBytes}}function createCurve(F,t){const Z=at=>weierstrass({...F,...getHash(at)});return{...Z(t),create:Z}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2),divNearest=(F,t)=>(F+t/_2n)/t;function sqrtMod(F){const t=secp256k1P,Z=BigInt(3),at=BigInt(6),Hs=BigInt(11),zs=BigInt(22),Ys=BigInt(23),Zs=BigInt(44),$u=BigInt(88),Eu=F*F*F%t,Au=Eu*Eu*F%t,vu=pow2(Au,Z,t)*Au%t,Iu=pow2(vu,Z,t)*Au%t,_u=pow2(Iu,_2n,t)*Eu%t,Su=pow2(_u,Hs,t)*_u%t,Bu=pow2(Su,zs,t)*Su%t,Du=pow2(Bu,Zs,t)*Bu%t,Tu=pow2(Du,$u,t)*Du%t,Pu=pow2(Tu,Zs,t)*Bu%t,Uu=pow2(Pu,Z,t)*Au%t,Fu=pow2(Uu,Ys,t)*Su%t,Lu=pow2(Fu,at,t)*Eu%t,qu=pow2(Lu,_2n,t);if(!Fpk1.eql(Fpk1.sqr(qu),F))throw new Error("Cannot find square root");return qu}const Fpk1=Field(secp256k1P,void 0,void 0,{sqrt:sqrtMod}),secp256k1=createCurve({a:_0n,b:BigInt(7),Fp:Fpk1,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:F=>{const t=secp256k1N,Z=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),at=-_1n*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),Hs=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),zs=Z,Ys=BigInt("0x100000000000000000000000000000000"),Zs=divNearest(zs*F,t),$u=divNearest(-at*F,t);let Eu=mod(F-Zs*Z-$u*Hs,t),Au=mod(-Zs*at-$u*zs,t);const vu=Eu>Ys,Iu=Au>Ys;if(vu&&(Eu=t-Eu),Iu&&(Au=t-Au),Eu>Ys||Au>Ys)throw new Error("splitScalar: Endomorphism failed, k="+F);return{k1neg:vu,k1:Eu,k2neg:Iu,k2:Au}}}},sha256);function fromHex(F){if(F.length!==130&&F.length!==132)throw new InvalidSerializedSizeError({signature:F});const t=BigInt(slice(F,0,32)),Z=BigInt(slice(F,32,64)),at=(()=>{const Hs=+`0x${F.slice(130)}`;if(!Number.isNaN(Hs))try{return vToYParity(Hs)}catch{throw new InvalidYParityError({value:Hs})}})();return typeof at>"u"?{r:t,s:Z}:{r:t,s:Z,yParity:at}}function vToYParity(F){if(F===0||F===27)return 0;if(F===1||F===28)return 1;if(F>=35)return F%2===0?1:0;throw new InvalidVError({value:F})}class InvalidSerializedSizeError extends BaseError{constructor({signature:t}){super(`Value \`${t}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${size$1(from$4(t))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class InvalidYParityError extends BaseError{constructor({value:t}){super(`Value \`${t}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class InvalidVError extends BaseError{constructor({value:t}){super(`Value \`${t}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes(F){return F instanceof Uint8Array||ArrayBuffer.isView(F)&&F.constructor.name==="Uint8Array"}function isArrayOf(F,t){return Array.isArray(t)?t.length===0?!0:F?t.every(Z=>typeof Z=="string"):t.every(Z=>Number.isSafeInteger(Z)):!1}function astr(F,t){if(typeof t!="string")throw new Error(`${F}: string expected`);return!0}function anumber(F){if(!Number.isSafeInteger(F))throw new Error(`invalid integer: ${F}`)}function aArr(F){if(!Array.isArray(F))throw new Error("array expected")}function astrArr(F,t){if(!isArrayOf(!0,t))throw new Error(`${F}: array of strings expected`)}function anumArr(F,t){if(!isArrayOf(!1,t))throw new Error(`${F}: array of numbers expected`)}function chain(...F){const t=zs=>zs,Z=(zs,Ys)=>Zs=>zs(Ys(Zs)),at=F.map(zs=>zs.encode).reduceRight(Z,t),Hs=F.map(zs=>zs.decode).reduce(Z,t);return{encode:at,decode:Hs}}function alphabet$1(F){const t=typeof F=="string"?F.split(""):F,Z=t.length;astrArr("alphabet",t);const at=new Map(t.map((Hs,zs)=>[Hs,zs]));return{encode:Hs=>(aArr(Hs),Hs.map(zs=>{if(!Number.isSafeInteger(zs)||zs<0||zs>=Z)throw new Error(`alphabet.encode: digit index outside alphabet "${zs}". Allowed: ${F}`);return t[zs]})),decode:Hs=>(aArr(Hs),Hs.map(zs=>{astr("alphabet.decode",zs);const Ys=at.get(zs);if(Ys===void 0)throw new Error(`Unknown letter: "${zs}". Allowed: ${F}`);return Ys}))}}function join(F=""){return astr("join",F),{encode:t=>(astrArr("join.decode",t),t.join(F)),decode:t=>(astr("join.decode",t),t.split(F))}}function padding(F,t="="){return anumber(F),astr("padding",t),{encode(Z){for(astrArr("padding.encode",Z);Z.length*F%8;)Z.push(t);return Z},decode(Z){astrArr("padding.decode",Z);let at=Z.length;if(at*F%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;at>0&&Z[at-1]===t;at--)if((at-1)*F%8===0)throw new Error("padding: invalid, string has too much padding");return Z.slice(0,at)}}}const gcd=(F,t)=>t===0?F:gcd(t,F%t),radix2carry=(F,t)=>F+(t-gcd(F,t)),powers=(()=>{let F=[];for(let t=0;t<40;t++)F.push(2**t);return F})();function convertRadix2(F,t,Z,at){if(aArr(F),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(Z<=0||Z>32)throw new Error(`convertRadix2: wrong to=${Z}`);if(radix2carry(t,Z)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${Z} carryBits=${radix2carry(t,Z)}`);let Hs=0,zs=0;const Ys=powers[t],Zs=powers[Z]-1,$u=[];for(const Eu of F){if(anumber(Eu),Eu>=Ys)throw new Error(`convertRadix2: invalid data word=${Eu} from=${t}`);if(Hs=Hs<<t|Eu,zs+t>32)throw new Error(`convertRadix2: carry overflow pos=${zs} from=${t}`);for(zs+=t;zs>=Z;zs-=Z)$u.push((Hs>>zs-Z&Zs)>>>0);const Au=powers[zs];if(Au===void 0)throw new Error("invalid carry");Hs&=Au-1}if(Hs=Hs<<Z-zs&Zs,!at&&zs>=t)throw new Error("Excess padding");if(!at&&Hs>0)throw new Error(`Non-zero padding: ${Hs}`);return at&&zs>0&&$u.push(Hs>>>0),$u}function radix2(F,t=!1){if(anumber(F),F<=0||F>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,F)>32||radix2carry(F,8)>32)throw new Error("radix2: carry overflow");return{encode:Z=>{if(!isBytes(Z))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(Z),8,F,!t)},decode:Z=>(anumArr("radix2.decode",Z),Uint8Array.from(convertRadix2(Z,F,8,t)))}}const base32$2=chain(radix2(5),alphabet$1("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),padding(5),join(""));function recoverAddress(F){return fromPublicKey(recoverPublicKey(F))}function recoverPublicKey(F){const{payload:t,signature:Z}=F,{r:at,s:Hs,yParity:zs}=Z,Zs=new secp256k1.Signature(BigInt(at),BigInt(Hs)).addRecoveryBit(zs).recoverPublicKey(from$4(t).substring(2));return from$2(Zs)}function base$1(F){if(F.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let Eu=0;Eu<t.length;Eu++)t[Eu]=255;for(let Eu=0;Eu<F.length;Eu++){const Au=F.charAt(Eu),vu=Au.charCodeAt(0);if(t[vu]!==255)throw new TypeError(Au+" is ambiguous");t[vu]=Eu}const Z=F.length,at=F.charAt(0),Hs=Math.log(Z)/Math.log(256),zs=Math.log(256)/Math.log(Z);function Ys(Eu){if(Eu instanceof Uint8Array||(ArrayBuffer.isView(Eu)?Eu=new Uint8Array(Eu.buffer,Eu.byteOffset,Eu.byteLength):Array.isArray(Eu)&&(Eu=Uint8Array.from(Eu))),!(Eu instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Eu.length===0)return"";let Au=0,vu=0,Iu=0;const _u=Eu.length;for(;Iu!==_u&&Eu[Iu]===0;)Iu++,Au++;const Su=(_u-Iu)*zs+1>>>0,Bu=new Uint8Array(Su);for(;Iu!==_u;){let Pu=Eu[Iu],Uu=0;for(let Fu=Su-1;(Pu!==0||Uu<vu)&&Fu!==-1;Fu--,Uu++)Pu+=256*Bu[Fu]>>>0,Bu[Fu]=Pu%Z>>>0,Pu=Pu/Z>>>0;if(Pu!==0)throw new Error("Non-zero carry");vu=Uu,Iu++}let Du=Su-vu;for(;Du!==Su&&Bu[Du]===0;)Du++;let Tu=at.repeat(Au);for(;Du<Su;++Du)Tu+=F.charAt(Bu[Du]);return Tu}function Zs(Eu){if(typeof Eu!="string")throw new TypeError("Expected String");if(Eu.length===0)return new Uint8Array;let Au=0,vu=0,Iu=0;for(;Eu[Au]===at;)vu++,Au++;const _u=(Eu.length-Au)*Hs+1>>>0,Su=new Uint8Array(_u);for(;Au<Eu.length;){const Pu=Eu.charCodeAt(Au);if(Pu>255)return;let Uu=t[Pu];if(Uu===255)return;let Fu=0;for(let Lu=_u-1;(Uu!==0||Fu<Iu)&&Lu!==-1;Lu--,Fu++)Uu+=Z*Su[Lu]>>>0,Su[Lu]=Uu%256>>>0,Uu=Uu/256>>>0;if(Uu!==0)throw new Error("Non-zero carry");Iu=Fu,Au++}let Bu=_u-Iu;for(;Bu!==_u&&Su[Bu]===0;)Bu++;const Du=new Uint8Array(vu+(_u-Bu));let Tu=vu;for(;Bu!==_u;)Du[Tu++]=Su[Bu++];return Du}function $u(Eu){const Au=Zs(Eu);if(Au)return Au;throw new Error("Non-base"+Z+" character")}return{encode:Ys,decodeUnsafe:Zs,decode:$u}}var ALPHABET="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const ue=base$1(ALPHABET);function utf8Count(F){const t=F.length;let Z=0,at=0;for(;at<t;){let Hs=F.charCodeAt(at++);if(Hs&4294967168)if(!(Hs&4294965248))Z+=2;else{if(Hs>=55296&&Hs<=56319&&at<t){const zs=F.charCodeAt(at);(zs&64512)===56320&&(++at,Hs=((Hs&1023)<<10)+(zs&1023)+65536)}Hs&4294901760?Z+=4:Z+=3}else{Z++;continue}}return Z}function utf8EncodeJs(F,t,Z){const at=F.length;let Hs=Z,zs=0;for(;zs<at;){let Ys=F.charCodeAt(zs++);if(Ys&4294967168)if(!(Ys&4294965248))t[Hs++]=Ys>>6&31|192;else{if(Ys>=55296&&Ys<=56319&&zs<at){const Zs=F.charCodeAt(zs);(Zs&64512)===56320&&(++zs,Ys=((Ys&1023)<<10)+(Zs&1023)+65536)}Ys&4294901760?(t[Hs++]=Ys>>18&7|240,t[Hs++]=Ys>>12&63|128,t[Hs++]=Ys>>6&63|128):(t[Hs++]=Ys>>12&15|224,t[Hs++]=Ys>>6&63|128)}else{t[Hs++]=Ys;continue}t[Hs++]=Ys&63|128}}const sharedTextEncoder=new TextEncoder,TEXT_ENCODER_THRESHOLD=50;function utf8EncodeTE(F,t,Z){sharedTextEncoder.encodeInto(F,t.subarray(Z))}function utf8Encode(F,t,Z){F.length>TEXT_ENCODER_THRESHOLD?utf8EncodeTE(F,t,Z):utf8EncodeJs(F,t,Z)}const CHUNK_SIZE=4096;function utf8DecodeJs(F,t,Z){let at=t;const Hs=at+Z,zs=[];let Ys="";for(;at<Hs;){const Zs=F[at++];if(!(Zs&128))zs.push(Zs);else if((Zs&224)===192){const $u=F[at++]&63;zs.push((Zs&31)<<6|$u)}else if((Zs&240)===224){const $u=F[at++]&63,Eu=F[at++]&63;zs.push((Zs&31)<<12|$u<<6|Eu)}else if((Zs&248)===240){const $u=F[at++]&63,Eu=F[at++]&63,Au=F[at++]&63;let vu=(Zs&7)<<18|$u<<12|Eu<<6|Au;vu>65535&&(vu-=65536,zs.push(vu>>>10&1023|55296),vu=56320|vu&1023),zs.push(vu)}else zs.push(Zs);zs.length>=CHUNK_SIZE&&(Ys+=String.fromCharCode(...zs),zs.length=0)}return zs.length>0&&(Ys+=String.fromCharCode(...zs)),Ys}const sharedTextDecoder=new TextDecoder,TEXT_DECODER_THRESHOLD=200;function utf8DecodeTD(F,t,Z){const at=F.subarray(t,t+Z);return sharedTextDecoder.decode(at)}function utf8Decode(F,t,Z){return Z>TEXT_DECODER_THRESHOLD?utf8DecodeTD(F,t,Z):utf8DecodeJs(F,t,Z)}class ExtData{constructor(t,Z){this.type=t,this.data=Z}}class DecodeError extends Error{constructor(t){super(t);const Z=Object.create(DecodeError.prototype);Object.setPrototypeOf(this,Z),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:DecodeError.name})}}const UINT32_MAX=4294967295;function setUint64(F,t,Z){const at=Z/4294967296,Hs=Z;F.setUint32(t,at),F.setUint32(t+4,Hs)}function setInt64(F,t,Z){const at=Math.floor(Z/4294967296),Hs=Z;F.setUint32(t,at),F.setUint32(t+4,Hs)}function getInt64(F,t){const Z=F.getInt32(t),at=F.getUint32(t+4);return Z*4294967296+at}function getUint64(F,t){const Z=F.getUint32(t),at=F.getUint32(t+4);return Z*4294967296+at}const EXT_TIMESTAMP=-1,TIMESTAMP32_MAX_SEC=4294967296-1,TIMESTAMP64_MAX_SEC=17179869184-1;function encodeTimeSpecToTimestamp({sec:F,nsec:t}){if(F>=0&&t>=0&&F<=TIMESTAMP64_MAX_SEC)if(t===0&&F<=TIMESTAMP32_MAX_SEC){const Z=new Uint8Array(4);return new DataView(Z.buffer).setUint32(0,F),Z}else{const Z=F/4294967296,at=F&4294967295,Hs=new Uint8Array(8),zs=new DataView(Hs.buffer);return zs.setUint32(0,t<<2|Z&3),zs.setUint32(4,at),Hs}else{const Z=new Uint8Array(12),at=new DataView(Z.buffer);return at.setUint32(0,t),setInt64(at,4,F),Z}}function encodeDateToTimeSpec(F){const t=F.getTime(),Z=Math.floor(t/1e3),at=(t-Z*1e3)*1e6,Hs=Math.floor(at/1e9);return{sec:Z+Hs,nsec:at-Hs*1e9}}function encodeTimestampExtension(F){if(F instanceof Date){const t=encodeDateToTimeSpec(F);return encodeTimeSpecToTimestamp(t)}else return null}function decodeTimestampToTimeSpec(F){const t=new DataView(F.buffer,F.byteOffset,F.byteLength);switch(F.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{const Z=t.getUint32(0),at=t.getUint32(4),Hs=(Z&3)*4294967296+at,zs=Z>>>2;return{sec:Hs,nsec:zs}}case 12:{const Z=getInt64(t,4),at=t.getUint32(0);return{sec:Z,nsec:at}}default:throw new DecodeError(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${F.length}`)}}function decodeTimestampExtension(F){const t=decodeTimestampToTimeSpec(F);return new Date(t.sec*1e3+t.nsec/1e6)}const timestampExtension={type:EXT_TIMESTAMP,encode:encodeTimestampExtension,decode:decodeTimestampExtension};class ExtensionCodec{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(timestampExtension)}register({type:t,encode:Z,decode:at}){if(t>=0)this.encoders[t]=Z,this.decoders[t]=at;else{const Hs=-1-t;this.builtInEncoders[Hs]=Z,this.builtInDecoders[Hs]=at}}tryToEncode(t,Z){for(let at=0;at<this.builtInEncoders.length;at++){const Hs=this.builtInEncoders[at];if(Hs!=null){const zs=Hs(t,Z);if(zs!=null){const Ys=-1-at;return new ExtData(Ys,zs)}}}for(let at=0;at<this.encoders.length;at++){const Hs=this.encoders[at];if(Hs!=null){const zs=Hs(t,Z);if(zs!=null){const Ys=at;return new ExtData(Ys,zs)}}}return t instanceof ExtData?t:null}decode(t,Z,at){const Hs=Z<0?this.builtInDecoders[-1-Z]:this.decoders[Z];return Hs?Hs(t,Z,at):new ExtData(Z,t)}}ExtensionCodec.defaultCodec=new ExtensionCodec;function isArrayBufferLike(F){return F instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&F instanceof SharedArrayBuffer}function ensureUint8Array(F){return F instanceof Uint8Array?F:ArrayBuffer.isView(F)?new Uint8Array(F.buffer,F.byteOffset,F.byteLength):isArrayBufferLike(F)?new Uint8Array(F):Uint8Array.from(F)}const DEFAULT_MAX_DEPTH=100,DEFAULT_INITIAL_BUFFER_SIZE=2048;let Encoder$1=class $h{constructor(t){this.entered=!1,this.extensionCodec=(t==null?void 0:t.extensionCodec)??ExtensionCodec.defaultCodec,this.context=t==null?void 0:t.context,this.useBigInt64=(t==null?void 0:t.useBigInt64)??!1,this.maxDepth=(t==null?void 0:t.maxDepth)??DEFAULT_MAX_DEPTH,this.initialBufferSize=(t==null?void 0:t.initialBufferSize)??DEFAULT_INITIAL_BUFFER_SIZE,this.sortKeys=(t==null?void 0:t.sortKeys)??!1,this.forceFloat32=(t==null?void 0:t.forceFloat32)??!1,this.ignoreUndefined=(t==null?void 0:t.ignoreUndefined)??!1,this.forceIntegerToFloat=(t==null?void 0:t.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new $h({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(t){if(this.entered)return this.clone().encodeSharedRef(t);try{return this.entered=!0,this.reinitializeState(),this.doEncode(t,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(t){if(this.entered)return this.clone().encode(t);try{return this.entered=!0,this.reinitializeState(),this.doEncode(t,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(t,Z){if(Z>this.maxDepth)throw new Error(`Too deep objects in depth ${Z}`);t==null?this.encodeNil():typeof t=="boolean"?this.encodeBoolean(t):typeof t=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(t):this.encodeNumber(t):typeof t=="string"?this.encodeString(t):this.useBigInt64&&typeof t=="bigint"?this.encodeBigInt64(t):this.encodeObject(t,Z)}ensureBufferSizeToWrite(t){const Z=this.pos+t;this.view.byteLength<Z&&this.resizeBuffer(Z*2)}resizeBuffer(t){const Z=new ArrayBuffer(t),at=new Uint8Array(Z),Hs=new DataView(Z);at.set(this.bytes),this.view=Hs,this.bytes=at}encodeNil(){this.writeU8(192)}encodeBoolean(t){t===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(t){!this.forceIntegerToFloat&&Number.isSafeInteger(t)?t>=0?t<128?this.writeU8(t):t<256?(this.writeU8(204),this.writeU8(t)):t<65536?(this.writeU8(205),this.writeU16(t)):t<4294967296?(this.writeU8(206),this.writeU32(t)):this.useBigInt64?this.encodeNumberAsFloat(t):(this.writeU8(207),this.writeU64(t)):t>=-32?this.writeU8(224|t+32):t>=-128?(this.writeU8(208),this.writeI8(t)):t>=-32768?(this.writeU8(209),this.writeI16(t)):t>=-2147483648?(this.writeU8(210),this.writeI32(t)):this.useBigInt64?this.encodeNumberAsFloat(t):(this.writeU8(211),this.writeI64(t)):this.encodeNumberAsFloat(t)}encodeNumberAsFloat(t){this.forceFloat32?(this.writeU8(202),this.writeF32(t)):(this.writeU8(203),this.writeF64(t))}encodeBigInt64(t){t>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(t)):(this.writeU8(211),this.writeBigInt64(t))}writeStringHeader(t){if(t<32)this.writeU8(160+t);else if(t<256)this.writeU8(217),this.writeU8(t);else if(t<65536)this.writeU8(218),this.writeU16(t);else if(t<4294967296)this.writeU8(219),this.writeU32(t);else throw new Error(`Too long string: ${t} bytes in UTF-8`)}encodeString(t){const at=utf8Count(t);this.ensureBufferSizeToWrite(5+at),this.writeStringHeader(at),utf8Encode(t,this.bytes,this.pos),this.pos+=at}encodeObject(t,Z){const at=this.extensionCodec.tryToEncode(t,this.context);if(at!=null)this.encodeExtension(at);else if(Array.isArray(t))this.encodeArray(t,Z);else if(ArrayBuffer.isView(t))this.encodeBinary(t);else if(typeof t=="object")this.encodeMap(t,Z);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(t)}`)}encodeBinary(t){const Z=t.byteLength;if(Z<256)this.writeU8(196),this.writeU8(Z);else if(Z<65536)this.writeU8(197),this.writeU16(Z);else if(Z<4294967296)this.writeU8(198),this.writeU32(Z);else throw new Error(`Too large binary: ${Z}`);const at=ensureUint8Array(t);this.writeU8a(at)}encodeArray(t,Z){const at=t.length;if(at<16)this.writeU8(144+at);else if(at<65536)this.writeU8(220),this.writeU16(at);else if(at<4294967296)this.writeU8(221),this.writeU32(at);else throw new Error(`Too large array: ${at}`);for(const Hs of t)this.doEncode(Hs,Z+1)}countWithoutUndefined(t,Z){let at=0;for(const Hs of Z)t[Hs]!==void 0&&at++;return at}encodeMap(t,Z){const at=Object.keys(t);this.sortKeys&&at.sort();const Hs=this.ignoreUndefined?this.countWithoutUndefined(t,at):at.length;if(Hs<16)this.writeU8(128+Hs);else if(Hs<65536)this.writeU8(222),this.writeU16(Hs);else if(Hs<4294967296)this.writeU8(223),this.writeU32(Hs);else throw new Error(`Too large map object: ${Hs}`);for(const zs of at){const Ys=t[zs];this.ignoreUndefined&&Ys===void 0||(this.encodeString(zs),this.doEncode(Ys,Z+1))}}encodeExtension(t){if(typeof t.data=="function"){const at=t.data(this.pos+6),Hs=at.length;if(Hs>=4294967296)throw new Error(`Too large extension object: ${Hs}`);this.writeU8(201),this.writeU32(Hs),this.writeI8(t.type),this.writeU8a(at);return}const Z=t.data.length;if(Z===1)this.writeU8(212);else if(Z===2)this.writeU8(213);else if(Z===4)this.writeU8(214);else if(Z===8)this.writeU8(215);else if(Z===16)this.writeU8(216);else if(Z<256)this.writeU8(199),this.writeU8(Z);else if(Z<65536)this.writeU8(200),this.writeU16(Z);else if(Z<4294967296)this.writeU8(201),this.writeU32(Z);else throw new Error(`Too large extension object: ${Z}`);this.writeI8(t.type),this.writeU8a(t.data)}writeU8(t){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,t),this.pos++}writeU8a(t){const Z=t.length;this.ensureBufferSizeToWrite(Z),this.bytes.set(t,this.pos),this.pos+=Z}writeI8(t){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,t),this.pos++}writeU16(t){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,t),this.pos+=2}writeI16(t){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,t),this.pos+=2}writeU32(t){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,t),this.pos+=4}writeI32(t){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,t),this.pos+=4}writeF32(t){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,t),this.pos+=4}writeF64(t){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,t),this.pos+=8}writeU64(t){this.ensureBufferSizeToWrite(8),setUint64(this.view,this.pos,t),this.pos+=8}writeI64(t){this.ensureBufferSizeToWrite(8),setInt64(this.view,this.pos,t),this.pos+=8}writeBigUint64(t){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,t),this.pos+=8}writeBigInt64(t){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,t),this.pos+=8}};function encode$2(F,t){return new Encoder$1(t).encodeSharedRef(F)}function prettyByte(F){return`${F<0?"-":""}0x${Math.abs(F).toString(16).padStart(2,"0")}`}const DEFAULT_MAX_KEY_LENGTH=16,DEFAULT_MAX_LENGTH_PER_KEY=16;class CachedKeyDecoder{constructor(t=DEFAULT_MAX_KEY_LENGTH,Z=DEFAULT_MAX_LENGTH_PER_KEY){this.hit=0,this.miss=0,this.maxKeyLength=t,this.maxLengthPerKey=Z,this.caches=[];for(let at=0;at<this.maxKeyLength;at++)this.caches.push([])}canBeCached(t){return t>0&&t<=this.maxKeyLength}find(t,Z,at){const Hs=this.caches[at-1];e:for(const zs of Hs){const Ys=zs.bytes;for(let Zs=0;Zs<at;Zs++)if(Ys[Zs]!==t[Z+Zs])continue e;return zs.str}return null}store(t,Z){const at=this.caches[t.length-1],Hs={bytes:t,str:Z};at.length>=this.maxLengthPerKey?at[Math.random()*at.length|0]=Hs:at.push(Hs)}decode(t,Z,at){const Hs=this.find(t,Z,at);if(Hs!=null)return this.hit++,Hs;this.miss++;const zs=utf8DecodeJs(t,Z,at),Ys=Uint8Array.prototype.slice.call(t,Z,Z+at);return this.store(Ys,zs),zs}}const STATE_ARRAY="array",STATE_MAP_KEY="map_key",STATE_MAP_VALUE="map_value",mapKeyConverter=F=>{if(typeof F=="string"||typeof F=="number")return F;throw new DecodeError("The type of key must be string or number but "+typeof F)};class StackPool{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(t){const Z=this.getUninitializedStateFromPool();Z.type=STATE_ARRAY,Z.position=0,Z.size=t,Z.array=new Array(t)}pushMapState(t){const Z=this.getUninitializedStateFromPool();Z.type=STATE_MAP_KEY,Z.readCount=0,Z.size=t,Z.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const t={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(t)}return this.stack[this.stackHeadPosition]}release(t){if(this.stack[this.stackHeadPosition]!==t)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(t.type===STATE_ARRAY){const at=t;at.size=0,at.array=void 0,at.position=0,at.type=void 0}if(t.type===STATE_MAP_KEY||t.type===STATE_MAP_VALUE){const at=t;at.size=0,at.map=void 0,at.readCount=0,at.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const HEAD_BYTE_REQUIRED=-1,EMPTY_VIEW=new DataView(new ArrayBuffer(0)),EMPTY_BYTES=new Uint8Array(EMPTY_VIEW.buffer);try{EMPTY_VIEW.getInt8(0)}catch(F){if(!(F instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const MORE_DATA=new RangeError("Insufficient data"),sharedCachedKeyDecoder=new CachedKeyDecoder;let Decoder$1=class Ah{constructor(t){this.totalPos=0,this.pos=0,this.view=EMPTY_VIEW,this.bytes=EMPTY_BYTES,this.headByte=HEAD_BYTE_REQUIRED,this.stack=new StackPool,this.entered=!1,this.extensionCodec=(t==null?void 0:t.extensionCodec)??ExtensionCodec.defaultCodec,this.context=t==null?void 0:t.context,this.useBigInt64=(t==null?void 0:t.useBigInt64)??!1,this.rawStrings=(t==null?void 0:t.rawStrings)??!1,this.maxStrLength=(t==null?void 0:t.maxStrLength)??UINT32_MAX,this.maxBinLength=(t==null?void 0:t.maxBinLength)??UINT32_MAX,this.maxArrayLength=(t==null?void 0:t.maxArrayLength)??UINT32_MAX,this.maxMapLength=(t==null?void 0:t.maxMapLength)??UINT32_MAX,this.maxExtLength=(t==null?void 0:t.maxExtLength)??UINT32_MAX,this.keyDecoder=(t==null?void 0:t.keyDecoder)!==void 0?t.keyDecoder:sharedCachedKeyDecoder,this.mapKeyConverter=(t==null?void 0:t.mapKeyConverter)??mapKeyConverter}clone(){return new Ah({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=HEAD_BYTE_REQUIRED,this.stack.reset()}setBuffer(t){const Z=ensureUint8Array(t);this.bytes=Z,this.view=new DataView(Z.buffer,Z.byteOffset,Z.byteLength),this.pos=0}appendBuffer(t){if(this.headByte===HEAD_BYTE_REQUIRED&&!this.hasRemaining(1))this.setBuffer(t);else{const Z=this.bytes.subarray(this.pos),at=ensureUint8Array(t),Hs=new Uint8Array(Z.length+at.length);Hs.set(Z),Hs.set(at,Z.length),this.setBuffer(Hs)}}hasRemaining(t){return this.view.byteLength-this.pos>=t}createExtraByteError(t){const{view:Z,pos:at}=this;return new RangeError(`Extra ${Z.byteLength-at} of ${Z.byteLength} byte(s) found at buffer[${t}]`)}decode(t){if(this.entered)return this.clone().decode(t);try{this.entered=!0,this.reinitializeState(),this.setBuffer(t);const Z=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return Z}finally{this.entered=!1}}*decodeMulti(t){if(this.entered){yield*this.clone().decodeMulti(t);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(t);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(t){if(this.entered)return this.clone().decodeAsync(t);try{this.entered=!0;let Z=!1,at;for await(const Zs of t){if(Z)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(Zs);try{at=this.doDecodeSync(),Z=!0}catch($u){if(!($u instanceof RangeError))throw $u}this.totalPos+=this.pos}if(Z){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return at}const{headByte:Hs,pos:zs,totalPos:Ys}=this;throw new RangeError(`Insufficient data in parsing ${prettyByte(Hs)} at ${Ys} (${zs} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(t){return this.decodeMultiAsync(t,!0)}decodeStream(t){return this.decodeMultiAsync(t,!1)}async*decodeMultiAsync(t,Z){if(this.entered){yield*this.clone().decodeMultiAsync(t,Z);return}try{this.entered=!0;let at=Z,Hs=-1;for await(const zs of t){if(Z&&Hs===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(zs),at&&(Hs=this.readArraySize(),at=!1,this.complete());try{for(;yield this.doDecodeSync(),--Hs!==0;);}catch(Ys){if(!(Ys instanceof RangeError))throw Ys}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const t=this.readHeadByte();let Z;if(t>=224)Z=t-256;else if(t<192)if(t<128)Z=t;else if(t<144){const Hs=t-128;if(Hs!==0){this.pushMapState(Hs),this.complete();continue e}else Z={}}else if(t<160){const Hs=t-144;if(Hs!==0){this.pushArrayState(Hs),this.complete();continue e}else Z=[]}else{const Hs=t-160;Z=this.decodeString(Hs,0)}else if(t===192)Z=null;else if(t===194)Z=!1;else if(t===195)Z=!0;else if(t===202)Z=this.readF32();else if(t===203)Z=this.readF64();else if(t===204)Z=this.readU8();else if(t===205)Z=this.readU16();else if(t===206)Z=this.readU32();else if(t===207)this.useBigInt64?Z=this.readU64AsBigInt():Z=this.readU64();else if(t===208)Z=this.readI8();else if(t===209)Z=this.readI16();else if(t===210)Z=this.readI32();else if(t===211)this.useBigInt64?Z=this.readI64AsBigInt():Z=this.readI64();else if(t===217){const Hs=this.lookU8();Z=this.decodeString(Hs,1)}else if(t===218){const Hs=this.lookU16();Z=this.decodeString(Hs,2)}else if(t===219){const Hs=this.lookU32();Z=this.decodeString(Hs,4)}else if(t===220){const Hs=this.readU16();if(Hs!==0){this.pushArrayState(Hs),this.complete();continue e}else Z=[]}else if(t===221){const Hs=this.readU32();if(Hs!==0){this.pushArrayState(Hs),this.complete();continue e}else Z=[]}else if(t===222){const Hs=this.readU16();if(Hs!==0){this.pushMapState(Hs),this.complete();continue e}else Z={}}else if(t===223){const Hs=this.readU32();if(Hs!==0){this.pushMapState(Hs),this.complete();continue e}else Z={}}else if(t===196){const Hs=this.lookU8();Z=this.decodeBinary(Hs,1)}else if(t===197){const Hs=this.lookU16();Z=this.decodeBinary(Hs,2)}else if(t===198){const Hs=this.lookU32();Z=this.decodeBinary(Hs,4)}else if(t===212)Z=this.decodeExtension(1,0);else if(t===213)Z=this.decodeExtension(2,0);else if(t===214)Z=this.decodeExtension(4,0);else if(t===215)Z=this.decodeExtension(8,0);else if(t===216)Z=this.decodeExtension(16,0);else if(t===199){const Hs=this.lookU8();Z=this.decodeExtension(Hs,1)}else if(t===200){const Hs=this.lookU16();Z=this.decodeExtension(Hs,2)}else if(t===201){const Hs=this.lookU32();Z=this.decodeExtension(Hs,4)}else throw new DecodeError(`Unrecognized type byte: ${prettyByte(t)}`);this.complete();const at=this.stack;for(;at.length>0;){const Hs=at.top();if(Hs.type===STATE_ARRAY)if(Hs.array[Hs.position]=Z,Hs.position++,Hs.position===Hs.size)Z=Hs.array,at.release(Hs);else continue e;else if(Hs.type===STATE_MAP_KEY){if(Z==="__proto__")throw new DecodeError("The key __proto__ is not allowed");Hs.key=this.mapKeyConverter(Z),Hs.type=STATE_MAP_VALUE;continue e}else if(Hs.map[Hs.key]=Z,Hs.readCount++,Hs.readCount===Hs.size)Z=Hs.map,at.release(Hs);else{Hs.key=null,Hs.type=STATE_MAP_KEY;continue e}}return Z}}readHeadByte(){return this.headByte===HEAD_BYTE_REQUIRED&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=HEAD_BYTE_REQUIRED}readArraySize(){const t=this.readHeadByte();switch(t){case 220:return this.readU16();case 221:return this.readU32();default:{if(t<160)return t-144;throw new DecodeError(`Unrecognized array type byte: ${prettyByte(t)}`)}}}pushMapState(t){if(t>this.maxMapLength)throw new DecodeError(`Max length exceeded: map length (${t}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(t)}pushArrayState(t){if(t>this.maxArrayLength)throw new DecodeError(`Max length exceeded: array length (${t}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(t)}decodeString(t,Z){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(t,Z):this.decodeBinary(t,Z)}decodeUtf8String(t,Z){var zs;if(t>this.maxStrLength)throw new DecodeError(`Max length exceeded: UTF-8 byte length (${t}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+Z+t)throw MORE_DATA;const at=this.pos+Z;let Hs;return this.stateIsMapKey()&&((zs=this.keyDecoder)!=null&&zs.canBeCached(t))?Hs=this.keyDecoder.decode(this.bytes,at,t):Hs=utf8Decode(this.bytes,at,t),this.pos+=Z+t,Hs}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===STATE_MAP_KEY:!1}decodeBinary(t,Z){if(t>this.maxBinLength)throw new DecodeError(`Max length exceeded: bin length (${t}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(t+Z))throw MORE_DATA;const at=this.pos+Z,Hs=this.bytes.subarray(at,at+t);return this.pos+=Z+t,Hs}decodeExtension(t,Z){if(t>this.maxExtLength)throw new DecodeError(`Max length exceeded: ext length (${t}) > maxExtLength (${this.maxExtLength})`);const at=this.view.getInt8(this.pos+Z),Hs=this.decodeBinary(t,Z+1);return this.extensionCodec.decode(Hs,at,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const t=this.view.getUint8(this.pos);return this.pos++,t}readI8(){const t=this.view.getInt8(this.pos);return this.pos++,t}readU16(){const t=this.view.getUint16(this.pos);return this.pos+=2,t}readI16(){const t=this.view.getInt16(this.pos);return this.pos+=2,t}readU32(){const t=this.view.getUint32(this.pos);return this.pos+=4,t}readI32(){const t=this.view.getInt32(this.pos);return this.pos+=4,t}readU64(){const t=getUint64(this.view,this.pos);return this.pos+=8,t}readI64(){const t=getInt64(this.view,this.pos);return this.pos+=8,t}readU64AsBigInt(){const t=this.view.getBigUint64(this.pos);return this.pos+=8,t}readI64AsBigInt(){const t=this.view.getBigInt64(this.pos);return this.pos+=8,t}readF32(){const t=this.view.getFloat32(this.pos);return this.pos+=4,t}readF64(){const t=this.view.getFloat64(this.pos);return this.pos+=8,t}};function decode$2(F,t){return new Decoder$1(t).decode(F)}function asUint8Array(F){return globalThis.Buffer!=null?new Uint8Array(F.buffer,F.byteOffset,F.byteLength):F}function allocUnsafe(F=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?asUint8Array(globalThis.Buffer.allocUnsafe(F)):new Uint8Array(F)}function concat(F,t){t||(t=F.reduce((Hs,zs)=>Hs+zs.length,0));const Z=allocUnsafe(t);let at=0;for(const Hs of F)Z.set(Hs,at),at+=Hs.length;return asUint8Array(Z)}function base(F,t){if(F.length>=255)throw new TypeError("Alphabet too long");for(var Z=new Uint8Array(256),at=0;at<Z.length;at++)Z[at]=255;for(var Hs=0;Hs<F.length;Hs++){var zs=F.charAt(Hs),Ys=zs.charCodeAt(0);if(Z[Ys]!==255)throw new TypeError(zs+" is ambiguous");Z[Ys]=Hs}var Zs=F.length,$u=F.charAt(0),Eu=Math.log(Zs)/Math.log(256),Au=Math.log(256)/Math.log(Zs);function vu(Su){if(Su instanceof Uint8Array||(ArrayBuffer.isView(Su)?Su=new Uint8Array(Su.buffer,Su.byteOffset,Su.byteLength):Array.isArray(Su)&&(Su=Uint8Array.from(Su))),!(Su instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Su.length===0)return"";for(var Bu=0,Du=0,Tu=0,Pu=Su.length;Tu!==Pu&&Su[Tu]===0;)Tu++,Bu++;for(var Uu=(Pu-Tu)*Au+1>>>0,Fu=new Uint8Array(Uu);Tu!==Pu;){for(var Lu=Su[Tu],qu=0,zu=Uu-1;(Lu!==0||qu<Du)&&zu!==-1;zu--,qu++)Lu+=256*Fu[zu]>>>0,Fu[zu]=Lu%Zs>>>0,Lu=Lu/Zs>>>0;if(Lu!==0)throw new Error("Non-zero carry");Du=qu,Tu++}for(var tl=Uu-Du;tl!==Uu&&Fu[tl]===0;)tl++;for(var Wu=$u.repeat(Bu);tl<Uu;++tl)Wu+=F.charAt(Fu[tl]);return Wu}function Iu(Su){if(typeof Su!="string")throw new TypeError("Expected String");if(Su.length===0)return new Uint8Array;var Bu=0;if(Su[Bu]!==" "){for(var Du=0,Tu=0;Su[Bu]===$u;)Du++,Bu++;for(var Pu=(Su.length-Bu)*Eu+1>>>0,Uu=new Uint8Array(Pu);Su[Bu];){var Fu=Z[Su.charCodeAt(Bu)];if(Fu===255)return;for(var Lu=0,qu=Pu-1;(Fu!==0||Lu<Tu)&&qu!==-1;qu--,Lu++)Fu+=Zs*Uu[qu]>>>0,Uu[qu]=Fu%256>>>0,Fu=Fu/256>>>0;if(Fu!==0)throw new Error("Non-zero carry");Tu=Lu,Bu++}if(Su[Bu]!==" "){for(var zu=Pu-Tu;zu!==Pu&&Uu[zu]===0;)zu++;for(var tl=new Uint8Array(Du+(Pu-zu)),Wu=Du;zu!==Pu;)tl[Wu++]=Uu[zu++];return tl}}}function _u(Su){var Bu=Iu(Su);if(Bu)return Bu;throw new Error(`Non-${t} character`)}return{encode:vu,decodeUnsafe:Iu,decode:_u}}var src=base,_brrp__multiformats_scope_baseX=src;const coerce=F=>{if(F instanceof Uint8Array&&F.constructor.name==="Uint8Array")return F;if(F instanceof ArrayBuffer)return new Uint8Array(F);if(ArrayBuffer.isView(F))return new Uint8Array(F.buffer,F.byteOffset,F.byteLength);throw new Error("Unknown type, must be binary type")},fromString$1=F=>new TextEncoder().encode(F),toString$1=F=>new TextDecoder().decode(F);class Encoder{constructor(t,Z,at){this.name=t,this.prefix=Z,this.baseEncode=at}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Decoder{constructor(t,Z,at){if(this.name=t,this.prefix=Z,Z.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=Z.codePointAt(0),this.baseDecode=at}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return or$2(this,t)}}class ComposedDecoder{constructor(t){this.decoders=t}or(t){return or$2(this,t)}decode(t){const Z=t[0],at=this.decoders[Z];if(at)return at.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const or$2=(F,t)=>new ComposedDecoder({...F.decoders||{[F.prefix]:F},...t.decoders||{[t.prefix]:t}});class Codec{constructor(t,Z,at,Hs){this.name=t,this.prefix=Z,this.baseEncode=at,this.baseDecode=Hs,this.encoder=new Encoder(t,Z,at),this.decoder=new Decoder(t,Z,Hs)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const from=({name:F,prefix:t,encode:Z,decode:at})=>new Codec(F,t,Z,at),baseX=({prefix:F,name:t,alphabet:Z})=>{const{encode:at,decode:Hs}=_brrp__multiformats_scope_baseX(Z,t);return from({prefix:F,name:t,encode:at,decode:zs=>coerce(Hs(zs))})},decode$1=(F,t,Z,at)=>{const Hs={};for(let Au=0;Au<t.length;++Au)Hs[t[Au]]=Au;let zs=F.length;for(;F[zs-1]==="=";)--zs;const Ys=new Uint8Array(zs*Z/8|0);let Zs=0,$u=0,Eu=0;for(let Au=0;Au<zs;++Au){const vu=Hs[F[Au]];if(vu===void 0)throw new SyntaxError(`Non-${at} character`);$u=$u<<Z|vu,Zs+=Z,Zs>=8&&(Zs-=8,Ys[Eu++]=255&$u>>Zs)}if(Zs>=Z||255&$u<<8-Zs)throw new SyntaxError("Unexpected end of data");return Ys},encode$1=(F,t,Z)=>{const at=t[t.length-1]==="=",Hs=(1<<Z)-1;let zs="",Ys=0,Zs=0;for(let $u=0;$u<F.length;++$u)for(Zs=Zs<<8|F[$u],Ys+=8;Ys>Z;)Ys-=Z,zs+=t[Hs&Zs>>Ys];if(Ys&&(zs+=t[Hs&Zs<<Z-Ys]),at)for(;zs.length*Z&7;)zs+="=";return zs},rfc4648=({name:F,prefix:t,bitsPerChar:Z,alphabet:at})=>from({prefix:t,name:F,encode(Hs){return encode$1(Hs,at,Z)},decode(Hs){return decode$1(Hs,at,Z,F)}}),identity=from({prefix:"\0",name:"identity",encode:F=>toString$1(F),decode:F=>fromString$1(F)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity},Symbol.toStringTag,{value:"Module"})),base2=rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2},Symbol.toStringTag,{value:"Module"})),base8=rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8},Symbol.toStringTag,{value:"Module"})),base10=baseX({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16,base16upper},Symbol.toStringTag,{value:"Module"})),base32=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$1=Object.freeze(Object.defineProperty({__proto__:null,base32,base32hex,base32hexpad,base32hexpadupper,base32hexupper,base32pad,base32padupper,base32upper,base32z},Symbol.toStringTag,{value:"Module"})),base36=baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36,base36upper},Symbol.toStringTag,{value:"Module"})),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc,base58flickr},Symbol.toStringTag,{value:"Module"})),base64$1=rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$2=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$1,base64pad,base64url,base64urlpad},Symbol.toStringTag,{value:"Module"})),alphabet=Array.from(""),alphabetBytesToChars=alphabet.reduce((F,t,Z)=>(F[Z]=t,F),[]),alphabetCharsToBytes=alphabet.reduce((F,t,Z)=>(F[t.codePointAt(0)]=Z,F),[]);function encode(F){return F.reduce((t,Z)=>(t+=alphabetBytesToChars[Z],t),"")}function decode(F){const t=[];for(const Z of F){const at=alphabetCharsToBytes[Z.codePointAt(0)];if(at===void 0)throw new Error(`Non-base256emoji character: ${Z}`);t.push(at)}return new Uint8Array(t)}const base256emoji=from({prefix:"",name:"base256emoji",encode,decode}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$1,...base36$1,...base58,...base64$2,...base256emoji$1};function createCodec(F,t,Z,at){return{name:F,prefix:t,encoder:{name:F,prefix:t,encode:Z},decoder:{decode:at}}}const string=createCodec("utf8","u",F=>"u"+new TextDecoder("utf8").decode(F),F=>new TextEncoder().encode(F.substring(1))),ascii=createCodec("ascii","a",F=>{let t="a";for(let Z=0;Z<F.length;Z++)t+=String.fromCharCode(F[Z]);return t},F=>{F=F.substring(1);const t=allocUnsafe(F.length);for(let Z=0;Z<F.length;Z++)t[Z]=F.charCodeAt(Z);return t}),BASES={utf8:string,"utf-8":string,hex:bases.base16,latin1:ascii,ascii,binary:ascii,...bases};function fromString(F,t="utf8"){const Z=BASES[t];if(!Z)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array(globalThis.Buffer.from(F,"utf-8")):Z.decoder.decode(`${Z.prefix}${F}`)}function toString(F,t="utf8"){const Z=BASES[t];if(!Z)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(F.buffer,F.byteOffset,F.byteLength).toString("utf8"):Z.encoder.encode(F).substring(1)}const C$1={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},ERROR_MSG_INPUT="Input must be an string, Buffer or Uint8Array";function normalizeInput(F){let t;if(F instanceof Uint8Array)t=F;else if(typeof F=="string")t=new TextEncoder().encode(F);else throw new Error(ERROR_MSG_INPUT);return t}function toHex$2(F){return Array.prototype.map.call(F,function(t){return(t<16?"0":"")+t.toString(16)}).join("")}function uint32ToHex(F){return(4294967296+F).toString(16).substring(1)}function debugPrint(F,t,Z){let at=`
`+F+" = ";for(let Hs=0;Hs<t.length;Hs+=2){if(Z===32)at+=uint32ToHex(t[Hs]).toUpperCase(),at+=" ",at+=uint32ToHex(t[Hs+1]).toUpperCase();else if(Z===64)at+=uint32ToHex(t[Hs+1]).toUpperCase(),at+=uint32ToHex(t[Hs]).toUpperCase();else throw new Error("Invalid size "+Z);Hs%6===4?at+=`
`+new Array(F.length+4).join(" "):Hs<t.length-2&&(at+=" ")}console.log(at)}function testSpeed(F,t,Z){let at=new Date().getTime();const Hs=new Uint8Array(t);for(let Ys=0;Ys<t;Ys++)Hs[Ys]=Ys%256;const zs=new Date().getTime();console.log("Generated random input in "+(zs-at)+"ms"),at=zs;for(let Ys=0;Ys<Z;Ys++){const Zs=F(Hs),$u=new Date().getTime(),Eu=$u-at;at=$u,console.log("Hashed in "+Eu+"ms: "+Zs.substring(0,20)+"..."),console.log(Math.round(t/(1<<20)/(Eu/1e3)*100)/100+" MB PER SECOND")}}var util$2={normalizeInput,toHex:toHex$2,debugPrint,testSpeed};const util$1=util$2;function ADD64AA$1(F,t,Z){const at=F[t]+F[Z];let Hs=F[t+1]+F[Z+1];at>=4294967296&&Hs++,F[t]=at,F[t+1]=Hs}function ADD64AC$1(F,t,Z,at){let Hs=F[t]+Z;Z<0&&(Hs+=4294967296);let zs=F[t+1]+at;Hs>=4294967296&&zs++,F[t]=Hs,F[t+1]=zs}function B2B_GET32$1(F,t){return F[t]^F[t+1]<<8^F[t+2]<<16^F[t+3]<<24}function B2B_G$1(F,t,Z,at,Hs,zs){const Ys=m$2[Hs],Zs=m$2[Hs+1],$u=m$2[zs],Eu=m$2[zs+1];ADD64AA$1(v$4,F,t),ADD64AC$1(v$4,F,Ys,Zs);let Au=v$4[at]^v$4[F],vu=v$4[at+1]^v$4[F+1];v$4[at]=vu,v$4[at+1]=Au,ADD64AA$1(v$4,Z,at),Au=v$4[t]^v$4[Z],vu=v$4[t+1]^v$4[Z+1],v$4[t]=Au>>>24^vu<<8,v$4[t+1]=vu>>>24^Au<<8,ADD64AA$1(v$4,F,t),ADD64AC$1(v$4,F,$u,Eu),Au=v$4[at]^v$4[F],vu=v$4[at+1]^v$4[F+1],v$4[at]=Au>>>16^vu<<16,v$4[at+1]=vu>>>16^Au<<16,ADD64AA$1(v$4,Z,at),Au=v$4[t]^v$4[Z],vu=v$4[t+1]^v$4[Z+1],v$4[t]=vu>>>31^Au<<1,v$4[t+1]=Au>>>31^vu<<1}const BLAKE2B_IV32$1=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),SIGMA8$1=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],SIGMA82$1=new Uint8Array(SIGMA8$1.map(function(F){return F*2})),v$4=new Uint32Array(32),m$2=new Uint32Array(32);function blake2bCompress$1(F,t){let Z=0;for(Z=0;Z<16;Z++)v$4[Z]=F.h[Z],v$4[Z+16]=BLAKE2B_IV32$1[Z];for(v$4[24]=v$4[24]^F.t,v$4[25]=v$4[25]^F.t/4294967296,t&&(v$4[28]=~v$4[28],v$4[29]=~v$4[29]),Z=0;Z<32;Z++)m$2[Z]=B2B_GET32$1(F.b,4*Z);for(Z=0;Z<12;Z++)B2B_G$1(0,8,16,24,SIGMA82$1[Z*16+0],SIGMA82$1[Z*16+1]),B2B_G$1(2,10,18,26,SIGMA82$1[Z*16+2],SIGMA82$1[Z*16+3]),B2B_G$1(4,12,20,28,SIGMA82$1[Z*16+4],SIGMA82$1[Z*16+5]),B2B_G$1(6,14,22,30,SIGMA82$1[Z*16+6],SIGMA82$1[Z*16+7]),B2B_G$1(0,10,20,30,SIGMA82$1[Z*16+8],SIGMA82$1[Z*16+9]),B2B_G$1(2,12,22,24,SIGMA82$1[Z*16+10],SIGMA82$1[Z*16+11]),B2B_G$1(4,14,16,26,SIGMA82$1[Z*16+12],SIGMA82$1[Z*16+13]),B2B_G$1(6,8,18,28,SIGMA82$1[Z*16+14],SIGMA82$1[Z*16+15]);for(Z=0;Z<16;Z++)F.h[Z]=F.h[Z]^v$4[Z]^v$4[Z+16]}const parameterBlock=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function blake2bInit(F,t,Z,at){if(F===0||F>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(Z&&Z.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(at&&at.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const Hs={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:F};parameterBlock.fill(0),parameterBlock[0]=F,t&&(parameterBlock[1]=t.length),parameterBlock[2]=1,parameterBlock[3]=1,Z&&parameterBlock.set(Z,32),at&&parameterBlock.set(at,48);for(let zs=0;zs<16;zs++)Hs.h[zs]=BLAKE2B_IV32$1[zs]^B2B_GET32$1(parameterBlock,zs*4);return t&&(blake2bUpdate$1(Hs,t),Hs.c=128),Hs}function blake2bUpdate$1(F,t){for(let Z=0;Z<t.length;Z++)F.c===128&&(F.t+=F.c,blake2bCompress$1(F,!1),F.c=0),F.b[F.c++]=t[Z]}function blake2bFinal$1(F){for(F.t+=F.c;F.c<128;)F.b[F.c++]=0;blake2bCompress$1(F,!0);const t=new Uint8Array(F.outlen);for(let Z=0;Z<F.outlen;Z++)t[Z]=F.h[Z>>2]>>8*(Z&3);return t}function blake2b$2(F,t,Z,at,Hs){Z=Z||64,F=util$1.normalizeInput(F),at&&(at=util$1.normalizeInput(at)),Hs&&(Hs=util$1.normalizeInput(Hs));const zs=blake2bInit(Z,t,at,Hs);return blake2bUpdate$1(zs,F),blake2bFinal$1(zs)}function blake2bHex(F,t,Z,at,Hs){const zs=blake2b$2(F,t,Z,at,Hs);return util$1.toHex(zs)}var blake2b_1={blake2b:blake2b$2,blake2bHex,blake2bInit,blake2bUpdate:blake2bUpdate$1,blake2bFinal:blake2bFinal$1};const util=util$2;function B2S_GET32(F,t){return F[t]^F[t+1]<<8^F[t+2]<<16^F[t+3]<<24}function B2S_G(F,t,Z,at,Hs,zs){v$3[F]=v$3[F]+v$3[t]+Hs,v$3[at]=ROTR32(v$3[at]^v$3[F],16),v$3[Z]=v$3[Z]+v$3[at],v$3[t]=ROTR32(v$3[t]^v$3[Z],12),v$3[F]=v$3[F]+v$3[t]+zs,v$3[at]=ROTR32(v$3[at]^v$3[F],8),v$3[Z]=v$3[Z]+v$3[at],v$3[t]=ROTR32(v$3[t]^v$3[Z],7)}function ROTR32(F,t){return F>>>t^F<<32-t}const BLAKE2S_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),v$3=new Uint32Array(16),m$1=new Uint32Array(16);function blake2sCompress(F,t){let Z=0;for(Z=0;Z<8;Z++)v$3[Z]=F.h[Z],v$3[Z+8]=BLAKE2S_IV[Z];for(v$3[12]^=F.t,v$3[13]^=F.t/4294967296,t&&(v$3[14]=~v$3[14]),Z=0;Z<16;Z++)m$1[Z]=B2S_GET32(F.b,4*Z);for(Z=0;Z<10;Z++)B2S_G(0,4,8,12,m$1[SIGMA[Z*16+0]],m$1[SIGMA[Z*16+1]]),B2S_G(1,5,9,13,m$1[SIGMA[Z*16+2]],m$1[SIGMA[Z*16+3]]),B2S_G(2,6,10,14,m$1[SIGMA[Z*16+4]],m$1[SIGMA[Z*16+5]]),B2S_G(3,7,11,15,m$1[SIGMA[Z*16+6]],m$1[SIGMA[Z*16+7]]),B2S_G(0,5,10,15,m$1[SIGMA[Z*16+8]],m$1[SIGMA[Z*16+9]]),B2S_G(1,6,11,12,m$1[SIGMA[Z*16+10]],m$1[SIGMA[Z*16+11]]),B2S_G(2,7,8,13,m$1[SIGMA[Z*16+12]],m$1[SIGMA[Z*16+13]]),B2S_G(3,4,9,14,m$1[SIGMA[Z*16+14]],m$1[SIGMA[Z*16+15]]);for(Z=0;Z<8;Z++)F.h[Z]^=v$3[Z]^v$3[Z+8]}function blake2sInit(F,t){if(!(F>0&&F<=32))throw new Error("Incorrect output length, should be in [1, 32]");const Z=t?t.length:0;if(t&&!(Z>0&&Z<=32))throw new Error("Incorrect key length, should be in [1, 32]");const at={h:new Uint32Array(BLAKE2S_IV),b:new Uint8Array(64),c:0,t:0,outlen:F};return at.h[0]^=16842752^Z<<8^F,Z>0&&(blake2sUpdate(at,t),at.c=64),at}function blake2sUpdate(F,t){for(let Z=0;Z<t.length;Z++)F.c===64&&(F.t+=F.c,blake2sCompress(F,!1),F.c=0),F.b[F.c++]=t[Z]}function blake2sFinal(F){for(F.t+=F.c;F.c<64;)F.b[F.c++]=0;blake2sCompress(F,!0);const t=new Uint8Array(F.outlen);for(let Z=0;Z<F.outlen;Z++)t[Z]=F.h[Z>>2]>>8*(Z&3)&255;return t}function blake2s(F,t,Z){Z=Z||32,F=util.normalizeInput(F);const at=blake2sInit(Z,t);return blake2sUpdate(at,F),blake2sFinal(at)}function blake2sHex(F,t,Z){const at=blake2s(F,t,Z);return util.toHex(at)}var blake2s_1={blake2s,blake2sHex,blake2sInit,blake2sUpdate,blake2sFinal};const b2b=blake2b_1,b2s=blake2s_1;var blakejs={blake2b:b2b.blake2b,blake2bHex:b2b.blake2bHex,blake2bInit:b2b.blake2bInit,blake2bUpdate:b2b.blake2bUpdate,blake2bFinal:b2b.blake2bFinal,blake2s:b2s.blake2s,blake2sHex:b2s.blake2sHex,blake2sInit:b2s.blake2sInit,blake2sUpdate:b2s.blake2sUpdate,blake2sFinal:b2s.blake2sFinal};const Ae=":";function Je$1(F){const[t,Z]=F.split(Ae);return{namespace:t,reference:Z}}function or$1(F){const{namespace:t,reference:Z}=F;return[t,Z].join(Ae)}function Qe$1(F){const[t,Z,at]=F.split(Ae);return{namespace:t,reference:Z,address:at}}function sr(F){const{namespace:t,reference:Z,address:at}=F;return[t,Z,at].join(Ae)}function tn$1(F,t){const Z=[];return F.forEach(at=>{const Hs=t(at);Z.includes(Hs)||Z.push(Hs)}),Z}function ir$1(F){const{address:t}=Qe$1(F);return t}function cr$1(F){const{namespace:t,reference:Z}=Qe$1(F);return or$1({namespace:t,reference:Z})}function Ws(F,t){const{namespace:Z,reference:at}=Je$1(t);return sr({namespace:Z,reference:at,address:F})}function Xs(F){return tn$1(F,ir$1)}function fr$1(F){return tn$1(F,cr$1)}function Js(F,t=[]){const Z=[];return Object.keys(F).forEach(at=>{if(t.length&&!t.includes(at))return;const Hs=F[at];Z.push(...Hs.accounts)}),Z}function Qs$1(F,t=[]){const Z=[];return Object.keys(F).forEach(at=>{if(t.length&&!t.includes(at))return;const Hs=F[at];Z.push(...fr$1(Hs.accounts))}),Z}function ti$1(F,t=[]){const Z=[];return Object.keys(F).forEach(at=>{if(t.length&&!t.includes(at))return;const Hs=F[at];Z.push(...Ie(at,Hs))}),Z}function Ie(F,t){return F.includes(":")?[F]:t.chains||[]}var ei$1=Object.defineProperty,ni$1=Object.defineProperties,ri$1=Object.getOwnPropertyDescriptors,ar$1=Object.getOwnPropertySymbols,oi$1=Object.prototype.hasOwnProperty,si$1=Object.prototype.propertyIsEnumerable,en$1=(F,t,Z)=>t in F?ei$1(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,ur$1=(F,t)=>{for(var Z in t||(t={}))oi$1.call(t,Z)&&en$1(F,Z,t[Z]);if(ar$1)for(var Z of ar$1(t))si$1.call(t,Z)&&en$1(F,Z,t[Z]);return F},ii$1=(F,t)=>ni$1(F,ri$1(t)),lr$1=(F,t,Z)=>en$1(F,typeof t!="symbol"?t+"":t,Z);const dr$1="ReactNative",et$1={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Se$1=" ",ci$1=":",hr$1="/",nn$1=2,fi$1=1e3,pr$1="js";function rn$1(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function At$1(){return!getDocument_1()&&!!getNavigator_1()&&navigator.product===dr$1}function ai$1(){return At$1()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function ui$1(){return At$1()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Wt$1(){return!rn$1()&&!!getNavigator_1()&&!!getDocument_1()}function Vt$1(){return At$1()?et$1.reactNative:rn$1()?et$1.node:Wt$1()?et$1.browser:et$1.unknown}function li$1(){var F;try{return At$1()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(F=global.Application)==null?void 0:F.applicationId:void 0}catch{return}}function gr$1(F,t){const Z=new URLSearchParams(F);return Object.entries(t).sort(([at],[Hs])=>at.localeCompare(Hs)).forEach(([at,Hs])=>{Hs!=null&&Z.set(at,String(Hs))}),Z.toString()}function di$1(F){var t,Z;const at=br$1();try{return F!=null&&F.url&&at.url&&new URL(F.url).host!==new URL(at.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${F.url} differs from the actual page url:${at.url}. This is probably unintended and can lead to issues.`),F.url=at.url),(t=F==null?void 0:F.icons)!=null&&t.length&&F.icons.length>0&&(F.icons=F.icons.filter(Hs=>Hs!=="")),ii$1(ur$1(ur$1({},at),F),{url:(F==null?void 0:F.url)||at.url,name:(F==null?void 0:F.name)||at.name,description:(F==null?void 0:F.description)||at.description,icons:(Z=F==null?void 0:F.icons)!=null&&Z.length&&F.icons.length>0?F.icons:at.icons})}catch(Hs){return console.warn("Error populating app metadata",Hs),F||at}}function br$1(){return getWindowMetadata_1()||{name:"",description:"",url:"",icons:[""]}}function hi$1(F,t){var Z;const at=Vt$1(),Hs={protocol:F,version:t,env:at};return at==="browser"&&(Hs.host=((Z=getLocation_1())==null?void 0:Z.host)||"unknown"),Hs}function yr$1(){if(Vt$1()===et$1.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:Z,Version:at}=global.Platform;return[Z,at].join("-")}const F=detect();if(F===null)return"unknown";const t=F.os?F.os.replace(" ","").toLowerCase():"unknown";return F.type==="browser"?[t,F.name,F.version].join("-"):[t,F.version].join("-")}function mr$1(){var F;const t=Vt$1();return t===et$1.browser?[t,((F=getLocation_1())==null?void 0:F.host)||"unknown"].join(":"):t}function wr$1(F,t,Z){const at=yr$1(),Hs=mr$1();return[[F,t].join("-"),[pr$1,Z].join("-"),at,Hs].join("/")}function pi$1({protocol:F,version:t,relayUrl:Z,sdkVersion:at,auth:Hs,projectId:zs,useOnCloseEvent:Ys,bundleId:Zs,packageName:$u}){const Eu=Z.split("?"),Au=wr$1(F,t,at),vu={auth:Hs,ua:Au,projectId:zs,useOnCloseEvent:Ys||void 0,packageName:$u||void 0,bundleId:Zs||void 0},Iu=gr$1(Eu[1]||"",vu);return Eu[0]+"?"+Iu}function gi$1(F){let t=(F.match(/^[^:]+(?=:\/\/)/gi)||[])[0];const Z=typeof t<"u"?F.split("://")[1]:F;return t=t==="wss"?"https":"http",[t,Z].join("://")}function bi$1(F,t,Z){if(!F[t]||typeof F[t]!==Z)throw new Error(`Missing or invalid "${t}" param`)}function vr$1(F,t=nn$1){return xr$1(F.split(hr$1),t)}function yi$1(F){return vr$1(F).join(Se$1)}function It$2(F,t){return F.filter(Z=>t.includes(Z)).length===F.length}function xr$1(F,t=nn$1){return F.slice(Math.max(F.length-t,0))}function mi$1(F){return Object.fromEntries(F.entries())}function wi$1(F){return new Map(Object.entries(F))}function vi$1(F,t){const Z={};return Object.keys(F).forEach(at=>{Z[at]=t(F[at])}),Z}const xi$1=F=>F;function Er$1(F){return F.trim().replace(/^\w/,t=>t.toUpperCase())}function Ei$1(F){return F.split(Se$1).map(t=>Er$1(t)).join(Se$1)}function Bi$1(F=cjs$3.FIVE_MINUTES,t){const Z=cjs$3.toMiliseconds(F||cjs$3.FIVE_MINUTES);let at,Hs,zs,Ys;return{resolve:Zs=>{zs&&at&&(clearTimeout(zs),at(Zs),Ys=Promise.resolve(Zs))},reject:Zs=>{zs&&Hs&&(clearTimeout(zs),Hs(Zs))},done:()=>new Promise((Zs,$u)=>{if(Ys)return Zs(Ys);zs=setTimeout(()=>{const Eu=new Error(t);Ys=Promise.reject(Eu),$u(Eu)},Z),at=Zs,Hs=$u})}}function Ai$1(F,t,Z){return new Promise(async(at,Hs)=>{const zs=setTimeout(()=>Hs(new Error(Z)),t);try{const Ys=await F;at(Ys)}catch(Ys){Hs(Ys)}clearTimeout(zs)})}function on$1(F,t){if(typeof t=="string"&&t.startsWith(`${F}:`))return t;if(F.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(F.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${F}`)}function Ii$1(F){return on$1("topic",F)}function Si$1(F){return on$1("id",F)}function Oi$1(F){const[t,Z]=F.split(":"),at={id:void 0,topic:void 0};if(t==="topic"&&typeof Z=="string")at.topic=Z;else if(t==="id"&&Number.isInteger(Number(Z)))at.id=Number(Z);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${Z}`);return at}function Ni$1(F,t){return cjs$3.fromMiliseconds((t||Date.now())+cjs$3.toMiliseconds(F))}function Ui$1(F){return Date.now()>=cjs$3.toMiliseconds(F)}function _i$1(F,t){return`${F}${t?`:${t}`:""}`}function ut$1(F=[],t=[]){return[...new Set([...F,...t])]}async function Ri$1({id:F,topic:t,wcDeepLink:Z}){var at;try{if(!Z)return;const Hs=typeof Z=="string"?JSON.parse(Z):Z,zs=Hs==null?void 0:Hs.href;if(typeof zs!="string")return;const Ys=Br$1(zs,F,t),Zs=Vt$1();if(Zs===et$1.browser){if(!((at=getDocument_1())!=null&&at.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}Ar$1(Ys)}else Zs===et$1.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(Ys)}catch(Hs){console.error(Hs)}}function Br$1(F,t,Z){const at=`requestId=${t}&sessionTopic=${Z}`;F.endsWith("/")&&(F=F.slice(0,-1));let Hs=`${F}`;if(F.startsWith("https://t.me")){const zs=F.includes("?")?"&startapp=":"?startapp=";Hs=`${Hs}${zs}${Or$1(at,!0)}`}else Hs=`${Hs}/wc?${at}`;return Hs}function Ar$1(F){let t="_self";Sr$1()?t="_top":(Ir$1()||F.startsWith("https://")||F.startsWith("http://"))&&(t="_blank"),window.open(F,t,"noreferrer noopener")}async function $i$1(F,t){let Z="";try{if(Wt$1()&&(Z=localStorage.getItem(t),Z))return Z;Z=await F.getItem(t)}catch(at){console.error(at)}return Z}function sn$1(F,t){return F.filter(Z=>t.includes(Z))}function Ti$1(F,t){if(!F.includes(t))return null;const Z=F.split(/([&,?,=])/),at=Z.indexOf(t);return Z[at+2]}function Ci$1(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,F=>{const t=Math.random()*16|0;return(F==="x"?t:t&3|8).toString(16)})}function ji$1(){return typeof process<"u"&&{}.IS_VITEST==="true"}function Ir$1(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function Sr$1(){try{return window.self!==window.top}catch{return!1}}function Or$1(F,t=!1){const Z=Buffer.from(F).toString("base64");return t?Z.replace(/[=]/g,""):Z}function cn$1(F){return Buffer.from(F,"base64").toString("utf-8")}function Li$1(F){return new Promise(t=>setTimeout(t,F))}let ki$1=class{constructor({limit:t}){lr$1(this,"limit"),lr$1(this,"set"),this.limit=t,this.set=new Set}add(t){if(!this.set.has(t)){if(this.set.size>=this.limit){const Z=this.set.values().next().value;Z&&this.set.delete(Z)}this.set.add(t)}}has(t){return this.set.has(t)}};const Oe$1=BigInt(2**32-1),Nr$1=BigInt(32);function Ur$1(F,t=!1){return t?{h:Number(F&Oe$1),l:Number(F>>Nr$1&Oe$1)}:{h:Number(F>>Nr$1&Oe$1)|0,l:Number(F&Oe$1)|0}}function _r$1(F,t=!1){const Z=F.length;let at=new Uint32Array(Z),Hs=new Uint32Array(Z);for(let zs=0;zs<Z;zs++){const{h:Ys,l:Zs}=Ur$1(F[zs],t);[at[zs],Hs[zs]]=[Ys,Zs]}return[at,Hs]}const Rr$1=(F,t,Z)=>F>>>Z,$r$1=(F,t,Z)=>F<<32-Z|t>>>Z,St$2=(F,t,Z)=>F>>>Z|t<<32-Z,Ot$1=(F,t,Z)=>F<<32-Z|t>>>Z,de=(F,t,Z)=>F<<64-Z|t>>>Z-32,he$1=(F,t,Z)=>F>>>Z-32|t<<64-Z,Pi$1=(F,t)=>t,Hi$1=(F,t)=>F,Di$1=(F,t,Z)=>F<<Z|t>>>32-Z,Vi$1=(F,t,Z)=>t<<Z|F>>>32-Z,Mi$1=(F,t,Z)=>t<<Z-32|F>>>64-Z,Ki$1=(F,t,Z)=>F<<Z-32|t>>>64-Z;function dt$1(F,t,Z,at){const Hs=(t>>>0)+(at>>>0);return{h:F+Z+(Hs/2**32|0)|0,l:Hs|0}}const fn$1=(F,t,Z)=>(F>>>0)+(t>>>0)+(Z>>>0),an$1=(F,t,Z,at)=>t+Z+at+(F/2**32|0)|0,qi$1=(F,t,Z,at)=>(F>>>0)+(t>>>0)+(Z>>>0)+(at>>>0),Fi$1=(F,t,Z,at,Hs)=>t+Z+at+Hs+(F/2**32|0)|0,Zi=(F,t,Z,at,Hs)=>(F>>>0)+(t>>>0)+(Z>>>0)+(at>>>0)+(Hs>>>0),Gi$1=(F,t,Z,at,Hs,zs)=>t+Z+at+Hs+zs+(F/2**32|0)|0,Xt$1=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Ne(F){return F instanceof Uint8Array||ArrayBuffer.isView(F)&&F.constructor.name==="Uint8Array"}function mt$1(F){if(!Number.isSafeInteger(F)||F<0)throw new Error("positive integer expected, got "+F)}function ht(F,...t){if(!Ne(F))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(F.length))throw new Error("Uint8Array expected of length "+t+", got length="+F.length)}function Ue$1(F){if(typeof F!="function"||typeof F.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");mt$1(F.outputLen),mt$1(F.blockLen)}function Nt$1(F,t=!0){if(F.destroyed)throw new Error("Hash instance has been destroyed");if(t&&F.finished)throw new Error("Hash#digest() has already been called")}function un$1(F,t){ht(F);const Z=t.outputLen;if(F.length<Z)throw new Error("digestInto() expects output buffer of length at least "+Z)}function pe$1(F){return new Uint32Array(F.buffer,F.byteOffset,Math.floor(F.byteLength/4))}function lt(...F){for(let t=0;t<F.length;t++)F[t].fill(0)}function ln$1(F){return new DataView(F.buffer,F.byteOffset,F.byteLength)}function bt(F,t){return F<<32-t|F>>>t}const Tr$1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Cr$1(F){return F<<24&4278190080|F<<8&16711680|F>>>8&65280|F>>>24&255}const wt$1=Tr$1?F=>F:F=>Cr$1(F);function zi$1(F){for(let t=0;t<F.length;t++)F[t]=Cr$1(F[t]);return F}const Ut$1=Tr$1?F=>F:zi$1,jr$1=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Yi=Array.from({length:256},(F,t)=>t.toString(16).padStart(2,"0"));function Jt$1(F){if(ht(F),jr$1)return F.toHex();let t="";for(let Z=0;Z<F.length;Z++)t+=Yi[F[Z]];return t}const vt$1={_0:48,_9:57,A:65,F:70,a:97,f:102};function Lr$1(F){if(F>=vt$1._0&&F<=vt$1._9)return F-vt$1._0;if(F>=vt$1.A&&F<=vt$1.F)return F-(vt$1.A-10);if(F>=vt$1.a&&F<=vt$1.f)return F-(vt$1.a-10)}function _e$2(F){if(typeof F!="string")throw new Error("hex string expected, got "+typeof F);if(jr$1)return Uint8Array.fromHex(F);const t=F.length,Z=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const at=new Uint8Array(Z);for(let Hs=0,zs=0;Hs<Z;Hs++,zs+=2){const Ys=Lr$1(F.charCodeAt(zs)),Zs=Lr$1(F.charCodeAt(zs+1));if(Ys===void 0||Zs===void 0){const $u=F[zs]+F[zs+1];throw new Error('hex string expected, got non-hex character "'+$u+'" at index '+zs)}at[Hs]=Ys*16+Zs}return at}function kr$1(F){if(typeof F!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(F))}function pt(F){return typeof F=="string"&&(F=kr$1(F)),ht(F),F}function _t$1(...F){let t=0;for(let at=0;at<F.length;at++){const Hs=F[at];ht(Hs),t+=Hs.length}const Z=new Uint8Array(t);for(let at=0,Hs=0;at<F.length;at++){const zs=F[at];Z.set(zs,Hs),Hs+=zs.length}return Z}class Re{}function ge$1(F){const t=at=>F().update(pt(at)).digest(),Z=F();return t.outputLen=Z.outputLen,t.blockLen=Z.blockLen,t.create=()=>F(),t}function Wi$1(F){const t=(at,Hs)=>F(Hs).update(pt(at)).digest(),Z=F({});return t.outputLen=Z.outputLen,t.blockLen=Z.blockLen,t.create=at=>F(at),t}function Mt$1(F=32){if(Xt$1&&typeof Xt$1.getRandomValues=="function")return Xt$1.getRandomValues(new Uint8Array(F));if(Xt$1&&typeof Xt$1.randomBytes=="function")return Uint8Array.from(Xt$1.randomBytes(F));throw new Error("crypto.getRandomValues must be defined")}const Xi=BigInt(0),be$1=BigInt(1),Ji=BigInt(2),Qi=BigInt(7),tc=BigInt(256),ec=BigInt(113),Pr$1=[],Hr$1=[],Dr$1=[];for(let F=0,t=be$1,Z=1,at=0;F<24;F++){[Z,at]=[at,(2*Z+3*at)%5],Pr$1.push(2*(5*at+Z)),Hr$1.push((F+1)*(F+2)/2%64);let Hs=Xi;for(let zs=0;zs<7;zs++)t=(t<<be$1^(t>>Qi)*ec)%tc,t&Ji&&(Hs^=be$1<<(be$1<<BigInt(zs))-be$1);Dr$1.push(Hs)}const Vr$1=_r$1(Dr$1,!0),nc=Vr$1[0],rc=Vr$1[1],Mr$1=(F,t,Z)=>Z>32?Mi$1(F,t,Z):Di$1(F,t,Z),Kr$1=(F,t,Z)=>Z>32?Ki$1(F,t,Z):Vi$1(F,t,Z);function oc(F,t=24){const Z=new Uint32Array(10);for(let at=24-t;at<24;at++){for(let Ys=0;Ys<10;Ys++)Z[Ys]=F[Ys]^F[Ys+10]^F[Ys+20]^F[Ys+30]^F[Ys+40];for(let Ys=0;Ys<10;Ys+=2){const Zs=(Ys+8)%10,$u=(Ys+2)%10,Eu=Z[$u],Au=Z[$u+1],vu=Mr$1(Eu,Au,1)^Z[Zs],Iu=Kr$1(Eu,Au,1)^Z[Zs+1];for(let _u=0;_u<50;_u+=10)F[Ys+_u]^=vu,F[Ys+_u+1]^=Iu}let Hs=F[2],zs=F[3];for(let Ys=0;Ys<24;Ys++){const Zs=Hr$1[Ys],$u=Mr$1(Hs,zs,Zs),Eu=Kr$1(Hs,zs,Zs),Au=Pr$1[Ys];Hs=F[Au],zs=F[Au+1],F[Au]=$u,F[Au+1]=Eu}for(let Ys=0;Ys<50;Ys+=10){for(let Zs=0;Zs<10;Zs++)Z[Zs]=F[Ys+Zs];for(let Zs=0;Zs<10;Zs++)F[Ys+Zs]^=~Z[(Zs+2)%10]&Z[(Zs+4)%10]}F[0]^=nc[at],F[1]^=rc[at]}lt(Z)}let Jn$1=class vh extends Re{constructor(t,Z,at,Hs=!1,zs=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=Z,this.outputLen=at,this.enableXOF=Hs,this.rounds=zs,mt$1(at),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=pe$1(this.state)}clone(){return this._cloneInto()}keccak(){Ut$1(this.state32),oc(this.state32,this.rounds),Ut$1(this.state32),this.posOut=0,this.pos=0}update(t){Nt$1(this),t=pt(t),ht(t);const{blockLen:Z,state:at}=this,Hs=t.length;for(let zs=0;zs<Hs;){const Ys=Math.min(Z-this.pos,Hs-zs);for(let Zs=0;Zs<Ys;Zs++)at[this.pos++]^=t[zs++];this.pos===Z&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:Z,pos:at,blockLen:Hs}=this;t[at]^=Z,Z&128&&at===Hs-1&&this.keccak(),t[Hs-1]^=128,this.keccak()}writeInto(t){Nt$1(this,!1),ht(t),this.finish();const Z=this.state,{blockLen:at}=this;for(let Hs=0,zs=t.length;Hs<zs;){this.posOut>=at&&this.keccak();const Ys=Math.min(at-this.posOut,zs-Hs);t.set(Z.subarray(this.posOut,this.posOut+Ys),Hs),this.posOut+=Ys,Hs+=Ys}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return mt$1(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(un$1(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,lt(this.state)}_cloneInto(t){const{blockLen:Z,suffix:at,outputLen:Hs,rounds:zs,enableXOF:Ys}=this;return t||(t=new vh(Z,at,Hs,Ys,zs)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=zs,t.suffix=at,t.outputLen=Hs,t.enableXOF=Ys,t.destroyed=this.destroyed,t}};const sc=(F,t,Z)=>ge$1(()=>new Jn$1(t,F,Z)),ic=sc(1,136,256/8);function cc(F,t,Z,at){if(typeof F.setBigUint64=="function")return F.setBigUint64(t,Z,at);const Hs=BigInt(32),zs=BigInt(4294967295),Ys=Number(Z>>Hs&zs),Zs=Number(Z&zs),$u=at?4:0,Eu=at?0:4;F.setUint32(t+$u,Ys,at),F.setUint32(t+Eu,Zs,at)}function fc(F,t,Z){return F&t^~F&Z}function ac(F,t,Z){return F&t^F&Z^t&Z}let qr$1=class extends Re{constructor(t,Z,at,Hs){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=Z,this.padOffset=at,this.isLE=Hs,this.buffer=new Uint8Array(t),this.view=ln$1(this.buffer)}update(t){Nt$1(this),t=pt(t),ht(t);const{view:Z,buffer:at,blockLen:Hs}=this,zs=t.length;for(let Ys=0;Ys<zs;){const Zs=Math.min(Hs-this.pos,zs-Ys);if(Zs===Hs){const $u=ln$1(t);for(;Hs<=zs-Ys;Ys+=Hs)this.process($u,Ys);continue}at.set(t.subarray(Ys,Ys+Zs),this.pos),this.pos+=Zs,Ys+=Zs,this.pos===Hs&&(this.process(Z,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Nt$1(this),un$1(t,this),this.finished=!0;const{buffer:Z,view:at,blockLen:Hs,isLE:zs}=this;let{pos:Ys}=this;Z[Ys++]=128,lt(this.buffer.subarray(Ys)),this.padOffset>Hs-Ys&&(this.process(at,0),Ys=0);for(let vu=Ys;vu<Hs;vu++)Z[vu]=0;cc(at,Hs-8,BigInt(this.length*8),zs),this.process(at,0);const Zs=ln$1(t),$u=this.outputLen;if($u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const Eu=$u/4,Au=this.get();if(Eu>Au.length)throw new Error("_sha2: outputLen bigger than state");for(let vu=0;vu<Eu;vu++)Zs.setUint32(4*vu,Au[vu],zs)}digest(){const{buffer:t,outputLen:Z}=this;this.digestInto(t);const at=t.slice(0,Z);return this.destroy(),at}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:Z,buffer:at,length:Hs,finished:zs,destroyed:Ys,pos:Zs}=this;return t.destroyed=Ys,t.finished=zs,t.length=Hs,t.pos=Zs,Hs%Z&&t.buffer.set(at),t}clone(){return this._cloneInto()}};const Rt$2=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),X$1=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),J$1=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),uc=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$t$1=new Uint32Array(64);class lc extends qr$1{constructor(t=32){super(64,t,8,!1),this.A=Rt$2[0]|0,this.B=Rt$2[1]|0,this.C=Rt$2[2]|0,this.D=Rt$2[3]|0,this.E=Rt$2[4]|0,this.F=Rt$2[5]|0,this.G=Rt$2[6]|0,this.H=Rt$2[7]|0}get(){const{A:t,B:Z,C:at,D:Hs,E:zs,F:Ys,G:Zs,H:$u}=this;return[t,Z,at,Hs,zs,Ys,Zs,$u]}set(t,Z,at,Hs,zs,Ys,Zs,$u){this.A=t|0,this.B=Z|0,this.C=at|0,this.D=Hs|0,this.E=zs|0,this.F=Ys|0,this.G=Zs|0,this.H=$u|0}process(t,Z){for(let vu=0;vu<16;vu++,Z+=4)$t$1[vu]=t.getUint32(Z,!1);for(let vu=16;vu<64;vu++){const Iu=$t$1[vu-15],_u=$t$1[vu-2],Su=bt(Iu,7)^bt(Iu,18)^Iu>>>3,Bu=bt(_u,17)^bt(_u,19)^_u>>>10;$t$1[vu]=Bu+$t$1[vu-7]+Su+$t$1[vu-16]|0}let{A:at,B:Hs,C:zs,D:Ys,E:Zs,F:$u,G:Eu,H:Au}=this;for(let vu=0;vu<64;vu++){const Iu=bt(Zs,6)^bt(Zs,11)^bt(Zs,25),_u=Au+Iu+fc(Zs,$u,Eu)+uc[vu]+$t$1[vu]|0,Su=(bt(at,2)^bt(at,13)^bt(at,22))+ac(at,Hs,zs)|0;Au=Eu,Eu=$u,$u=Zs,Zs=Ys+_u|0,Ys=zs,zs=Hs,Hs=at,at=_u+Su|0}at=at+this.A|0,Hs=Hs+this.B|0,zs=zs+this.C|0,Ys=Ys+this.D|0,Zs=Zs+this.E|0,$u=$u+this.F|0,Eu=Eu+this.G|0,Au=Au+this.H|0,this.set(at,Hs,zs,Ys,Zs,$u,Eu,Au)}roundClean(){lt($t$1)}destroy(){this.set(0,0,0,0,0,0,0,0),lt(this.buffer)}}const Fr$1=_r$1(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(F=>BigInt(F))),dc=Fr$1[0],hc=Fr$1[1],Tt$1=new Uint32Array(80),Ct$1=new Uint32Array(80);let dn$1=class extends qr$1{constructor(t=64){super(128,t,16,!1),this.Ah=J$1[0]|0,this.Al=J$1[1]|0,this.Bh=J$1[2]|0,this.Bl=J$1[3]|0,this.Ch=J$1[4]|0,this.Cl=J$1[5]|0,this.Dh=J$1[6]|0,this.Dl=J$1[7]|0,this.Eh=J$1[8]|0,this.El=J$1[9]|0,this.Fh=J$1[10]|0,this.Fl=J$1[11]|0,this.Gh=J$1[12]|0,this.Gl=J$1[13]|0,this.Hh=J$1[14]|0,this.Hl=J$1[15]|0}get(){const{Ah:t,Al:Z,Bh:at,Bl:Hs,Ch:zs,Cl:Ys,Dh:Zs,Dl:$u,Eh:Eu,El:Au,Fh:vu,Fl:Iu,Gh:_u,Gl:Su,Hh:Bu,Hl:Du}=this;return[t,Z,at,Hs,zs,Ys,Zs,$u,Eu,Au,vu,Iu,_u,Su,Bu,Du]}set(t,Z,at,Hs,zs,Ys,Zs,$u,Eu,Au,vu,Iu,_u,Su,Bu,Du){this.Ah=t|0,this.Al=Z|0,this.Bh=at|0,this.Bl=Hs|0,this.Ch=zs|0,this.Cl=Ys|0,this.Dh=Zs|0,this.Dl=$u|0,this.Eh=Eu|0,this.El=Au|0,this.Fh=vu|0,this.Fl=Iu|0,this.Gh=_u|0,this.Gl=Su|0,this.Hh=Bu|0,this.Hl=Du|0}process(t,Z){for(let Uu=0;Uu<16;Uu++,Z+=4)Tt$1[Uu]=t.getUint32(Z),Ct$1[Uu]=t.getUint32(Z+=4);for(let Uu=16;Uu<80;Uu++){const Fu=Tt$1[Uu-15]|0,Lu=Ct$1[Uu-15]|0,qu=St$2(Fu,Lu,1)^St$2(Fu,Lu,8)^Rr$1(Fu,Lu,7),zu=Ot$1(Fu,Lu,1)^Ot$1(Fu,Lu,8)^$r$1(Fu,Lu,7),tl=Tt$1[Uu-2]|0,Wu=Ct$1[Uu-2]|0,cl=St$2(tl,Wu,19)^de(tl,Wu,61)^Rr$1(tl,Wu,6),wl=Ot$1(tl,Wu,19)^he$1(tl,Wu,61)^$r$1(tl,Wu,6),hl=qi$1(zu,wl,Ct$1[Uu-7],Ct$1[Uu-16]),Qu=Fi$1(hl,qu,cl,Tt$1[Uu-7],Tt$1[Uu-16]);Tt$1[Uu]=Qu|0,Ct$1[Uu]=hl|0}let{Ah:at,Al:Hs,Bh:zs,Bl:Ys,Ch:Zs,Cl:$u,Dh:Eu,Dl:Au,Eh:vu,El:Iu,Fh:_u,Fl:Su,Gh:Bu,Gl:Du,Hh:Tu,Hl:Pu}=this;for(let Uu=0;Uu<80;Uu++){const Fu=St$2(vu,Iu,14)^St$2(vu,Iu,18)^de(vu,Iu,41),Lu=Ot$1(vu,Iu,14)^Ot$1(vu,Iu,18)^he$1(vu,Iu,41),qu=vu&_u^~vu&Bu,zu=Iu&Su^~Iu&Du,tl=Zi(Pu,Lu,zu,hc[Uu],Ct$1[Uu]),Wu=Gi$1(tl,Tu,Fu,qu,dc[Uu],Tt$1[Uu]),cl=tl|0,wl=St$2(at,Hs,28)^de(at,Hs,34)^de(at,Hs,39),hl=Ot$1(at,Hs,28)^he$1(at,Hs,34)^he$1(at,Hs,39),Qu=at&zs^at&Zs^zs&Zs,rl=Hs&Ys^Hs&$u^Ys&$u;Tu=Bu|0,Pu=Du|0,Bu=_u|0,Du=Su|0,_u=vu|0,Su=Iu|0,{h:vu,l:Iu}=dt$1(Eu|0,Au|0,Wu|0,cl|0),Eu=Zs|0,Au=$u|0,Zs=zs|0,$u=Ys|0,zs=at|0,Ys=Hs|0;const Hu=fn$1(cl,hl,rl);at=an$1(Hu,Wu,wl,Qu),Hs=Hu|0}({h:at,l:Hs}=dt$1(this.Ah|0,this.Al|0,at|0,Hs|0)),{h:zs,l:Ys}=dt$1(this.Bh|0,this.Bl|0,zs|0,Ys|0),{h:Zs,l:$u}=dt$1(this.Ch|0,this.Cl|0,Zs|0,$u|0),{h:Eu,l:Au}=dt$1(this.Dh|0,this.Dl|0,Eu|0,Au|0),{h:vu,l:Iu}=dt$1(this.Eh|0,this.El|0,vu|0,Iu|0),{h:_u,l:Su}=dt$1(this.Fh|0,this.Fl|0,_u|0,Su|0),{h:Bu,l:Du}=dt$1(this.Gh|0,this.Gl|0,Bu|0,Du|0),{h:Tu,l:Pu}=dt$1(this.Hh|0,this.Hl|0,Tu|0,Pu|0),this.set(at,Hs,zs,Ys,Zs,$u,Eu,Au,vu,Iu,_u,Su,Bu,Du,Tu,Pu)}roundClean(){lt(Tt$1,Ct$1)}destroy(){lt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class pc extends dn$1{constructor(){super(48),this.Ah=X$1[0]|0,this.Al=X$1[1]|0,this.Bh=X$1[2]|0,this.Bl=X$1[3]|0,this.Ch=X$1[4]|0,this.Cl=X$1[5]|0,this.Dh=X$1[6]|0,this.Dl=X$1[7]|0,this.Eh=X$1[8]|0,this.El=X$1[9]|0,this.Fh=X$1[10]|0,this.Fl=X$1[11]|0,this.Gh=X$1[12]|0,this.Gl=X$1[13]|0,this.Hh=X$1[14]|0,this.Hl=X$1[15]|0}}const Q=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class gc extends dn$1{constructor(){super(32),this.Ah=Q[0]|0,this.Al=Q[1]|0,this.Bh=Q[2]|0,this.Bl=Q[3]|0,this.Ch=Q[4]|0,this.Cl=Q[5]|0,this.Dh=Q[6]|0,this.Dl=Q[7]|0,this.Eh=Q[8]|0,this.El=Q[9]|0,this.Fh=Q[10]|0,this.Fl=Q[11]|0,this.Gh=Q[12]|0,this.Gl=Q[13]|0,this.Hh=Q[14]|0,this.Hl=Q[15]|0}}const $e$1=ge$1(()=>new lc),bc=ge$1(()=>new dn$1),yc=ge$1(()=>new pc),mc=ge$1(()=>new gc),wc=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),z$1=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),S=new Uint32Array(32);function jt$1(F,t,Z,at,Hs,zs){const Ys=Hs[zs],Zs=Hs[zs+1];let $u=S[2*F],Eu=S[2*F+1],Au=S[2*t],vu=S[2*t+1],Iu=S[2*Z],_u=S[2*Z+1],Su=S[2*at],Bu=S[2*at+1],Du=fn$1($u,Au,Ys);Eu=an$1(Du,Eu,vu,Zs),$u=Du|0,{Dh:Bu,Dl:Su}={Dh:Bu^Eu,Dl:Su^$u},{Dh:Bu,Dl:Su}={Dh:Pi$1(Bu,Su),Dl:Hi$1(Bu)},{h:_u,l:Iu}=dt$1(_u,Iu,Bu,Su),{Bh:vu,Bl:Au}={Bh:vu^_u,Bl:Au^Iu},{Bh:vu,Bl:Au}={Bh:St$2(vu,Au,24),Bl:Ot$1(vu,Au,24)},S[2*F]=$u,S[2*F+1]=Eu,S[2*t]=Au,S[2*t+1]=vu,S[2*Z]=Iu,S[2*Z+1]=_u,S[2*at]=Su,S[2*at+1]=Bu}function Lt$1(F,t,Z,at,Hs,zs){const Ys=Hs[zs],Zs=Hs[zs+1];let $u=S[2*F],Eu=S[2*F+1],Au=S[2*t],vu=S[2*t+1],Iu=S[2*Z],_u=S[2*Z+1],Su=S[2*at],Bu=S[2*at+1],Du=fn$1($u,Au,Ys);Eu=an$1(Du,Eu,vu,Zs),$u=Du|0,{Dh:Bu,Dl:Su}={Dh:Bu^Eu,Dl:Su^$u},{Dh:Bu,Dl:Su}={Dh:St$2(Bu,Su,16),Dl:Ot$1(Bu,Su,16)},{h:_u,l:Iu}=dt$1(_u,Iu,Bu,Su),{Bh:vu,Bl:Au}={Bh:vu^_u,Bl:Au^Iu},{Bh:vu,Bl:Au}={Bh:de(vu,Au,63),Bl:he$1(vu,Au,63)},S[2*F]=$u,S[2*F+1]=Eu,S[2*t]=Au,S[2*t+1]=vu,S[2*Z]=Iu,S[2*Z+1]=_u,S[2*at]=Su,S[2*at+1]=Bu}function vc(F,t={},Z,at,Hs){if(mt$1(Z),F<0||F>Z)throw new Error("outputLen bigger than keyLen");const{key:zs,salt:Ys,personalization:Zs}=t;if(zs!==void 0&&(zs.length<1||zs.length>Z))throw new Error("key length must be undefined or 1.."+Z);if(Ys!==void 0&&Ys.length!==at)throw new Error("salt must be undefined or "+at);if(Zs!==void 0&&Zs.length!==Hs)throw new Error("personalization must be undefined or "+Hs)}class xc extends Re{constructor(t,Z){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,mt$1(t),mt$1(Z),this.blockLen=t,this.outputLen=Z,this.buffer=new Uint8Array(t),this.buffer32=pe$1(this.buffer)}update(t){Nt$1(this),t=pt(t),ht(t);const{blockLen:Z,buffer:at,buffer32:Hs}=this,zs=t.length,Ys=t.byteOffset,Zs=t.buffer;for(let $u=0;$u<zs;){this.pos===Z&&(Ut$1(Hs),this.compress(Hs,0,!1),Ut$1(Hs),this.pos=0);const Eu=Math.min(Z-this.pos,zs-$u),Au=Ys+$u;if(Eu===Z&&!(Au%4)&&$u+Eu<zs){const vu=new Uint32Array(Zs,Au,Math.floor((zs-$u)/4));Ut$1(vu);for(let Iu=0;$u+Z<zs;Iu+=Hs.length,$u+=Z)this.length+=Z,this.compress(vu,Iu,!1);Ut$1(vu);continue}at.set(t.subarray($u,$u+Eu),this.pos),this.pos+=Eu,this.length+=Eu,$u+=Eu}return this}digestInto(t){Nt$1(this),un$1(t,this);const{pos:Z,buffer32:at}=this;this.finished=!0,lt(this.buffer.subarray(Z)),Ut$1(at),this.compress(at,0,!0),Ut$1(at);const Hs=pe$1(t);this.get().forEach((zs,Ys)=>Hs[Ys]=wt$1(zs))}digest(){const{buffer:t,outputLen:Z}=this;this.digestInto(t);const at=t.slice(0,Z);return this.destroy(),at}_cloneInto(t){const{buffer:Z,length:at,finished:Hs,destroyed:zs,outputLen:Ys,pos:Zs}=this;return t||(t=new this.constructor({dkLen:Ys})),t.set(...this.get()),t.buffer.set(Z),t.destroyed=zs,t.finished=Hs,t.length=at,t.pos=Zs,t.outputLen=Ys,t}clone(){return this._cloneInto()}}class Ec extends xc{constructor(t={}){const Z=t.dkLen===void 0?64:t.dkLen;super(128,Z),this.v0l=z$1[0]|0,this.v0h=z$1[1]|0,this.v1l=z$1[2]|0,this.v1h=z$1[3]|0,this.v2l=z$1[4]|0,this.v2h=z$1[5]|0,this.v3l=z$1[6]|0,this.v3h=z$1[7]|0,this.v4l=z$1[8]|0,this.v4h=z$1[9]|0,this.v5l=z$1[10]|0,this.v5h=z$1[11]|0,this.v6l=z$1[12]|0,this.v6h=z$1[13]|0,this.v7l=z$1[14]|0,this.v7h=z$1[15]|0,vc(Z,t,64,16,16);let{key:at,personalization:Hs,salt:zs}=t,Ys=0;if(at!==void 0&&(at=pt(at),Ys=at.length),this.v0l^=this.outputLen|Ys<<8|65536|1<<24,zs!==void 0){zs=pt(zs);const Zs=pe$1(zs);this.v4l^=wt$1(Zs[0]),this.v4h^=wt$1(Zs[1]),this.v5l^=wt$1(Zs[2]),this.v5h^=wt$1(Zs[3])}if(Hs!==void 0){Hs=pt(Hs);const Zs=pe$1(Hs);this.v6l^=wt$1(Zs[0]),this.v6h^=wt$1(Zs[1]),this.v7l^=wt$1(Zs[2]),this.v7h^=wt$1(Zs[3])}if(at!==void 0){const Zs=new Uint8Array(this.blockLen);Zs.set(at),this.update(Zs)}}get(){let{v0l:t,v0h:Z,v1l:at,v1h:Hs,v2l:zs,v2h:Ys,v3l:Zs,v3h:$u,v4l:Eu,v4h:Au,v5l:vu,v5h:Iu,v6l:_u,v6h:Su,v7l:Bu,v7h:Du}=this;return[t,Z,at,Hs,zs,Ys,Zs,$u,Eu,Au,vu,Iu,_u,Su,Bu,Du]}set(t,Z,at,Hs,zs,Ys,Zs,$u,Eu,Au,vu,Iu,_u,Su,Bu,Du){this.v0l=t|0,this.v0h=Z|0,this.v1l=at|0,this.v1h=Hs|0,this.v2l=zs|0,this.v2h=Ys|0,this.v3l=Zs|0,this.v3h=$u|0,this.v4l=Eu|0,this.v4h=Au|0,this.v5l=vu|0,this.v5h=Iu|0,this.v6l=_u|0,this.v6h=Su|0,this.v7l=Bu|0,this.v7h=Du|0}compress(t,Z,at){this.get().forEach(($u,Eu)=>S[Eu]=$u),S.set(z$1,16);let{h:Hs,l:zs}=Ur$1(BigInt(this.length));S[24]=z$1[8]^zs,S[25]=z$1[9]^Hs,at&&(S[28]=~S[28],S[29]=~S[29]);let Ys=0;const Zs=wc;for(let $u=0;$u<12;$u++)jt$1(0,4,8,12,t,Z+2*Zs[Ys++]),Lt$1(0,4,8,12,t,Z+2*Zs[Ys++]),jt$1(1,5,9,13,t,Z+2*Zs[Ys++]),Lt$1(1,5,9,13,t,Z+2*Zs[Ys++]),jt$1(2,6,10,14,t,Z+2*Zs[Ys++]),Lt$1(2,6,10,14,t,Z+2*Zs[Ys++]),jt$1(3,7,11,15,t,Z+2*Zs[Ys++]),Lt$1(3,7,11,15,t,Z+2*Zs[Ys++]),jt$1(0,5,10,15,t,Z+2*Zs[Ys++]),Lt$1(0,5,10,15,t,Z+2*Zs[Ys++]),jt$1(1,6,11,12,t,Z+2*Zs[Ys++]),Lt$1(1,6,11,12,t,Z+2*Zs[Ys++]),jt$1(2,7,8,13,t,Z+2*Zs[Ys++]),Lt$1(2,7,8,13,t,Z+2*Zs[Ys++]),jt$1(3,4,9,14,t,Z+2*Zs[Ys++]),Lt$1(3,4,9,14,t,Z+2*Zs[Ys++]);this.v0l^=S[0]^S[16],this.v0h^=S[1]^S[17],this.v1l^=S[2]^S[18],this.v1h^=S[3]^S[19],this.v2l^=S[4]^S[20],this.v2h^=S[5]^S[21],this.v3l^=S[6]^S[22],this.v3h^=S[7]^S[23],this.v4l^=S[8]^S[24],this.v4h^=S[9]^S[25],this.v5l^=S[10]^S[26],this.v5h^=S[11]^S[27],this.v6l^=S[12]^S[28],this.v6h^=S[13]^S[29],this.v7l^=S[14]^S[30],this.v7h^=S[15]^S[31],lt(S)}destroy(){this.destroyed=!0,lt(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Bc=Wi$1(F=>new Ec(F)),Ac="https://rpc.walletconnect.org/v1";function hn$1(F){const t=`Ethereum Signed Message:
${F.length}`,Z=new TextEncoder().encode(t+F);return"0x"+Buffer.from(ic(Z)).toString("hex")}async function Zr$1(F,t,Z,at,Hs,zs){switch(Z.t){case"eip191":return await Gr$1(F,t,Z.s);case"eip1271":return await zr$1(F,t,Z.s,at,Hs,zs);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${Z.t}`)}}function Gr$1(F,t,Z){const at=fromHex(Z);return recoverAddress({payload:hn$1(t),signature:at}).toLowerCase()===F.toLowerCase()}async function zr$1(F,t,Z,at,Hs,zs){const Ys=Je$1(at);if(!Ys.namespace||!Ys.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${at}`);try{const Zs="0x1626ba7e",$u="0000000000000000000000000000000000000000000000000000000000000040",Eu=Z.substring(2),Au=(Eu.length/2).toString(16).padStart(64,"0"),vu=(t.startsWith("0x")?t:hn$1(t)).substring(2),Iu=Zs+vu+$u+Au+Eu,_u=await fetch(`${zs||Ac}/?chainId=${at}&projectId=${Hs}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Ic(),jsonrpc:"2.0",method:"eth_call",params:[{to:F,data:Iu},"latest"]})}),{result:Su}=await _u.json();return Su?Su.slice(0,Zs.length).toLowerCase()===Zs.toLowerCase():!1}catch(Zs){return console.error("isValidEip1271Signature: ",Zs),!1}}function Ic(){return Date.now()+Math.floor(Math.random()*1e3)}function Sc(F){const t=atob(F),Z=new Uint8Array(t.length);for(let Ys=0;Ys<t.length;Ys++)Z[Ys]=t.charCodeAt(Ys);const at=Z[0];if(at===0)throw new Error("No signatures found");const Hs=1+at*64;if(Z.length<Hs)throw new Error("Transaction data too short for claimed signature count");if(Z.length<100)throw new Error("Transaction too short");const zs=Buffer.from(F,"base64").slice(1,65);return ue.encode(zs)}function Oc(F){const t=new Uint8Array(Buffer.from(F,"base64")),Z=Array.from("TransactionData::").map(zs=>zs.charCodeAt(0)),at=new Uint8Array(Z.length+t.length);at.set(Z),at.set(t,Z.length);const Hs=Bc(at,{dkLen:32});return ue.encode(Hs)}function Nc(F){const t=new Uint8Array($e$1(Yr$1(F)));return ue.encode(t)}function Yr$1(F){if(F instanceof Uint8Array)return F;if(Array.isArray(F))return new Uint8Array(F);if(typeof F=="object"&&F!=null&&F.data)return new Uint8Array(Object.values(F.data));if(typeof F=="object"&&F)return new Uint8Array(Object.values(F));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function Uc(F){const t=Buffer.from(F,"base64"),Z=decode$2(t).txn;if(!Z)throw new Error("Invalid signed transaction: missing 'txn' field");const at=encode$2(Z),Hs=Buffer.from("TX"),zs=Buffer.concat([Hs,Buffer.from(at)]),Ys=mc(zs);return base32$2.encode(Ys).replace(/=+$/,"")}function pn$1(F){const t=[];let Z=BigInt(F);for(;Z>=BigInt(128);)t.push(Number(Z&BigInt(127)|BigInt(128))),Z>>=BigInt(7);return t.push(Number(Z)),Buffer.from(t)}function _c(F){const t=Buffer.from(F.signed.bodyBytes,"base64"),Z=Buffer.from(F.signed.authInfoBytes,"base64"),at=Buffer.from(F.signature.signature,"base64"),Hs=[];Hs.push(Buffer.from([10])),Hs.push(pn$1(t.length)),Hs.push(t),Hs.push(Buffer.from([18])),Hs.push(pn$1(Z.length)),Hs.push(Z),Hs.push(Buffer.from([26])),Hs.push(pn$1(at.length)),Hs.push(at);const zs=Buffer.concat(Hs),Ys=$e$1(zs);return Buffer.from(Ys).toString("hex").toUpperCase()}function Rc(F){var t,Z;const at=[];try{if(typeof F=="string")return at.push(F),at;if(typeof F!="object")return at;F!=null&&F.id&&at.push(F.id);const Hs=(Z=(t=F==null?void 0:F.capabilities)==null?void 0:t.caip345)==null?void 0:Z.transactionHashes;Hs&&at.push(...Hs)}catch(Hs){console.warn("getWalletSendCallsHashes failed: ",Hs)}return at}var $c=Object.defineProperty,Tc=Object.defineProperties,Cc=Object.getOwnPropertyDescriptors,Wr$1=Object.getOwnPropertySymbols,jc=Object.prototype.hasOwnProperty,Lc=Object.prototype.propertyIsEnumerable,Xr$1=(F,t,Z)=>t in F?$c(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,gn$1=(F,t)=>{for(var Z in t||(t={}))jc.call(t,Z)&&Xr$1(F,Z,t[Z]);if(Wr$1)for(var Z of Wr$1(t))Lc.call(t,Z)&&Xr$1(F,Z,t[Z]);return F},Jr$1=(F,t)=>Tc(F,Cc(t));const kc="did:pkh:",Te=F=>F==null?void 0:F.split(":"),Qr$1=F=>{const t=F&&Te(F);if(t)return F.includes(kc)?t[3]:t[1]},to$1=F=>{const t=F&&Te(F);if(t)return t[2]+":"+t[3]},bn$1=F=>{const t=F&&Te(F);if(t)return t.pop()};async function Pc(F){const{cacao:t,projectId:Z}=F,{s:at,p:Hs}=t,zs=eo$1(Hs,Hs.iss),Ys=bn$1(Hs.iss);return await Zr$1(Ys,zs,at,to$1(Hs.iss),Z)}const eo$1=(F,t)=>{const Z=`${F.domain} wants you to sign in with your Ethereum account:`,at=bn$1(t);if(!F.aud&&!F.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let Hs=F.statement||void 0;const zs=`URI: ${F.aud||F.uri}`,Ys=`Version: ${F.version}`,Zs=`Chain ID: ${Qr$1(t)}`,$u=`Nonce: ${F.nonce}`,Eu=`Issued At: ${F.iat}`,Au=F.exp?`Expiration Time: ${F.exp}`:void 0,vu=F.nbf?`Not Before: ${F.nbf}`:void 0,Iu=F.requestId?`Request ID: ${F.requestId}`:void 0,_u=F.resources?`Resources:${F.resources.map(Bu=>`
- ${Bu}`).join("")}`:void 0,Su=je(F.resources);if(Su){const Bu=kt$1(Su);Hs=wn$1(Hs,Bu)}return[Z,at,"",Hs,"",zs,Ys,Zs,$u,Eu,Au,vu,Iu,_u].filter(Bu=>Bu!=null).join(`
`)};function Hc(F,t,Z){return Z.includes("did:pkh:")||(Z=`did:pkh:${Z}`),{h:{t:"caip122"},p:{iss:Z,domain:F.domain,aud:F.aud,version:F.version,nonce:F.nonce,iat:F.iat,statement:F.statement,requestId:F.requestId,resources:F.resources,nbf:F.nbf,exp:F.exp},s:t}}function Dc(F){var t;const{authPayload:Z,chains:at,methods:Hs}=F,zs=Z.statement||"";if(!(at!=null&&at.length))return Z;const Ys=Z.chains,Zs=sn$1(Ys,at);if(!(Zs!=null&&Zs.length))throw new Error("No supported chains");const $u=no$1(Z.resources);if(!$u)return Z;yt$1($u);const Eu=ro$1($u,"eip155");let Au=(Z==null?void 0:Z.resources)||[];if(Eu!=null&&Eu.length){const vu=oo$1(Eu),Iu=sn$1(vu,Hs);if(!(Iu!=null&&Iu.length))throw new Error(`Supported methods don't satisfy the requested: ${JSON.stringify(vu)}, supported: ${JSON.stringify(Hs)}`);const _u=yn$1("request",Iu,{chains:Zs}),Su=fo$1($u,"eip155",_u);Au=((t=Z==null?void 0:Z.resources)==null?void 0:t.slice(0,-1))||[],Au.push(Ce(Su))}return Jr$1(gn$1({},Z),{statement:uo$1(zs,je(Au)),chains:Zs,resources:Z!=null&&Z.resources||Au.length>0?Au:void 0})}function no$1(F){const t=je(F);if(t&&mn$1(t))return kt$1(t)}function Vc(F,t){var Z;return(Z=F==null?void 0:F.att)==null?void 0:Z.hasOwnProperty(t)}function ro$1(F,t){var Z,at;return(Z=F==null?void 0:F.att)!=null&&Z[t]?Object.keys((at=F==null?void 0:F.att)==null?void 0:at[t]):[]}function Mc(F){return(F==null?void 0:F.map(t=>Object.keys(t)))||[]}function oo$1(F){return(F==null?void 0:F.map(t=>{var Z;return(Z=t.split("/"))==null?void 0:Z[1]}))||[]}function so$1(F){return Buffer.from(JSON.stringify(F)).toString("base64")}function io$1(F){return JSON.parse(Buffer.from(F,"base64").toString("utf-8"))}function yt$1(F){if(!F)throw new Error("No recap provided, value is undefined");if(!F.att)throw new Error("No `att` property found");const t=Object.keys(F.att);if(!(t!=null&&t.length))throw new Error("No resources found in `att` property");t.forEach(Z=>{const at=F.att[Z];if(Array.isArray(at))throw new Error(`Resource must be an object: ${Z}`);if(typeof at!="object")throw new Error(`Resource must be an object: ${Z}`);if(!Object.keys(at).length)throw new Error(`Resource object is empty: ${Z}`);Object.keys(at).forEach(Hs=>{const zs=at[Hs];if(!Array.isArray(zs))throw new Error(`Ability limits ${Hs} must be an array of objects, found: ${zs}`);if(!zs.length)throw new Error(`Value of ${Hs} is empty array, must be an array with objects`);zs.forEach(Ys=>{if(typeof Ys!="object")throw new Error(`Ability limits (${Hs}) must be an array of objects, found: ${Ys}`)})})})}function co$1(F,t,Z,at={}){return Z==null||Z.sort((Hs,zs)=>Hs.localeCompare(zs)),{att:{[F]:yn$1(t,Z,at)}}}function fo$1(F,t,Z){var at;F.att[t]=gn$1({},Z);const Hs=(at=Object.keys(F.att))==null?void 0:at.sort((Ys,Zs)=>Ys.localeCompare(Zs)),zs={att:{}};return Hs.reduce((Ys,Zs)=>(Ys.att[Zs]=F.att[Zs],Ys),zs)}function yn$1(F,t,Z={}){t=t==null?void 0:t.sort((Hs,zs)=>Hs.localeCompare(zs));const at=t.map(Hs=>({[`${F}/${Hs}`]:[Z]}));return Object.assign({},...at)}function Ce(F){return yt$1(F),`urn:recap:${so$1(F).replace(/=/g,"")}`}function kt$1(F){const t=io$1(F.replace("urn:recap:",""));return yt$1(t),t}function Kc(F,t,Z){const at=co$1(F,t,Z);return Ce(at)}function mn$1(F){return F&&F.includes("urn:recap:")}function qc(F,t){const Z=kt$1(F),at=kt$1(t),Hs=ao$1(Z,at);return Ce(Hs)}function ao$1(F,t){yt$1(F),yt$1(t);const Z=Object.keys(F.att).concat(Object.keys(t.att)).sort((Hs,zs)=>Hs.localeCompare(zs)),at={att:{}};return Z.forEach(Hs=>{var zs,Ys;Object.keys(((zs=F.att)==null?void 0:zs[Hs])||{}).concat(Object.keys(((Ys=t.att)==null?void 0:Ys[Hs])||{})).sort((Zs,$u)=>Zs.localeCompare($u)).forEach(Zs=>{var $u,Eu;at.att[Hs]=Jr$1(gn$1({},at.att[Hs]),{[Zs]:(($u=F.att[Hs])==null?void 0:$u[Zs])||((Eu=t.att[Hs])==null?void 0:Eu[Zs])})})}),at}function wn$1(F="",t){yt$1(t);const Z="I further authorize the stated URI to perform the following actions on my behalf: ";if(F.includes(Z))return F;const at=[];let Hs=0;Object.keys(t.att).forEach(Zs=>{const $u=Object.keys(t.att[Zs]).map(vu=>({ability:vu.split("/")[0],action:vu.split("/")[1]}));$u.sort((vu,Iu)=>vu.action.localeCompare(Iu.action));const Eu={};$u.forEach(vu=>{Eu[vu.ability]||(Eu[vu.ability]=[]),Eu[vu.ability].push(vu.action)});const Au=Object.keys(Eu).map(vu=>(Hs++,`(${Hs}) '${vu}': '${Eu[vu].join("', '")}' for '${Zs}'.`));at.push(Au.join(", ").replace(".,","."))});const zs=at.join(" "),Ys=`${Z}${zs}`;return`${F?F+" ":""}${Ys}`}function Fc(F){var t;const Z=kt$1(F);yt$1(Z);const at=(t=Z.att)==null?void 0:t.eip155;return at?Object.keys(at).map(Hs=>Hs.split("/")[1]):[]}function Zc(F){const t=kt$1(F);yt$1(t);const Z=[];return Object.values(t.att).forEach(at=>{Object.values(at).forEach(Hs=>{var zs;(zs=Hs==null?void 0:Hs[0])!=null&&zs.chains&&Z.push(Hs[0].chains)})}),[...new Set(Z.flat())]}function uo$1(F,t){if(!t)return F;const Z=kt$1(t);return yt$1(Z),wn$1(F,Z)}function je(F){if(!F)return;const t=F==null?void 0:F[F.length-1];return mn$1(t)?t:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function lo$1(F){return F instanceof Uint8Array||ArrayBuffer.isView(F)&&F.constructor.name==="Uint8Array"}function vn$1(F){if(typeof F!="boolean")throw new Error(`boolean expected, not ${F}`)}function xn$1(F){if(!Number.isSafeInteger(F)||F<0)throw new Error("positive integer expected, got "+F)}function ot(F,...t){if(!lo$1(F))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(F.length))throw new Error("Uint8Array expected of length "+t+", got length="+F.length)}function ho$1(F,t=!0){if(F.destroyed)throw new Error("Hash instance has been destroyed");if(t&&F.finished)throw new Error("Hash#digest() has already been called")}function Gc(F,t){ot(F);const Z=t.outputLen;if(F.length<Z)throw new Error("digestInto() expects output buffer of length at least "+Z)}function Pt$1(F){return new Uint32Array(F.buffer,F.byteOffset,Math.floor(F.byteLength/4))}function Qt$1(...F){for(let t=0;t<F.length;t++)F[t].fill(0)}function zc(F){return new DataView(F.buffer,F.byteOffset,F.byteLength)}const Yc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Wc(F){if(typeof F!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(F))}function En$1(F){if(typeof F=="string")F=Wc(F);else if(lo$1(F))F=Bn$1(F);else throw new Error("Uint8Array expected, got "+typeof F);return F}function Xc(F,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(F,t)}function Jc(F,t){if(F.length!==t.length)return!1;let Z=0;for(let at=0;at<F.length;at++)Z|=F[at]^t[at];return Z===0}const Qc=(F,t)=>{function Z(at,...Hs){if(ot(at),!Yc)throw new Error("Non little-endian hardware is not yet supported");if(F.nonceLength!==void 0){const Eu=Hs[0];if(!Eu)throw new Error("nonce / iv required");F.varSizeNonce?ot(Eu):ot(Eu,F.nonceLength)}const zs=F.tagLength;zs&&Hs[1]!==void 0&&ot(Hs[1]);const Ys=t(at,...Hs),Zs=(Eu,Au)=>{if(Au!==void 0){if(Eu!==2)throw new Error("cipher output not supported");ot(Au)}};let $u=!1;return{encrypt(Eu,Au){if($u)throw new Error("cannot encrypt() twice with same key + nonce");return $u=!0,ot(Eu),Zs(Ys.encrypt.length,Au),Ys.encrypt(Eu,Au)},decrypt(Eu,Au){if(ot(Eu),zs&&Eu.length<zs)throw new Error("invalid ciphertext length: smaller than tagLength="+zs);return Zs(Ys.decrypt.length,Au),Ys.decrypt(Eu,Au)}}}return Object.assign(Z,F),Z};function po$1(F,t,Z=!0){if(t===void 0)return new Uint8Array(F);if(t.length!==F)throw new Error("invalid output length, expected "+F+", got: "+t.length);if(Z&&!ef(t))throw new Error("invalid output, must be aligned");return t}function go$1(F,t,Z,at){if(typeof F.setBigUint64=="function")return F.setBigUint64(t,Z,at);const Hs=BigInt(32),zs=BigInt(4294967295),Ys=Number(Z>>Hs&zs),Zs=Number(Z&zs),$u=at?4:0,Eu=at?0:4;F.setUint32(t+$u,Ys,at),F.setUint32(t+Eu,Zs,at)}function tf(F,t,Z){vn$1(Z);const at=new Uint8Array(16),Hs=zc(at);return go$1(Hs,0,BigInt(t),Z),go$1(Hs,8,BigInt(F),Z),at}function ef(F){return F.byteOffset%4===0}function Bn$1(F){return Uint8Array.from(F)}const bo$1=F=>Uint8Array.from(F.split("").map(t=>t.charCodeAt(0))),nf=bo$1("expand 16-byte k"),rf=bo$1("expand 32-byte k"),of=Pt$1(nf),sf=Pt$1(rf);function K$1(F,t){return F<<t|F>>>32-t}function An$1(F){return F.byteOffset%4===0}const Le$1=64,cf=16,yo$1=2**32-1,mo$1=new Uint32Array;function ff(F,t,Z,at,Hs,zs,Ys,Zs){const $u=Hs.length,Eu=new Uint8Array(Le$1),Au=Pt$1(Eu),vu=An$1(Hs)&&An$1(zs),Iu=vu?Pt$1(Hs):mo$1,_u=vu?Pt$1(zs):mo$1;for(let Su=0;Su<$u;Ys++){if(F(t,Z,at,Au,Ys,Zs),Ys>=yo$1)throw new Error("arx: counter overflow");const Bu=Math.min(Le$1,$u-Su);if(vu&&Bu===Le$1){const Du=Su/4;if(Su%4!==0)throw new Error("arx: invalid block position");for(let Tu=0,Pu;Tu<cf;Tu++)Pu=Du+Tu,_u[Pu]=Iu[Pu]^Au[Tu];Su+=Le$1;continue}for(let Du=0,Tu;Du<Bu;Du++)Tu=Su+Du,zs[Tu]=Hs[Tu]^Eu[Du];Su+=Bu}}function af(F,t){const{allowShortKeys:Z,extendNonceFn:at,counterLength:Hs,counterRight:zs,rounds:Ys}=Xc({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof F!="function")throw new Error("core must be a function");return xn$1(Hs),xn$1(Ys),vn$1(zs),vn$1(Z),(Zs,$u,Eu,Au,vu=0)=>{ot(Zs),ot($u),ot(Eu);const Iu=Eu.length;if(Au===void 0&&(Au=new Uint8Array(Iu)),ot(Au),xn$1(vu),vu<0||vu>=yo$1)throw new Error("arx: counter overflow");if(Au.length<Iu)throw new Error(`arx: output (${Au.length}) is shorter than data (${Iu})`);const _u=[];let Su=Zs.length,Bu,Du;if(Su===32)_u.push(Bu=Bn$1(Zs)),Du=sf;else if(Su===16&&Z)Bu=new Uint8Array(32),Bu.set(Zs),Bu.set(Zs,16),Du=of,_u.push(Bu);else throw new Error(`arx: invalid 32-byte key, got length=${Su}`);An$1($u)||_u.push($u=Bn$1($u));const Tu=Pt$1(Bu);if(at){if($u.length!==24)throw new Error("arx: extended nonce must be 24 bytes");at(Du,Tu,Pt$1($u.subarray(0,16)),Tu),$u=$u.subarray(16)}const Pu=16-Hs;if(Pu!==$u.length)throw new Error(`arx: nonce must be ${Pu} or 16 bytes`);if(Pu!==12){const Fu=new Uint8Array(12);Fu.set($u,zs?0:12-$u.length),$u=Fu,_u.push($u)}const Uu=Pt$1($u);return ff(F,Du,Tu,Uu,Eu,Au,vu,Ys),Qt$1(..._u),Au}}const W$2=(F,t)=>F[t++]&255|(F[t++]&255)<<8;class uf{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=En$1(t),ot(t,32);const Z=W$2(t,0),at=W$2(t,2),Hs=W$2(t,4),zs=W$2(t,6),Ys=W$2(t,8),Zs=W$2(t,10),$u=W$2(t,12),Eu=W$2(t,14);this.r[0]=Z&8191,this.r[1]=(Z>>>13|at<<3)&8191,this.r[2]=(at>>>10|Hs<<6)&7939,this.r[3]=(Hs>>>7|zs<<9)&8191,this.r[4]=(zs>>>4|Ys<<12)&255,this.r[5]=Ys>>>1&8190,this.r[6]=(Ys>>>14|Zs<<2)&8191,this.r[7]=(Zs>>>11|$u<<5)&8065,this.r[8]=($u>>>8|Eu<<8)&8191,this.r[9]=Eu>>>5&127;for(let Au=0;Au<8;Au++)this.pad[Au]=W$2(t,16+2*Au)}process(t,Z,at=!1){const Hs=at?0:2048,{h:zs,r:Ys}=this,Zs=Ys[0],$u=Ys[1],Eu=Ys[2],Au=Ys[3],vu=Ys[4],Iu=Ys[5],_u=Ys[6],Su=Ys[7],Bu=Ys[8],Du=Ys[9],Tu=W$2(t,Z+0),Pu=W$2(t,Z+2),Uu=W$2(t,Z+4),Fu=W$2(t,Z+6),Lu=W$2(t,Z+8),qu=W$2(t,Z+10),zu=W$2(t,Z+12),tl=W$2(t,Z+14);let Wu=zs[0]+(Tu&8191),cl=zs[1]+((Tu>>>13|Pu<<3)&8191),wl=zs[2]+((Pu>>>10|Uu<<6)&8191),hl=zs[3]+((Uu>>>7|Fu<<9)&8191),Qu=zs[4]+((Fu>>>4|Lu<<12)&8191),rl=zs[5]+(Lu>>>1&8191),Hu=zs[6]+((Lu>>>14|qu<<2)&8191),ju=zs[7]+((qu>>>11|zu<<5)&8191),Yu=zs[8]+((zu>>>8|tl<<8)&8191),ul=zs[9]+(tl>>>5|Hs),Xu=0,al=Xu+Wu*Zs+cl*(5*Du)+wl*(5*Bu)+hl*(5*Su)+Qu*(5*_u);Xu=al>>>13,al&=8191,al+=rl*(5*Iu)+Hu*(5*vu)+ju*(5*Au)+Yu*(5*Eu)+ul*(5*$u),Xu+=al>>>13,al&=8191;let pl=Xu+Wu*$u+cl*Zs+wl*(5*Du)+hl*(5*Bu)+Qu*(5*Su);Xu=pl>>>13,pl&=8191,pl+=rl*(5*_u)+Hu*(5*Iu)+ju*(5*vu)+Yu*(5*Au)+ul*(5*Eu),Xu+=pl>>>13,pl&=8191;let ml=Xu+Wu*Eu+cl*$u+wl*Zs+hl*(5*Du)+Qu*(5*Bu);Xu=ml>>>13,ml&=8191,ml+=rl*(5*Su)+Hu*(5*_u)+ju*(5*Iu)+Yu*(5*vu)+ul*(5*Au),Xu+=ml>>>13,ml&=8191;let Il=Xu+Wu*Au+cl*Eu+wl*$u+hl*Zs+Qu*(5*Du);Xu=Il>>>13,Il&=8191,Il+=rl*(5*Bu)+Hu*(5*Su)+ju*(5*_u)+Yu*(5*Iu)+ul*(5*vu),Xu+=Il>>>13,Il&=8191;let dl=Xu+Wu*vu+cl*Au+wl*Eu+hl*$u+Qu*Zs;Xu=dl>>>13,dl&=8191,dl+=rl*(5*Du)+Hu*(5*Bu)+ju*(5*Su)+Yu*(5*_u)+ul*(5*Iu),Xu+=dl>>>13,dl&=8191;let vl=Xu+Wu*Iu+cl*vu+wl*Au+hl*Eu+Qu*$u;Xu=vl>>>13,vl&=8191,vl+=rl*Zs+Hu*(5*Du)+ju*(5*Bu)+Yu*(5*Su)+ul*(5*_u),Xu+=vl>>>13,vl&=8191;let nl=Xu+Wu*_u+cl*Iu+wl*vu+hl*Au+Qu*Eu;Xu=nl>>>13,nl&=8191,nl+=rl*$u+Hu*Zs+ju*(5*Du)+Yu*(5*Bu)+ul*(5*Su),Xu+=nl>>>13,nl&=8191;let el=Xu+Wu*Su+cl*_u+wl*Iu+hl*vu+Qu*Au;Xu=el>>>13,el&=8191,el+=rl*Eu+Hu*$u+ju*Zs+Yu*(5*Du)+ul*(5*Bu),Xu+=el>>>13,el&=8191;let yl=Xu+Wu*Bu+cl*Su+wl*_u+hl*Iu+Qu*vu;Xu=yl>>>13,yl&=8191,yl+=rl*Au+Hu*Eu+ju*$u+Yu*Zs+ul*(5*Du),Xu+=yl>>>13,yl&=8191;let bl=Xu+Wu*Du+cl*Bu+wl*Su+hl*_u+Qu*Iu;Xu=bl>>>13,bl&=8191,bl+=rl*vu+Hu*Au+ju*Eu+Yu*$u+ul*Zs,Xu+=bl>>>13,bl&=8191,Xu=(Xu<<2)+Xu|0,Xu=Xu+al|0,al=Xu&8191,Xu=Xu>>>13,pl+=Xu,zs[0]=al,zs[1]=pl,zs[2]=ml,zs[3]=Il,zs[4]=dl,zs[5]=vl,zs[6]=nl,zs[7]=el,zs[8]=yl,zs[9]=bl}finalize(){const{h:t,pad:Z}=this,at=new Uint16Array(10);let Hs=t[1]>>>13;t[1]&=8191;for(let Zs=2;Zs<10;Zs++)t[Zs]+=Hs,Hs=t[Zs]>>>13,t[Zs]&=8191;t[0]+=Hs*5,Hs=t[0]>>>13,t[0]&=8191,t[1]+=Hs,Hs=t[1]>>>13,t[1]&=8191,t[2]+=Hs,at[0]=t[0]+5,Hs=at[0]>>>13,at[0]&=8191;for(let Zs=1;Zs<10;Zs++)at[Zs]=t[Zs]+Hs,Hs=at[Zs]>>>13,at[Zs]&=8191;at[9]-=8192;let zs=(Hs^1)-1;for(let Zs=0;Zs<10;Zs++)at[Zs]&=zs;zs=~zs;for(let Zs=0;Zs<10;Zs++)t[Zs]=t[Zs]&zs|at[Zs];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let Ys=t[0]+Z[0];t[0]=Ys&65535;for(let Zs=1;Zs<8;Zs++)Ys=(t[Zs]+Z[Zs]|0)+(Ys>>>16)|0,t[Zs]=Ys&65535;Qt$1(at)}update(t){ho$1(this),t=En$1(t),ot(t);const{buffer:Z,blockLen:at}=this,Hs=t.length;for(let zs=0;zs<Hs;){const Ys=Math.min(at-this.pos,Hs-zs);if(Ys===at){for(;at<=Hs-zs;zs+=at)this.process(t,zs);continue}Z.set(t.subarray(zs,zs+Ys),this.pos),this.pos+=Ys,zs+=Ys,this.pos===at&&(this.process(Z,0,!1),this.pos=0)}return this}destroy(){Qt$1(this.h,this.r,this.buffer,this.pad)}digestInto(t){ho$1(this),Gc(t,this),this.finished=!0;const{buffer:Z,h:at}=this;let{pos:Hs}=this;if(Hs){for(Z[Hs++]=1;Hs<16;Hs++)Z[Hs]=0;this.process(Z,0,!0)}this.finalize();let zs=0;for(let Ys=0;Ys<8;Ys++)t[zs++]=at[Ys]>>>0,t[zs++]=at[Ys]>>>8;return t}digest(){const{buffer:t,outputLen:Z}=this;this.digestInto(t);const at=t.slice(0,Z);return this.destroy(),at}}function lf(F){const t=(at,Hs)=>F(Hs).update(En$1(at)).digest(),Z=F(new Uint8Array(32));return t.outputLen=Z.outputLen,t.blockLen=Z.blockLen,t.create=at=>F(at),t}const df=lf(F=>new uf(F));function hf(F,t,Z,at,Hs,zs=20){let Ys=F[0],Zs=F[1],$u=F[2],Eu=F[3],Au=t[0],vu=t[1],Iu=t[2],_u=t[3],Su=t[4],Bu=t[5],Du=t[6],Tu=t[7],Pu=Hs,Uu=Z[0],Fu=Z[1],Lu=Z[2],qu=Ys,zu=Zs,tl=$u,Wu=Eu,cl=Au,wl=vu,hl=Iu,Qu=_u,rl=Su,Hu=Bu,ju=Du,Yu=Tu,ul=Pu,Xu=Uu,al=Fu,pl=Lu;for(let Il=0;Il<zs;Il+=2)qu=qu+cl|0,ul=K$1(ul^qu,16),rl=rl+ul|0,cl=K$1(cl^rl,12),qu=qu+cl|0,ul=K$1(ul^qu,8),rl=rl+ul|0,cl=K$1(cl^rl,7),zu=zu+wl|0,Xu=K$1(Xu^zu,16),Hu=Hu+Xu|0,wl=K$1(wl^Hu,12),zu=zu+wl|0,Xu=K$1(Xu^zu,8),Hu=Hu+Xu|0,wl=K$1(wl^Hu,7),tl=tl+hl|0,al=K$1(al^tl,16),ju=ju+al|0,hl=K$1(hl^ju,12),tl=tl+hl|0,al=K$1(al^tl,8),ju=ju+al|0,hl=K$1(hl^ju,7),Wu=Wu+Qu|0,pl=K$1(pl^Wu,16),Yu=Yu+pl|0,Qu=K$1(Qu^Yu,12),Wu=Wu+Qu|0,pl=K$1(pl^Wu,8),Yu=Yu+pl|0,Qu=K$1(Qu^Yu,7),qu=qu+wl|0,pl=K$1(pl^qu,16),ju=ju+pl|0,wl=K$1(wl^ju,12),qu=qu+wl|0,pl=K$1(pl^qu,8),ju=ju+pl|0,wl=K$1(wl^ju,7),zu=zu+hl|0,ul=K$1(ul^zu,16),Yu=Yu+ul|0,hl=K$1(hl^Yu,12),zu=zu+hl|0,ul=K$1(ul^zu,8),Yu=Yu+ul|0,hl=K$1(hl^Yu,7),tl=tl+Qu|0,Xu=K$1(Xu^tl,16),rl=rl+Xu|0,Qu=K$1(Qu^rl,12),tl=tl+Qu|0,Xu=K$1(Xu^tl,8),rl=rl+Xu|0,Qu=K$1(Qu^rl,7),Wu=Wu+cl|0,al=K$1(al^Wu,16),Hu=Hu+al|0,cl=K$1(cl^Hu,12),Wu=Wu+cl|0,al=K$1(al^Wu,8),Hu=Hu+al|0,cl=K$1(cl^Hu,7);let ml=0;at[ml++]=Ys+qu|0,at[ml++]=Zs+zu|0,at[ml++]=$u+tl|0,at[ml++]=Eu+Wu|0,at[ml++]=Au+cl|0,at[ml++]=vu+wl|0,at[ml++]=Iu+hl|0,at[ml++]=_u+Qu|0,at[ml++]=Su+rl|0,at[ml++]=Bu+Hu|0,at[ml++]=Du+ju|0,at[ml++]=Tu+Yu|0,at[ml++]=Pu+ul|0,at[ml++]=Uu+Xu|0,at[ml++]=Fu+al|0,at[ml++]=Lu+pl|0}const pf=af(hf,{counterRight:!1,counterLength:4,allowShortKeys:!1}),gf=new Uint8Array(16),wo$1=(F,t)=>{F.update(t);const Z=t.length%16;Z&&F.update(gf.subarray(Z))},bf=new Uint8Array(32);function vo$1(F,t,Z,at,Hs){const zs=F(t,Z,bf),Ys=df.create(zs);Hs&&wo$1(Ys,Hs),wo$1(Ys,at);const Zs=tf(at.length,Hs?Hs.length:0,!0);Ys.update(Zs);const $u=Ys.digest();return Qt$1(zs,Zs),$u}const yf=F=>(t,Z,at)=>({encrypt(Hs,zs){const Ys=Hs.length;zs=po$1(Ys+16,zs,!1),zs.set(Hs);const Zs=zs.subarray(0,-16);F(t,Z,Zs,Zs,1);const $u=vo$1(F,t,Z,Zs,at);return zs.set($u,Ys),Qt$1($u),zs},decrypt(Hs,zs){zs=po$1(Hs.length-16,zs,!1);const Ys=Hs.subarray(0,-16),Zs=Hs.subarray(-16),$u=vo$1(F,t,Z,Ys,at);if(!Jc(Zs,$u))throw new Error("invalid tag");return zs.set(Hs.subarray(0,-16)),F(t,Z,zs,zs,1),Qt$1($u),zs}}),xo$1=Qc({blockSize:64,nonceLength:12,tagLength:16},yf(pf));let Eo$1=class extends Re{constructor(t,Z){super(),this.finished=!1,this.destroyed=!1,Ue$1(t);const at=pt(Z);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const Hs=this.blockLen,zs=new Uint8Array(Hs);zs.set(at.length>Hs?t.create().update(at).digest():at);for(let Ys=0;Ys<zs.length;Ys++)zs[Ys]^=54;this.iHash.update(zs),this.oHash=t.create();for(let Ys=0;Ys<zs.length;Ys++)zs[Ys]^=106;this.oHash.update(zs),lt(zs)}update(t){return Nt$1(this),this.iHash.update(t),this}digestInto(t){Nt$1(this),ht(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:Z,iHash:at,finished:Hs,destroyed:zs,blockLen:Ys,outputLen:Zs}=this;return t=t,t.finished=Hs,t.destroyed=zs,t.blockLen=Ys,t.outputLen=Zs,t.oHash=Z._cloneInto(t.oHash),t.iHash=at._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const ke$1=(F,t,Z)=>new Eo$1(F,t).update(Z).digest();ke$1.create=(F,t)=>new Eo$1(F,t);function mf(F,t,Z){return Ue$1(F),Z===void 0&&(Z=new Uint8Array(F.outputLen)),ke$1(F,pt(Z),pt(t))}const In$1=Uint8Array.from([0]),Bo$1=Uint8Array.of();function wf(F,t,Z,at=32){Ue$1(F),mt$1(at);const Hs=F.outputLen;if(at>255*Hs)throw new Error("Length should be <= 255*HashLen");const zs=Math.ceil(at/Hs);Z===void 0&&(Z=Bo$1);const Ys=new Uint8Array(zs*Hs),Zs=ke$1.create(F,t),$u=Zs._cloneInto(),Eu=new Uint8Array(Zs.outputLen);for(let Au=0;Au<zs;Au++)In$1[0]=Au+1,$u.update(Au===0?Bo$1:Eu).update(Z).update(In$1).digestInto(Eu),Ys.set(Eu,Hs*Au),Zs._cloneInto($u);return Zs.destroy(),$u.destroy(),lt(Eu,In$1),Ys.slice(0,at)}const vf=(F,t,Z,at,Hs)=>wf(F,mf(F,t,Z),at,Hs),Pe$1=$e$1,Sn$1=BigInt(0),On$1=BigInt(1);function He$1(F,t=""){if(typeof F!="boolean"){const Z=t&&`"${t}"`;throw new Error(Z+"expected boolean, got type="+typeof F)}return F}function Kt$1(F,t,Z=""){const at=Ne(F),Hs=F==null?void 0:F.length,zs=t!==void 0;if(!at||zs&&Hs!==t){const Ys=Z&&`"${Z}" `,Zs=zs?` of length ${t}`:"",$u=at?`length=${Hs}`:`type=${typeof F}`;throw new Error(Ys+"expected Uint8Array"+Zs+", got "+$u)}return F}function De$2(F){const t=F.toString(16);return t.length&1?"0"+t:t}function Ao$1(F){if(typeof F!="string")throw new Error("hex string expected, got "+typeof F);return F===""?Sn$1:BigInt("0x"+F)}function Ve$2(F){return Ao$1(Jt$1(F))}function Me$2(F){return ht(F),Ao$1(Jt$1(Uint8Array.from(F).reverse()))}function Nn$1(F,t){return _e$2(F.toString(16).padStart(t*2,"0"))}function Un$1(F,t){return Nn$1(F,t).reverse()}function tt$1(F,t,Z){let at;if(typeof t=="string")try{at=_e$2(t)}catch(zs){throw new Error(F+" must be hex string or Uint8Array, cause: "+zs)}else if(Ne(t))at=Uint8Array.from(t);else throw new Error(F+" must be hex string or Uint8Array");const Hs=at.length;if(typeof Z=="number"&&Hs!==Z)throw new Error(F+" of length "+Z+" expected, got "+Hs);return at}const _n$1=F=>typeof F=="bigint"&&Sn$1<=F;function xf(F,t,Z){return _n$1(F)&&_n$1(t)&&_n$1(Z)&&t<=F&&F<Z}function Rn$1(F,t,Z,at){if(!xf(t,Z,at))throw new Error("expected valid "+F+": "+Z+" <= n < "+at+", got "+t)}function Io$1(F){let t;for(t=0;F>Sn$1;F>>=On$1,t+=1);return t}const ye$1=F=>(On$1<<BigInt(F))-On$1;function Ef(F,t,Z){if(typeof F!="number"||F<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof Z!="function")throw new Error("hmacFn must be a function");const at=Iu=>new Uint8Array(Iu),Hs=Iu=>Uint8Array.of(Iu);let zs=at(F),Ys=at(F),Zs=0;const $u=()=>{zs.fill(1),Ys.fill(0),Zs=0},Eu=(...Iu)=>Z(Ys,zs,...Iu),Au=(Iu=at(0))=>{Ys=Eu(Hs(0),Iu),zs=Eu(),Iu.length!==0&&(Ys=Eu(Hs(1),Iu),zs=Eu())},vu=()=>{if(Zs++>=1e3)throw new Error("drbg: tried 1000 values");let Iu=0;const _u=[];for(;Iu<t;){zs=Eu();const Su=zs.slice();_u.push(Su),Iu+=zs.length}return _t$1(..._u)};return(Iu,_u)=>{$u(),Au(Iu);let Su;for(;!(Su=_u(vu()));)Au();return $u(),Su}}function Ke$2(F,t,Z={}){if(!F||typeof F!="object")throw new Error("expected valid options object");function at(Hs,zs,Ys){const Zs=F[Hs];if(Ys&&Zs===void 0)return;const $u=typeof Zs;if($u!==zs||Zs===null)throw new Error(`param "${Hs}" is invalid: expected ${zs}, got ${$u}`)}Object.entries(t).forEach(([Hs,zs])=>at(Hs,zs,!1)),Object.entries(Z).forEach(([Hs,zs])=>at(Hs,zs,!0))}function So$1(F){const t=new WeakMap;return(Z,...at)=>{const Hs=t.get(Z);if(Hs!==void 0)return Hs;const zs=F(Z,...at);return t.set(Z,zs),zs}}const st=BigInt(0),nt=BigInt(1),qt$1=BigInt(2),Oo$1=BigInt(3),No$1=BigInt(4),Uo$1=BigInt(5),Bf=BigInt(7),_o$1=BigInt(8),Af=BigInt(9),Ro$1=BigInt(16);function ct(F,t){const Z=F%t;return Z>=st?Z:t+Z}function gt$1(F,t,Z){let at=F;for(;t-- >st;)at*=at,at%=Z;return at}function $o$1(F,t){if(F===st)throw new Error("invert: expected non-zero number");if(t<=st)throw new Error("invert: expected positive modulus, got "+t);let Z=ct(F,t),at=t,Hs=st,zs=nt;for(;Z!==st;){const Ys=at/Z,Zs=at%Z,$u=Hs-zs*Ys;at=Z,Z=Zs,Hs=zs,zs=$u}if(at!==nt)throw new Error("invert: does not exist");return ct(Hs,t)}function $n$1(F,t,Z){if(!F.eql(F.sqr(t),Z))throw new Error("Cannot find square root")}function To$1(F,t){const Z=(F.ORDER+nt)/No$1,at=F.pow(t,Z);return $n$1(F,at,t),at}function If(F,t){const Z=(F.ORDER-Uo$1)/_o$1,at=F.mul(t,qt$1),Hs=F.pow(at,Z),zs=F.mul(t,Hs),Ys=F.mul(F.mul(zs,qt$1),Hs),Zs=F.mul(zs,F.sub(Ys,F.ONE));return $n$1(F,Zs,t),Zs}function Sf(F){const t=Ht$1(F),Z=Co$1(F),at=Z(t,t.neg(t.ONE)),Hs=Z(t,at),zs=Z(t,t.neg(at)),Ys=(F+Bf)/Ro$1;return(Zs,$u)=>{let Eu=Zs.pow($u,Ys),Au=Zs.mul(Eu,at);const vu=Zs.mul(Eu,Hs),Iu=Zs.mul(Eu,zs),_u=Zs.eql(Zs.sqr(Au),$u),Su=Zs.eql(Zs.sqr(vu),$u);Eu=Zs.cmov(Eu,Au,_u),Au=Zs.cmov(Iu,vu,Su);const Bu=Zs.eql(Zs.sqr(Au),$u),Du=Zs.cmov(Eu,Au,Bu);return $n$1(Zs,Du,$u),Du}}function Co$1(F){if(F<Oo$1)throw new Error("sqrt is not defined for small field");let t=F-nt,Z=0;for(;t%qt$1===st;)t/=qt$1,Z++;let at=qt$1;const Hs=Ht$1(F);for(;Lo$1(Hs,at)===1;)if(at++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(Z===1)return To$1;let zs=Hs.pow(at,t);const Ys=(t+nt)/qt$1;return function(Zs,$u){if(Zs.is0($u))return $u;if(Lo$1(Zs,$u)!==1)throw new Error("Cannot find square root");let Eu=Z,Au=Zs.mul(Zs.ONE,zs),vu=Zs.pow($u,t),Iu=Zs.pow($u,Ys);for(;!Zs.eql(vu,Zs.ONE);){if(Zs.is0(vu))return Zs.ZERO;let _u=1,Su=Zs.sqr(vu);for(;!Zs.eql(Su,Zs.ONE);)if(_u++,Su=Zs.sqr(Su),_u===Eu)throw new Error("Cannot find square root");const Bu=nt<<BigInt(Eu-_u-1),Du=Zs.pow(Au,Bu);Eu=_u,Au=Zs.sqr(Du),vu=Zs.mul(vu,Au),Iu=Zs.mul(Iu,Du)}return Iu}}function Of(F){return F%No$1===Oo$1?To$1:F%_o$1===Uo$1?If:F%Ro$1===Af?Sf(F):Co$1(F)}const Nf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Uf(F){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},Z=Nf.reduce((at,Hs)=>(at[Hs]="function",at),t);return Ke$2(F,Z),F}function _f(F,t,Z){if(Z<st)throw new Error("invalid exponent, negatives unsupported");if(Z===st)return F.ONE;if(Z===nt)return t;let at=F.ONE,Hs=t;for(;Z>st;)Z&nt&&(at=F.mul(at,Hs)),Hs=F.sqr(Hs),Z>>=nt;return at}function jo$1(F,t,Z=!1){const at=new Array(t.length).fill(Z?F.ZERO:void 0),Hs=t.reduce((Ys,Zs,$u)=>F.is0(Zs)?Ys:(at[$u]=Ys,F.mul(Ys,Zs)),F.ONE),zs=F.inv(Hs);return t.reduceRight((Ys,Zs,$u)=>F.is0(Zs)?Ys:(at[$u]=F.mul(Ys,at[$u]),F.mul(Ys,Zs)),zs),at}function Lo$1(F,t){const Z=(F.ORDER-nt)/qt$1,at=F.pow(t,Z),Hs=F.eql(at,F.ONE),zs=F.eql(at,F.ZERO),Ys=F.eql(at,F.neg(F.ONE));if(!Hs&&!zs&&!Ys)throw new Error("invalid Legendre symbol result");return Hs?1:zs?0:-1}function ko$1(F,t){t!==void 0&&mt$1(t);const Z=t!==void 0?t:F.toString(2).length,at=Math.ceil(Z/8);return{nBitLength:Z,nByteLength:at}}function Ht$1(F,t,Z=!1,at={}){if(F<=st)throw new Error("invalid field: expected ORDER > 0, got "+F);let Hs,zs,Ys=!1,Zs;if(typeof t=="object"&&t!=null){if(at.sqrt||Z)throw new Error("cannot specify opts in two arguments");const Iu=t;Iu.BITS&&(Hs=Iu.BITS),Iu.sqrt&&(zs=Iu.sqrt),typeof Iu.isLE=="boolean"&&(Z=Iu.isLE),typeof Iu.modFromBytes=="boolean"&&(Ys=Iu.modFromBytes),Zs=Iu.allowedLengths}else typeof t=="number"&&(Hs=t),at.sqrt&&(zs=at.sqrt);const{nBitLength:$u,nByteLength:Eu}=ko$1(F,Hs);if(Eu>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let Au;const vu=Object.freeze({ORDER:F,isLE:Z,BITS:$u,BYTES:Eu,MASK:ye$1($u),ZERO:st,ONE:nt,allowedLengths:Zs,create:Iu=>ct(Iu,F),isValid:Iu=>{if(typeof Iu!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof Iu);return st<=Iu&&Iu<F},is0:Iu=>Iu===st,isValidNot0:Iu=>!vu.is0(Iu)&&vu.isValid(Iu),isOdd:Iu=>(Iu&nt)===nt,neg:Iu=>ct(-Iu,F),eql:(Iu,_u)=>Iu===_u,sqr:Iu=>ct(Iu*Iu,F),add:(Iu,_u)=>ct(Iu+_u,F),sub:(Iu,_u)=>ct(Iu-_u,F),mul:(Iu,_u)=>ct(Iu*_u,F),pow:(Iu,_u)=>_f(vu,Iu,_u),div:(Iu,_u)=>ct(Iu*$o$1(_u,F),F),sqrN:Iu=>Iu*Iu,addN:(Iu,_u)=>Iu+_u,subN:(Iu,_u)=>Iu-_u,mulN:(Iu,_u)=>Iu*_u,inv:Iu=>$o$1(Iu,F),sqrt:zs||(Iu=>(Au||(Au=Of(F)),Au(vu,Iu))),toBytes:Iu=>Z?Un$1(Iu,Eu):Nn$1(Iu,Eu),fromBytes:(Iu,_u=!0)=>{if(Zs){if(!Zs.includes(Iu.length)||Iu.length>Eu)throw new Error("Field.fromBytes: expected "+Zs+" bytes, got "+Iu.length);const Bu=new Uint8Array(Eu);Bu.set(Iu,Z?0:Bu.length-Iu.length),Iu=Bu}if(Iu.length!==Eu)throw new Error("Field.fromBytes: expected "+Eu+" bytes, got "+Iu.length);let Su=Z?Me$2(Iu):Ve$2(Iu);if(Ys&&(Su=ct(Su,F)),!_u&&!vu.isValid(Su))throw new Error("invalid field element: outside of range 0..ORDER");return Su},invertBatch:Iu=>jo$1(vu,Iu),cmov:(Iu,_u,Su)=>Su?_u:Iu});return Object.freeze(vu)}function Po$1(F){if(typeof F!="bigint")throw new Error("field order must be bigint");const t=F.toString(2).length;return Math.ceil(t/8)}function Ho$1(F){const t=Po$1(F);return t+Math.ceil(t/2)}function Rf(F,t,Z=!1){const at=F.length,Hs=Po$1(t),zs=Ho$1(t);if(at<16||at<zs||at>1024)throw new Error("expected "+zs+"-1024 bytes of input, got "+at);const Ys=Z?Me$2(F):Ve$2(F),Zs=ct(Ys,t-nt)+nt;return Z?Un$1(Zs,Hs):Nn$1(Zs,Hs)}const te=BigInt(0),Ft$1=BigInt(1);function qe$1(F,t){const Z=t.negate();return F?Z:t}function Tn$1(F,t){const Z=jo$1(F.Fp,t.map(at=>at.Z));return t.map((at,Hs)=>F.fromAffine(at.toAffine(Z[Hs])))}function Do$1(F,t){if(!Number.isSafeInteger(F)||F<=0||F>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+F)}function Cn$1(F,t){Do$1(F,t);const Z=Math.ceil(t/F)+1,at=2**(F-1),Hs=2**F,zs=ye$1(F),Ys=BigInt(F);return{windows:Z,windowSize:at,mask:zs,maxNumber:Hs,shiftBy:Ys}}function Vo$1(F,t,Z){const{windowSize:at,mask:Hs,maxNumber:zs,shiftBy:Ys}=Z;let Zs=Number(F&Hs),$u=F>>Ys;Zs>at&&(Zs-=zs,$u+=Ft$1);const Eu=t*at,Au=Eu+Math.abs(Zs)-1,vu=Zs===0,Iu=Zs<0,_u=t%2!==0;return{nextN:$u,offset:Au,isZero:vu,isNeg:Iu,isNegF:_u,offsetF:Eu}}function $f(F,t){if(!Array.isArray(F))throw new Error("array expected");F.forEach((Z,at)=>{if(!(Z instanceof t))throw new Error("invalid point at index "+at)})}function Tf(F,t){if(!Array.isArray(F))throw new Error("array of scalars expected");F.forEach((Z,at)=>{if(!t.isValid(Z))throw new Error("invalid scalar at index "+at)})}const jn$1=new WeakMap,Mo$1=new WeakMap;function Ln$1(F){return Mo$1.get(F)||1}function Ko$1(F){if(F!==te)throw new Error("invalid wNAF")}class Cf{constructor(t,Z){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=Z}_unsafeLadder(t,Z,at=this.ZERO){let Hs=t;for(;Z>te;)Z&Ft$1&&(at=at.add(Hs)),Hs=Hs.double(),Z>>=Ft$1;return at}precomputeWindow(t,Z){const{windows:at,windowSize:Hs}=Cn$1(Z,this.bits),zs=[];let Ys=t,Zs=Ys;for(let $u=0;$u<at;$u++){Zs=Ys,zs.push(Zs);for(let Eu=1;Eu<Hs;Eu++)Zs=Zs.add(Ys),zs.push(Zs);Ys=Zs.double()}return zs}wNAF(t,Z,at){if(!this.Fn.isValid(at))throw new Error("invalid scalar");let Hs=this.ZERO,zs=this.BASE;const Ys=Cn$1(t,this.bits);for(let Zs=0;Zs<Ys.windows;Zs++){const{nextN:$u,offset:Eu,isZero:Au,isNeg:vu,isNegF:Iu,offsetF:_u}=Vo$1(at,Zs,Ys);at=$u,Au?zs=zs.add(qe$1(Iu,Z[_u])):Hs=Hs.add(qe$1(vu,Z[Eu]))}return Ko$1(at),{p:Hs,f:zs}}wNAFUnsafe(t,Z,at,Hs=this.ZERO){const zs=Cn$1(t,this.bits);for(let Ys=0;Ys<zs.windows&&at!==te;Ys++){const{nextN:Zs,offset:$u,isZero:Eu,isNeg:Au}=Vo$1(at,Ys,zs);if(at=Zs,!Eu){const vu=Z[$u];Hs=Hs.add(Au?vu.negate():vu)}}return Ko$1(at),Hs}getPrecomputes(t,Z,at){let Hs=jn$1.get(Z);return Hs||(Hs=this.precomputeWindow(Z,t),t!==1&&(typeof at=="function"&&(Hs=at(Hs)),jn$1.set(Z,Hs))),Hs}cached(t,Z,at){const Hs=Ln$1(t);return this.wNAF(Hs,this.getPrecomputes(Hs,t,at),Z)}unsafe(t,Z,at,Hs){const zs=Ln$1(t);return zs===1?this._unsafeLadder(t,Z,Hs):this.wNAFUnsafe(zs,this.getPrecomputes(zs,t,at),Z,Hs)}createCache(t,Z){Do$1(Z,this.bits),Mo$1.set(t,Z),jn$1.delete(t)}hasCache(t){return Ln$1(t)!==1}}function jf(F,t,Z,at){let Hs=t,zs=F.ZERO,Ys=F.ZERO;for(;Z>te||at>te;)Z&Ft$1&&(zs=zs.add(Hs)),at&Ft$1&&(Ys=Ys.add(Hs)),Hs=Hs.double(),Z>>=Ft$1,at>>=Ft$1;return{p1:zs,p2:Ys}}function Lf(F,t,Z,at){$f(Z,F),Tf(at,t);const Hs=Z.length,zs=at.length;if(Hs!==zs)throw new Error("arrays of points and scalars must have equal length");const Ys=F.ZERO,Zs=Io$1(BigInt(Hs));let $u=1;Zs>12?$u=Zs-3:Zs>4?$u=Zs-2:Zs>0&&($u=2);const Eu=ye$1($u),Au=new Array(Number(Eu)+1).fill(Ys),vu=Math.floor((t.BITS-1)/$u)*$u;let Iu=Ys;for(let _u=vu;_u>=0;_u-=$u){Au.fill(Ys);for(let Bu=0;Bu<zs;Bu++){const Du=at[Bu],Tu=Number(Du>>BigInt(_u)&Eu);Au[Tu]=Au[Tu].add(Z[Bu])}let Su=Ys;for(let Bu=Au.length-1,Du=Ys;Bu>0;Bu--)Du=Du.add(Au[Bu]),Su=Su.add(Du);if(Iu=Iu.add(Su),_u!==0)for(let Bu=0;Bu<$u;Bu++)Iu=Iu.double()}return Iu}function qo$1(F,t,Z){if(t){if(t.ORDER!==F)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Uf(t),t}else return Ht$1(F,{isLE:Z})}function kf(F,t,Z={},at){if(at===void 0&&(at=F==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${F} CURVE object`);for(const Zs of["p","n","h"]){const $u=t[Zs];if(!(typeof $u=="bigint"&&$u>te))throw new Error(`CURVE.${Zs} must be positive bigint`)}const Hs=qo$1(t.p,Z.Fp,at),zs=qo$1(t.n,Z.Fn,at),Ys=["Gx","Gy","a",F==="weierstrass"?"b":"d"];for(const Zs of Ys)if(!Hs.isValid(t[Zs]))throw new Error(`CURVE.${Zs} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:Hs,Fn:zs}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),kr$1("HashToScalar-");const me$2=BigInt(0),ee$1=BigInt(1),Fe$1=BigInt(2);function Pf(F){return Ke$2(F,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...F})}function Hf(F){const t=Pf(F),{P:Z,type:at,adjustScalarBytes:Hs,powPminus2:zs,randomBytes:Ys}=t,Zs=at==="x25519";if(!Zs&&at!=="x448")throw new Error("invalid type");const $u=Ys||Mt$1,Eu=Zs?255:448,Au=Zs?32:56,vu=BigInt(Zs?9:5),Iu=BigInt(Zs?121665:39081),_u=Zs?Fe$1**BigInt(254):Fe$1**BigInt(447),Su=Zs?BigInt(8)*Fe$1**BigInt(251)-ee$1:BigInt(4)*Fe$1**BigInt(445)-ee$1,Bu=_u+Su+ee$1,Du=hl=>ct(hl,Z),Tu=Pu(vu);function Pu(hl){return Un$1(Du(hl),Au)}function Uu(hl){const Qu=tt$1("u coordinate",hl,Au);return Zs&&(Qu[31]&=127),Du(Me$2(Qu))}function Fu(hl){return Me$2(Hs(tt$1("scalar",hl,Au)))}function Lu(hl,Qu){const rl=tl(Uu(Qu),Fu(hl));if(rl===me$2)throw new Error("invalid private or public key received");return Pu(rl)}function qu(hl){return Lu(hl,Tu)}function zu(hl,Qu,rl){const Hu=Du(hl*(Qu-rl));return Qu=Du(Qu-Hu),rl=Du(rl+Hu),{x_2:Qu,x_3:rl}}function tl(hl,Qu){Rn$1("u",hl,me$2,Z),Rn$1("scalar",Qu,_u,Bu);const rl=Qu,Hu=hl;let ju=ee$1,Yu=me$2,ul=hl,Xu=ee$1,al=me$2;for(let ml=BigInt(Eu-1);ml>=me$2;ml--){const Il=rl>>ml&ee$1;al^=Il,{x_2:ju,x_3:ul}=zu(al,ju,ul),{x_2:Yu,x_3:Xu}=zu(al,Yu,Xu),al=Il;const dl=ju+Yu,vl=Du(dl*dl),nl=ju-Yu,el=Du(nl*nl),yl=vl-el,bl=ul+Xu,Mu=ul-Xu,Ru=Du(Mu*dl),Ou=Du(bl*nl),Vu=Ru+Ou,Gu=Ru-Ou;ul=Du(Vu*Vu),Xu=Du(Hu*Du(Gu*Gu)),ju=Du(vl*el),Yu=Du(yl*(vl+Du(Iu*yl)))}({x_2:ju,x_3:ul}=zu(al,ju,ul)),{x_2:Yu,x_3:Xu}=zu(al,Yu,Xu);const pl=zs(Yu);return Du(ju*pl)}const Wu={secretKey:Au,publicKey:Au,seed:Au},cl=(hl=$u(Au))=>(ht(hl,Wu.seed),hl);function wl(hl){const Qu=cl(hl);return{secretKey:Qu,publicKey:qu(Qu)}}return{keygen:wl,getSharedSecret:(hl,Qu)=>Lu(hl,Qu),getPublicKey:hl=>qu(hl),scalarMult:Lu,scalarMultBase:qu,utils:{randomSecretKey:cl,randomPrivateKey:cl},GuBytes:Tu.slice(),lengths:Wu}}const Df=BigInt(1),Fo$1=BigInt(2),Vf=BigInt(3),Mf=BigInt(5),Kf=BigInt(8),Zo$1=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),qf={p:Zo$1,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Kf,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Ff(F){const t=BigInt(10),Z=BigInt(20),at=BigInt(40),Hs=BigInt(80),zs=Zo$1,Ys=F*F%zs*F%zs,Zs=gt$1(Ys,Fo$1,zs)*Ys%zs,$u=gt$1(Zs,Df,zs)*F%zs,Eu=gt$1($u,Mf,zs)*$u%zs,Au=gt$1(Eu,t,zs)*Eu%zs,vu=gt$1(Au,Z,zs)*Au%zs,Iu=gt$1(vu,at,zs)*vu%zs,_u=gt$1(Iu,Hs,zs)*Iu%zs,Su=gt$1(_u,Hs,zs)*Iu%zs,Bu=gt$1(Su,t,zs)*Eu%zs;return{pow_p_5_8:gt$1(Bu,Fo$1,zs)*F%zs,b2:Ys}}function Zf(F){return F[0]&=248,F[31]&=127,F[31]|=64,F}const Gf=Ht$1(qf.p,{isLE:!0}),kn$1=(()=>{const F=Gf.ORDER;return Hf({P:F,type:"x25519",powPminus2:t=>{const{pow_p_5_8:Z,b2:at}=Ff(t);return ct(gt$1(Z,Vf,F)*at,F)},adjustScalarBytes:Zf})})(),Go$1=(F,t)=>(F+(F>=0?t:-t)/zo$1)/t;function zf(F,t,Z){const[[at,Hs],[zs,Ys]]=t,Zs=Go$1(Ys*F,Z),$u=Go$1(-Hs*F,Z);let Eu=F-Zs*at-$u*zs,Au=-Zs*Hs-$u*Ys;const vu=Eu<Et$2,Iu=Au<Et$2;vu&&(Eu=-Eu),Iu&&(Au=-Au);const _u=ye$1(Math.ceil(Io$1(Z)/2))+ne;if(Eu<Et$2||Eu>=_u||Au<Et$2||Au>=_u)throw new Error("splitScalar (endomorphism): failed, k="+F);return{k1neg:vu,k1:Eu,k2neg:Iu,k2:Au}}function Pn$1(F){if(!["compact","recovered","der"].includes(F))throw new Error('Signature format must be "compact", "recovered", or "der"');return F}function Hn$1(F,t){const Z={};for(let at of Object.keys(t))Z[at]=F[at]===void 0?t[at]:F[at];return He$1(Z.lowS,"lowS"),He$1(Z.prehash,"prehash"),Z.format!==void 0&&Pn$1(Z.format),Z}class Yf extends Error{constructor(t=""){super(t)}}const xt$1={Err:Yf,_tlv:{encode:(F,t)=>{const{Err:Z}=xt$1;if(F<0||F>256)throw new Z("tlv.encode: wrong tag");if(t.length&1)throw new Z("tlv.encode: unpadded data");const at=t.length/2,Hs=De$2(at);if(Hs.length/2&128)throw new Z("tlv.encode: long form length too big");const zs=at>127?De$2(Hs.length/2|128):"";return De$2(F)+zs+Hs+t},decode(F,t){const{Err:Z}=xt$1;let at=0;if(F<0||F>256)throw new Z("tlv.encode: wrong tag");if(t.length<2||t[at++]!==F)throw new Z("tlv.decode: wrong tlv");const Hs=t[at++],zs=!!(Hs&128);let Ys=0;if(!zs)Ys=Hs;else{const $u=Hs&127;if(!$u)throw new Z("tlv.decode(long): indefinite length not supported");if($u>4)throw new Z("tlv.decode(long): byte length is too big");const Eu=t.subarray(at,at+$u);if(Eu.length!==$u)throw new Z("tlv.decode: length bytes not complete");if(Eu[0]===0)throw new Z("tlv.decode(long): zero leftmost byte");for(const Au of Eu)Ys=Ys<<8|Au;if(at+=$u,Ys<128)throw new Z("tlv.decode(long): not minimal encoding")}const Zs=t.subarray(at,at+Ys);if(Zs.length!==Ys)throw new Z("tlv.decode: wrong value length");return{v:Zs,l:t.subarray(at+Ys)}}},_int:{encode(F){const{Err:t}=xt$1;if(F<Et$2)throw new t("integer: negative integers are not allowed");let Z=De$2(F);if(Number.parseInt(Z[0],16)&8&&(Z="00"+Z),Z.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return Z},decode(F){const{Err:t}=xt$1;if(F[0]&128)throw new t("invalid signature integer: negative");if(F[0]===0&&!(F[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Ve$2(F)}},toSig(F){const{Err:t,_int:Z,_tlv:at}=xt$1,Hs=tt$1("signature",F),{v:zs,l:Ys}=at.decode(48,Hs);if(Ys.length)throw new t("invalid signature: left bytes after parsing");const{v:Zs,l:$u}=at.decode(2,zs),{v:Eu,l:Au}=at.decode(2,$u);if(Au.length)throw new t("invalid signature: left bytes after parsing");return{r:Z.decode(Zs),s:Z.decode(Eu)}},hexFromSig(F){const{_tlv:t,_int:Z}=xt$1,at=t.encode(2,Z.encode(F.r)),Hs=t.encode(2,Z.encode(F.s)),zs=at+Hs;return t.encode(48,zs)}},Et$2=BigInt(0),ne=BigInt(1),zo$1=BigInt(2),Ze$1=BigInt(3),Wf=BigInt(4);function re(F,t){const{BYTES:Z}=F;let at;if(typeof t=="bigint")at=t;else{let Hs=tt$1("private key",t);try{at=F.fromBytes(Hs)}catch{throw new Error(`invalid private key: expected ui8a of size ${Z}, got ${typeof t}`)}}if(!F.isValidNot0(at))throw new Error("invalid private key: out of range [1..N-1]");return at}function Xf(F,t={}){const Z=kf("weierstrass",F,t),{Fp:at,Fn:Hs}=Z;let zs=Z.CURVE;const{h:Ys,n:Zs}=zs;Ke$2(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:$u}=t;if($u&&(!at.is0(zs.a)||typeof $u.beta!="bigint"||!Array.isArray($u.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const Eu=Wo$1(at,Hs);function Au(){if(!at.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function vu(hl,Qu,rl){const{x:Hu,y:ju}=Qu.toAffine(),Yu=at.toBytes(Hu);if(He$1(rl,"isCompressed"),rl){Au();const ul=!at.isOdd(ju);return _t$1(Yo$1(ul),Yu)}else return _t$1(Uint8Array.of(4),Yu,at.toBytes(ju))}function Iu(hl){Kt$1(hl,void 0,"Point");const{publicKey:Qu,publicKeyUncompressed:rl}=Eu,Hu=hl.length,ju=hl[0],Yu=hl.subarray(1);if(Hu===Qu&&(ju===2||ju===3)){const ul=at.fromBytes(Yu);if(!at.isValid(ul))throw new Error("bad point: is not on curve, wrong x");const Xu=Bu(ul);let al;try{al=at.sqrt(Xu)}catch(ml){const Il=ml instanceof Error?": "+ml.message:"";throw new Error("bad point: is not on curve, sqrt error"+Il)}Au();const pl=at.isOdd(al);return(ju&1)===1!==pl&&(al=at.neg(al)),{x:ul,y:al}}else if(Hu===rl&&ju===4){const ul=at.BYTES,Xu=at.fromBytes(Yu.subarray(0,ul)),al=at.fromBytes(Yu.subarray(ul,ul*2));if(!Du(Xu,al))throw new Error("bad point: is not on curve");return{x:Xu,y:al}}else throw new Error(`bad point: got length ${Hu}, expected compressed=${Qu} or uncompressed=${rl}`)}const _u=t.toBytes||vu,Su=t.fromBytes||Iu;function Bu(hl){const Qu=at.sqr(hl),rl=at.mul(Qu,hl);return at.add(at.add(rl,at.mul(hl,zs.a)),zs.b)}function Du(hl,Qu){const rl=at.sqr(Qu),Hu=Bu(hl);return at.eql(rl,Hu)}if(!Du(zs.Gx,zs.Gy))throw new Error("bad curve params: generator point");const Tu=at.mul(at.pow(zs.a,Ze$1),Wf),Pu=at.mul(at.sqr(zs.b),BigInt(27));if(at.is0(at.add(Tu,Pu)))throw new Error("bad curve params: a or b");function Uu(hl,Qu,rl=!1){if(!at.isValid(Qu)||rl&&at.is0(Qu))throw new Error(`bad point coordinate ${hl}`);return Qu}function Fu(hl){if(!(hl instanceof Wu))throw new Error("ProjectivePoint expected")}function Lu(hl){if(!$u||!$u.basises)throw new Error("no endo");return zf(hl,$u.basises,Hs.ORDER)}const qu=So$1((hl,Qu)=>{const{X:rl,Y:Hu,Z:ju}=hl;if(at.eql(ju,at.ONE))return{x:rl,y:Hu};const Yu=hl.is0();Qu==null&&(Qu=Yu?at.ONE:at.inv(ju));const ul=at.mul(rl,Qu),Xu=at.mul(Hu,Qu),al=at.mul(ju,Qu);if(Yu)return{x:at.ZERO,y:at.ZERO};if(!at.eql(al,at.ONE))throw new Error("invZ was invalid");return{x:ul,y:Xu}}),zu=So$1(hl=>{if(hl.is0()){if(t.allowInfinityPoint&&!at.is0(hl.Y))return;throw new Error("bad point: ZERO")}const{x:Qu,y:rl}=hl.toAffine();if(!at.isValid(Qu)||!at.isValid(rl))throw new Error("bad point: x or y not field elements");if(!Du(Qu,rl))throw new Error("bad point: equation left != right");if(!hl.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function tl(hl,Qu,rl,Hu,ju){return rl=new Wu(at.mul(rl.X,hl),rl.Y,rl.Z),Qu=qe$1(Hu,Qu),rl=qe$1(ju,rl),Qu.add(rl)}class Wu{constructor(Qu,rl,Hu){this.X=Uu("x",Qu),this.Y=Uu("y",rl,!0),this.Z=Uu("z",Hu),Object.freeze(this)}static CURVE(){return zs}static fromAffine(Qu){const{x:rl,y:Hu}=Qu||{};if(!Qu||!at.isValid(rl)||!at.isValid(Hu))throw new Error("invalid affine point");if(Qu instanceof Wu)throw new Error("projective point not allowed");return at.is0(rl)&&at.is0(Hu)?Wu.ZERO:new Wu(rl,Hu,at.ONE)}static fromBytes(Qu){const rl=Wu.fromAffine(Su(Kt$1(Qu,void 0,"point")));return rl.assertValidity(),rl}static fromHex(Qu){return Wu.fromBytes(tt$1("pointHex",Qu))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(Qu=8,rl=!0){return wl.createCache(this,Qu),rl||this.multiply(Ze$1),this}assertValidity(){zu(this)}hasEvenY(){const{y:Qu}=this.toAffine();if(!at.isOdd)throw new Error("Field doesn't support isOdd");return!at.isOdd(Qu)}equals(Qu){Fu(Qu);const{X:rl,Y:Hu,Z:ju}=this,{X:Yu,Y:ul,Z:Xu}=Qu,al=at.eql(at.mul(rl,Xu),at.mul(Yu,ju)),pl=at.eql(at.mul(Hu,Xu),at.mul(ul,ju));return al&&pl}negate(){return new Wu(this.X,at.neg(this.Y),this.Z)}double(){const{a:Qu,b:rl}=zs,Hu=at.mul(rl,Ze$1),{X:ju,Y:Yu,Z:ul}=this;let Xu=at.ZERO,al=at.ZERO,pl=at.ZERO,ml=at.mul(ju,ju),Il=at.mul(Yu,Yu),dl=at.mul(ul,ul),vl=at.mul(ju,Yu);return vl=at.add(vl,vl),pl=at.mul(ju,ul),pl=at.add(pl,pl),Xu=at.mul(Qu,pl),al=at.mul(Hu,dl),al=at.add(Xu,al),Xu=at.sub(Il,al),al=at.add(Il,al),al=at.mul(Xu,al),Xu=at.mul(vl,Xu),pl=at.mul(Hu,pl),dl=at.mul(Qu,dl),vl=at.sub(ml,dl),vl=at.mul(Qu,vl),vl=at.add(vl,pl),pl=at.add(ml,ml),ml=at.add(pl,ml),ml=at.add(ml,dl),ml=at.mul(ml,vl),al=at.add(al,ml),dl=at.mul(Yu,ul),dl=at.add(dl,dl),ml=at.mul(dl,vl),Xu=at.sub(Xu,ml),pl=at.mul(dl,Il),pl=at.add(pl,pl),pl=at.add(pl,pl),new Wu(Xu,al,pl)}add(Qu){Fu(Qu);const{X:rl,Y:Hu,Z:ju}=this,{X:Yu,Y:ul,Z:Xu}=Qu;let al=at.ZERO,pl=at.ZERO,ml=at.ZERO;const Il=zs.a,dl=at.mul(zs.b,Ze$1);let vl=at.mul(rl,Yu),nl=at.mul(Hu,ul),el=at.mul(ju,Xu),yl=at.add(rl,Hu),bl=at.add(Yu,ul);yl=at.mul(yl,bl),bl=at.add(vl,nl),yl=at.sub(yl,bl),bl=at.add(rl,ju);let Mu=at.add(Yu,Xu);return bl=at.mul(bl,Mu),Mu=at.add(vl,el),bl=at.sub(bl,Mu),Mu=at.add(Hu,ju),al=at.add(ul,Xu),Mu=at.mul(Mu,al),al=at.add(nl,el),Mu=at.sub(Mu,al),ml=at.mul(Il,bl),al=at.mul(dl,el),ml=at.add(al,ml),al=at.sub(nl,ml),ml=at.add(nl,ml),pl=at.mul(al,ml),nl=at.add(vl,vl),nl=at.add(nl,vl),el=at.mul(Il,el),bl=at.mul(dl,bl),nl=at.add(nl,el),el=at.sub(vl,el),el=at.mul(Il,el),bl=at.add(bl,el),vl=at.mul(nl,bl),pl=at.add(pl,vl),vl=at.mul(Mu,bl),al=at.mul(yl,al),al=at.sub(al,vl),vl=at.mul(yl,nl),ml=at.mul(Mu,ml),ml=at.add(ml,vl),new Wu(al,pl,ml)}subtract(Qu){return this.add(Qu.negate())}is0(){return this.equals(Wu.ZERO)}multiply(Qu){const{endo:rl}=t;if(!Hs.isValidNot0(Qu))throw new Error("invalid scalar: out of range");let Hu,ju;const Yu=ul=>wl.cached(this,ul,Xu=>Tn$1(Wu,Xu));if(rl){const{k1neg:ul,k1:Xu,k2neg:al,k2:pl}=Lu(Qu),{p:ml,f:Il}=Yu(Xu),{p:dl,f:vl}=Yu(pl);ju=Il.add(vl),Hu=tl(rl.beta,ml,dl,ul,al)}else{const{p:ul,f:Xu}=Yu(Qu);Hu=ul,ju=Xu}return Tn$1(Wu,[Hu,ju])[0]}multiplyUnsafe(Qu){const{endo:rl}=t,Hu=this;if(!Hs.isValid(Qu))throw new Error("invalid scalar: out of range");if(Qu===Et$2||Hu.is0())return Wu.ZERO;if(Qu===ne)return Hu;if(wl.hasCache(this))return this.multiply(Qu);if(rl){const{k1neg:ju,k1:Yu,k2neg:ul,k2:Xu}=Lu(Qu),{p1:al,p2:pl}=jf(Wu,Hu,Yu,Xu);return tl(rl.beta,al,pl,ju,ul)}else return wl.unsafe(Hu,Qu)}multiplyAndAddUnsafe(Qu,rl,Hu){const ju=this.multiplyUnsafe(rl).add(Qu.multiplyUnsafe(Hu));return ju.is0()?void 0:ju}toAffine(Qu){return qu(this,Qu)}isTorsionFree(){const{isTorsionFree:Qu}=t;return Ys===ne?!0:Qu?Qu(Wu,this):wl.unsafe(this,Zs).is0()}clearCofactor(){const{clearCofactor:Qu}=t;return Ys===ne?this:Qu?Qu(Wu,this):this.multiplyUnsafe(Ys)}isSmallOrder(){return this.multiplyUnsafe(Ys).is0()}toBytes(Qu=!0){return He$1(Qu,"isCompressed"),this.assertValidity(),_u(Wu,this,Qu)}toHex(Qu=!0){return Jt$1(this.toBytes(Qu))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(Qu=!0){return this.toBytes(Qu)}_setWindowSize(Qu){this.precompute(Qu)}static normalizeZ(Qu){return Tn$1(Wu,Qu)}static msm(Qu,rl){return Lf(Wu,Hs,Qu,rl)}static fromPrivateKey(Qu){return Wu.BASE.multiply(re(Hs,Qu))}}Wu.BASE=new Wu(zs.Gx,zs.Gy,at.ONE),Wu.ZERO=new Wu(at.ZERO,at.ONE,at.ZERO),Wu.Fp=at,Wu.Fn=Hs;const cl=Hs.BITS,wl=new Cf(Wu,t.endo?Math.ceil(cl/2):cl);return Wu.BASE.precompute(8),Wu}function Yo$1(F){return Uint8Array.of(F?2:3)}function Wo$1(F,t){return{secretKey:t.BYTES,publicKey:1+F.BYTES,publicKeyUncompressed:1+2*F.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function Jf(F,t={}){const{Fn:Z}=F,at=t.randomBytes||Mt$1,Hs=Object.assign(Wo$1(F.Fp,Z),{seed:Ho$1(Z.ORDER)});function zs(Iu){try{return!!re(Z,Iu)}catch{return!1}}function Ys(Iu,_u){const{publicKey:Su,publicKeyUncompressed:Bu}=Hs;try{const Du=Iu.length;return _u===!0&&Du!==Su||_u===!1&&Du!==Bu?!1:!!F.fromBytes(Iu)}catch{return!1}}function Zs(Iu=at(Hs.seed)){return Rf(Kt$1(Iu,Hs.seed,"seed"),Z.ORDER)}function $u(Iu,_u=!0){return F.BASE.multiply(re(Z,Iu)).toBytes(_u)}function Eu(Iu){const _u=Zs(Iu);return{secretKey:_u,publicKey:$u(_u)}}function Au(Iu){if(typeof Iu=="bigint")return!1;if(Iu instanceof F)return!0;const{secretKey:_u,publicKey:Su,publicKeyUncompressed:Bu}=Hs;if(Z.allowedLengths||_u===Su)return;const Du=tt$1("key",Iu).length;return Du===Su||Du===Bu}function vu(Iu,_u,Su=!0){if(Au(Iu)===!0)throw new Error("first arg must be private key");if(Au(_u)===!1)throw new Error("second arg must be public key");const Bu=re(Z,Iu);return F.fromHex(_u).multiply(Bu).toBytes(Su)}return Object.freeze({getPublicKey:$u,getSharedSecret:vu,keygen:Eu,Point:F,utils:{isValidSecretKey:zs,isValidPublicKey:Ys,randomSecretKey:Zs,isValidPrivateKey:zs,randomPrivateKey:Zs,normPrivateKeyToScalar:Iu=>re(Z,Iu),precompute(Iu=8,_u=F.BASE){return _u.precompute(Iu,!1)}},lengths:Hs})}function Qf(F,t,Z={}){Ue$1(t),Ke$2(Z,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const at=Z.randomBytes||Mt$1,Hs=Z.hmac||((rl,...Hu)=>ke$1(t,rl,_t$1(...Hu))),{Fp:zs,Fn:Ys}=F,{ORDER:Zs,BITS:$u}=Ys,{keygen:Eu,getPublicKey:Au,getSharedSecret:vu,utils:Iu,lengths:_u}=Jf(F,Z),Su={prehash:!1,lowS:typeof Z.lowS=="boolean"?Z.lowS:!1,format:void 0,extraEntropy:!1},Bu="compact";function Du(rl){const Hu=Zs>>ne;return rl>Hu}function Tu(rl,Hu){if(!Ys.isValidNot0(Hu))throw new Error(`invalid signature ${rl}: out of range 1..Point.Fn.ORDER`);return Hu}function Pu(rl,Hu){Pn$1(Hu);const ju=_u.signature,Yu=Hu==="compact"?ju:Hu==="recovered"?ju+1:void 0;return Kt$1(rl,Yu,`${Hu} signature`)}class Uu{constructor(Hu,ju,Yu){this.r=Tu("r",Hu),this.s=Tu("s",ju),Yu!=null&&(this.recovery=Yu),Object.freeze(this)}static fromBytes(Hu,ju=Bu){Pu(Hu,ju);let Yu;if(ju==="der"){const{r:pl,s:ml}=xt$1.toSig(Kt$1(Hu));return new Uu(pl,ml)}ju==="recovered"&&(Yu=Hu[0],ju="compact",Hu=Hu.subarray(1));const ul=Ys.BYTES,Xu=Hu.subarray(0,ul),al=Hu.subarray(ul,ul*2);return new Uu(Ys.fromBytes(Xu),Ys.fromBytes(al),Yu)}static fromHex(Hu,ju){return this.fromBytes(_e$2(Hu),ju)}addRecoveryBit(Hu){return new Uu(this.r,this.s,Hu)}recoverPublicKey(Hu){const ju=zs.ORDER,{r:Yu,s:ul,recovery:Xu}=this;if(Xu==null||![0,1,2,3].includes(Xu))throw new Error("recovery id invalid");if(Zs*zo$1<ju&&Xu>1)throw new Error("recovery id is ambiguous for h>1 curve");const al=Xu===2||Xu===3?Yu+Zs:Yu;if(!zs.isValid(al))throw new Error("recovery id 2 or 3 invalid");const pl=zs.toBytes(al),ml=F.fromBytes(_t$1(Yo$1((Xu&1)===0),pl)),Il=Ys.inv(al),dl=Lu(tt$1("msgHash",Hu)),vl=Ys.create(-dl*Il),nl=Ys.create(ul*Il),el=F.BASE.multiplyUnsafe(vl).add(ml.multiplyUnsafe(nl));if(el.is0())throw new Error("point at infinify");return el.assertValidity(),el}hasHighS(){return Du(this.s)}toBytes(Hu=Bu){if(Pn$1(Hu),Hu==="der")return _e$2(xt$1.hexFromSig(this));const ju=Ys.toBytes(this.r),Yu=Ys.toBytes(this.s);if(Hu==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return _t$1(Uint8Array.of(this.recovery),ju,Yu)}return _t$1(ju,Yu)}toHex(Hu){return Jt$1(this.toBytes(Hu))}assertValidity(){}static fromCompact(Hu){return Uu.fromBytes(tt$1("sig",Hu),"compact")}static fromDER(Hu){return Uu.fromBytes(tt$1("sig",Hu),"der")}normalizeS(){return this.hasHighS()?new Uu(this.r,Ys.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Jt$1(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Jt$1(this.toBytes("compact"))}}const Fu=Z.bits2int||function(rl){if(rl.length>8192)throw new Error("input is too large");const Hu=Ve$2(rl),ju=rl.length*8-$u;return ju>0?Hu>>BigInt(ju):Hu},Lu=Z.bits2int_modN||function(rl){return Ys.create(Fu(rl))},qu=ye$1($u);function zu(rl){return Rn$1("num < 2^"+$u,rl,Et$2,qu),Ys.toBytes(rl)}function tl(rl,Hu){return Kt$1(rl,void 0,"message"),Hu?Kt$1(t(rl),void 0,"prehashed message"):rl}function Wu(rl,Hu,ju){if(["recovered","canonical"].some(nl=>nl in ju))throw new Error("sign() legacy options not supported");const{lowS:Yu,prehash:ul,extraEntropy:Xu}=Hn$1(ju,Su);rl=tl(rl,ul);const al=Lu(rl),pl=re(Ys,Hu),ml=[zu(pl),zu(al)];if(Xu!=null&&Xu!==!1){const nl=Xu===!0?at(_u.secretKey):Xu;ml.push(tt$1("extraEntropy",nl))}const Il=_t$1(...ml),dl=al;function vl(nl){const el=Fu(nl);if(!Ys.isValidNot0(el))return;const yl=Ys.inv(el),bl=F.BASE.multiply(el).toAffine(),Mu=Ys.create(bl.x);if(Mu===Et$2)return;const Ru=Ys.create(yl*Ys.create(dl+Mu*pl));if(Ru===Et$2)return;let Ou=(bl.x===Mu?0:2)|Number(bl.y&ne),Vu=Ru;return Yu&&Du(Ru)&&(Vu=Ys.neg(Ru),Ou^=1),new Uu(Mu,Vu,Ou)}return{seed:Il,k2sig:vl}}function cl(rl,Hu,ju={}){rl=tt$1("message",rl);const{seed:Yu,k2sig:ul}=Wu(rl,Hu,ju);return Ef(t.outputLen,Ys.BYTES,Hs)(Yu,ul)}function wl(rl){let Hu;const ju=typeof rl=="string"||Ne(rl),Yu=!ju&&rl!==null&&typeof rl=="object"&&typeof rl.r=="bigint"&&typeof rl.s=="bigint";if(!ju&&!Yu)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(Yu)Hu=new Uu(rl.r,rl.s);else if(ju){try{Hu=Uu.fromBytes(tt$1("sig",rl),"der")}catch(ul){if(!(ul instanceof xt$1.Err))throw ul}if(!Hu)try{Hu=Uu.fromBytes(tt$1("sig",rl),"compact")}catch{return!1}}return Hu||!1}function hl(rl,Hu,ju,Yu={}){const{lowS:ul,prehash:Xu,format:al}=Hn$1(Yu,Su);if(ju=tt$1("publicKey",ju),Hu=tl(tt$1("message",Hu),Xu),"strict"in Yu)throw new Error("options.strict was renamed to lowS");const pl=al===void 0?wl(rl):Uu.fromBytes(tt$1("sig",rl),al);if(pl===!1)return!1;try{const ml=F.fromBytes(ju);if(ul&&pl.hasHighS())return!1;const{r:Il,s:dl}=pl,vl=Lu(Hu),nl=Ys.inv(dl),el=Ys.create(vl*nl),yl=Ys.create(Il*nl),bl=F.BASE.multiplyUnsafe(el).add(ml.multiplyUnsafe(yl));return bl.is0()?!1:Ys.create(bl.x)===Il}catch{return!1}}function Qu(rl,Hu,ju={}){const{prehash:Yu}=Hn$1(ju,Su);return Hu=tl(Hu,Yu),Uu.fromBytes(rl,"recovered").recoverPublicKey(Hu).toBytes()}return Object.freeze({keygen:Eu,getPublicKey:Au,getSharedSecret:vu,utils:Iu,lengths:_u,Point:F,sign:cl,verify:hl,recoverPublicKey:Qu,Signature:Uu,hash:t})}function ta$1(F){const t={a:F.a,b:F.b,p:F.Fp.ORDER,n:F.n,h:F.h,Gx:F.Gx,Gy:F.Gy},Z=F.Fp;let at=F.allowedPrivateKeyLengths?Array.from(new Set(F.allowedPrivateKeyLengths.map(Ys=>Math.ceil(Ys/2)))):void 0;const Hs=Ht$1(t.n,{BITS:F.nBitLength,allowedLengths:at,modFromBytes:F.wrapPrivateKey}),zs={Fp:Z,Fn:Hs,allowInfinityPoint:F.allowInfinityPoint,endo:F.endo,isTorsionFree:F.isTorsionFree,clearCofactor:F.clearCofactor,fromBytes:F.fromBytes,toBytes:F.toBytes};return{CURVE:t,curveOpts:zs}}function ea$1(F){const{CURVE:t,curveOpts:Z}=ta$1(F),at={hmac:F.hmac,randomBytes:F.randomBytes,lowS:F.lowS,bits2int:F.bits2int,bits2int_modN:F.bits2int_modN};return{CURVE:t,curveOpts:Z,hash:F.hash,ecdsaOpts:at}}function na(F,t){const Z=t.Point;return Object.assign({},t,{ProjectivePoint:Z,CURVE:Object.assign({},F,ko$1(Z.Fn.ORDER,Z.Fn.BITS))})}function ra(F){const{CURVE:t,curveOpts:Z,hash:at,ecdsaOpts:Hs}=ea$1(F),zs=Xf(t,Z),Ys=Qf(zs,at,Hs);return na(F,Ys)}function Dn$1(F,t){const Z=at=>ra({...F,hash:at});return{...Z(t),create:Z}}const Xo$1={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Jo$1={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Qo$1={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},oa=Ht$1(Xo$1.p),sa=Ht$1(Jo$1.p),ia=Ht$1(Qo$1.p),ca=Dn$1({...Xo$1,Fp:oa,lowS:!1},$e$1);Dn$1({...Jo$1,Fp:sa,lowS:!1},yc),Dn$1({...Qo$1,Fp:ia,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},bc);const fa=ca,Vn$1="base10",rt="base16",oe$1="base64pad",Ge$1="base64url",se="utf8",Mn$1=0,ie=1,we$1=2,aa=0,ts=1,ve$1=12,Kn$1=32;function ua(){const F=kn$1.utils.randomPrivateKey(),t=kn$1.getPublicKey(F);return{privateKey:toString(F,rt),publicKey:toString(t,rt)}}function la(){const F=Mt$1(Kn$1);return toString(F,rt)}function da(F,t){const Z=kn$1.getSharedSecret(fromString(F,rt),fromString(t,rt)),at=vf(Pe$1,Z,void 0,void 0,Kn$1);return toString(at,rt)}function ha(F){const t=Pe$1(fromString(F,rt));return toString(t,rt)}function pa(F){const t=Pe$1(fromString(F,se));return toString(t,rt)}function qn$1(F){return fromString(`${F}`,Vn$1)}function Zt$1(F){return Number(toString(F,Vn$1))}function es(F){return F.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function ns(F){const t=F.replace(/-/g,"+").replace(/_/g,"/"),Z=(4-t.length%4)%4;return t+"=".repeat(Z)}function ga(F){const t=qn$1(typeof F.type<"u"?F.type:Mn$1);if(Zt$1(t)===ie&&typeof F.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const Z=typeof F.senderPublicKey<"u"?fromString(F.senderPublicKey,rt):void 0,at=typeof F.iv<"u"?fromString(F.iv,rt):Mt$1(ve$1),Hs=fromString(F.symKey,rt),zs=xo$1(Hs,at).encrypt(fromString(F.message,se)),Ys=Fn$1({type:t,sealed:zs,iv:at,senderPublicKey:Z});return F.encoding===Ge$1?es(Ys):Ys}function ba(F){const t=fromString(F.symKey,rt),{sealed:Z,iv:at}=ze({encoded:F.encoded,encoding:F.encoding}),Hs=xo$1(t,at).decrypt(Z);if(Hs===null)throw new Error("Failed to decrypt");return toString(Hs,se)}function ya(F,t){const Z=qn$1(we$1),at=Mt$1(ve$1),Hs=fromString(F,se),zs=Fn$1({type:Z,sealed:Hs,iv:at});return t===Ge$1?es(zs):zs}function ma(F,t){const{sealed:Z}=ze({encoded:F,encoding:t});return toString(Z,se)}function Fn$1(F){if(Zt$1(F.type)===we$1)return toString(concat([F.type,F.sealed]),oe$1);if(Zt$1(F.type)===ie){if(typeof F.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return toString(concat([F.type,F.senderPublicKey,F.iv,F.sealed]),oe$1)}return toString(concat([F.type,F.iv,F.sealed]),oe$1)}function ze(F){const t=(F.encoding||oe$1)===Ge$1?ns(F.encoded):F.encoded,Z=fromString(t,oe$1),at=Z.slice(aa,ts),Hs=ts;if(Zt$1(at)===ie){const $u=Hs+Kn$1,Eu=$u+ve$1,Au=Z.slice(Hs,$u),vu=Z.slice($u,Eu),Iu=Z.slice(Eu);return{type:at,sealed:Iu,iv:vu,senderPublicKey:Au}}if(Zt$1(at)===we$1){const $u=Z.slice(Hs),Eu=Mt$1(ve$1);return{type:at,sealed:$u,iv:Eu}}const zs=Hs+ve$1,Ys=Z.slice(Hs,zs),Zs=Z.slice(zs);return{type:at,sealed:Zs,iv:Ys}}function wa(F,t){const Z=ze({encoded:F,encoding:t==null?void 0:t.encoding});return rs({type:Zt$1(Z.type),senderPublicKey:typeof Z.senderPublicKey<"u"?toString(Z.senderPublicKey,rt):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function rs(F){const t=(F==null?void 0:F.type)||Mn$1;if(t===ie){if(typeof(F==null?void 0:F.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(F==null?void 0:F.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:F==null?void 0:F.senderPublicKey,receiverPublicKey:F==null?void 0:F.receiverPublicKey}}function va(F){return F.type===ie&&typeof F.senderPublicKey=="string"&&typeof F.receiverPublicKey=="string"}function xa(F){return F.type===we$1}function os(F){const t=Buffer.from(F.x,"base64"),Z=Buffer.from(F.y,"base64");return concat([new Uint8Array([4]),t,Z])}function Ea(F,t){const[Z,at,Hs]=F.split("."),zs=Buffer.from(ns(Hs),"base64");if(zs.length!==64)throw new Error("Invalid signature length");const Ys=zs.slice(0,32),Zs=zs.slice(32,64),$u=`${Z}.${at}`,Eu=Pe$1($u),Au=os(t);if(!fa.verify(concat([Ys,Zs]),Eu,Au))throw new Error("Invalid signature");return sn$2(F).payload}const ss="irn";function Ba(F){return(F==null?void 0:F.relay)||{protocol:ss}}function Aa(F){const t=C$1[F];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${F}`);return t}var Ia=Object.defineProperty,Sa=Object.defineProperties,Oa=Object.getOwnPropertyDescriptors,is=Object.getOwnPropertySymbols,Na=Object.prototype.hasOwnProperty,Ua=Object.prototype.propertyIsEnumerable,cs=(F,t,Z)=>t in F?Ia(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,Zn$1=(F,t)=>{for(var Z in t||(t={}))Na.call(t,Z)&&cs(F,Z,t[Z]);if(is)for(var Z of is(t))Ua.call(t,Z)&&cs(F,Z,t[Z]);return F},_a=(F,t)=>Sa(F,Oa(t));function fs(F,t="-"){const Z={},at="relay"+t;return Object.keys(F).forEach(Hs=>{if(Hs.startsWith(at)){const zs=Hs.replace(at,""),Ys=F[Hs];Z[zs]=Ys}}),Z}function Ra(F){if(!F.includes("wc:")){const Eu=cn$1(F);Eu!=null&&Eu.includes("wc:")&&(F=Eu)}F=F.includes("wc://")?F.replace("wc://",""):F,F=F.includes("wc:")?F.replace("wc:",""):F;const t=F.indexOf(":"),Z=F.indexOf("?")!==-1?F.indexOf("?"):void 0,at=F.substring(0,t),Hs=F.substring(t+1,Z).split("@"),zs=typeof Z<"u"?F.substring(Z):"",Ys=new URLSearchParams(zs),Zs=Object.fromEntries(Ys.entries()),$u=typeof Zs.methods=="string"?Zs.methods.split(","):void 0;return{protocol:at,topic:as(Hs[0]),version:parseInt(Hs[1],10),symKey:Zs.symKey,relay:fs(Zs),methods:$u,expiryTimestamp:Zs.expiryTimestamp?parseInt(Zs.expiryTimestamp,10):void 0}}function as(F){return F.startsWith("//")?F.substring(2):F}function us(F,t="-"){const Z="relay",at={};return Object.keys(F).forEach(Hs=>{const zs=Hs,Ys=Z+t+zs;F[zs]&&(at[Ys]=F[zs])}),at}function $a(F){const t=new URLSearchParams,Z=Zn$1(Zn$1(_a(Zn$1({},us(F.relay)),{symKey:F.symKey}),F.expiryTimestamp&&{expiryTimestamp:F.expiryTimestamp.toString()}),F.methods&&{methods:F.methods.join(",")});return Object.entries(Z).sort(([at],[Hs])=>at.localeCompare(Hs)).forEach(([at,Hs])=>{Hs!==void 0&&t.append(at,String(Hs))}),`${F.protocol}:${F.topic}@${F.version}?${t}`}function Ta(F,t,Z){return`${F}?wc_ev=${Z}&topic=${t}`}var Ca=Object.defineProperty,ja=Object.defineProperties,La=Object.getOwnPropertyDescriptors,ls=Object.getOwnPropertySymbols,ka=Object.prototype.hasOwnProperty,Pa=Object.prototype.propertyIsEnumerable,ds=(F,t,Z)=>t in F?Ca(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,Ha=(F,t)=>{for(var Z in t||(t={}))ka.call(t,Z)&&ds(F,Z,t[Z]);if(ls)for(var Z of ls(t))Pa.call(t,Z)&&ds(F,Z,t[Z]);return F},Da=(F,t)=>ja(F,La(t));function Gt$1(F){const t=[];return F.forEach(Z=>{const[at,Hs]=Z.split(":");t.push(`${at}:${Hs}`)}),t}function hs(F){const t=[];return Object.values(F).forEach(Z=>{t.push(...Gt$1(Z.accounts))}),t}function ps(F,t){const Z=[];return Object.values(F).forEach(at=>{Gt$1(at.accounts).includes(t)&&Z.push(...at.methods)}),Z}function gs(F,t){const Z=[];return Object.values(F).forEach(at=>{Gt$1(at.accounts).includes(t)&&Z.push(...at.events)}),Z}function Va(F,t){const Z=Ss$1(F,t);if(Z)throw new Error(Z.message);const at={};for(const[Hs,zs]of Object.entries(F))at[Hs]={methods:zs.methods,events:zs.events,chains:zs.accounts.map(Ys=>`${Ys.split(":")[0]}:${Ys.split(":")[1]}`)};return at}function Ma(F){var t;const{proposal:{requiredNamespaces:Z,optionalNamespaces:at={}},supportedNamespaces:Hs}=F,zs=xe(Z),Ys=xe(at),Zs={};Object.keys(Hs).forEach(Au=>{const vu=Hs[Au].chains,Iu=Hs[Au].methods,_u=Hs[Au].events,Su=Hs[Au].accounts;vu.forEach(Bu=>{if(!Su.some(Du=>Du.includes(Bu)))throw new Error(`No accounts provided for chain ${Bu} in namespace ${Au}`)}),Zs[Au]={chains:vu,methods:Iu,events:_u,accounts:Su}});const $u=Ns$1(Z,Zs,"approve()");if($u)throw new Error($u.message);const Eu={};if(!Object.keys(Z).length&&!Object.keys(at).length)return Zs;Object.keys(zs).forEach(Au=>{const vu=Hs[Au].chains.filter(Bu=>{var Du,Tu;return(Tu=(Du=zs[Au])==null?void 0:Du.chains)==null?void 0:Tu.includes(Bu)}),Iu=Hs[Au].methods.filter(Bu=>{var Du,Tu;return(Tu=(Du=zs[Au])==null?void 0:Du.methods)==null?void 0:Tu.includes(Bu)}),_u=Hs[Au].events.filter(Bu=>{var Du,Tu;return(Tu=(Du=zs[Au])==null?void 0:Du.events)==null?void 0:Tu.includes(Bu)}),Su=vu.map(Bu=>Hs[Au].accounts.filter(Du=>Du.includes(`${Bu}:`))).flat();Eu[Au]={chains:vu,methods:Iu,events:_u,accounts:Su}}),Object.keys(Ys).forEach(Au=>{var vu,Iu,_u,Su,Bu,Du;if(!Hs[Au])return;const Tu=(Iu=(vu=Ys[Au])==null?void 0:vu.chains)==null?void 0:Iu.filter(Lu=>Hs[Au].chains.includes(Lu)),Pu=Hs[Au].methods.filter(Lu=>{var qu,zu;return(zu=(qu=Ys[Au])==null?void 0:qu.methods)==null?void 0:zu.includes(Lu)}),Uu=Hs[Au].events.filter(Lu=>{var qu,zu;return(zu=(qu=Ys[Au])==null?void 0:qu.events)==null?void 0:zu.includes(Lu)}),Fu=Tu==null?void 0:Tu.map(Lu=>Hs[Au].accounts.filter(qu=>qu.includes(`${Lu}:`))).flat();Eu[Au]={chains:ut$1((_u=Eu[Au])==null?void 0:_u.chains,Tu),methods:ut$1((Su=Eu[Au])==null?void 0:Su.methods,Pu),events:ut$1((Bu=Eu[Au])==null?void 0:Bu.events,Uu),accounts:ut$1((Du=Eu[Au])==null?void 0:Du.accounts,Fu)}});for(const[Au,vu]of Object.entries(Eu))(vu.accounts.length===0||((t=vu==null?void 0:vu.chains)==null?void 0:t.length)===0)&&delete Eu[Au];return Eu}function Gn$1(F){return F.includes(":")}function bs$1(F){return Gn$1(F)?F.split(":")[0]:F}function xe(F){var t,Z,at;const Hs={};if(!Ye$1(F))return Hs;for(const[zs,Ys]of Object.entries(F)){const Zs=Gn$1(zs)?[zs]:Ys.chains,$u=Ys.methods||[],Eu=Ys.events||[],Au=bs$1(zs);Hs[Au]=Da(Ha({},Hs[Au]),{chains:ut$1(Zs,(t=Hs[Au])==null?void 0:t.chains),methods:ut$1($u,(Z=Hs[Au])==null?void 0:Z.methods),events:ut$1(Eu,(at=Hs[Au])==null?void 0:at.events)})}return Hs}function ys(F){const t={};return F==null||F.forEach(Z=>{var at;const[Hs,zs]=Z.split(":");t[Hs]||(t[Hs]={accounts:[],chains:[],events:[],methods:[]}),t[Hs].accounts.push(Z),(at=t[Hs].chains)==null||at.push(`${Hs}:${zs}`)}),t}function Ka(F,t){t=t.map(at=>at.replace("did:pkh:",""));const Z=ys(t);for(const[at,Hs]of Object.entries(Z))Hs.methods?Hs.methods=ut$1(Hs.methods,F):Hs.methods=F,Hs.events=["chainChanged","accountsChanged"];return Z}function qa(F,t){var Z,at,Hs,zs,Ys,Zs;const $u=xe(F),Eu=xe(t),Au={},vu=Object.keys($u).concat(Object.keys(Eu));for(const Iu of vu)Au[Iu]={chains:ut$1((Z=$u[Iu])==null?void 0:Z.chains,(at=Eu[Iu])==null?void 0:at.chains),methods:ut$1((Hs=$u[Iu])==null?void 0:Hs.methods,(zs=Eu[Iu])==null?void 0:zs.methods),events:ut$1((Ys=$u[Iu])==null?void 0:Ys.events,(Zs=Eu[Iu])==null?void 0:Zs.events)};return Au}const ms={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},ws={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Bt$1(F,t){const{message:Z,code:at}=ws[F];return{message:t?`${Z} ${t}`:Z,code:at}}function zt$1(F,t){const{message:Z,code:at}=ms[F];return{message:t?`${Z} ${t}`:Z,code:at}}function Ee(F,t){return Array.isArray(F)?typeof t<"u"&&F.length?F.every(t):!0:!1}function Ye$1(F){return Object.getPrototypeOf(F)===Object.prototype&&Object.keys(F).length}function Dt(F){return typeof F>"u"}function ft$1(F,t){return t&&Dt(F)?!0:typeof F=="string"&&!!F.trim().length}function We$1(F,t){return t&&Dt(F)?!0:typeof F=="number"&&!isNaN(F)}function Fa(F,t){const{requiredNamespaces:Z}=t,at=Object.keys(F.namespaces),Hs=Object.keys(Z);let zs=!0;return It$2(Hs,at)?(at.forEach(Ys=>{const{accounts:Zs,methods:$u,events:Eu}=F.namespaces[Ys],Au=Gt$1(Zs),vu=Z[Ys];(!It$2(Ie(Ys,vu),Au)||!It$2(vu.methods,$u)||!It$2(vu.events,Eu))&&(zs=!1)}),zs):!1}function Be$1(F){return ft$1(F,!1)&&F.includes(":")?F.split(":").length===2:!1}function vs$1(F){if(ft$1(F,!1)&&F.includes(":")){const t=F.split(":");if(t.length===3){const Z=t[0]+":"+t[1];return!!t[2]&&Be$1(Z)}}return!1}function Za(F){function t(Z){try{return typeof new URL(Z)<"u"}catch{return!1}}try{if(ft$1(F,!1)){if(t(F))return!0;const Z=cn$1(F);return t(Z)}}catch{}return!1}function Ga(F){var t;return(t=F==null?void 0:F.proposer)==null?void 0:t.publicKey}function za(F){return F==null?void 0:F.topic}function Ya(F,t){let Z=null;return ft$1(F==null?void 0:F.publicKey,!1)||(Z=Bt$1("MISSING_OR_INVALID",`${t} controller public key should be a string`)),Z}function zn$1(F){let t=!0;return Ee(F)?F.length&&(t=F.every(Z=>ft$1(Z,!1))):t=!1,t}function xs$1(F,t,Z){let at=null;return Ee(t)&&t.length?t.forEach(Hs=>{at||Be$1(Hs)||(at=zt$1("UNSUPPORTED_CHAINS",`${Z}, chain ${Hs} should be a string and conform to "namespace:chainId" format`))}):Be$1(F)||(at=zt$1("UNSUPPORTED_CHAINS",`${Z}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),at}function Es(F,t,Z){let at=null;return Object.entries(F).forEach(([Hs,zs])=>{if(at)return;const Ys=xs$1(Hs,Ie(Hs,zs),`${t} ${Z}`);Ys&&(at=Ys)}),at}function Bs(F,t){let Z=null;return Ee(F)?F.forEach(at=>{Z||vs$1(at)||(Z=zt$1("UNSUPPORTED_ACCOUNTS",`${t}, account ${at} should be a string and conform to "namespace:chainId:address" format`))}):Z=zt$1("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),Z}function As$1(F,t){let Z=null;return Object.values(F).forEach(at=>{if(Z)return;const Hs=Bs(at==null?void 0:at.accounts,`${t} namespace`);Hs&&(Z=Hs)}),Z}function Is$1(F,t){let Z=null;return zn$1(F==null?void 0:F.methods)?zn$1(F==null?void 0:F.events)||(Z=zt$1("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):Z=zt$1("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),Z}function Yn$1(F,t){let Z=null;return Object.values(F).forEach(at=>{if(Z)return;const Hs=Is$1(at,`${t}, namespace`);Hs&&(Z=Hs)}),Z}function Wa(F,t,Z){let at=null;if(F&&Ye$1(F)){const Hs=Yn$1(F,t);Hs&&(at=Hs);const zs=Es(F,t,Z);zs&&(at=zs)}else at=Bt$1("MISSING_OR_INVALID",`${t}, ${Z} should be an object with data`);return at}function Ss$1(F,t){let Z=null;if(F&&Ye$1(F)){const at=Yn$1(F,t);at&&(Z=at);const Hs=As$1(F,t);Hs&&(Z=Hs)}else Z=Bt$1("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return Z}function Os$1(F){return ft$1(F.protocol,!0)}function Xa(F,t){let Z=!1;return t&&!F?Z=!0:F&&Ee(F)&&F.length&&F.forEach(at=>{Z=Os$1(at)}),Z}function Ja(F){return typeof F=="number"}function Qa(F){return typeof F<"u"&&typeof F!==null}function tu(F){return!(!F||typeof F!="object"||!F.code||!We$1(F.code,!1)||!F.message||!ft$1(F.message,!1))}function eu(F){return!(Dt(F)||!ft$1(F.method,!1))}function nu(F){return!(Dt(F)||Dt(F.result)&&Dt(F.error)||!We$1(F.id,!1)||!ft$1(F.jsonrpc,!1))}function ru(F){return!(Dt(F)||!ft$1(F.name,!1))}function ou(F,t){return!(!Be$1(t)||!hs(F).includes(t))}function su(F,t,Z){return ft$1(Z,!1)?ps(F,t).includes(Z):!1}function iu(F,t,Z){return ft$1(Z,!1)?gs(F,t).includes(Z):!1}function Ns$1(F,t,Z){let at=null;const Hs=cu(F),zs=fu(t),Ys=Object.keys(Hs),Zs=Object.keys(zs),$u=Us$1(Object.keys(F)),Eu=Us$1(Object.keys(t)),Au=$u.filter(vu=>!Eu.includes(vu));return Au.length&&(at=Bt$1("NON_CONFORMING_NAMESPACES",`${Z} namespaces keys don't satisfy requiredNamespaces.
      Required: ${Au.toString()}
      Received: ${Object.keys(t).toString()}`)),It$2(Ys,Zs)||(at=Bt$1("NON_CONFORMING_NAMESPACES",`${Z} namespaces chains don't satisfy required namespaces.
      Required: ${Ys.toString()}
      Approved: ${Zs.toString()}`)),Object.keys(t).forEach(vu=>{if(!vu.includes(":")||at)return;const Iu=Gt$1(t[vu].accounts);Iu.includes(vu)||(at=Bt$1("NON_CONFORMING_NAMESPACES",`${Z} namespaces accounts don't satisfy namespace accounts for ${vu}
        Required: ${vu}
        Approved: ${Iu.toString()}`))}),Ys.forEach(vu=>{at||(It$2(Hs[vu].methods,zs[vu].methods)?It$2(Hs[vu].events,zs[vu].events)||(at=Bt$1("NON_CONFORMING_NAMESPACES",`${Z} namespaces events don't satisfy namespace events for ${vu}`)):at=Bt$1("NON_CONFORMING_NAMESPACES",`${Z} namespaces methods don't satisfy namespace methods for ${vu}`))}),at}function cu(F){const t={};return Object.keys(F).forEach(Z=>{var at;Z.includes(":")?t[Z]=F[Z]:(at=F[Z].chains)==null||at.forEach(Hs=>{t[Hs]={methods:F[Z].methods,events:F[Z].events}})}),t}function Us$1(F){return[...new Set(F.map(t=>t.includes(":")?t.split(":")[0]:t))]}function fu(F){const t={};return Object.keys(F).forEach(Z=>{if(Z.includes(":"))t[Z]=F[Z];else{const at=Gt$1(F[Z].accounts);at==null||at.forEach(Hs=>{t[Hs]={accounts:F[Z].accounts.filter(zs=>zs.includes(`${Hs}:`)),methods:F[Z].methods,events:F[Z].events}})}}),t}function au(F,t){return We$1(F,!1)&&F<=t.max&&F>=t.min}function uu(){const F=Vt$1();return new Promise(t=>{switch(F){case et$1.browser:t(_s());break;case et$1.reactNative:t(Rs$1());break;case et$1.node:t($s$1());break;default:t(!0)}})}function _s(){return Wt$1()&&(navigator==null?void 0:navigator.onLine)}async function Rs$1(){if(At$1()&&typeof global<"u"&&global!=null&&global.NetInfo){const F=await(global==null?void 0:global.NetInfo.fetch());return F==null?void 0:F.isConnected}return!0}function $s$1(){return!0}function lu(F){switch(Vt$1()){case et$1.browser:Ts$1(F);break;case et$1.reactNative:Cs$1(F);break;case et$1.node:break}}function Ts$1(F){!At$1()&&Wt$1()&&(window.addEventListener("online",()=>F(!0)),window.addEventListener("offline",()=>F(!1)))}function Cs$1(F){At$1()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>F(t==null?void 0:t.isConnected)))}function du(){var F;return Wt$1()&&getDocument_1()?((F=getDocument_1())==null?void 0:F.visibilityState)==="visible":!0}const Wn$1={};class hu{static get(t){return Wn$1[t]}static set(t,Z){Wn$1[t]=Z}static delete(t){delete Wn$1[t]}}function js$1(F){const t=ue.decode(F);if(t.length<33)throw new Error("Too short to contain a public key");return t.slice(1,33)}function Ls$1({publicKey:F,signature:t,payload:Z}){var at;const Hs=Xn$1(Z.method),zs=128|parseInt(((at=Z.version)==null?void 0:at.toString())||"4"),Ys=gu(Z.address),Zs=Z.era==="00"?new Uint8Array([0]):Xn$1(Z.era);if(Zs.length!==1&&Zs.length!==2)throw new Error("Invalid era length");const $u=parseInt(Z.nonce,16),Eu=new Uint8Array([$u&255,$u>>8&255]),Au=BigInt(`0x${pu(Z.tip)}`),vu=yu(Au),Iu=new Uint8Array([0,...F,Ys,...t,...Zs,...Eu,...vu,...Hs]),_u=bu(Iu.length+1);return new Uint8Array([..._u,zs,...Iu])}function ks$1(F){const t=Xn$1(F),Z=blakejs.blake2b(t,void 0,32);return"0x"+Buffer.from(Z).toString("hex")}function Xn$1(F){return new Uint8Array(F.replace(/^0x/,"").match(/.{1,2}/g).map(t=>parseInt(t,16)))}function pu(F){return F.startsWith("0x")?F.slice(2):F}function gu(F){const t=ue.decode(F)[0];return t===42?0:t===60?2:1}function bu(F){if(F<64)return new Uint8Array([F<<2]);if(F<16384){const t=F<<2|1;return new Uint8Array([t&255,t>>8&255])}else if(F<1<<30){const t=F<<2|2;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function yu(F){if(F<BigInt(1)<<BigInt(6))return new Uint8Array([Number(F<<BigInt(2))]);if(F<BigInt(1)<<BigInt(14)){const t=F<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}else if(F<BigInt(1)<<BigInt(30)){const t=F<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function mu(F){const t=Uint8Array.from(Buffer.from(F.signature,"hex")),Z=js$1(F.transaction.address),at=Ls$1({publicKey:Z,signature:t,payload:F.transaction}),Hs=Buffer.from(at).toString("hex");return ks$1(Hs)}function wu({logger:F,name:t}){const Z=typeof F=="string"?Y$1({opts:{level:F,name:t}}).logger:F;return Z.level=typeof F=="string"?F:F.level,Z}const dist$1=Object.freeze(Object.defineProperty({__proto__:null,BASE10:Vn$1,BASE16:rt,BASE64:oe$1,BASE64URL:Ge$1,COLON:ci$1,DEFAULT_DEPTH:nn$1,EMPTY_SPACE:Se$1,ENV_MAP:et$1,INTERNAL_ERRORS:ws,LimitedSet:ki$1,MemoryStore:hu,ONE_THOUSAND:fi$1,REACT_NATIVE_PRODUCT:dr$1,RELAYER_DEFAULT_PROTOCOL:ss,SDK_ERRORS:ms,SDK_TYPE:pr$1,SLASH:hr$1,TYPE_0:Mn$1,TYPE_1:ie,TYPE_2:we$1,UTF8:se,addResourceToRecap:fo$1,addSignatureToExtrinsic:Ls$1,appendToQueryString:gr$1,assertType:bi$1,assignAbilityToActions:yn$1,base64Decode:io$1,base64Encode:so$1,buildApprovedNamespaces:Ma,buildAuthObject:Hc,buildNamespacesFromAuth:Ka,buildRecapStatement:uo$1,buildSignedExtrinsicHash:mu,calcExpiry:Ni$1,capitalize:Ei$1,capitalizeWord:Er$1,createDelayedPromise:Bi$1,createEncodedRecap:Kc,createExpiringPromise:Ai$1,createLogger:wu,createRecap:co$1,decodeRecap:kt$1,decodeTypeByte:Zt$1,decodeTypeTwoEnvelope:ma,decrypt:ba,deriveExtrinsicHash:ks$1,deriveSymKey:da,deserialize:ze,encodeRecap:Ce,encodeTypeByte:qn$1,encodeTypeTwoEnvelope:ya,encrypt:ga,engineEvent:_i$1,enumify:xi$1,extractSolanaTransactionId:Sc,formatAccountId:sr,formatAccountWithChain:Ws,formatChainId:or$1,formatDeeplinkUrl:Br$1,formatExpirerTarget:on$1,formatIdTarget:Si$1,formatMessage:eo$1,formatMessageContext:yi$1,formatRelayParams:us,formatRelayRpcUrl:pi$1,formatStatementFromRecap:wn$1,formatTopicTarget:Ii$1,formatUA:wr$1,formatUri:$a,fromBase64:cn$1,generateKeyPair:ua,generateRandomBytes32:la,getAccountsChains:Gt$1,getAccountsFromNamespaces:Js,getAddressFromAccount:ir$1,getAddressesFromAccounts:Xs,getAlgorandTransactionId:Uc,getAppId:li$1,getAppMetadata:br$1,getBrowserOnlineStatus:_s,getChainFromAccount:cr$1,getChainsFromAccounts:fr$1,getChainsFromNamespace:Ie,getChainsFromNamespaces:Qs$1,getChainsFromRecap:Zc,getChainsFromRequiredNamespaces:ti$1,getCommonValuesInArrays:sn$1,getCryptoKeyFromKeyData:os,getDecodedRecapFromResources:no$1,getDeepLink:$i$1,getDidAddress:bn$1,getDidAddressSegments:Te,getDidChainId:Qr$1,getEnvironment:Vt$1,getHttpUrl:gi$1,getInternalError:Bt$1,getJavascriptID:mr$1,getJavascriptOS:yr$1,getLastItems:xr$1,getLinkModeURL:Ta,getMethodsFromRecap:Fc,getNamespacedDidChainId:to$1,getNamespacesChains:hs,getNamespacesEventsForChainId:gs,getNamespacesFromAccounts:ys,getNamespacesMethodsForChainId:ps,getNearTransactionIdFromSignedTransaction:Nc,getNearUint8ArrayFromBytes:Yr$1,getNodeOnlineStatus:$s$1,getReCapActions:oo$1,getReactNativeOnlineStatus:Rs$1,getRecapAbilitiesFromResource:Mc,getRecapFromResources:je,getRecapResource:ro$1,getRelayClientMetadata:hi$1,getRelayProtocolApi:Aa,getRelayProtocolName:Ba,getRequiredNamespacesFromNamespaces:Va,getSdkError:zt$1,getSearchParamFromURL:Ti$1,getSignDirectHash:_c,getSuiDigest:Oc,getUniqueValues:tn$1,getWalletSendCallsHashes:Rc,handleDeeplinkRedirect:Ri$1,hasOverlap:It$2,hashEthereumMessage:hn$1,hashKey:ha,hashMessage:pa,isAndroid:ai$1,isAppVisible:du,isBrowser:Wt$1,isCaipNamespace:Gn$1,isConformingNamespaces:Ns$1,isExpired:Ui$1,isIframe:Sr$1,isIos:ui$1,isNode:rn$1,isOnline:uu,isProposalStruct:Ga,isReactNative:At$1,isRecap:mn$1,isSessionCompatible:Fa,isSessionStruct:za,isTelegram:Ir$1,isTestRun:ji$1,isTypeOneEnvelope:va,isTypeTwoEnvelope:xa,isUndefined:Dt,isValidAccountId:vs$1,isValidAccounts:Bs,isValidActions:Is$1,isValidArray:Ee,isValidChainId:Be$1,isValidChains:xs$1,isValidController:Ya,isValidEip1271Signature:zr$1,isValidEip191Signature:Gr$1,isValidErrorReason:tu,isValidEvent:ru,isValidId:Ja,isValidNamespaceAccounts:As$1,isValidNamespaceActions:Yn$1,isValidNamespaceChains:Es,isValidNamespaceMethodsOrEvents:zn$1,isValidNamespaces:Ss$1,isValidNamespacesChainId:ou,isValidNamespacesEvent:iu,isValidNamespacesRequest:su,isValidNumber:We$1,isValidObject:Ye$1,isValidParams:Qa,isValidRecap:yt$1,isValidRelay:Os$1,isValidRelays:Xa,isValidRequest:eu,isValidRequestExpiry:au,isValidRequiredNamespaces:Wa,isValidResponse:nu,isValidString:ft$1,isValidUrl:Za,mapEntries:vi$1,mapToObj:mi$1,mergeArrays:ut$1,mergeEncodedRecaps:qc,mergeRecaps:ao$1,mergeRequiredAndOptionalNamespaces:qa,normalizeNamespaces:xe,objToMap:wi$1,openDeeplink:Ar$1,parseAccountId:Qe$1,parseChainId:Je$1,parseContextNames:vr$1,parseExpirerTarget:Oi$1,parseNamespaceKey:bs$1,parseRelayParams:fs,parseTopic:as,parseUri:Ra,populateAppMetadata:di$1,populateAuthPayload:Dc,recapHasResource:Vc,serialize:Fn$1,sleep:Li$1,ss58AddressToPublicKey:js$1,subscribeToBrowserNetworkChange:Ts$1,subscribeToNetworkChange:lu,subscribeToReactNativeNetworkChange:Cs$1,toBase64:Or$1,uuidv4:Ci$1,validateDecoding:wa,validateEncoding:rs,validateSignedCacao:Pc,verifyP256Jwt:Ea,verifySignature:Zr$1},Symbol.toStringTag,{value:"Module"})),PARSE_ERROR="PARSE_ERROR",INVALID_REQUEST="INVALID_REQUEST",METHOD_NOT_FOUND="METHOD_NOT_FOUND",INVALID_PARAMS="INVALID_PARAMS",INTERNAL_ERROR="INTERNAL_ERROR",SERVER_ERROR="SERVER_ERROR",RESERVED_ERROR_CODES=[-32700,-32600,-32601,-32602,-32603],STANDARD_ERROR_MAP={[PARSE_ERROR]:{code:-32700,message:"Parse error"},[INVALID_REQUEST]:{code:-32600,message:"Invalid Request"},[METHOD_NOT_FOUND]:{code:-32601,message:"Method not found"},[INVALID_PARAMS]:{code:-32602,message:"Invalid params"},[INTERNAL_ERROR]:{code:-32603,message:"Internal error"},[SERVER_ERROR]:{code:-32e3,message:"Server error"}},DEFAULT_ERROR=SERVER_ERROR;function isReservedErrorCode(F){return RESERVED_ERROR_CODES.includes(F)}function getError(F){return Object.keys(STANDARD_ERROR_MAP).includes(F)?STANDARD_ERROR_MAP[F]:STANDARD_ERROR_MAP[DEFAULT_ERROR]}function getErrorByCode(F){const t=Object.values(STANDARD_ERROR_MAP).find(Z=>Z.code===F);return t||STANDARD_ERROR_MAP[DEFAULT_ERROR]}function parseConnectionError(F,t,Z){return F.message.includes("getaddrinfo ENOTFOUND")||F.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${Z} RPC url at ${t}`):F}var cjs={},crypto$1={},hasRequiredCrypto;function requireCrypto(){if(hasRequiredCrypto)return crypto$1;hasRequiredCrypto=1,Object.defineProperty(crypto$1,"__esModule",{value:!0}),crypto$1.isBrowserCryptoAvailable=crypto$1.getSubtleCrypto=crypto$1.getBrowerCrypto=void 0;function F(){return(commonjsGlobal==null?void 0:commonjsGlobal.crypto)||(commonjsGlobal==null?void 0:commonjsGlobal.msCrypto)||{}}crypto$1.getBrowerCrypto=F;function t(){const at=F();return at.subtle||at.webkitSubtle}crypto$1.getSubtleCrypto=t;function Z(){return!!F()&&!!t()}return crypto$1.isBrowserCryptoAvailable=Z,crypto$1}var env={},hasRequiredEnv;function requireEnv(){if(hasRequiredEnv)return env;hasRequiredEnv=1,Object.defineProperty(env,"__esModule",{value:!0}),env.isBrowser=env.isNode=env.isReactNative=void 0;function F(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}env.isReactNative=F;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}env.isNode=t;function Z(){return!F()&&!t()}return env.isBrowser=Z,env}(function(F){Object.defineProperty(F,"__esModule",{value:!0});const t=require$$0;t.__exportStar(requireCrypto(),F),t.__exportStar(requireEnv(),F)})(cjs);function payloadId(F=3){const t=Date.now()*Math.pow(10,F),Z=Math.floor(Math.random()*Math.pow(10,F));return t+Z}function getBigIntRpcId(F=6){return BigInt(payloadId(F))}function formatJsonRpcRequest(F,t,Z){return{id:Z||payloadId(),jsonrpc:"2.0",method:F,params:t}}function formatJsonRpcResult(F,t){return{id:F,jsonrpc:"2.0",result:t}}function formatJsonRpcError(F,t,Z){return{id:F,jsonrpc:"2.0",error:formatErrorMessage(t,Z)}}function formatErrorMessage(F,t){return typeof F>"u"?getError(INTERNAL_ERROR):(typeof F=="string"&&(F=Object.assign(Object.assign({},getError(SERVER_ERROR)),{message:F})),typeof t<"u"&&(F.data=t),isReservedErrorCode(F.code)&&(F=getErrorByCode(F.code)),F)}class e{}class n extends e{constructor(){super()}}class r extends n{constructor(t){super()}}const WS_REGEX="^wss?:";function getUrlProtocol(F){const t=F.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function matchRegexProtocol(F,t){const Z=getUrlProtocol(F);return typeof Z>"u"?!1:new RegExp(t).test(Z)}function isWsUrl(F){return matchRegexProtocol(F,WS_REGEX)}function isLocalhostUrl(F){return new RegExp("wss?://localhost(:d{2,5})?").test(F)}function isJsonRpcPayload(F){return typeof F=="object"&&"id"in F&&"jsonrpc"in F&&F.jsonrpc==="2.0"}function isJsonRpcRequest(F){return isJsonRpcPayload(F)&&"method"in F}function isJsonRpcResponse(F){return isJsonRpcPayload(F)&&(isJsonRpcResult(F)||isJsonRpcError(F))}function isJsonRpcResult(F){return"result"in F}function isJsonRpcError(F){return"error"in F}class o extends r{constructor(t){super(t),this.events=new eventsExports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,Z){this.events.on(t,Z)}once(t,Z){this.events.once(t,Z)}off(t,Z){this.events.off(t,Z)}removeListener(t,Z){this.events.removeListener(t,Z)}async request(t,Z){return this.requestStrict(formatJsonRpcRequest(t.method,t.params||[],t.id||getBigIntRpcId().toString()),Z)}async requestStrict(t,Z){return new Promise(async(at,Hs)=>{if(!this.connection.connected)try{await this.open()}catch(zs){Hs(zs)}this.events.on(`${t.id}`,zs=>{isJsonRpcError(zs)?Hs(zs.error):at(zs.result)});try{await this.connection.send(t,Z)}catch(zs){Hs(zs)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),isJsonRpcResponse(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const v$2=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),w=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",d$1=F=>F.split("?")[0],h=10,b=v$2();let f$2=class{constructor(t){if(this.url=t,this.events=new eventsExports.EventEmitter,this.registering=!1,!isWsUrl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,Z){this.events.on(t,Z)}once(t,Z){this.events.once(t,Z)}off(t,Z){this.events.off(t,Z)}removeListener(t,Z){this.events.removeListener(t,Z)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,Z)=>{if(typeof this.socket>"u"){Z(new Error("Connection already closed"));return}this.socket.onclose=at=>{this.onClose(at),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(safeJsonStringify(t))}catch(Z){this.onError(t.id,Z)}}register(t=this.url){if(!isWsUrl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const Z=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=Z||this.events.listenerCount("open")>=Z)&&this.events.setMaxListeners(Z+1),new Promise((at,Hs)=>{this.events.once("register_error",zs=>{this.resetMaxListeners(),Hs(zs)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return Hs(new Error("WebSocket connection is missing or invalid"));at(this.socket)})})}return this.url=t,this.registering=!0,new Promise((Z,at)=>{const Hs=cjs.isReactNative()?void 0:{rejectUnauthorized:!isLocalhostUrl(t)},zs=new b(t,[],Hs);w()?zs.onerror=Ys=>{const Zs=Ys;at(this.emitError(Zs.error))}:zs.on("error",Ys=>{at(this.emitError(Ys))}),zs.onopen=()=>{this.onOpen(zs),Z(zs)}})}onOpen(t){t.onmessage=Z=>this.onPayload(Z),t.onclose=Z=>this.onClose(Z),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const Z=typeof t.data=="string"?safeJsonParse(t.data):t.data;this.events.emit("payload",Z)}onError(t,Z){const at=this.parseError(Z),Hs=at.message||at.toString(),zs=formatJsonRpcError(t,Hs);this.events.emit("payload",zs)}parseError(t,Z=this.url){return parseConnectionError(t,d$1(Z),"WS")}resetMaxListeners(){this.events.getMaxListeners()>h&&this.events.setMaxListeners(h)}emitError(t){const Z=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${d$1(this.url)}`));return this.events.emit("register_error",Z),Z}};const Ue="wc",Fe=2,ge="core",W$1=`${Ue}@2:${ge}:`,Et$1={name:ge,logger:"error"},It$1={database:":memory:"},Tt="crypto",Me$1="client_ed25519_seed",Ct=cjs$3.ONE_DAY,Pt="keychain",St$1="0.3",Ot="messages",Rt$1="0.3",At=cjs$3.SIX_HOURS,xt="publisher",Nt="irn",$t="error",Ke$1="wss://relay.walletconnect.org",zt="relayer",C={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Lt="_subscription",M={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},kt=.1,Pe="2.22.4",ee={link_mode:"link_mode",relay:"relay"},ye={inbound:"inbound",outbound:"outbound"},jt="0.3",Ut="WALLETCONNECT_CLIENT_ID",Be="WALLETCONNECT_LINK_MODE_APPS",j={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Ft="subscription",Mt="0.3",Kt="pairing",Bt="0.3",oe={wc_pairingDelete:{req:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:cjs$3.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:cjs$3.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:0},res:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:0}}},ae={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},V={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Vt="history",qt="0.3",Gt="expirer",q={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Wt="0.3",Ht="verify-api",ir="https://verify.walletconnect.com",Yt="https://verify.walletconnect.org",be=Yt,Jt=`${be}/v3`,Xt=[ir,Yt],Zt="echo",Qt="https://echo.walletconnect.com",Y={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},X={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},rr={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},nr={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},or={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},ar={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},ei=.1,ti="event-client",ii=86400,si="https://pulse.walletconnect.org/batch";function cr(F,t){if(F.length>=255)throw new TypeError("Alphabet too long");for(var Z=new Uint8Array(256),at=0;at<Z.length;at++)Z[at]=255;for(var Hs=0;Hs<F.length;Hs++){var zs=F.charAt(Hs),Ys=zs.charCodeAt(0);if(Z[Ys]!==255)throw new TypeError(zs+" is ambiguous");Z[Ys]=Hs}var Zs=F.length,$u=F.charAt(0),Eu=Math.log(Zs)/Math.log(256),Au=Math.log(256)/Math.log(Zs);function vu(Su){if(Su instanceof Uint8Array||(ArrayBuffer.isView(Su)?Su=new Uint8Array(Su.buffer,Su.byteOffset,Su.byteLength):Array.isArray(Su)&&(Su=Uint8Array.from(Su))),!(Su instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Su.length===0)return"";for(var Bu=0,Du=0,Tu=0,Pu=Su.length;Tu!==Pu&&Su[Tu]===0;)Tu++,Bu++;for(var Uu=(Pu-Tu)*Au+1>>>0,Fu=new Uint8Array(Uu);Tu!==Pu;){for(var Lu=Su[Tu],qu=0,zu=Uu-1;(Lu!==0||qu<Du)&&zu!==-1;zu--,qu++)Lu+=256*Fu[zu]>>>0,Fu[zu]=Lu%Zs>>>0,Lu=Lu/Zs>>>0;if(Lu!==0)throw new Error("Non-zero carry");Du=qu,Tu++}for(var tl=Uu-Du;tl!==Uu&&Fu[tl]===0;)tl++;for(var Wu=$u.repeat(Bu);tl<Uu;++tl)Wu+=F.charAt(Fu[tl]);return Wu}function Iu(Su){if(typeof Su!="string")throw new TypeError("Expected String");if(Su.length===0)return new Uint8Array;var Bu=0;if(Su[Bu]!==" "){for(var Du=0,Tu=0;Su[Bu]===$u;)Du++,Bu++;for(var Pu=(Su.length-Bu)*Eu+1>>>0,Uu=new Uint8Array(Pu);Su[Bu];){var Fu=Z[Su.charCodeAt(Bu)];if(Fu===255)return;for(var Lu=0,qu=Pu-1;(Fu!==0||Lu<Tu)&&qu!==-1;qu--,Lu++)Fu+=Zs*Uu[qu]>>>0,Uu[qu]=Fu%256>>>0,Fu=Fu/256>>>0;if(Fu!==0)throw new Error("Non-zero carry");Tu=Lu,Bu++}if(Su[Bu]!==" "){for(var zu=Pu-Tu;zu!==Pu&&Uu[zu]===0;)zu++;for(var tl=new Uint8Array(Du+(Pu-zu)),Wu=Du;zu!==Pu;)tl[Wu++]=Uu[zu++];return tl}}}function _u(Su){var Bu=Iu(Su);if(Bu)return Bu;throw new Error(`Non-${t} character`)}return{encode:vu,decodeUnsafe:Iu,decode:_u}}var hr=cr,lr=hr;const ri=F=>{if(F instanceof Uint8Array&&F.constructor.name==="Uint8Array")return F;if(F instanceof ArrayBuffer)return new Uint8Array(F);if(ArrayBuffer.isView(F))return new Uint8Array(F.buffer,F.byteOffset,F.byteLength);throw new Error("Unknown type, must be binary type")},ur=F=>new TextEncoder().encode(F),dr=F=>new TextDecoder().decode(F);class pr{constructor(t,Z,at){this.name=t,this.prefix=Z,this.baseEncode=at}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class gr{constructor(t,Z,at){if(this.name=t,this.prefix=Z,Z.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=Z.codePointAt(0),this.baseDecode=at}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ni(this,t)}}class yr{constructor(t){this.decoders=t}or(t){return ni(this,t)}decode(t){const Z=t[0],at=this.decoders[Z];if(at)return at.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ni=(F,t)=>new yr({...F.decoders||{[F.prefix]:F},...t.decoders||{[t.prefix]:t}});class br{constructor(t,Z,at,Hs){this.name=t,this.prefix=Z,this.baseEncode=at,this.baseDecode=Hs,this.encoder=new pr(t,Z,at),this.decoder=new gr(t,Z,Hs)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Se=({name:F,prefix:t,encode:Z,decode:at})=>new br(F,t,Z,at),me$1=({prefix:F,name:t,alphabet:Z})=>{const{encode:at,decode:Hs}=lr(Z,t);return Se({prefix:F,name:t,encode:at,decode:zs=>ri(Hs(zs))})},mr=(F,t,Z,at)=>{const Hs={};for(let Au=0;Au<t.length;++Au)Hs[t[Au]]=Au;let zs=F.length;for(;F[zs-1]==="=";)--zs;const Ys=new Uint8Array(zs*Z/8|0);let Zs=0,$u=0,Eu=0;for(let Au=0;Au<zs;++Au){const vu=Hs[F[Au]];if(vu===void 0)throw new SyntaxError(`Non-${at} character`);$u=$u<<Z|vu,Zs+=Z,Zs>=8&&(Zs-=8,Ys[Eu++]=255&$u>>Zs)}if(Zs>=Z||255&$u<<8-Zs)throw new SyntaxError("Unexpected end of data");return Ys},fr=(F,t,Z)=>{const at=t[t.length-1]==="=",Hs=(1<<Z)-1;let zs="",Ys=0,Zs=0;for(let $u=0;$u<F.length;++$u)for(Zs=Zs<<8|F[$u],Ys+=8;Ys>Z;)Ys-=Z,zs+=t[Hs&Zs>>Ys];if(Ys&&(zs+=t[Hs&Zs<<Z-Ys]),at)for(;zs.length*Z&7;)zs+="=";return zs},x=({name:F,prefix:t,bitsPerChar:Z,alphabet:at})=>Se({prefix:t,name:F,encode(Hs){return fr(Hs,at,Z)},decode(Hs){return mr(Hs,at,Z,F)}}),Dr=Se({prefix:"\0",name:"identity",encode:F=>dr(F),decode:F=>ur(F)});var vr=Object.freeze({__proto__:null,identity:Dr});const _r=x({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var wr=Object.freeze({__proto__:null,base2:_r});const Er=x({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ir=Object.freeze({__proto__:null,base8:Er});const Tr=me$1({prefix:"9",name:"base10",alphabet:"0123456789"});var Cr=Object.freeze({__proto__:null,base10:Tr});const Pr=x({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Sr=x({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Or=Object.freeze({__proto__:null,base16:Pr,base16upper:Sr});const Rr=x({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ar=x({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),xr=x({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Nr=x({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$r=x({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zr=x({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Lr=x({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),kr=x({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),jr=x({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ur=Object.freeze({__proto__:null,base32:Rr,base32upper:Ar,base32pad:xr,base32padupper:Nr,base32hex:$r,base32hexupper:zr,base32hexpad:Lr,base32hexpadupper:kr,base32z:jr});const Fr=me$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Mr=me$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Kr=Object.freeze({__proto__:null,base36:Fr,base36upper:Mr});const Br=me$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vr=me$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var qr=Object.freeze({__proto__:null,base58btc:Br,base58flickr:Vr});const Gr=x({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Wr=x({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Hr=x({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Yr=x({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Jr=Object.freeze({__proto__:null,base64:Gr,base64pad:Wr,base64url:Hr,base64urlpad:Yr});const oi=Array.from(""),Xr=oi.reduce((F,t,Z)=>(F[Z]=t,F),[]),Zr=oi.reduce((F,t,Z)=>(F[t.codePointAt(0)]=Z,F),[]);function Qr(F){return F.reduce((t,Z)=>(t+=Xr[Z],t),"")}function en(F){const t=[];for(const Z of F){const at=Zr[Z.codePointAt(0)];if(at===void 0)throw new Error(`Non-base256emoji character: ${Z}`);t.push(at)}return new Uint8Array(t)}const tn=Se({prefix:"",name:"base256emoji",encode:Qr,decode:en});var sn=Object.freeze({__proto__:null,base256emoji:tn}),rn=ci,ai=128,nn=127,on=~nn,an=Math.pow(2,31);function ci(F,t,Z){t=t||[],Z=Z||0;for(var at=Z;F>=an;)t[Z++]=F&255|ai,F/=128;for(;F&on;)t[Z++]=F&255|ai,F>>>=7;return t[Z]=F|0,ci.bytes=Z-at+1,t}var cn=Ve$1,hn=128,hi=127;function Ve$1(F,at){var Z=0,at=at||0,Hs=0,zs=at,Ys,Zs=F.length;do{if(zs>=Zs)throw Ve$1.bytes=0,new RangeError("Could not decode varint");Ys=F[zs++],Z+=Hs<28?(Ys&hi)<<Hs:(Ys&hi)*Math.pow(2,Hs),Hs+=7}while(Ys>=hn);return Ve$1.bytes=zs-at,Z}var ln=Math.pow(2,7),un=Math.pow(2,14),dn=Math.pow(2,21),pn=Math.pow(2,28),gn=Math.pow(2,35),yn=Math.pow(2,42),bn=Math.pow(2,49),mn=Math.pow(2,56),fn=Math.pow(2,63),Dn=function(F){return F<ln?1:F<un?2:F<dn?3:F<pn?4:F<gn?5:F<yn?6:F<bn?7:F<mn?8:F<fn?9:10},vn={encode:rn,decode:cn,encodingLength:Dn},li=vn;const ui=(F,t,Z=0)=>(li.encode(F,t,Z),t),di=F=>li.encodingLength(F),qe=(F,t)=>{const Z=t.byteLength,at=di(F),Hs=at+di(Z),zs=new Uint8Array(Hs+Z);return ui(F,zs,0),ui(Z,zs,at),zs.set(t,Hs),new _n(F,Z,t,zs)};class _n{constructor(t,Z,at,Hs){this.code=t,this.size=Z,this.digest=at,this.bytes=Hs}}const pi=({name:F,code:t,encode:Z})=>new wn(F,t,Z);class wn{constructor(t,Z,at){this.name=t,this.code=Z,this.encode=at}digest(t){if(t instanceof Uint8Array){const Z=this.encode(t);return Z instanceof Uint8Array?qe(this.code,Z):Z.then(at=>qe(this.code,at))}else throw Error("Unknown type, must be binary type")}}const gi=F=>async t=>new Uint8Array(await crypto.subtle.digest(F,t)),En=pi({name:"sha2-256",code:18,encode:gi("SHA-256")}),In=pi({name:"sha2-512",code:19,encode:gi("SHA-512")});var Tn=Object.freeze({__proto__:null,sha256:En,sha512:In});const yi=0,Cn="identity",bi=ri,Pn=F=>qe(yi,bi(F)),Sn={code:yi,name:Cn,encode:bi,digest:Pn};var On=Object.freeze({__proto__:null,identity:Sn});new TextEncoder,new TextDecoder;const mi={...vr,...wr,...Ir,...Cr,...Or,...Ur,...Kr,...qr,...Jr,...sn};({...Tn,...On});function fi(F){return globalThis.Buffer!=null?new Uint8Array(F.buffer,F.byteOffset,F.byteLength):F}function Rn(F=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?fi(globalThis.Buffer.allocUnsafe(F)):new Uint8Array(F)}function Di(F,t,Z,at){return{name:F,prefix:t,encoder:{name:F,prefix:t,encode:Z},decoder:{decode:at}}}const vi=Di("utf8","u",F=>"u"+new TextDecoder("utf8").decode(F),F=>new TextEncoder().encode(F.substring(1))),Ge=Di("ascii","a",F=>{let t="a";for(let Z=0;Z<F.length;Z++)t+=String.fromCharCode(F[Z]);return t},F=>{F=F.substring(1);const t=Rn(F.length);for(let Z=0;Z<F.length;Z++)t[Z]=F.charCodeAt(Z);return t}),An={utf8:vi,"utf-8":vi,hex:mi.base16,latin1:Ge,ascii:Ge,binary:Ge,...mi};function xn(F,t="utf8"){const Z=An[t];if(!Z)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?fi(globalThis.Buffer.from(F,"utf-8")):Z.decoder.decode(`${Z.prefix}${F}`)}var Nn=Object.defineProperty,$n=(F,t,Z)=>t in F?Nn(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,J=(F,t,Z)=>$n(F,typeof t!="symbol"?t+"":t,Z);class _i{constructor(t,Z){this.core=t,this.logger=Z,J(this,"keychain",new Map),J(this,"name",Pt),J(this,"version",St$1),J(this,"initialized",!1),J(this,"storagePrefix",W$1),J(this,"init",async()=>{if(!this.initialized){const at=await this.getKeyChain();typeof at<"u"&&(this.keychain=at),this.initialized=!0}}),J(this,"has",at=>(this.isInitialized(),this.keychain.has(at))),J(this,"set",async(at,Hs)=>{this.isInitialized(),this.keychain.set(at,Hs),await this.persist()}),J(this,"get",at=>{this.isInitialized();const Hs=this.keychain.get(at);if(typeof Hs>"u"){const{message:zs}=Bt$1("NO_MATCHING_KEY",`${this.name}: ${at}`);throw new Error(zs)}return Hs}),J(this,"del",async at=>{this.isInitialized(),this.keychain.delete(at),await this.persist()}),this.core=t,this.logger=X$2(Z,this.name)}get context(){return w$1(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,mi$1(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?wi$1(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}}var zn=Object.defineProperty,Ln=(F,t,Z)=>t in F?zn(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,R$1=(F,t,Z)=>Ln(F,typeof t!="symbol"?t+"":t,Z);class wi{constructor(t,Z,at){this.core=t,this.logger=Z,R$1(this,"name",Tt),R$1(this,"keychain"),R$1(this,"randomSessionIdentifier",la()),R$1(this,"initialized",!1),R$1(this,"clientId"),R$1(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),R$1(this,"hasKeys",Hs=>(this.isInitialized(),this.keychain.has(Hs))),R$1(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const Hs=await this.getClientSeed(),zs=Po$2(Hs),Ys=Qe$2(zs.publicKey);return this.clientId=Ys,Ys}),R$1(this,"generateKeyPair",()=>{this.isInitialized();const Hs=ua();return this.setPrivateKey(Hs.publicKey,Hs.privateKey)}),R$1(this,"signJWT",async Hs=>{this.isInitialized();const zs=await this.getClientSeed(),Ys=Po$2(zs),Zs=this.randomSessionIdentifier;return await Qo$2(Zs,Hs,Ct,Ys)}),R$1(this,"generateSharedKey",(Hs,zs,Ys)=>{this.isInitialized();const Zs=this.getPrivateKey(Hs),$u=da(Zs,zs);return this.setSymKey($u,Ys)}),R$1(this,"setSymKey",async(Hs,zs)=>{this.isInitialized();const Ys=zs||ha(Hs);return await this.keychain.set(Ys,Hs),Ys}),R$1(this,"deleteKeyPair",async Hs=>{this.isInitialized(),await this.keychain.del(Hs)}),R$1(this,"deleteSymKey",async Hs=>{this.isInitialized(),await this.keychain.del(Hs)}),R$1(this,"encode",async(Hs,zs,Ys)=>{this.isInitialized();const Zs=rs(Ys),$u=safeJsonStringify(zs);if(xa(Zs))return ya($u,Ys==null?void 0:Ys.encoding);if(va(Zs)){const Iu=Zs.senderPublicKey,_u=Zs.receiverPublicKey;Hs=await this.generateSharedKey(Iu,_u)}const Eu=this.getSymKey(Hs),{type:Au,senderPublicKey:vu}=Zs;return ga({type:Au,symKey:Eu,message:$u,senderPublicKey:vu,encoding:Ys==null?void 0:Ys.encoding})}),R$1(this,"decode",async(Hs,zs,Ys)=>{this.isInitialized();const Zs=wa(zs,Ys);if(xa(Zs)){const $u=ma(zs,Ys==null?void 0:Ys.encoding);return safeJsonParse($u)}if(va(Zs)){const $u=Zs.receiverPublicKey,Eu=Zs.senderPublicKey;Hs=await this.generateSharedKey($u,Eu)}try{const $u=this.getSymKey(Hs),Eu=ba({symKey:$u,encoded:zs,encoding:Ys==null?void 0:Ys.encoding});return safeJsonParse(Eu)}catch($u){this.logger.error(`Failed to decode message from topic: '${Hs}', clientId: '${await this.getClientId()}'`),this.logger.error($u)}}),R$1(this,"getPayloadType",(Hs,zs=oe$1)=>{const Ys=ze({encoded:Hs,encoding:zs});return Zt$1(Ys.type)}),R$1(this,"getPayloadSenderPublicKey",(Hs,zs=oe$1)=>{const Ys=ze({encoded:Hs,encoding:zs});return Ys.senderPublicKey?toString(Ys.senderPublicKey,rt):void 0}),this.core=t,this.logger=X$2(Z,this.name),this.keychain=at||new _i(this.core,this.logger)}get context(){return w$1(this.logger)}async setPrivateKey(t,Z){return await this.keychain.set(t,Z),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Me$1)}catch{t=la(),await this.keychain.set(Me$1,t)}return xn(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}}var kn=Object.defineProperty,jn=Object.defineProperties,Un=Object.getOwnPropertyDescriptors,Ei=Object.getOwnPropertySymbols,Fn=Object.prototype.hasOwnProperty,Mn=Object.prototype.propertyIsEnumerable,We=(F,t,Z)=>t in F?kn(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,Kn=(F,t)=>{for(var Z in t||(t={}))Fn.call(t,Z)&&We(F,Z,t[Z]);if(Ei)for(var Z of Ei(t))Mn.call(t,Z)&&We(F,Z,t[Z]);return F},Bn=(F,t)=>jn(F,Un(t)),K=(F,t,Z)=>We(F,typeof t!="symbol"?t+"":t,Z);class Ii extends y{constructor(t,Z){super(t,Z),this.logger=t,this.core=Z,K(this,"messages",new Map),K(this,"messagesWithoutClientAck",new Map),K(this,"name",Ot),K(this,"version",Rt$1),K(this,"initialized",!1),K(this,"storagePrefix",W$1),K(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const at=await this.getRelayerMessages();typeof at<"u"&&(this.messages=at);const Hs=await this.getRelayerMessagesWithoutClientAck();typeof Hs<"u"&&(this.messagesWithoutClientAck=Hs),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(at){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(at)}finally{this.initialized=!0}}}),K(this,"set",async(at,Hs,zs)=>{this.isInitialized();const Ys=pa(Hs);let Zs=this.messages.get(at);if(typeof Zs>"u"&&(Zs={}),typeof Zs[Ys]<"u")return Ys;if(Zs[Ys]=Hs,this.messages.set(at,Zs),zs===ye.inbound){const $u=this.messagesWithoutClientAck.get(at)||{};this.messagesWithoutClientAck.set(at,Bn(Kn({},$u),{[Ys]:Hs}))}return await this.persist(),Ys}),K(this,"get",at=>{this.isInitialized();let Hs=this.messages.get(at);return typeof Hs>"u"&&(Hs={}),Hs}),K(this,"getWithoutAck",at=>{this.isInitialized();const Hs={};for(const zs of at){const Ys=this.messagesWithoutClientAck.get(zs)||{};Hs[zs]=Object.values(Ys)}return Hs}),K(this,"has",(at,Hs)=>{this.isInitialized();const zs=this.get(at),Ys=pa(Hs);return typeof zs[Ys]<"u"}),K(this,"ack",async(at,Hs)=>{this.isInitialized();const zs=this.messagesWithoutClientAck.get(at);if(typeof zs>"u")return;const Ys=pa(Hs);delete zs[Ys],Object.keys(zs).length===0?this.messagesWithoutClientAck.delete(at):this.messagesWithoutClientAck.set(at,zs),await this.persist()}),K(this,"del",async at=>{this.isInitialized(),this.messages.delete(at),this.messagesWithoutClientAck.delete(at),await this.persist()}),this.logger=X$2(t,this.name),this.core=Z}get context(){return w$1(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,mi$1(t))}async setRelayerMessagesWithoutClientAck(t){await this.core.storage.setItem(this.storageKeyWithoutClientAck,mi$1(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?wi$1(t):void 0}async getRelayerMessagesWithoutClientAck(){const t=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof t<"u"?wi$1(t):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Vn=Object.defineProperty,qn=Object.defineProperties,Gn=Object.getOwnPropertyDescriptors,Ti=Object.getOwnPropertySymbols,Wn=Object.prototype.hasOwnProperty,Hn=Object.prototype.propertyIsEnumerable,He=(F,t,Z)=>t in F?Vn(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,ce=(F,t)=>{for(var Z in t||(t={}))Wn.call(t,Z)&&He(F,Z,t[Z]);if(Ti)for(var Z of Ti(t))Hn.call(t,Z)&&He(F,Z,t[Z]);return F},Ci=(F,t)=>qn(F,Gn(t)),G=(F,t,Z)=>He(F,typeof t!="symbol"?t+"":t,Z);class Yn extends m$3{constructor(t,Z){super(t,Z),this.relayer=t,this.logger=Z,G(this,"events",new eventsExports.EventEmitter),G(this,"name",xt),G(this,"queue",new Map),G(this,"publishTimeout",cjs$3.toMiliseconds(cjs$3.ONE_MINUTE)),G(this,"initialPublishTimeout",cjs$3.toMiliseconds(cjs$3.ONE_SECOND*15)),G(this,"needsTransportRestart",!1),G(this,"publish",async(at,Hs,zs)=>{var Ys,Zs,$u,Eu,Au;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:at,message:Hs,opts:zs}});const vu=(zs==null?void 0:zs.ttl)||At,Iu=(zs==null?void 0:zs.prompt)||!1,_u=(zs==null?void 0:zs.tag)||0,Su=(zs==null?void 0:zs.id)||getBigIntRpcId().toString(),Bu=Aa(Ba().protocol),Du={id:Su,method:(zs==null?void 0:zs.publishMethod)||Bu.publish,params:ce({topic:at,message:Hs,ttl:vu,prompt:Iu,tag:_u,attestation:zs==null?void 0:zs.attestation},zs==null?void 0:zs.tvf)},Tu=`Failed to publish payload, please try again. id:${Su} tag:${_u}`;try{Dt((Ys=Du.params)==null?void 0:Ys.prompt)&&((Zs=Du.params)==null||delete Zs.prompt),Dt(($u=Du.params)==null?void 0:$u.tag)&&((Eu=Du.params)==null||delete Eu.tag);const Pu=new Promise(async Uu=>{const Fu=({id:qu})=>{var zu;((zu=Du.id)==null?void 0:zu.toString())===qu.toString()&&(this.removeRequestFromQueue(qu),this.relayer.events.removeListener(C.publish,Fu),Uu())};this.relayer.events.on(C.publish,Fu);const Lu=Ai$1(new Promise((qu,zu)=>{this.rpcPublish(Du,zs).then(qu).catch(tl=>{this.logger.warn(tl,tl==null?void 0:tl.message),zu(tl)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${Su} tag:${_u}`);try{await Lu,this.events.removeListener(C.publish,Fu)}catch(qu){this.queue.set(Su,{request:Du,opts:zs,attempt:1}),this.logger.warn(qu,qu==null?void 0:qu.message)}});this.logger.trace({type:"method",method:"publish",params:{id:Su,topic:at,message:Hs,opts:zs}}),await Ai$1(Pu,this.publishTimeout,Tu)}catch(Pu){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(Pu),(Au=zs==null?void 0:zs.internal)!=null&&Au.throwOnFailedPublish)throw Pu}finally{this.queue.delete(Su)}}),G(this,"publishCustom",async at=>{var Hs,zs,Ys,Zs,$u;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:at});const{payload:Eu,opts:Au={}}=at,{attestation:vu,tvf:Iu,publishMethod:_u,prompt:Su,tag:Bu,ttl:Du=cjs$3.FIVE_MINUTES}=Au,Tu=Au.id||getBigIntRpcId().toString(),Pu=Aa(Ba().protocol),Uu=_u||Pu.publish,Fu={id:Tu,method:Uu,params:ce(Ci(ce({},Eu),{ttl:Du,prompt:Su,tag:Bu,attestation:vu}),Iu)},Lu=`Failed to publish custom payload, please try again. id:${Tu} tag:${Bu}`;try{Dt((Hs=Fu.params)==null?void 0:Hs.prompt)&&((zs=Fu.params)==null||delete zs.prompt),Dt((Ys=Fu.params)==null?void 0:Ys.tag)&&((Zs=Fu.params)==null||delete Zs.tag);const qu=new Promise(async zu=>{const tl=({id:cl})=>{var wl;((wl=Fu.id)==null?void 0:wl.toString())===cl.toString()&&(this.removeRequestFromQueue(cl),this.relayer.events.removeListener(C.publish,tl),zu())};this.relayer.events.on(C.publish,tl);const Wu=Ai$1(new Promise((cl,wl)=>{this.rpcPublish(Fu,Au).then(cl).catch(hl=>{this.logger.warn(hl,hl==null?void 0:hl.message),wl(hl)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${Uu} id:${Tu} tag:${Bu}`);try{await Wu,this.events.removeListener(C.publish,tl)}catch(cl){this.queue.set(Tu,{request:Fu,opts:Au,attempt:1}),this.logger.warn(cl,cl==null?void 0:cl.message)}});this.logger.trace({type:"method",method:"publish",params:{id:Tu,payload:Eu,opts:Au}}),await Ai$1(qu,this.publishTimeout,Lu)}catch(qu){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(qu),($u=Au==null?void 0:Au.internal)!=null&&$u.throwOnFailedPublish)throw qu}finally{this.queue.delete(Tu)}}),G(this,"on",(at,Hs)=>{this.events.on(at,Hs)}),G(this,"once",(at,Hs)=>{this.events.once(at,Hs)}),G(this,"off",(at,Hs)=>{this.events.off(at,Hs)}),G(this,"removeListener",(at,Hs)=>{this.events.removeListener(at,Hs)}),this.relayer=t,this.logger=X$2(Z,this.name),this.registerEventListeners()}get context(){return w$1(this.logger)}async rpcPublish(t,Z){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:t});const at=await this.relayer.request(t);return this.relayer.events.emit(C.publish,ce(ce({},t),Z)),this.logger.debug("Successfully Published Payload"),at}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async(t,Z)=>{var at;const Hs=t.attempt+1;this.queue.set(Z,Ci(ce({},t),{attempt:Hs})),this.logger.warn({},`Publisher: queue->publishing: ${t.request.id}, tag: ${(at=t.request.params)==null?void 0:at.tag}, attempt: ${Hs}`),await this.rpcPublish(t.request,t.opts),this.logger.warn({},`Publisher: queue->published: ${t.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(r$1.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(C.connection_stalled);return}this.checkQueue()}),this.relayer.on(C.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}var Jn=Object.defineProperty,Xn=(F,t,Z)=>t in F?Jn(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,he=(F,t,Z)=>Xn(F,typeof t!="symbol"?t+"":t,Z);class Zn{constructor(){he(this,"map",new Map),he(this,"set",(t,Z)=>{const at=this.get(t);this.exists(t,Z)||this.map.set(t,[...at,Z])}),he(this,"get",t=>this.map.get(t)||[]),he(this,"exists",(t,Z)=>this.get(t).includes(Z)),he(this,"delete",(t,Z)=>{if(typeof Z>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const at=this.get(t);if(!this.exists(t,Z))return;const Hs=at.filter(zs=>zs!==Z);if(!Hs.length){this.map.delete(t);return}this.map.set(t,Hs)}),he(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var Qn=Object.defineProperty,eo=Object.defineProperties,to=Object.getOwnPropertyDescriptors,Pi=Object.getOwnPropertySymbols,io=Object.prototype.hasOwnProperty,so=Object.prototype.propertyIsEnumerable,Ye=(F,t,Z)=>t in F?Qn(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,fe$1=(F,t)=>{for(var Z in t||(t={}))io.call(t,Z)&&Ye(F,Z,t[Z]);if(Pi)for(var Z of Pi(t))so.call(t,Z)&&Ye(F,Z,t[Z]);return F},Je=(F,t)=>eo(F,to(t)),f$1=(F,t,Z)=>Ye(F,typeof t!="symbol"?t+"":t,Z);class Si extends P$3{constructor(t,Z){super(t,Z),this.relayer=t,this.logger=Z,f$1(this,"subscriptions",new Map),f$1(this,"topicMap",new Zn),f$1(this,"events",new eventsExports.EventEmitter),f$1(this,"name",Ft),f$1(this,"version",Mt),f$1(this,"pending",new Map),f$1(this,"cached",[]),f$1(this,"initialized",!1),f$1(this,"storagePrefix",W$1),f$1(this,"subscribeTimeout",cjs$3.toMiliseconds(cjs$3.ONE_MINUTE)),f$1(this,"initialSubscribeTimeout",cjs$3.toMiliseconds(cjs$3.ONE_SECOND*15)),f$1(this,"clientId"),f$1(this,"batchSubscribeTopicsLimit",500),f$1(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),f$1(this,"subscribe",async(at,Hs)=>{var zs;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:at,opts:Hs}});try{const Ys=Ba(Hs),Zs={topic:at,relay:Ys,transportType:Hs==null?void 0:Hs.transportType};(zs=Hs==null?void 0:Hs.internal)!=null&&zs.skipSubscribe||this.pending.set(at,Zs);const $u=await this.rpcSubscribe(at,Ys,Hs);return typeof $u=="string"&&(this.onSubscribe($u,Zs),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:at,opts:Hs}})),$u}catch(Ys){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(Ys),Ys}}),f$1(this,"unsubscribe",async(at,Hs)=>{this.isInitialized(),typeof(Hs==null?void 0:Hs.id)<"u"?await this.unsubscribeById(at,Hs.id,Hs):await this.unsubscribeByTopic(at,Hs)}),f$1(this,"isSubscribed",at=>new Promise(Hs=>{Hs(this.topicMap.topics.includes(at))})),f$1(this,"isKnownTopic",at=>new Promise(Hs=>{Hs(this.topicMap.topics.includes(at)||this.pending.has(at)||this.cached.some(zs=>zs.topic===at))})),f$1(this,"on",(at,Hs)=>{this.events.on(at,Hs)}),f$1(this,"once",(at,Hs)=>{this.events.once(at,Hs)}),f$1(this,"off",(at,Hs)=>{this.events.off(at,Hs)}),f$1(this,"removeListener",(at,Hs)=>{this.events.removeListener(at,Hs)}),f$1(this,"start",async()=>{await this.onConnect()}),f$1(this,"stop",async()=>{await this.onDisconnect()}),f$1(this,"restart",async()=>{await this.restore(),await this.onRestart()}),f$1(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const at=[];this.pending.forEach(Hs=>{at.push(Hs)}),await this.batchSubscribe(at)}),f$1(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(r$1.pulse,async()=>{await this.checkPending()}),this.events.on(j.created,async at=>{const Hs=j.created;this.logger.info(`Emitting ${Hs}`),this.logger.debug({type:"event",event:Hs,data:at}),await this.persist()}),this.events.on(j.deleted,async at=>{const Hs=j.deleted;this.logger.info(`Emitting ${Hs}`),this.logger.debug({type:"event",event:Hs,data:at}),await this.persist()})}),this.relayer=t,this.logger=X$2(Z,this.name),this.clientId=""}get context(){return w$1(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(t,Z){let at=!1;try{at=this.getSubscription(t).topic===Z}catch{}return at}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,Z){const at=this.topicMap.get(t);await Promise.all(at.map(async Hs=>await this.unsubscribeById(t,Hs,Z)))}async unsubscribeById(t,Z,at){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:Z,opts:at}});try{const Hs=Ba(at);await this.restartToComplete({topic:t,id:Z,relay:Hs}),await this.rpcUnsubscribe(t,Z,Hs);const zs=zt$1("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,Z,zs),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:Z,opts:at}})}catch(Hs){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(Hs),Hs}}async rpcSubscribe(t,Z,at){var Hs,zs;const Ys=await this.getSubscriptionId(t);if((Hs=at==null?void 0:at.internal)!=null&&Hs.skipSubscribe)return Ys;(!at||(at==null?void 0:at.transportType)===ee.relay)&&await this.restartToComplete({topic:t,id:t,relay:Z});const Zs={method:Aa(Z.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:Zs});const $u=(zs=at==null?void 0:at.internal)==null?void 0:zs.throwOnFailedPublish;try{if((at==null?void 0:at.transportType)===ee.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(Zs).catch(vu=>this.logger.warn(vu))},cjs$3.toMiliseconds(cjs$3.ONE_SECOND)),Ys;const Eu=new Promise(async vu=>{const Iu=_u=>{_u.topic===t&&(this.events.removeListener(j.created,Iu),vu(_u.id))};this.events.on(j.created,Iu);try{const _u=await Ai$1(new Promise((Su,Bu)=>{this.relayer.request(Zs).catch(Du=>{this.logger.warn(Du,Du==null?void 0:Du.message),Bu(Du)}).then(Su)}),this.initialSubscribeTimeout,`Subscribing to ${t} failed, please try again`);this.events.removeListener(j.created,Iu),vu(_u)}catch{}}),Au=await Ai$1(Eu,this.subscribeTimeout,`Subscribing to ${t} failed, please try again`);if(!Au&&$u)throw new Error(`Subscribing to ${t} failed, please try again`);return Au?Ys:null}catch(Eu){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(C.connection_stalled),$u)throw Eu}return null}async rpcBatchSubscribe(t){if(!t.length)return;const Z=t[0].relay,at={method:Aa(Z.protocol).batchSubscribe,params:{topics:t.map(Hs=>Hs.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:at});try{await await Ai$1(new Promise(Hs=>{this.relayer.request(at).catch(zs=>this.logger.warn(zs)).then(Hs)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(C.connection_stalled)}}async rpcBatchFetchMessages(t){if(!t.length)return;const Z=t[0].relay,at={method:Aa(Z.protocol).batchFetchMessages,params:{topics:t.map(zs=>zs.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:at});let Hs;try{Hs=await await Ai$1(new Promise((zs,Ys)=>{this.relayer.request(at).catch(Zs=>{this.logger.warn(Zs),Ys(Zs)}).then(zs)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(C.connection_stalled)}return Hs}rpcUnsubscribe(t,Z,at){const Hs={method:Aa(at.protocol).unsubscribe,params:{topic:t,id:Z}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:Hs}),this.relayer.request(Hs)}onSubscribe(t,Z){this.setSubscription(t,Je(fe$1({},Z),{id:t})),this.pending.delete(Z.topic)}onBatchSubscribe(t){t.length&&t.forEach(Z=>{this.setSubscription(Z.id,fe$1({},Z)),this.pending.delete(Z.topic)})}async onUnsubscribe(t,Z,at){this.events.removeAllListeners(Z),this.hasSubscription(Z,t)&&this.deleteSubscription(Z,at),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,Z){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:Z}),this.addSubscription(t,Z)}addSubscription(t,Z){this.subscriptions.set(t,fe$1({},Z)),this.topicMap.set(Z.topic,t),this.events.emit(j.created,Z)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const Z=this.subscriptions.get(t);if(!Z){const{message:at}=Bt$1("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(at)}return Z}deleteSubscription(t,Z){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:Z});const at=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(at.topic,t),this.events.emit(j.deleted,Je(fe$1({},at),{reason:Z}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(j.sync)}async onRestart(){if(this.cached.length){const t=[...this.cached],Z=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let at=0;at<Z;at++){const Hs=t.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(Hs)}}this.events.emit(j.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size&&!t.every(Z=>{var at;return Z.topic===((at=this.subscriptions.get(Z.id))==null?void 0:at.topic)})){const{message:Z}=Bt$1("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(Z),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(Z)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){t.length&&(await this.rpcBatchSubscribe(t),this.onBatchSubscribe(await Promise.all(t.map(async Z=>Je(fe$1({},Z),{id:await this.getSubscriptionId(Z.topic)})))))}async batchFetchMessages(t){if(!t.length)return;this.logger.trace(`Fetching batch messages for ${t.length} subscriptions`);const Z=await this.rpcBatchFetchMessages(t);Z&&Z.messages&&(await Li$1(cjs$3.toMiliseconds(cjs$3.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(Z.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(t){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(t),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(t){return pa(t+await this.getClientId())}}var ro=Object.defineProperty,Oi=Object.getOwnPropertySymbols,no=Object.prototype.hasOwnProperty,oo=Object.prototype.propertyIsEnumerable,Xe=(F,t,Z)=>t in F?ro(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,Ri=(F,t)=>{for(var Z in t||(t={}))no.call(t,Z)&&Xe(F,Z,t[Z]);if(Oi)for(var Z of Oi(t))oo.call(t,Z)&&Xe(F,Z,t[Z]);return F},p=(F,t,Z)=>Xe(F,typeof t!="symbol"?t+"":t,Z);class Ai extends d$2{constructor(t){var Z;super(t),p(this,"protocol","wc"),p(this,"version",2),p(this,"core"),p(this,"logger"),p(this,"events",new eventsExports.EventEmitter),p(this,"provider"),p(this,"messages"),p(this,"subscriber"),p(this,"publisher"),p(this,"name",zt),p(this,"transportExplicitlyClosed",!1),p(this,"initialized",!1),p(this,"connectionAttemptInProgress",!1),p(this,"relayUrl"),p(this,"projectId"),p(this,"packageName"),p(this,"bundleId"),p(this,"hasExperiencedNetworkDisruption",!1),p(this,"pingTimeout"),p(this,"heartBeatTimeout",cjs$3.toMiliseconds(cjs$3.THIRTY_SECONDS+cjs$3.FIVE_SECONDS)),p(this,"reconnectTimeout"),p(this,"connectPromise"),p(this,"reconnectInProgress",!1),p(this,"requestsInFlight",[]),p(this,"connectTimeout",cjs$3.toMiliseconds(cjs$3.ONE_SECOND*15)),p(this,"request",async at=>{var Hs,zs;this.logger.debug("Publishing Request Payload");const Ys=at.id||getBigIntRpcId().toString();await this.toEstablishConnection();try{this.logger.trace({id:Ys,method:at.method,topic:(Hs=at.params)==null?void 0:Hs.topic},"relayer.request - publishing...");const Zs=`${Ys}:${((zs=at.params)==null?void 0:zs.tag)||""}`;this.requestsInFlight.push(Zs);const $u=await this.provider.request(at);return this.requestsInFlight=this.requestsInFlight.filter(Eu=>Eu!==Zs),$u}catch(Zs){throw this.logger.debug(`Failed to Publish Request: ${Ys}`),Zs}}),p(this,"resetPingTimeout",()=>{rn$1()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var at,Hs,zs,Ys;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(Ys=(zs=(Hs=(at=this.provider)==null?void 0:at.connection)==null?void 0:Hs.socket)==null?void 0:zs.terminate)==null||Ys.call(zs)}catch(Zs){this.logger.warn(Zs,Zs==null?void 0:Zs.message)}},this.heartBeatTimeout))}),p(this,"onPayloadHandler",at=>{this.onProviderPayload(at),this.resetPingTimeout()}),p(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(C.connect)}),p(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),p(this,"onProviderErrorHandler",at=>{this.logger.fatal(`Fatal socket error: ${at.message}`),this.events.emit(C.error,at),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),p(this,"registerProviderListeners",()=>{this.provider.on(M.payload,this.onPayloadHandler),this.provider.on(M.connect,this.onConnectHandler),this.provider.on(M.disconnect,this.onDisconnectHandler),this.provider.on(M.error,this.onProviderErrorHandler)}),this.core=t.core,this.logger=wu({logger:(Z=t.logger)!=null?Z:$t,name:this.name}),this.messages=new Ii(this.logger,t.core),this.subscriber=new Si(this,this.logger),this.publisher=new Yn(this,this.logger),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Ke$1,ai$1()?this.packageName=li$1():ui$1()&&(this.bundleId=li$1()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(t=>this.logger.warn(t,t==null?void 0:t.message))}get context(){return w$1(this.logger)}get connected(){var t,Z,at;return((at=(Z=(t=this.provider)==null?void 0:t.connection)==null?void 0:Z.socket)==null?void 0:at.readyState)===1||!1}get connecting(){var t,Z,at;return((at=(Z=(t=this.provider)==null?void 0:t.connection)==null?void 0:Z.socket)==null?void 0:at.readyState)===0||this.connectPromise!==void 0||!1}async publish(t,Z,at){this.isInitialized(),await this.publisher.publish(t,Z,at),await this.recordMessageEvent({topic:t,message:Z,publishedAt:Date.now(),transportType:ee.relay},ye.outbound)}async publishCustom(t){this.isInitialized(),await this.publisher.publishCustom(t)}async subscribe(t,Z){var at,Hs,zs;this.isInitialized(),(!(Z!=null&&Z.transportType)||(Z==null?void 0:Z.transportType)==="relay")&&await this.toEstablishConnection();const Ys=typeof((at=Z==null?void 0:Z.internal)==null?void 0:at.throwOnFailedPublish)>"u"?!0:(Hs=Z==null?void 0:Z.internal)==null?void 0:Hs.throwOnFailedPublish;let Zs=((zs=this.subscriber.topicMap.get(t))==null?void 0:zs[0])||"",$u;const Eu=Au=>{Au.topic===t&&(this.subscriber.off(j.created,Eu),$u())};return await Promise.all([new Promise(Au=>{$u=Au,this.subscriber.on(j.created,Eu)}),new Promise(async(Au,vu)=>{Zs=await this.subscriber.subscribe(t,Ri({internal:{throwOnFailedPublish:Ys}},Z)).catch(Iu=>{Ys&&vu(Iu)})||Zs,Au()})]),Zs}async unsubscribe(t,Z){this.isInitialized(),await this.subscriber.unsubscribe(t,Z)}on(t,Z){this.events.on(t,Z)}once(t,Z){this.events.once(t,Z)}off(t,Z){this.events.off(t,Z)}removeListener(t,Z){this.events.removeListener(t,Z)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Ai$1(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(Z,at)=>{await this.connect(t).then(Z).catch(at).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(t){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await uu())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(t){if((t==null?void 0:t.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const Z=t.sort((at,Hs)=>at.publishedAt-Hs.publishedAt);this.logger.debug(`Batch of ${Z.length} message events sorted`);for(const at of Z)try{await this.onMessageEvent(at)}catch(Hs){this.logger.warn(Hs,"Error while processing batch message event: "+(Hs==null?void 0:Hs.message))}this.logger.trace(`Batch of ${Z.length} message events processed`)}async onLinkMessageEvent(t,Z){const{topic:at}=t;if(!Z.sessionExists){const Hs=Ni$1(cjs$3.FIVE_MINUTES),zs={topic:at,expiry:Hs,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(at,zs)}this.events.emit(C.message,t),await this.recordMessageEvent(t,ye.inbound)}async connect(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let Z=1;for(;Z<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${Z}...`),await this.createProvider(),await new Promise(async(at,Hs)=>{const zs=()=>{Hs(new Error("Connection interrupted while trying to connect"))};this.provider.once(M.disconnect,zs),await Ai$1(new Promise((Ys,Zs)=>{this.provider.connect().then(Ys).catch(Zs)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(Ys=>{Hs(Ys)}).finally(()=>{this.provider.off(M.disconnect,zs),clearTimeout(this.reconnectTimeout)}),await new Promise(async(Ys,Zs)=>{const $u=()=>{Hs(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(M.disconnect,$u),await this.subscriber.start().then(Ys).catch(Zs).finally(()=>{this.provider.off(M.disconnect,$u)})}),this.hasExperiencedNetworkDisruption=!1,at()})}catch(at){await this.subscriber.stop();const Hs=at;this.logger.warn({},Hs.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${Z}`);break}await new Promise(at=>setTimeout(at,cjs$3.toMiliseconds(Z*1))),Z++}}startPingTimeout(){var t,Z,at,Hs,zs;if(rn$1())try{(Z=(t=this.provider)==null?void 0:t.connection)!=null&&Z.socket&&((zs=(Hs=(at=this.provider)==null?void 0:at.connection)==null?void 0:Hs.socket)==null||zs.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(Ys){this.logger.warn(Ys,Ys==null?void 0:Ys.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new o(new f$2(pi$1({sdkVersion:Pe,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(t,Z){const{topic:at,message:Hs}=t;await this.messages.set(at,Hs,Z)}async shouldIgnoreMessageEvent(t){const{topic:Z,message:at}=t;if(!at||at.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${at}`),!0;if(!await this.subscriber.isKnownTopic(Z))return this.logger.warn(`Ignoring message for unknown topic ${Z}`),!0;const Hs=this.messages.has(Z,at);return Hs&&this.logger.warn(`Ignoring duplicate message: ${at}`),Hs}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),isJsonRpcRequest(t)){if(!t.method.endsWith(Lt))return;const Z=t.params,{topic:at,message:Hs,publishedAt:zs,attestation:Ys}=Z.data,Zs={topic:at,message:Hs,publishedAt:zs,transportType:ee.relay,attestation:Ys};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ri({type:"event",event:Z.id},Zs)),this.events.emit(Z.id,Zs),await this.acknowledgePayload(t),await this.onMessageEvent(Zs)}else isJsonRpcResponse(t)&&this.events.emit(C.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(await this.recordMessageEvent(t,ye.inbound),this.events.emit(C.message,t))}async acknowledgePayload(t){const Z=formatJsonRpcResult(t.id,!0);await this.provider.connection.send(Z)}unregisterProviderListeners(){this.provider.off(M.payload,this.onPayloadHandler),this.provider.off(M.connect,this.onConnectHandler),this.provider.off(M.disconnect,this.onDisconnectHandler),this.provider.off(M.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await uu();lu(async Z=>{t!==Z&&(t=Z,Z?await this.transportOpen().catch(at=>this.logger.error(at,at==null?void 0:at.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(r$1.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&du())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(Z){this.logger.warn(Z,Z==null?void 0:Z.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(C.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t,t==null?void 0:t.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},cjs$3.toMiliseconds(kt)))))}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function ao(F,t){return F===t||Number.isNaN(F)&&Number.isNaN(t)}function xi(F){return Object.getOwnPropertySymbols(F).filter(t=>Object.prototype.propertyIsEnumerable.call(F,t))}function Ni(F){return F==null?F===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(F)}const co="[object RegExp]",ho="[object String]",lo="[object Number]",uo="[object Boolean]",$i="[object Arguments]",po="[object Symbol]",go="[object Date]",yo="[object Map]",bo="[object Set]",mo="[object Array]",fo="[object Function]",Do="[object ArrayBuffer]",Ze="[object Object]",vo="[object Error]",_o="[object DataView]",wo="[object Uint8Array]",Eo="[object Uint8ClampedArray]",Io="[object Uint16Array]",To="[object Uint32Array]",Co="[object BigUint64Array]",Po="[object Int8Array]",So="[object Int16Array]",Oo="[object Int32Array]",Ro="[object BigInt64Array]",Ao="[object Float32Array]",xo="[object Float64Array]";function No(){}function zi(F){if(!F||typeof F!="object")return!1;const t=Object.getPrototypeOf(F);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(F)==="[object Object]":!1}function $o(F,t,Z){return De$1(F,t,void 0,void 0,void 0,void 0,Z)}function De$1(F,t,Z,at,Hs,zs,Ys){const Zs=Ys(F,t,Z,at,Hs,zs);if(Zs!==void 0)return Zs;if(typeof F==typeof t)switch(typeof F){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return F===t;case"number":return F===t||Object.is(F,t);case"function":return F===t;case"object":return ve(F,t,zs,Ys)}return ve(F,t,zs,Ys)}function ve(F,t,Z,at){if(Object.is(F,t))return!0;let Hs=Ni(F),zs=Ni(t);if(Hs===$i&&(Hs=Ze),zs===$i&&(zs=Ze),Hs!==zs)return!1;switch(Hs){case ho:return F.toString()===t.toString();case lo:{const $u=F.valueOf(),Eu=t.valueOf();return ao($u,Eu)}case uo:case go:case po:return Object.is(F.valueOf(),t.valueOf());case co:return F.source===t.source&&F.flags===t.flags;case fo:return F===t}Z=Z??new Map;const Ys=Z.get(F),Zs=Z.get(t);if(Ys!=null&&Zs!=null)return Ys===t;Z.set(F,t),Z.set(t,F);try{switch(Hs){case yo:{if(F.size!==t.size)return!1;for(const[$u,Eu]of F.entries())if(!t.has($u)||!De$1(Eu,t.get($u),$u,F,t,Z,at))return!1;return!0}case bo:{if(F.size!==t.size)return!1;const $u=Array.from(F.values()),Eu=Array.from(t.values());for(let Au=0;Au<$u.length;Au++){const vu=$u[Au],Iu=Eu.findIndex(_u=>De$1(vu,_u,void 0,F,t,Z,at));if(Iu===-1)return!1;Eu.splice(Iu,1)}return!0}case mo:case wo:case Eo:case Io:case To:case Co:case Po:case So:case Oo:case Ro:case Ao:case xo:{if(typeof Buffer<"u"&&Buffer.isBuffer(F)!==Buffer.isBuffer(t)||F.length!==t.length)return!1;for(let $u=0;$u<F.length;$u++)if(!De$1(F[$u],t[$u],$u,F,t,Z,at))return!1;return!0}case Do:return F.byteLength!==t.byteLength?!1:ve(new Uint8Array(F),new Uint8Array(t),Z,at);case _o:return F.byteLength!==t.byteLength||F.byteOffset!==t.byteOffset?!1:ve(new Uint8Array(F),new Uint8Array(t),Z,at);case vo:return F.name===t.name&&F.message===t.message;case Ze:{if(!(ve(F.constructor,t.constructor,Z,at)||zi(F)&&zi(t)))return!1;const $u=[...Object.keys(F),...xi(F)],Eu=[...Object.keys(t),...xi(t)];if($u.length!==Eu.length)return!1;for(let Au=0;Au<$u.length;Au++){const vu=$u[Au],Iu=F[vu];if(!Object.hasOwn(t,vu))return!1;const _u=t[vu];if(!De$1(Iu,_u,vu,F,t,Z,at))return!1}return!0}default:return!1}}finally{Z.delete(F),Z.delete(t)}}function zo(F,t){return $o(F,t,No)}var Lo=Object.defineProperty,Li=Object.getOwnPropertySymbols,ko=Object.prototype.hasOwnProperty,jo=Object.prototype.propertyIsEnumerable,Qe=(F,t,Z)=>t in F?Lo(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,ki=(F,t)=>{for(var Z in t||(t={}))ko.call(t,Z)&&Qe(F,Z,t[Z]);if(Li)for(var Z of Li(t))jo.call(t,Z)&&Qe(F,Z,t[Z]);return F},U=(F,t,Z)=>Qe(F,typeof t!="symbol"?t+"":t,Z);class ji extends f$3{constructor(t,Z,at,Hs=W$1,zs=void 0){super(t,Z,at,Hs),this.core=t,this.logger=Z,this.name=at,U(this,"map",new Map),U(this,"version",jt),U(this,"cached",[]),U(this,"initialized",!1),U(this,"getKey"),U(this,"storagePrefix",W$1),U(this,"recentlyDeleted",[]),U(this,"recentlyDeletedLimit",200),U(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(Ys=>{this.getKey&&Ys!==null&&!Dt(Ys)?this.map.set(this.getKey(Ys),Ys):Ga(Ys)?this.map.set(Ys.id,Ys):za(Ys)&&this.map.set(Ys.topic,Ys)}),this.cached=[],this.initialized=!0)}),U(this,"set",async(Ys,Zs)=>{this.isInitialized(),this.map.has(Ys)?await this.update(Ys,Zs):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:Ys,value:Zs}),this.map.set(Ys,Zs),await this.persist())}),U(this,"get",Ys=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:Ys}),this.getData(Ys))),U(this,"getAll",Ys=>(this.isInitialized(),Ys?this.values.filter(Zs=>Object.keys(Ys).every($u=>zo(Zs[$u],Ys[$u]))):this.values)),U(this,"update",async(Ys,Zs)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:Ys,update:Zs});const $u=ki(ki({},this.getData(Ys)),Zs);this.map.set(Ys,$u),await this.persist()}),U(this,"delete",async(Ys,Zs)=>{this.isInitialized(),this.map.has(Ys)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:Ys,reason:Zs}),this.map.delete(Ys),this.addToRecentlyDeleted(Ys),await this.persist())}),this.logger=X$2(Z,this.name),this.storagePrefix=Hs,this.getKey=zs}get context(){return w$1(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const Z=this.map.get(t);if(!Z){if(this.recentlyDeleted.includes(t)){const{message:Hs}=Bt$1("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(Hs),new Error(Hs)}const{message:at}=Bt$1("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(at),new Error(at)}return Z}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:Z}=Bt$1("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(Z),new Error(Z)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Uo=Object.defineProperty,Fo=(F,t,Z)=>t in F?Uo(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,d=(F,t,Z)=>Fo(F,typeof t!="symbol"?t+"":t,Z);class Ui{constructor(t,Z){this.core=t,this.logger=Z,d(this,"name",Kt),d(this,"version",Bt),d(this,"events",new Nt$3),d(this,"pairings"),d(this,"initialized",!1),d(this,"storagePrefix",W$1),d(this,"ignoredPayloadTypes",[ie]),d(this,"registeredMethods",[]),d(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),d(this,"register",({methods:at})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...at])]}),d(this,"create",async at=>{this.isInitialized();const Hs=la(),zs=await this.core.crypto.setSymKey(Hs),Ys=Ni$1(cjs$3.FIVE_MINUTES),Zs={protocol:Nt},$u={topic:zs,expiry:Ys,relay:Zs,active:!1,methods:at==null?void 0:at.methods},Eu=$a({protocol:this.core.protocol,version:this.core.version,topic:zs,symKey:Hs,relay:Zs,expiryTimestamp:Ys,methods:at==null?void 0:at.methods});return this.events.emit(ae.create,$u),this.core.expirer.set(zs,Ys),await this.pairings.set(zs,$u),await this.core.relayer.subscribe(zs,{transportType:at==null?void 0:at.transportType,internal:at==null?void 0:at.internal}),{topic:zs,uri:Eu}}),d(this,"pair",async at=>{this.isInitialized();const Hs=this.core.eventClient.createEvent({properties:{topic:at==null?void 0:at.uri,trace:[Y.pairing_started]}});this.isValidPair(at,Hs);const{topic:zs,symKey:Ys,relay:Zs,expiryTimestamp:$u,methods:Eu}=Ra(at.uri);Hs.props.properties.topic=zs,Hs.addTrace(Y.pairing_uri_validation_success),Hs.addTrace(Y.pairing_uri_not_expired);let Au;if(this.pairings.keys.includes(zs)){if(Au=this.pairings.get(zs),Hs.addTrace(Y.existing_pairing),Au.active)throw Hs.setError(X.active_pairing_already_exists),new Error(`Pairing already exists: ${zs}. Please try again with a new connection URI.`);Hs.addTrace(Y.pairing_not_expired)}const vu=$u||Ni$1(cjs$3.FIVE_MINUTES),Iu={topic:zs,relay:Zs,expiry:vu,active:!1,methods:Eu};this.core.expirer.set(zs,vu),await this.pairings.set(zs,Iu),Hs.addTrace(Y.store_new_pairing),at.activatePairing&&await this.activate({topic:zs}),this.events.emit(ae.create,Iu),Hs.addTrace(Y.emit_inactive_pairing),this.core.crypto.keychain.has(zs)||await this.core.crypto.setSymKey(Ys,zs),Hs.addTrace(Y.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{Hs.setError(X.no_internet_connection)}try{await this.core.relayer.subscribe(zs,{relay:Zs})}catch(_u){throw Hs.setError(X.subscribe_pairing_topic_failure),_u}return Hs.addTrace(Y.subscribe_pairing_topic_success),Iu}),d(this,"activate",async({topic:at})=>{this.isInitialized();const Hs=Ni$1(cjs$3.FIVE_MINUTES);this.core.expirer.set(at,Hs),await this.pairings.update(at,{active:!0,expiry:Hs})}),d(this,"ping",async at=>{this.isInitialized(),await this.isValidPing(at),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:Hs}=at;if(this.pairings.keys.includes(Hs)){const zs=await this.sendRequest(Hs,"wc_pairingPing",{}),{done:Ys,resolve:Zs,reject:$u}=Bi$1();this.events.once(_i$1("pairing_ping",zs),({error:Eu})=>{Eu?$u(Eu):Zs()}),await Ys()}}),d(this,"updateExpiry",async({topic:at,expiry:Hs})=>{this.isInitialized(),await this.pairings.update(at,{expiry:Hs})}),d(this,"updateMetadata",async({topic:at,metadata:Hs})=>{this.isInitialized(),await this.pairings.update(at,{peerMetadata:Hs})}),d(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),d(this,"disconnect",async at=>{this.isInitialized(),await this.isValidDisconnect(at);const{topic:Hs}=at;this.pairings.keys.includes(Hs)&&(await this.sendRequest(Hs,"wc_pairingDelete",zt$1("USER_DISCONNECTED")),await this.deletePairing(Hs))}),d(this,"formatUriFromPairing",at=>{this.isInitialized();const{topic:Hs,relay:zs,expiry:Ys,methods:Zs}=at,$u=this.core.crypto.keychain.get(Hs);return $a({protocol:this.core.protocol,version:this.core.version,topic:Hs,symKey:$u,relay:zs,expiryTimestamp:Ys,methods:Zs})}),d(this,"sendRequest",async(at,Hs,zs)=>{const Ys=formatJsonRpcRequest(Hs,zs),Zs=await this.core.crypto.encode(at,Ys),$u=oe[Hs].req;return this.core.history.set(at,Ys),this.core.relayer.publish(at,Zs,$u),Ys.id}),d(this,"sendResult",async(at,Hs,zs)=>{const Ys=formatJsonRpcResult(at,zs),Zs=await this.core.crypto.encode(Hs,Ys),$u=(await this.core.history.get(Hs,at)).request.method,Eu=oe[$u].res;await this.core.relayer.publish(Hs,Zs,Eu),await this.core.history.resolve(Ys)}),d(this,"sendError",async(at,Hs,zs)=>{const Ys=formatJsonRpcError(at,zs),Zs=await this.core.crypto.encode(Hs,Ys),$u=(await this.core.history.get(Hs,at)).request.method,Eu=oe[$u]?oe[$u].res:oe.unregistered_method.res;await this.core.relayer.publish(Hs,Zs,Eu),await this.core.history.resolve(Ys)}),d(this,"deletePairing",async(at,Hs)=>{await this.core.relayer.unsubscribe(at),await Promise.all([this.pairings.delete(at,zt$1("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(at),Hs?Promise.resolve():this.core.expirer.del(at)])}),d(this,"cleanup",async()=>{const at=this.pairings.getAll().filter(Hs=>Ui$1(Hs.expiry));await Promise.all(at.map(Hs=>this.deletePairing(Hs.topic)))}),d(this,"onRelayEventRequest",async at=>{const{topic:Hs,payload:zs}=at;switch(zs.method){case"wc_pairingPing":return await this.onPairingPingRequest(Hs,zs);case"wc_pairingDelete":return await this.onPairingDeleteRequest(Hs,zs);default:return await this.onUnknownRpcMethodRequest(Hs,zs)}}),d(this,"onRelayEventResponse",async at=>{const{topic:Hs,payload:zs}=at,Ys=(await this.core.history.get(Hs,zs.id)).request.method;switch(Ys){case"wc_pairingPing":return this.onPairingPingResponse(Hs,zs);default:return this.onUnknownRpcMethodResponse(Ys)}}),d(this,"onPairingPingRequest",async(at,Hs)=>{const{id:zs}=Hs;try{this.isValidPing({topic:at}),await this.sendResult(zs,at,!0),this.events.emit(ae.ping,{id:zs,topic:at})}catch(Ys){await this.sendError(zs,at,Ys),this.logger.error(Ys)}}),d(this,"onPairingPingResponse",(at,Hs)=>{const{id:zs}=Hs;setTimeout(()=>{isJsonRpcResult(Hs)?this.events.emit(_i$1("pairing_ping",zs),{}):isJsonRpcError(Hs)&&this.events.emit(_i$1("pairing_ping",zs),{error:Hs.error})},500)}),d(this,"onPairingDeleteRequest",async(at,Hs)=>{const{id:zs}=Hs;try{this.isValidDisconnect({topic:at}),await this.deletePairing(at),this.events.emit(ae.delete,{id:zs,topic:at})}catch(Ys){await this.sendError(zs,at,Ys),this.logger.error(Ys)}}),d(this,"onUnknownRpcMethodRequest",async(at,Hs)=>{const{id:zs,method:Ys}=Hs;try{if(this.registeredMethods.includes(Ys))return;const Zs=zt$1("WC_METHOD_UNSUPPORTED",Ys);await this.sendError(zs,at,Zs),this.logger.error(Zs)}catch(Zs){await this.sendError(zs,at,Zs),this.logger.error(Zs)}}),d(this,"onUnknownRpcMethodResponse",at=>{this.registeredMethods.includes(at)||this.logger.error(zt$1("WC_METHOD_UNSUPPORTED",at))}),d(this,"isValidPair",(at,Hs)=>{var zs;if(!Qa(at)){const{message:Zs}=Bt$1("MISSING_OR_INVALID",`pair() params: ${at}`);throw Hs.setError(X.malformed_pairing_uri),new Error(Zs)}if(!Za(at.uri)){const{message:Zs}=Bt$1("MISSING_OR_INVALID",`pair() uri: ${at.uri}`);throw Hs.setError(X.malformed_pairing_uri),new Error(Zs)}const Ys=Ra(at==null?void 0:at.uri);if(!((zs=Ys==null?void 0:Ys.relay)!=null&&zs.protocol)){const{message:Zs}=Bt$1("MISSING_OR_INVALID","pair() uri#relay-protocol");throw Hs.setError(X.malformed_pairing_uri),new Error(Zs)}if(!(Ys!=null&&Ys.symKey)){const{message:Zs}=Bt$1("MISSING_OR_INVALID","pair() uri#symKey");throw Hs.setError(X.malformed_pairing_uri),new Error(Zs)}if(Ys!=null&&Ys.expiryTimestamp&&cjs$3.toMiliseconds(Ys==null?void 0:Ys.expiryTimestamp)<Date.now()){Hs.setError(X.pairing_expired);const{message:Zs}=Bt$1("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(Zs)}}),d(this,"isValidPing",async at=>{if(!Qa(at)){const{message:zs}=Bt$1("MISSING_OR_INVALID",`ping() params: ${at}`);throw new Error(zs)}const{topic:Hs}=at;await this.isValidPairingTopic(Hs)}),d(this,"isValidDisconnect",async at=>{if(!Qa(at)){const{message:zs}=Bt$1("MISSING_OR_INVALID",`disconnect() params: ${at}`);throw new Error(zs)}const{topic:Hs}=at;await this.isValidPairingTopic(Hs)}),d(this,"isValidPairingTopic",async at=>{if(!ft$1(at,!1)){const{message:Hs}=Bt$1("MISSING_OR_INVALID",`pairing topic should be a string: ${at}`);throw new Error(Hs)}if(!this.pairings.keys.includes(at)){const{message:Hs}=Bt$1("NO_MATCHING_KEY",`pairing topic doesn't exist: ${at}`);throw new Error(Hs)}if(Ui$1(this.pairings.get(at).expiry)){await this.deletePairing(at);const{message:Hs}=Bt$1("EXPIRED",`pairing topic: ${at}`);throw new Error(Hs)}}),this.core=t,this.logger=X$2(Z,this.name),this.pairings=new ji(this.core,this.logger,this.name,this.storagePrefix)}get context(){return w$1(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(C.message,async t=>{const{topic:Z,message:at,transportType:Hs}=t;if(this.pairings.keys.includes(Z)&&Hs!==ee.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(at)))try{const zs=await this.core.crypto.decode(Z,at);isJsonRpcRequest(zs)?(this.core.history.set(Z,zs),await this.onRelayEventRequest({topic:Z,payload:zs})):isJsonRpcResponse(zs)&&(await this.core.history.resolve(zs),await this.onRelayEventResponse({topic:Z,payload:zs}),this.core.history.delete(Z,zs.id)),await this.core.relayer.messages.ack(Z,at)}catch(zs){this.logger.error(zs)}})}registerExpirerEvents(){this.core.expirer.on(q.expired,async t=>{const{topic:Z}=Oi$1(t.target);Z&&this.pairings.keys.includes(Z)&&(await this.deletePairing(Z,!0),this.events.emit(ae.expire,{topic:Z}))})}}var Mo=Object.defineProperty,Ko=(F,t,Z)=>t in F?Mo(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,N=(F,t,Z)=>Ko(F,typeof t!="symbol"?t+"":t,Z);class Fi extends I{constructor(t,Z){super(t,Z),this.core=t,this.logger=Z,N(this,"records",new Map),N(this,"events",new eventsExports.EventEmitter),N(this,"name",Vt),N(this,"version",qt),N(this,"cached",[]),N(this,"initialized",!1),N(this,"storagePrefix",W$1),N(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(at=>this.records.set(at.id,at)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),N(this,"set",(at,Hs,zs)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:at,request:Hs,chainId:zs}),this.records.has(Hs.id))return;const Ys={id:Hs.id,topic:at,request:{method:Hs.method,params:Hs.params||null},chainId:zs,expiry:Ni$1(cjs$3.THIRTY_DAYS)};this.records.set(Ys.id,Ys),this.persist(),this.events.emit(V.created,Ys)}),N(this,"resolve",async at=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:at}),!this.records.has(at.id))return;const Hs=await this.getRecord(at.id);typeof Hs.response>"u"&&(Hs.response=isJsonRpcError(at)?{error:at.error}:{result:at.result},this.records.set(Hs.id,Hs),this.persist(),this.events.emit(V.updated,Hs))}),N(this,"get",async(at,Hs)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:at,id:Hs}),await this.getRecord(Hs))),N(this,"delete",(at,Hs)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:Hs}),this.values.forEach(zs=>{if(zs.topic===at){if(typeof Hs<"u"&&zs.id!==Hs)return;this.records.delete(zs.id),this.events.emit(V.deleted,zs)}}),this.persist()}),N(this,"exists",async(at,Hs)=>(this.isInitialized(),this.records.has(Hs)?(await this.getRecord(Hs)).topic===at:!1)),N(this,"on",(at,Hs)=>{this.events.on(at,Hs)}),N(this,"once",(at,Hs)=>{this.events.once(at,Hs)}),N(this,"off",(at,Hs)=>{this.events.off(at,Hs)}),N(this,"removeListener",(at,Hs)=>{this.events.removeListener(at,Hs)}),this.logger=X$2(Z,this.name)}get context(){return w$1(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(Z=>{if(typeof Z.response<"u")return;const at={topic:Z.topic,request:formatJsonRpcRequest(Z.request.method,Z.request.params,Z.id),chainId:Z.chainId};return t.push(at)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const Z=this.records.get(t);if(!Z){const{message:at}=Bt$1("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(at)}return Z}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(V.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:Z}=Bt$1("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(Z),new Error(Z)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(V.created,t=>{const Z=V.created;this.logger.info(`Emitting ${Z}`),this.logger.debug({type:"event",event:Z,record:t})}),this.events.on(V.updated,t=>{const Z=V.updated;this.logger.info(`Emitting ${Z}`),this.logger.debug({type:"event",event:Z,record:t})}),this.events.on(V.deleted,t=>{const Z=V.deleted;this.logger.info(`Emitting ${Z}`),this.logger.debug({type:"event",event:Z,record:t})}),this.core.heartbeat.on(r$1.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(Z=>{cjs$3.toMiliseconds(Z.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${Z.id}`),this.records.delete(Z.id),this.events.emit(V.deleted,Z,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Bo=Object.defineProperty,Vo=(F,t,Z)=>t in F?Bo(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,z=(F,t,Z)=>Vo(F,typeof t!="symbol"?t+"":t,Z);class Mi extends S$1{constructor(t,Z){super(t,Z),this.core=t,this.logger=Z,z(this,"expirations",new Map),z(this,"events",new eventsExports.EventEmitter),z(this,"name",Gt),z(this,"version",Wt),z(this,"cached",[]),z(this,"initialized",!1),z(this,"storagePrefix",W$1),z(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(at=>this.expirations.set(at.target,at)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),z(this,"has",at=>{try{const Hs=this.formatTarget(at);return typeof this.getExpiration(Hs)<"u"}catch{return!1}}),z(this,"set",(at,Hs)=>{this.isInitialized();const zs=this.formatTarget(at),Ys={target:zs,expiry:Hs};this.expirations.set(zs,Ys),this.checkExpiry(zs,Ys),this.events.emit(q.created,{target:zs,expiration:Ys})}),z(this,"get",at=>{this.isInitialized();const Hs=this.formatTarget(at);return this.getExpiration(Hs)}),z(this,"del",at=>{if(this.isInitialized(),this.has(at)){const Hs=this.formatTarget(at),zs=this.getExpiration(Hs);this.expirations.delete(Hs),this.events.emit(q.deleted,{target:Hs,expiration:zs})}}),z(this,"on",(at,Hs)=>{this.events.on(at,Hs)}),z(this,"once",(at,Hs)=>{this.events.once(at,Hs)}),z(this,"off",(at,Hs)=>{this.events.off(at,Hs)}),z(this,"removeListener",(at,Hs)=>{this.events.removeListener(at,Hs)}),this.logger=X$2(Z,this.name)}get context(){return w$1(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Ii$1(t);if(typeof t=="number")return Si$1(t);const{message:Z}=Bt$1("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(Z)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(q.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:Z}=Bt$1("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(Z),new Error(Z)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const Z=this.expirations.get(t);if(!Z){const{message:at}=Bt$1("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(at),new Error(at)}return Z}checkExpiry(t,Z){const{expiry:at}=Z;cjs$3.toMiliseconds(at)-Date.now()<=0&&this.expire(t,Z)}expire(t,Z){this.expirations.delete(t),this.events.emit(q.expired,{target:t,expiration:Z})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,Z)=>this.checkExpiry(Z,t))}registerEventListeners(){this.core.heartbeat.on(r$1.pulse,()=>this.checkExpirations()),this.events.on(q.created,t=>{const Z=q.created;this.logger.info(`Emitting ${Z}`),this.logger.debug({type:"event",event:Z,data:t}),this.persist()}),this.events.on(q.expired,t=>{const Z=q.expired;this.logger.info(`Emitting ${Z}`),this.logger.debug({type:"event",event:Z,data:t}),this.persist()}),this.events.on(q.deleted,t=>{const Z=q.deleted;this.logger.info(`Emitting ${Z}`),this.logger.debug({type:"event",event:Z,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}}var qo=Object.defineProperty,Go=(F,t,Z)=>t in F?qo(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,P$1=(F,t,Z)=>Go(F,typeof t!="symbol"?t+"":t,Z);class Ki extends M$2{constructor(t,Z,at){super(t,Z,at),this.core=t,this.logger=Z,this.store=at,P$1(this,"name",Ht),P$1(this,"abortController"),P$1(this,"isDevEnv"),P$1(this,"verifyUrlV3",Jt),P$1(this,"storagePrefix",W$1),P$1(this,"version",Fe),P$1(this,"publicKey"),P$1(this,"fetchPromise"),P$1(this,"init",async()=>{var Hs;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&cjs$3.toMiliseconds((Hs=this.publicKey)==null?void 0:Hs.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),P$1(this,"register",async Hs=>{if(!Wt$1()||this.isDevEnv)return;const zs=window.location.origin,{id:Ys,decryptedId:Zs}=Hs,$u=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${zs}&id=${Ys}&decryptedId=${Zs}`;try{const Eu=getDocument_1(),Au=this.startAbortTimer(cjs$3.ONE_SECOND*5),vu=await new Promise((Iu,_u)=>{const Su=()=>{window.removeEventListener("message",Du),Eu.body.removeChild(Bu),_u("attestation aborted")};this.abortController.signal.addEventListener("abort",Su);const Bu=Eu.createElement("iframe");Bu.src=$u,Bu.style.display="none",Bu.addEventListener("error",Su,{signal:this.abortController.signal});const Du=Tu=>{if(Tu.data&&typeof Tu.data=="string")try{const Pu=JSON.parse(Tu.data);if(Pu.type==="verify_attestation"){if(sn$2(Pu.attestation).payload.id!==Ys)return;clearInterval(Au),Eu.body.removeChild(Bu),this.abortController.signal.removeEventListener("abort",Su),window.removeEventListener("message",Du),Iu(Pu.attestation===null?"":Pu.attestation)}}catch(Pu){this.logger.warn(Pu)}};Eu.body.appendChild(Bu),window.addEventListener("message",Du,{signal:this.abortController.signal})});return this.logger.debug(vu,"jwt attestation"),vu}catch(Eu){this.logger.warn(Eu)}return""}),P$1(this,"resolve",async Hs=>{if(this.isDevEnv)return"";const{attestationId:zs,hash:Ys,encryptedId:Zs}=Hs;if(zs===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(zs){if(sn$2(zs).payload.id!==Zs)return;const Eu=await this.isValidJwtAttestation(zs);if(Eu){if(!Eu.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return Eu}}if(!Ys)return;const $u=this.getVerifyUrl(Hs==null?void 0:Hs.verifyUrl);return this.fetchAttestation(Ys,$u)}),P$1(this,"fetchAttestation",async(Hs,zs)=>{this.logger.debug(`resolving attestation: ${Hs} from url: ${zs}`);const Ys=this.startAbortTimer(cjs$3.ONE_SECOND*5),Zs=await fetch(`${zs}/attestation/${Hs}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(Ys),Zs.status===200?await Zs.json():void 0}),P$1(this,"getVerifyUrl",Hs=>{let zs=Hs||be;return Xt.includes(zs)||(this.logger.info(`verify url: ${zs}, not included in trusted list, assigning default: ${be}`),zs=be),zs}),P$1(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const Hs=this.startAbortTimer(cjs$3.FIVE_SECONDS),zs=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(Hs),await zs.json()}catch(Hs){this.logger.warn(Hs)}}),P$1(this,"persistPublicKey",async Hs=>{this.logger.debug(Hs,"persisting public key to local storage"),await this.store.setItem(this.storeKey,Hs),this.publicKey=Hs}),P$1(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),P$1(this,"isValidJwtAttestation",async Hs=>{const zs=await this.getPublicKey();try{if(zs)return this.validateAttestation(Hs,zs)}catch(Zs){this.logger.error(Zs),this.logger.warn("error validating attestation")}const Ys=await this.fetchAndPersistPublicKey();try{if(Ys)return this.validateAttestation(Hs,Ys)}catch(Zs){this.logger.error(Zs),this.logger.warn("error validating attestation")}}),P$1(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),P$1(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async zs=>{const Ys=await this.fetchPublicKey();Ys&&(await this.persistPublicKey(Ys),zs(Ys))});const Hs=await this.fetchPromise;return this.fetchPromise=void 0,Hs}),P$1(this,"validateAttestation",(Hs,zs)=>{const Ys=Ea(Hs,zs.publicKey),Zs={hasExpired:cjs$3.toMiliseconds(Ys.exp)<Date.now(),payload:Ys};if(Zs.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:Zs.payload.origin,isScam:Zs.payload.isScam,isVerified:Zs.payload.isVerified}}),this.logger=X$2(Z,this.name),this.abortController=new AbortController,this.isDevEnv=ji$1(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return w$1(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),cjs$3.toMiliseconds(t))}}var Wo=Object.defineProperty,Ho=(F,t,Z)=>t in F?Wo(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,Bi=(F,t,Z)=>Ho(F,typeof t!="symbol"?t+"":t,Z);class Vi extends O$1{constructor(t,Z){super(t,Z),this.projectId=t,this.logger=Z,Bi(this,"context",Zt),Bi(this,"registerDeviceToken",async at=>{const{clientId:Hs,token:zs,notificationType:Ys,enableEncrypted:Zs=!1}=at,$u=`${Qt}/${this.projectId}/clients`;await fetch($u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:Hs,type:Ys,token:zs,always_raw:Zs})})}),this.logger=X$2(Z,this.context)}}var Yo=Object.defineProperty,qi=Object.getOwnPropertySymbols,Jo=Object.prototype.hasOwnProperty,Xo=Object.prototype.propertyIsEnumerable,et=(F,t,Z)=>t in F?Yo(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,_e$1=(F,t)=>{for(var Z in t||(t={}))Jo.call(t,Z)&&et(F,Z,t[Z]);if(qi)for(var Z of qi(t))Xo.call(t,Z)&&et(F,Z,t[Z]);return F},A=(F,t,Z)=>et(F,typeof t!="symbol"?t+"":t,Z);class Gi extends R$2{constructor(t,Z,at=!0){super(t,Z,at),this.core=t,this.logger=Z,A(this,"context",ti),A(this,"storagePrefix",W$1),A(this,"storageVersion",ei),A(this,"events",new Map),A(this,"shouldPersist",!1),A(this,"init",async()=>{if(!ji$1())try{const Hs={eventId:Ci$1(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:wr$1(this.core.relayer.protocol,this.core.relayer.version,Pe)}}};await this.sendEvent([Hs])}catch(Hs){this.logger.warn(Hs)}}),A(this,"createEvent",Hs=>{const{event:zs="ERROR",type:Ys="",properties:{topic:Zs,trace:$u}}=Hs,Eu=Ci$1(),Au=this.core.projectId||"",vu=Date.now(),Iu=_e$1({eventId:Eu,timestamp:vu,props:{event:zs,type:Ys,properties:{topic:Zs,trace:$u}},bundleId:Au,domain:this.getAppDomain()},this.setMethods(Eu));return this.telemetryEnabled&&(this.events.set(Eu,Iu),this.shouldPersist=!0),Iu}),A(this,"getEvent",Hs=>{const{eventId:zs,topic:Ys}=Hs;if(zs)return this.events.get(zs);const Zs=Array.from(this.events.values()).find($u=>$u.props.properties.topic===Ys);if(Zs)return _e$1(_e$1({},Zs),this.setMethods(Zs.eventId))}),A(this,"deleteEvent",Hs=>{const{eventId:zs}=Hs;this.events.delete(zs),this.shouldPersist=!0}),A(this,"setEventListeners",()=>{this.core.heartbeat.on(r$1.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(Hs=>{cjs$3.fromMiliseconds(Date.now())-cjs$3.fromMiliseconds(Hs.timestamp)>ii&&(this.events.delete(Hs.eventId),this.shouldPersist=!0)})})}),A(this,"setMethods",Hs=>({addTrace:zs=>this.addTrace(Hs,zs),setError:zs=>this.setError(Hs,zs)})),A(this,"addTrace",(Hs,zs)=>{const Ys=this.events.get(Hs);Ys&&(Ys.props.properties.trace.push(zs),this.events.set(Hs,Ys),this.shouldPersist=!0)}),A(this,"setError",(Hs,zs)=>{const Ys=this.events.get(Hs);Ys&&(Ys.props.type=zs,Ys.timestamp=Date.now(),this.events.set(Hs,Ys),this.shouldPersist=!0)}),A(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),A(this,"restore",async()=>{try{const Hs=await this.core.storage.getItem(this.storageKey)||[];if(!Hs.length)return;Hs.forEach(zs=>{this.events.set(zs.eventId,_e$1(_e$1({},zs),this.setMethods(zs.eventId)))})}catch(Hs){this.logger.warn(Hs)}}),A(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const Hs=[];for(const[zs,Ys]of this.events)Ys.props.type&&Hs.push(Ys);if(Hs.length!==0)try{if((await this.sendEvent(Hs)).ok)for(const zs of Hs)this.events.delete(zs.eventId),this.shouldPersist=!0}catch(zs){this.logger.warn(zs)}}),A(this,"sendEvent",async Hs=>{const zs=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${si}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Pe}${zs}`,{method:"POST",body:JSON.stringify(Hs)})}),A(this,"getAppDomain",()=>br$1().url),this.logger=X$2(Z,this.context),this.telemetryEnabled=at,at?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Zo=Object.defineProperty,Wi=Object.getOwnPropertySymbols,Qo=Object.prototype.hasOwnProperty,ea=Object.prototype.propertyIsEnumerable,tt=(F,t,Z)=>t in F?Zo(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,Hi=(F,t)=>{for(var Z in t||(t={}))Qo.call(t,Z)&&tt(F,Z,t[Z]);if(Wi)for(var Z of Wi(t))ea.call(t,Z)&&tt(F,Z,t[Z]);return F},v$1=(F,t,Z)=>tt(F,typeof t!="symbol"?t+"":t,Z);class Oe extends h$1{constructor(t){var Z;super(t),v$1(this,"protocol",Ue),v$1(this,"version",Fe),v$1(this,"name",ge),v$1(this,"relayUrl"),v$1(this,"projectId"),v$1(this,"customStoragePrefix"),v$1(this,"events",new eventsExports.EventEmitter),v$1(this,"logger"),v$1(this,"heartbeat"),v$1(this,"relayer"),v$1(this,"crypto"),v$1(this,"storage"),v$1(this,"history"),v$1(this,"expirer"),v$1(this,"pairing"),v$1(this,"verify"),v$1(this,"echoClient"),v$1(this,"linkModeSupportedApps"),v$1(this,"eventClient"),v$1(this,"initialized",!1),v$1(this,"logChunkController"),v$1(this,"on",(Zs,$u)=>this.events.on(Zs,$u)),v$1(this,"once",(Zs,$u)=>this.events.once(Zs,$u)),v$1(this,"off",(Zs,$u)=>this.events.off(Zs,$u)),v$1(this,"removeListener",(Zs,$u)=>this.events.removeListener(Zs,$u)),v$1(this,"dispatchEnvelope",({topic:Zs,message:$u,sessionExists:Eu})=>{if(!Zs||!$u)return;const Au={topic:Zs,message:$u,publishedAt:Date.now(),transportType:ee.link_mode};this.relayer.onLinkMessageEvent(Au,{sessionExists:Eu})});const at=this.getGlobalCore(t==null?void 0:t.customStoragePrefix);if(at)try{return this.customStoragePrefix=at.customStoragePrefix,this.logger=at.logger,this.heartbeat=at.heartbeat,this.crypto=at.crypto,this.history=at.history,this.expirer=at.expirer,this.storage=at.storage,this.relayer=at.relayer,this.pairing=at.pairing,this.verify=at.verify,this.echoClient=at.echoClient,this.linkModeSupportedApps=at.linkModeSupportedApps,this.eventClient=at.eventClient,this.initialized=at.initialized,this.logChunkController=at.logChunkController,at}catch(Zs){console.warn("Failed to copy global core",Zs)}this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Ke$1,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const Hs=D({level:typeof(t==null?void 0:t.logger)=="string"&&t.logger?t.logger:Et$1.logger,name:ge}),{logger:zs,chunkLoggerController:Ys}=Y$1({opts:Hs,maxSizeInBytes:t==null?void 0:t.maxLogBlobSizeInBytes,loggerOverride:t==null?void 0:t.logger});this.logChunkController=Ys,(Z=this.logChunkController)!=null&&Z.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var Zs,$u;(Zs=this.logChunkController)!=null&&Zs.downloadLogsBlobInBrowser&&(($u=this.logChunkController)==null||$u.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=X$2(zs,this.name),this.heartbeat=new i$2,this.crypto=new wi(this,this.logger,t==null?void 0:t.keychain),this.history=new Fi(this,this.logger),this.expirer=new Mi(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new h$3(Hi(Hi({},It$1),t==null?void 0:t.storageOptions)),this.relayer=new Ai({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Ui(this,this.logger),this.verify=new Ki(this,this.logger,this.storage),this.echoClient=new Vi(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Gi(this,this.logger,t==null?void 0:t.telemetryEnabled),this.setGlobalCore(this)}static async init(t){const Z=new Oe(t);await Z.initialize();const at=await Z.crypto.getClientId();return await Z.storage.setItem(Ut,at),Z}get context(){return w$1(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(t){this.linkModeSupportedApps.includes(t)||(this.linkModeSupportedApps.push(t),await this.storage.setItem(Be,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Be)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(t,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(t.message),t}}getGlobalCore(t=""){try{if(this.isGlobalCoreDisabled())return;const Z=`_walletConnectCore_${t}`,at=`${Z}_count`;return globalThis[at]=(globalThis[at]||0)+1,globalThis[at]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[at]} times.`),globalThis[Z]}catch(Z){console.warn("Failed to get global WalletConnect core",Z);return}}setGlobalCore(t){var Z;try{if(this.isGlobalCoreDisabled())return;const at=`_walletConnectCore_${((Z=t.opts)==null?void 0:Z.customStoragePrefix)||""}`;globalThis[at]=t}catch(at){console.warn("Failed to set global WalletConnect core",at)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&{}.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}}const ta=Oe,Ve="wc",ke=2,De="client",we=`${Ve}@${ke}:${De}:`,me={name:De,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},Ss={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire",session_authenticate:"session_authenticate",session_request_expire:"session_request_expire",session_connect:"session_connect"},Rs={database:":memory:"},Le="WALLETCONNECT_DEEPLINK_CHOICE",vs={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Is="history",Ts="0.3",dt="proposal",qs=cjs$3.THIRTY_DAYS,Me="Proposal expired",ut="session",W=cjs$3.SEVEN_DAYS,gt="engine",P={wc_sessionPropose:{req:{ttl:cjs$3.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:cjs$3.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:cjs$3.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:cjs$3.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:cjs$3.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:cjs$3.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1104},res:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1106},res:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:cjs$3.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:cjs$3.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:cjs$3.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:cjs$3.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1112},res:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1114},res:{ttl:cjs$3.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:cjs$3.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:cjs$3.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:cjs$3.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:cjs$3.FIVE_MINUTES,prompt:!1,tag:1119}}},_e={min:cjs$3.FIVE_MINUTES,max:cjs$3.SEVEN_DAYS},$={idle:"IDLE",active:"ACTIVE"},yt={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},wt="request",mt=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],_t="wc",Ps=1.5,ft="auth",Et="authKeys",St="pairingTopics",Rt="requests",le=`${_t}@${1.5}:${ft}:`,pe=`${le}:PUB_KEY`;var Ns=Object.defineProperty,Os=Object.defineProperties,bs=Object.getOwnPropertyDescriptors,vt=Object.getOwnPropertySymbols,As=Object.prototype.hasOwnProperty,xs=Object.prototype.propertyIsEnumerable,$e=(F,t,Z)=>t in F?Ns(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,R=(F,t)=>{for(var Z in t||(t={}))As.call(t,Z)&&$e(F,Z,t[Z]);if(vt)for(var Z of vt(t))xs.call(t,Z)&&$e(F,Z,t[Z]);return F},O=(F,t)=>Os(F,bs(t)),c=(F,t,Z)=>$e(F,typeof t!="symbol"?t+"":t,Z);class Cs extends V$1{constructor(t){super(t),c(this,"name",gt),c(this,"events",new Nt$3),c(this,"initialized",!1),c(this,"requestQueue",{state:$.idle,queue:[]}),c(this,"sessionRequestQueue",{state:$.idle,queue:[]}),c(this,"emittedSessionRequests",new ki$1({limit:500})),c(this,"requestQueueDelay",cjs$3.ONE_SECOND),c(this,"expectedPairingMethodMap",new Map),c(this,"recentlyDeletedMap",new Map),c(this,"recentlyDeletedLimit",200),c(this,"relayMessageCache",[]),c(this,"pendingSessions",new Map),c(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(P)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},cjs$3.toMiliseconds(this.requestQueueDelay)))}),c(this,"connect",async Z=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const at=O(R({},Z),{requiredNamespaces:Z.requiredNamespaces||{},optionalNamespaces:Z.optionalNamespaces||{}});await this.isValidConnect(at),at.optionalNamespaces=qa(at.requiredNamespaces,at.optionalNamespaces),at.requiredNamespaces={};const{pairingTopic:Hs,requiredNamespaces:zs,optionalNamespaces:Ys,sessionProperties:Zs,scopedProperties:$u,relays:Eu}=at;let Au=Hs,vu,Iu=!1;try{if(Au){const qu=this.client.core.pairing.pairings.get(Au);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),Iu=qu.active}}catch(qu){throw this.client.logger.error(`connect() -> pairing.get(${Au}) failed`),qu}if(!Au||!Iu){const{topic:qu,uri:zu}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});Au=qu,vu=zu}if(!Au){const{message:qu}=Bt$1("NO_MATCHING_KEY",`connect() pairing topic: ${Au}`);throw new Error(qu)}const _u=await this.client.core.crypto.generateKeyPair(),Su=P.wc_sessionPropose.req.ttl||cjs$3.FIVE_MINUTES,Bu=Ni$1(Su),Du=O(R(R({requiredNamespaces:zs,optionalNamespaces:Ys,relays:Eu??[{protocol:Nt}],proposer:{publicKey:_u,metadata:this.client.metadata},expiryTimestamp:Bu,pairingTopic:Au},Zs&&{sessionProperties:Zs}),$u&&{scopedProperties:$u}),{id:payloadId()}),Tu=_i$1("session_connect",Du.id),{reject:Pu,resolve:Uu,done:Fu}=Bi$1(Su,Me),Lu=({id:qu})=>{qu===Du.id&&(this.client.events.off("proposal_expire",Lu),this.pendingSessions.delete(Du.id),this.events.emit(Tu,{error:{message:Me,code:0}}))};return this.client.events.on("proposal_expire",Lu),this.events.once(Tu,({error:qu,session:zu})=>{this.client.events.off("proposal_expire",Lu),qu?Pu(qu):zu&&Uu(zu)}),await this.sendProposeSession({proposal:Du,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:Du.id}}}),await this.setProposal(Du.id,Du),{uri:vu,approval:Fu}}),c(this,"pair",async Z=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(Z)}catch(at){throw this.client.logger.error("pair() failed"),at}}),c(this,"approve",async Z=>{var at,Hs,zs;const Ys=this.client.core.eventClient.createEvent({properties:{topic:(at=Z==null?void 0:Z.id)==null?void 0:at.toString(),trace:[rr.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(Wu){throw Ys.setError(nr.no_internet_connection),Wu}try{await this.isValidProposalId(Z==null?void 0:Z.id)}catch(Wu){throw this.client.logger.error(`approve() -> proposal.get(${Z==null?void 0:Z.id}) failed`),Ys.setError(nr.proposal_not_found),Wu}try{await this.isValidApprove(Z)}catch(Wu){throw this.client.logger.error("approve() -> isValidApprove() failed"),Ys.setError(nr.session_approve_namespace_validation_failure),Wu}const{id:Zs,relayProtocol:$u,namespaces:Eu,sessionProperties:Au,scopedProperties:vu,sessionConfig:Iu}=Z,_u=this.client.proposal.get(Zs);this.client.core.eventClient.deleteEvent({eventId:Ys.eventId});const{pairingTopic:Su,proposer:Bu,requiredNamespaces:Du,optionalNamespaces:Tu}=_u;let Pu=(Hs=this.client.core.eventClient)==null?void 0:Hs.getEvent({topic:Su});Pu||(Pu=(zs=this.client.core.eventClient)==null?void 0:zs.createEvent({type:rr.session_approve_started,properties:{topic:Su,trace:[rr.session_approve_started,rr.session_namespaces_validation_success]}}));const Uu=await this.client.core.crypto.generateKeyPair(),Fu=Bu.publicKey,Lu=await this.client.core.crypto.generateSharedKey(Uu,Fu),qu=R(R(R({relay:{protocol:$u??"irn"},namespaces:Eu,controller:{publicKey:Uu,metadata:this.client.metadata},expiry:Ni$1(W)},Au&&{sessionProperties:Au}),vu&&{scopedProperties:vu}),Iu&&{sessionConfig:Iu}),zu=ee.relay;Pu.addTrace(rr.subscribing_session_topic);try{await this.client.core.relayer.subscribe(Lu,{transportType:zu,internal:{skipSubscribe:!0}})}catch(Wu){throw Pu.setError(nr.subscribe_session_topic_failure),Wu}Pu.addTrace(rr.subscribe_session_topic_success);const tl=O(R({},qu),{topic:Lu,requiredNamespaces:Du,optionalNamespaces:Tu,pairingTopic:Su,acknowledged:!1,self:qu.controller,peer:{publicKey:Bu.publicKey,metadata:Bu.metadata},controller:Uu,transportType:ee.relay});await this.client.session.set(Lu,tl),Pu.addTrace(rr.store_session);try{await this.sendApproveSession({sessionTopic:Lu,proposal:_u,pairingProposalResponse:{relay:{protocol:$u??"irn"},responderPublicKey:Uu},sessionSettleRequest:qu,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:Zs}}}),Pu.addTrace(rr.session_approve_publish_success)}catch(Wu){throw this.client.logger.error(Wu),this.client.session.delete(Lu,zt$1("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(Lu),Wu}return this.client.core.eventClient.deleteEvent({eventId:Pu.eventId}),await this.client.core.pairing.updateMetadata({topic:Su,metadata:Bu.metadata}),await this.deleteProposal(Zs),await this.client.core.pairing.activate({topic:Su}),await this.setExpiry(Lu,Ni$1(W)),{topic:Lu,acknowledged:()=>Promise.resolve(this.client.session.get(Lu))}}),c(this,"reject",async Z=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(Z)}catch(Ys){throw this.client.logger.error("reject() -> isValidReject() failed"),Ys}const{id:at,reason:Hs}=Z;let zs;try{zs=this.client.proposal.get(at).pairingTopic}catch(Ys){throw this.client.logger.error(`reject() -> proposal.get(${at}) failed`),Ys}zs&&await this.sendError({id:at,topic:zs,error:Hs,rpcOpts:P.wc_sessionPropose.reject}),await this.deleteProposal(at)}),c(this,"update",async Z=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(Z)}catch(vu){throw this.client.logger.error("update() -> isValidUpdate() failed"),vu}const{topic:at,namespaces:Hs}=Z,{done:zs,resolve:Ys,reject:Zs}=Bi$1(),$u=payloadId(),Eu=getBigIntRpcId().toString(),Au=this.client.session.get(at).namespaces;return this.events.once(_i$1("session_update",$u),({error:vu})=>{vu?Zs(vu):Ys()}),await this.client.session.update(at,{namespaces:Hs}),await this.sendRequest({topic:at,method:"wc_sessionUpdate",params:{namespaces:Hs},throwOnFailedPublish:!0,clientRpcId:$u,relayRpcId:Eu}).catch(vu=>{this.client.logger.error(vu),this.client.session.update(at,{namespaces:Au}),Zs(vu)}),{acknowledged:zs}}),c(this,"extend",async Z=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(Z)}catch($u){throw this.client.logger.error("extend() -> isValidExtend() failed"),$u}const{topic:at}=Z,Hs=payloadId(),{done:zs,resolve:Ys,reject:Zs}=Bi$1();return this.events.once(_i$1("session_extend",Hs),({error:$u})=>{$u?Zs($u):Ys()}),await this.setExpiry(at,Ni$1(W)),this.sendRequest({topic:at,method:"wc_sessionExtend",params:{},clientRpcId:Hs,throwOnFailedPublish:!0}).catch($u=>{Zs($u)}),{acknowledged:zs}}),c(this,"request",async Z=>{this.isInitialized();try{await this.isValidRequest(Z)}catch(Du){throw this.client.logger.error("request() -> isValidRequest() failed"),Du}const{chainId:at,request:Hs,topic:zs,expiry:Ys=P.wc_sessionRequest.req.ttl}=Z,Zs=this.client.session.get(zs);(Zs==null?void 0:Zs.transportType)===ee.relay&&await this.confirmOnlineStateOrThrow();const $u=payloadId(),Eu=getBigIntRpcId().toString(),{done:Au,resolve:vu,reject:Iu}=Bi$1(Ys,"Request expired. Please try again.");this.events.once(_i$1("session_request",$u),({error:Du,result:Tu})=>{Du?Iu(Du):vu(Tu)});const _u="wc_sessionRequest",Su=this.getAppLinkIfEnabled(Zs.peer.metadata,Zs.transportType);if(Su)return await this.sendRequest({clientRpcId:$u,relayRpcId:Eu,topic:zs,method:_u,params:{request:O(R({},Hs),{expiryTimestamp:Ni$1(Ys)}),chainId:at},expiry:Ys,throwOnFailedPublish:!0,appLink:Su}).catch(Du=>Iu(Du)),this.client.events.emit("session_request_sent",{topic:zs,request:Hs,chainId:at,id:$u}),await Au();const Bu={request:O(R({},Hs),{expiryTimestamp:Ni$1(Ys)}),chainId:at};return await Promise.all([new Promise(async Du=>{await this.sendRequest({clientRpcId:$u,relayRpcId:Eu,topic:zs,method:_u,params:Bu,expiry:Ys,throwOnFailedPublish:!0,tvf:this.getTVFParams($u,Bu)}).catch(Tu=>Iu(Tu)),this.client.events.emit("session_request_sent",{topic:zs,request:Hs,chainId:at,id:$u}),Du()}),new Promise(async Du=>{var Tu;if(!((Tu=Zs.sessionConfig)!=null&&Tu.disableDeepLink)){const Pu=await $i$1(this.client.core.storage,Le);await Ri$1({id:$u,topic:zs,wcDeepLink:Pu})}Du()}),Au()]).then(Du=>Du[2])}),c(this,"respond",async Z=>{var at,Hs;this.isInitialized();const zs=this.client.core.eventClient.createEvent({properties:{topic:(Z==null?void 0:Z.topic)||((Hs=(at=Z==null?void 0:Z.response)==null?void 0:at.id)==null?void 0:Hs.toString()),trace:[rr.session_request_response_started]}});try{await this.isValidRespond(Z)}catch(vu){throw zs.addTrace(vu==null?void 0:vu.message),zs.setError(nr.session_request_response_validation_failure),vu}zs.addTrace(rr.session_request_response_validation_success);const{topic:Ys,response:Zs}=Z,{id:$u}=Zs,Eu=this.client.session.get(Ys);Eu.transportType===ee.relay&&await this.confirmOnlineStateOrThrow();const Au=this.getAppLinkIfEnabled(Eu.peer.metadata,Eu.transportType);try{zs.addTrace(rr.session_request_response_publish_started),isJsonRpcResult(Zs)?await this.sendResult({id:$u,topic:Ys,result:Zs.result,throwOnFailedPublish:!0,appLink:Au}):isJsonRpcError(Zs)&&await this.sendError({id:$u,topic:Ys,error:Zs.error,appLink:Au}),this.cleanupAfterResponse(Z)}catch(vu){throw zs.addTrace(vu==null?void 0:vu.message),zs.setError(nr.session_request_response_publish_failure),vu}}),c(this,"ping",async Z=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(Z)}catch(Hs){throw this.client.logger.error("ping() -> isValidPing() failed"),Hs}const{topic:at}=Z;if(this.client.session.keys.includes(at)){const Hs=payloadId(),zs=getBigIntRpcId().toString(),{done:Ys,resolve:Zs,reject:$u}=Bi$1();this.events.once(_i$1("session_ping",Hs),({error:Eu})=>{Eu?$u(Eu):Zs()}),await Promise.all([this.sendRequest({topic:at,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:Hs,relayRpcId:zs}),Ys()])}else this.client.core.pairing.pairings.keys.includes(at)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:at}))}),c(this,"emit",async Z=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(Z);const{topic:at,event:Hs,chainId:zs}=Z,Ys=getBigIntRpcId().toString(),Zs=payloadId();await this.sendRequest({topic:at,method:"wc_sessionEvent",params:{event:Hs,chainId:zs},throwOnFailedPublish:!0,relayRpcId:Ys,clientRpcId:Zs})}),c(this,"disconnect",async Z=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(Z);const{topic:at}=Z;if(this.client.session.keys.includes(at))await this.sendRequest({topic:at,method:"wc_sessionDelete",params:zt$1("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:at,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(at))await this.client.core.pairing.disconnect({topic:at});else{const{message:Hs}=Bt$1("MISMATCHED_TOPIC",`Session or pairing topic not found: ${at}`);throw new Error(Hs)}}),c(this,"find",Z=>(this.isInitialized(),this.client.session.getAll().filter(at=>Fa(at,Z)))),c(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),c(this,"authenticate",async(Z,at)=>{var Hs;this.isInitialized(),this.isValidAuthenticate(Z);const zs=at&&this.client.core.linkModeSupportedApps.includes(at)&&((Hs=this.client.metadata.redirect)==null?void 0:Hs.linkMode),Ys=zs?ee.link_mode:ee.relay;Ys===ee.relay&&await this.confirmOnlineStateOrThrow();const{chains:Zs,statement:$u="",uri:Eu,domain:Au,nonce:vu,type:Iu,exp:_u,nbf:Su,methods:Bu=[],expiry:Du}=Z,Tu=[...Z.resources||[]],{topic:Pu,uri:Uu}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:Ys});this.client.logger.info({message:"Generated new pairing",pairing:{topic:Pu,uri:Uu}});const Fu=await this.client.core.crypto.generateKeyPair(),Lu=ha(Fu);if(await Promise.all([this.client.auth.authKeys.set(pe,{responseTopic:Lu,publicKey:Fu}),this.client.auth.pairingTopics.set(Lu,{topic:Lu,pairingTopic:Pu})]),await this.client.core.relayer.subscribe(Lu,{transportType:Ys}),this.client.logger.info(`sending request to new pairing topic: ${Pu}`),Bu.length>0){const{namespace:Xu}=Je$1(Zs[0]);let al=Kc(Xu,"request",Bu);je(Tu)&&(al=qc(al,Tu.pop())),Tu.push(al)}const qu=Du&&Du>P.wc_sessionAuthenticate.req.ttl?Du:P.wc_sessionAuthenticate.req.ttl,zu={authPayload:{type:Iu??"caip122",chains:Zs,statement:$u,aud:Eu,domain:Au,version:"1",nonce:vu,iat:new Date().toISOString(),exp:_u,nbf:Su,resources:Tu},requester:{publicKey:Fu,metadata:this.client.metadata},expiryTimestamp:Ni$1(qu)},tl={eip155:{chains:Zs,methods:[...new Set(["personal_sign",...Bu])],events:["chainChanged","accountsChanged"]}},Wu={requiredNamespaces:{},optionalNamespaces:tl,relays:[{protocol:"irn"}],pairingTopic:Pu,proposer:{publicKey:Fu,metadata:this.client.metadata},expiryTimestamp:Ni$1(P.wc_sessionPropose.req.ttl),id:payloadId()},{done:cl,resolve:wl,reject:hl}=Bi$1(qu,"Request expired"),Qu=payloadId(),rl=_i$1("session_connect",Wu.id),Hu=_i$1("session_request",Qu),ju=async({error:Xu,session:al})=>{this.events.off(Hu,Yu),Xu?hl(Xu):al&&wl({session:al})},Yu=async Xu=>{var al,pl,ml;if(await this.deletePendingAuthRequest(Qu,{message:"fulfilled",code:0}),Xu.error){const bl=zt$1("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return Xu.error.code===bl.code?void 0:(this.events.off(rl,ju),hl(Xu.error.message))}await this.deleteProposal(Wu.id),this.events.off(rl,ju);const{cacaos:Il,responder:dl}=Xu.result,vl=[],nl=[];for(const bl of Il){await Pc({cacao:bl,projectId:this.client.core.projectId})||(this.client.logger.error(bl,"Signature verification failed"),hl(zt$1("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Mu}=bl,Ru=je(Mu.resources),Ou=[to$1(Mu.iss)],Vu=bn$1(Mu.iss);if(Ru){const Gu=Fc(Ru),il=Zc(Ru);vl.push(...Gu),Ou.push(...il)}for(const Gu of Ou)nl.push(`${Gu}:${Vu}`)}const el=await this.client.core.crypto.generateSharedKey(Fu,dl.publicKey);let yl;vl.length>0&&(yl={topic:el,acknowledged:!0,self:{publicKey:Fu,metadata:this.client.metadata},peer:dl,controller:dl.publicKey,expiry:Ni$1(W),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:Pu,namespaces:Ka([...new Set(vl)],[...new Set(nl)]),transportType:Ys},await this.client.core.relayer.subscribe(el,{transportType:Ys}),await this.client.session.set(el,yl),Pu&&await this.client.core.pairing.updateMetadata({topic:Pu,metadata:dl.metadata}),yl=this.client.session.get(el)),(al=this.client.metadata.redirect)!=null&&al.linkMode&&(pl=dl.metadata.redirect)!=null&&pl.linkMode&&(ml=dl.metadata.redirect)!=null&&ml.universal&&at&&(this.client.core.addLinkModeSupportedApp(dl.metadata.redirect.universal),this.client.session.update(el,{transportType:ee.link_mode})),wl({auths:Il,session:yl})};this.events.once(rl,ju),this.events.once(Hu,Yu);let ul;try{if(zs){const Xu=formatJsonRpcRequest("wc_sessionAuthenticate",zu,Qu);this.client.core.history.set(Pu,Xu);const al=await this.client.core.crypto.encode("",Xu,{type:we$1,encoding:Ge$1});ul=Ta(at,Pu,al)}else await Promise.all([this.sendRequest({topic:Pu,method:"wc_sessionAuthenticate",params:zu,expiry:Z.expiry,throwOnFailedPublish:!0,clientRpcId:Qu}),this.sendRequest({topic:Pu,method:"wc_sessionPropose",params:Wu,expiry:P.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:Wu.id})])}catch(Xu){throw this.events.off(rl,ju),this.events.off(Hu,Yu),Xu}return await this.setProposal(Wu.id,Wu),await this.setAuthRequest(Qu,{request:O(R({},zu),{verifyContext:{}}),pairingTopic:Pu,transportType:Ys}),{uri:ul??Uu,response:cl}}),c(this,"approveSessionAuthenticate",async Z=>{const{id:at,auths:Hs}=Z,zs=this.client.core.eventClient.createEvent({properties:{topic:at.toString(),trace:[or.authenticated_session_approve_started]}});try{this.isInitialized()}catch(Du){throw zs.setError(ar.no_internet_connection),Du}const Ys=this.getPendingAuthRequest(at);if(!Ys)throw zs.setError(ar.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${at}`);const Zs=Ys.transportType||ee.relay;Zs===ee.relay&&await this.confirmOnlineStateOrThrow();const $u=Ys.requester.publicKey,Eu=await this.client.core.crypto.generateKeyPair(),Au=ha($u),vu={type:ie,receiverPublicKey:$u,senderPublicKey:Eu},Iu=[],_u=[];for(const Du of Hs){if(!await Pc({cacao:Du,projectId:this.client.core.projectId})){zs.setError(ar.invalid_cacao);const Lu=zt$1("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:at,topic:Au,error:Lu,encodeOpts:vu}),new Error(Lu.message)}zs.addTrace(or.cacaos_verified);const{p:Tu}=Du,Pu=je(Tu.resources),Uu=[to$1(Tu.iss)],Fu=bn$1(Tu.iss);if(Pu){const Lu=Fc(Pu),qu=Zc(Pu);Iu.push(...Lu),Uu.push(...qu)}for(const Lu of Uu)_u.push(`${Lu}:${Fu}`)}const Su=await this.client.core.crypto.generateSharedKey(Eu,$u);zs.addTrace(or.create_authenticated_session_topic);let Bu;if((Iu==null?void 0:Iu.length)>0){Bu={topic:Su,acknowledged:!0,self:{publicKey:Eu,metadata:this.client.metadata},peer:{publicKey:$u,metadata:Ys.requester.metadata},controller:$u,expiry:Ni$1(W),authentication:Hs,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:Ys.pairingTopic,namespaces:Ka([...new Set(Iu)],[...new Set(_u)]),transportType:Zs},zs.addTrace(or.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(Su,{transportType:Zs})}catch(Du){throw zs.setError(ar.subscribe_authenticated_session_topic_failure),Du}zs.addTrace(or.subscribe_authenticated_session_topic_success),await this.client.session.set(Su,Bu),zs.addTrace(or.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:Ys.pairingTopic,metadata:Ys.requester.metadata})}zs.addTrace(or.publishing_authenticated_session_approve);try{await this.sendResult({topic:Au,id:at,result:{cacaos:Hs,responder:{publicKey:Eu,metadata:this.client.metadata}},encodeOpts:vu,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(Ys.requester.metadata,Zs)})}catch(Du){throw zs.setError(ar.authenticated_session_approve_publish_failure),Du}return await this.client.auth.requests.delete(at,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:Ys.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:zs.eventId}),{session:Bu}}),c(this,"rejectSessionAuthenticate",async Z=>{this.isInitialized();const{id:at,reason:Hs}=Z,zs=this.getPendingAuthRequest(at);if(!zs)throw new Error(`Could not find pending auth request with id ${at}`);zs.transportType===ee.relay&&await this.confirmOnlineStateOrThrow();const Ys=zs.requester.publicKey,Zs=await this.client.core.crypto.generateKeyPair(),$u=ha(Ys),Eu={type:ie,receiverPublicKey:Ys,senderPublicKey:Zs};await this.sendError({id:at,topic:$u,error:Hs,encodeOpts:Eu,rpcOpts:P.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(zs.requester.metadata,zs.transportType)}),await this.client.auth.requests.delete(at,{message:"rejected",code:0}),await this.deleteProposal(at)}),c(this,"formatAuthMessage",Z=>{this.isInitialized();const{request:at,iss:Hs}=Z;return eo$1(at,Hs)}),c(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const Z=this.relayMessageCache.shift();Z&&await this.onRelayMessage(Z)}catch(Z){this.client.logger.error(Z)}},50)}),c(this,"cleanupDuplicatePairings",async Z=>{if(Z.pairingTopic)try{const at=this.client.core.pairing.pairings.get(Z.pairingTopic),Hs=this.client.core.pairing.pairings.getAll().filter(zs=>{var Ys,Zs;return((Ys=zs.peerMetadata)==null?void 0:Ys.url)&&((Zs=zs.peerMetadata)==null?void 0:Zs.url)===Z.peer.metadata.url&&zs.topic&&zs.topic!==at.topic});if(Hs.length===0)return;this.client.logger.info(`Cleaning up ${Hs.length} duplicate pairing(s)`),await Promise.all(Hs.map(zs=>this.client.core.pairing.disconnect({topic:zs.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(at){this.client.logger.error(at)}}),c(this,"deleteSession",async Z=>{var at;const{topic:Hs,expirerHasDeleted:zs=!1,emitEvent:Ys=!0,id:Zs=0}=Z,{self:$u}=this.client.session.get(Hs);await this.client.core.relayer.unsubscribe(Hs),await this.client.session.delete(Hs,zt$1("USER_DISCONNECTED")),this.addToRecentlyDeleted(Hs,"session"),this.client.core.crypto.keychain.has($u.publicKey)&&await this.client.core.crypto.deleteKeyPair($u.publicKey),this.client.core.crypto.keychain.has(Hs)&&await this.client.core.crypto.deleteSymKey(Hs),zs||this.client.core.expirer.del(Hs),this.client.core.storage.removeItem(Le).catch(Eu=>this.client.logger.warn(Eu)),this.getPendingSessionRequests().forEach(Eu=>{Eu.topic===Hs&&this.deletePendingSessionRequest(Eu.id,zt$1("USER_DISCONNECTED"))}),Hs===((at=this.sessionRequestQueue.queue[0])==null?void 0:at.topic)&&(this.sessionRequestQueue.state=$.idle),Ys&&this.client.events.emit("session_delete",{id:Zs,topic:Hs})}),c(this,"deleteProposal",async(Z,at)=>{if(at)try{const Hs=this.client.proposal.get(Z),zs=this.client.core.eventClient.getEvent({topic:Hs.pairingTopic});zs==null||zs.setError(nr.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(Z,zt$1("USER_DISCONNECTED")),at?Promise.resolve():this.client.core.expirer.del(Z)]),this.addToRecentlyDeleted(Z,"proposal")}),c(this,"deletePendingSessionRequest",async(Z,at,Hs=!1)=>{await Promise.all([this.client.pendingRequest.delete(Z,at),Hs?Promise.resolve():this.client.core.expirer.del(Z)]),this.addToRecentlyDeleted(Z,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(zs=>zs.id!==Z),Hs&&(this.sessionRequestQueue.state=$.idle,this.client.events.emit("session_request_expire",{id:Z}))}),c(this,"deletePendingAuthRequest",async(Z,at,Hs=!1)=>{await Promise.all([this.client.auth.requests.delete(Z,at),Hs?Promise.resolve():this.client.core.expirer.del(Z)])}),c(this,"setExpiry",async(Z,at)=>{this.client.session.keys.includes(Z)&&(this.client.core.expirer.set(Z,at),await this.client.session.update(Z,{expiry:at}))}),c(this,"setProposal",async(Z,at)=>{this.client.core.expirer.set(Z,Ni$1(P.wc_sessionPropose.req.ttl)),await this.client.proposal.set(Z,at)}),c(this,"setAuthRequest",async(Z,at)=>{const{request:Hs,pairingTopic:zs,transportType:Ys=ee.relay}=at;this.client.core.expirer.set(Z,Hs.expiryTimestamp),await this.client.auth.requests.set(Z,{authPayload:Hs.authPayload,requester:Hs.requester,expiryTimestamp:Hs.expiryTimestamp,id:Z,pairingTopic:zs,verifyContext:Hs.verifyContext,transportType:Ys})}),c(this,"setPendingSessionRequest",async Z=>{const{id:at,topic:Hs,params:zs,verifyContext:Ys}=Z,Zs=zs.request.expiryTimestamp||Ni$1(P.wc_sessionRequest.req.ttl);this.client.core.expirer.set(at,Zs),await this.client.pendingRequest.set(at,{id:at,topic:Hs,params:zs,verifyContext:Ys})}),c(this,"sendRequest",async Z=>{const{topic:at,method:Hs,params:zs,expiry:Ys,relayRpcId:Zs,clientRpcId:$u,throwOnFailedPublish:Eu,appLink:Au,tvf:vu,publishOpts:Iu={}}=Z,_u=formatJsonRpcRequest(Hs,zs,$u);let Su;const Bu=!!Au;try{const Pu=Bu?Ge$1:oe$1;Su=await this.client.core.crypto.encode(at,_u,{encoding:Pu})}catch(Pu){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${at} failed`),Pu}let Du;if(mt.includes(Hs)){const Pu=pa(JSON.stringify(_u)),Uu=pa(Su);Du=await this.client.core.verify.register({id:Uu,decryptedId:Pu})}const Tu=R(R({},P[Hs].req),Iu);if(Tu.attestation=Du,Ys&&(Tu.ttl=Ys),Zs&&(Tu.id=Zs),this.client.core.history.set(at,_u),Bu){const Pu=Ta(Au,at,Su);await global.Linking.openURL(Pu,this.client.name)}else Tu.tvf=O(R({},vu),{correlationId:_u.id}),Eu?(Tu.internal=O(R({},Tu.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(at,Su,Tu)):this.client.core.relayer.publish(at,Su,Tu).catch(Pu=>this.client.logger.error(Pu));return _u.id}),c(this,"sendProposeSession",async Z=>{const{proposal:at,publishOpts:Hs}=Z,zs=formatJsonRpcRequest("wc_sessionPropose",at,at.id);this.client.core.history.set(at.pairingTopic,zs);const Ys=await this.client.core.crypto.encode(at.pairingTopic,zs,{encoding:oe$1}),Zs=pa(JSON.stringify(zs)),$u=pa(Ys),Eu=await this.client.core.verify.register({id:$u,decryptedId:Zs});await this.client.core.relayer.publishCustom({payload:{pairingTopic:at.pairingTopic,sessionProposal:Ys},opts:O(R({},Hs),{publishMethod:"wc_proposeSession",attestation:Eu})})}),c(this,"sendApproveSession",async Z=>{const{sessionTopic:at,pairingProposalResponse:Hs,proposal:zs,sessionSettleRequest:Ys,publishOpts:Zs}=Z,$u=formatJsonRpcResult(zs.id,Hs),Eu=await this.client.core.crypto.encode(zs.pairingTopic,$u,{encoding:oe$1}),Au=formatJsonRpcRequest("wc_sessionSettle",Ys,Zs==null?void 0:Zs.id),vu=await this.client.core.crypto.encode(at,Au,{encoding:oe$1});this.client.core.history.set(at,Au),await this.client.core.relayer.publishCustom({payload:{sessionTopic:at,pairingTopic:zs.pairingTopic,sessionProposalResponse:Eu,sessionSettlementRequest:vu},opts:O(R({},Zs),{publishMethod:"wc_approveSession"})})}),c(this,"sendResult",async Z=>{const{id:at,topic:Hs,result:zs,throwOnFailedPublish:Ys,encodeOpts:Zs,appLink:$u}=Z,Eu=formatJsonRpcResult(at,zs);let Au;const vu=$u&&typeof(global==null?void 0:global.Linking)<"u";try{const Su=vu?Ge$1:oe$1;Au=await this.client.core.crypto.encode(Hs,Eu,O(R({},Zs||{}),{encoding:Su}))}catch(Su){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${Hs} failed`),Su}let Iu,_u;try{Iu=await this.client.core.history.get(Hs,at);const Su=Iu.request;try{_u=this.getTVFParams(at,Su.params,zs)}catch(Bu){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${Bu==null?void 0:Bu.message}`)}}catch(Su){throw this.client.logger.error(`sendResult() -> history.get(${Hs}, ${at}) failed`),Su}if(vu){const Su=Ta($u,Hs,Au);await global.Linking.openURL(Su,this.client.name)}else{const Su=Iu.request.method,Bu=P[Su].res;Bu.tvf=O(R({},_u),{correlationId:at}),Ys?(Bu.internal=O(R({},Bu.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(Hs,Au,Bu)):this.client.core.relayer.publish(Hs,Au,Bu).catch(Du=>this.client.logger.error(Du))}await this.client.core.history.resolve(Eu)}),c(this,"sendError",async Z=>{const{id:at,topic:Hs,error:zs,encodeOpts:Ys,rpcOpts:Zs,appLink:$u}=Z,Eu=formatJsonRpcError(at,zs);let Au;const vu=$u&&typeof(global==null?void 0:global.Linking)<"u";try{const _u=vu?Ge$1:oe$1;Au=await this.client.core.crypto.encode(Hs,Eu,O(R({},Ys||{}),{encoding:_u}))}catch(_u){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${Hs} failed`),_u}let Iu;try{Iu=await this.client.core.history.get(Hs,at)}catch(_u){throw this.client.logger.error(`sendError() -> history.get(${Hs}, ${at}) failed`),_u}if(vu){const _u=Ta($u,Hs,Au);await global.Linking.openURL(_u,this.client.name)}else{const _u=Iu.request.method,Su=Zs||P[_u].res;this.client.core.relayer.publish(Hs,Au,Su)}await this.client.core.history.resolve(Eu)}),c(this,"cleanup",async()=>{const Z=[],at=[];this.client.session.getAll().forEach(Hs=>{let zs=!1;Ui$1(Hs.expiry)&&(zs=!0),this.client.core.crypto.keychain.has(Hs.topic)||(zs=!0),zs&&Z.push(Hs.topic)}),this.client.proposal.getAll().forEach(Hs=>{Ui$1(Hs.expiryTimestamp)&&at.push(Hs.id)}),await Promise.all([...Z.map(Hs=>this.deleteSession({topic:Hs})),...at.map(Hs=>this.deleteProposal(Hs))])}),c(this,"onProviderMessageEvent",async Z=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(Z):await this.onRelayMessage(Z)}),c(this,"onRelayEventRequest",async Z=>{this.requestQueue.queue.push(Z),await this.processRequestsQueue()}),c(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===$.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=$.active;const Z=this.requestQueue.queue.shift();if(Z)try{await this.processRequest(Z)}catch(at){this.client.logger.warn(at)}}this.requestQueue.state=$.idle}),c(this,"processRequest",async Z=>{const{topic:at,payload:Hs,attestation:zs,transportType:Ys,encryptedId:Zs}=Z,$u=Hs.method;if(!this.shouldIgnorePairingRequest({topic:at,requestMethod:$u}))switch($u){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:at,payload:Hs,attestation:zs,encryptedId:Zs});case"wc_sessionSettle":return await this.onSessionSettleRequest(at,Hs);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(at,Hs);case"wc_sessionExtend":return await this.onSessionExtendRequest(at,Hs);case"wc_sessionPing":return await this.onSessionPingRequest(at,Hs);case"wc_sessionDelete":return await this.onSessionDeleteRequest(at,Hs);case"wc_sessionRequest":return await this.onSessionRequest({topic:at,payload:Hs,attestation:zs,encryptedId:Zs,transportType:Ys});case"wc_sessionEvent":return await this.onSessionEventRequest(at,Hs);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:at,payload:Hs,attestation:zs,encryptedId:Zs,transportType:Ys});default:return this.client.logger.info(`Unsupported request method ${$u}`)}}),c(this,"onRelayEventResponse",async Z=>{const{topic:at,payload:Hs,transportType:zs}=Z,Ys=(await this.client.core.history.get(at,Hs.id)).request.method;switch(Ys){case"wc_sessionPropose":return this.onSessionProposeResponse(at,Hs,zs);case"wc_sessionSettle":return this.onSessionSettleResponse(at,Hs);case"wc_sessionUpdate":return this.onSessionUpdateResponse(at,Hs);case"wc_sessionExtend":return this.onSessionExtendResponse(at,Hs);case"wc_sessionPing":return this.onSessionPingResponse(at,Hs);case"wc_sessionRequest":return this.onSessionRequestResponse(at,Hs);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(at,Hs);default:return this.client.logger.info(`Unsupported response method ${Ys}`)}}),c(this,"onRelayEventUnknownPayload",Z=>{const{topic:at}=Z,{message:Hs}=Bt$1("MISSING_OR_INVALID",`Decoded payload on topic ${at} is not identifiable as a JSON-RPC request or a response.`);throw new Error(Hs)}),c(this,"shouldIgnorePairingRequest",Z=>{const{topic:at,requestMethod:Hs}=Z,zs=this.expectedPairingMethodMap.get(at);return!zs||zs.includes(Hs)?!1:!!(zs.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),c(this,"onSessionProposeRequest",async Z=>{const{topic:at,payload:Hs,attestation:zs,encryptedId:Ys}=Z,{params:Zs,id:$u}=Hs;try{const Eu=this.client.core.eventClient.getEvent({topic:at});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),Eu==null||Eu.setError(X.proposal_listener_not_found)),this.isValidConnect(R({},Hs.params));const Au=Zs.expiryTimestamp||Ni$1(P.wc_sessionPropose.req.ttl),vu=R({id:$u,pairingTopic:at,expiryTimestamp:Au,attestation:zs,encryptedId:Ys},Zs);await this.setProposal($u,vu);const Iu=await this.getVerifyContext({attestationId:zs,hash:pa(JSON.stringify(Hs)),encryptedId:Ys,metadata:vu.proposer.metadata});Eu==null||Eu.addTrace(Y.emit_session_proposal),this.client.events.emit("session_proposal",{id:$u,params:vu,verifyContext:Iu})}catch(Eu){await this.sendError({id:$u,topic:at,error:Eu,rpcOpts:P.wc_sessionPropose.autoReject}),this.client.logger.error(Eu)}}),c(this,"onSessionProposeResponse",async(Z,at,Hs)=>{const{id:zs}=at;if(isJsonRpcResult(at)){const{result:Ys}=at;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:Ys});const Zs=this.client.proposal.get(zs);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:Zs});const $u=Zs.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:$u});const Eu=Ys.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:Eu});const Au=await this.client.core.crypto.generateSharedKey($u,Eu);this.pendingSessions.set(zs,{sessionTopic:Au,pairingTopic:Z,proposalId:zs,publicKey:$u});const vu=await this.client.core.relayer.subscribe(Au,{transportType:Hs});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:vu}),await this.client.core.pairing.activate({topic:Z})}else if(isJsonRpcError(at)){await this.deleteProposal(zs);const Ys=_i$1("session_connect",zs);if(this.events.listenerCount(Ys)===0)throw new Error(`emitting ${Ys} without any listeners, 954`);this.events.emit(Ys,{error:at.error})}}),c(this,"onSessionSettleRequest",async(Z,at)=>{const{id:Hs,params:zs}=at;try{this.isValidSessionSettleRequest(zs);const{relay:Ys,controller:Zs,expiry:$u,namespaces:Eu,sessionProperties:Au,scopedProperties:vu,sessionConfig:Iu}=at.params,_u=[...this.pendingSessions.values()].find(Du=>Du.sessionTopic===Z);if(!_u)return this.client.logger.error(`Pending session not found for topic ${Z}`);const Su=this.client.proposal.get(_u.proposalId),Bu=O(R(R(R({topic:Z,relay:Ys,expiry:$u,namespaces:Eu,acknowledged:!0,pairingTopic:_u.pairingTopic,requiredNamespaces:Su.requiredNamespaces,optionalNamespaces:Su.optionalNamespaces,controller:Zs.publicKey,self:{publicKey:_u.publicKey,metadata:this.client.metadata},peer:{publicKey:Zs.publicKey,metadata:Zs.metadata}},Au&&{sessionProperties:Au}),vu&&{scopedProperties:vu}),Iu&&{sessionConfig:Iu}),{transportType:ee.relay});await this.client.session.set(Bu.topic,Bu),await this.setExpiry(Bu.topic,Bu.expiry),await this.client.core.pairing.updateMetadata({topic:_u.pairingTopic,metadata:Bu.peer.metadata}),this.client.events.emit("session_connect",{session:Bu}),this.events.emit(_i$1("session_connect",_u.proposalId),{session:Bu}),this.pendingSessions.delete(_u.proposalId),this.deleteProposal(_u.proposalId,!1),this.cleanupDuplicatePairings(Bu),await this.sendResult({id:at.id,topic:Z,result:!0})}catch(Ys){await this.sendError({id:Hs,topic:Z,error:Ys}),this.client.logger.error(Ys)}}),c(this,"onSessionSettleResponse",async(Z,at)=>{const{id:Hs}=at;isJsonRpcResult(at)?(await this.client.session.update(Z,{acknowledged:!0}),this.events.emit(_i$1("session_approve",Hs),{})):isJsonRpcError(at)&&(await this.client.session.delete(Z,zt$1("USER_DISCONNECTED")),this.events.emit(_i$1("session_approve",Hs),{error:at.error}))}),c(this,"onSessionUpdateRequest",async(Z,at)=>{const{params:Hs,id:zs}=at;try{const Ys=`${Z}_session_update`,Zs=hu.get(Ys);if(Zs&&this.isRequestOutOfSync(Zs,zs)){this.client.logger.warn(`Discarding out of sync request - ${zs}`),this.sendError({id:zs,topic:Z,error:zt$1("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(R({topic:Z},Hs));try{hu.set(Ys,zs),await this.client.session.update(Z,{namespaces:Hs.namespaces}),await this.sendResult({id:zs,topic:Z,result:!0})}catch($u){throw hu.delete(Ys),$u}this.client.events.emit("session_update",{id:zs,topic:Z,params:Hs})}catch(Ys){await this.sendError({id:zs,topic:Z,error:Ys}),this.client.logger.error(Ys)}}),c(this,"isRequestOutOfSync",(Z,at)=>at.toString().slice(0,-3)<Z.toString().slice(0,-3)),c(this,"onSessionUpdateResponse",(Z,at)=>{const{id:Hs}=at,zs=_i$1("session_update",Hs);if(this.events.listenerCount(zs)===0)throw new Error(`emitting ${zs} without any listeners`);isJsonRpcResult(at)?this.events.emit(_i$1("session_update",Hs),{}):isJsonRpcError(at)&&this.events.emit(_i$1("session_update",Hs),{error:at.error})}),c(this,"onSessionExtendRequest",async(Z,at)=>{const{id:Hs}=at;try{this.isValidExtend({topic:Z}),await this.setExpiry(Z,Ni$1(W)),await this.sendResult({id:Hs,topic:Z,result:!0}),this.client.events.emit("session_extend",{id:Hs,topic:Z})}catch(zs){await this.sendError({id:Hs,topic:Z,error:zs}),this.client.logger.error(zs)}}),c(this,"onSessionExtendResponse",(Z,at)=>{const{id:Hs}=at,zs=_i$1("session_extend",Hs);if(this.events.listenerCount(zs)===0)throw new Error(`emitting ${zs} without any listeners`);isJsonRpcResult(at)?this.events.emit(_i$1("session_extend",Hs),{}):isJsonRpcError(at)&&this.events.emit(_i$1("session_extend",Hs),{error:at.error})}),c(this,"onSessionPingRequest",async(Z,at)=>{const{id:Hs}=at;try{this.isValidPing({topic:Z}),await this.sendResult({id:Hs,topic:Z,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:Hs,topic:Z})}catch(zs){await this.sendError({id:Hs,topic:Z,error:zs}),this.client.logger.error(zs)}}),c(this,"onSessionPingResponse",(Z,at)=>{const{id:Hs}=at,zs=_i$1("session_ping",Hs);setTimeout(()=>{if(this.events.listenerCount(zs)===0)throw new Error(`emitting ${zs} without any listeners 2176`);isJsonRpcResult(at)?this.events.emit(_i$1("session_ping",Hs),{}):isJsonRpcError(at)&&this.events.emit(_i$1("session_ping",Hs),{error:at.error})},500)}),c(this,"onSessionDeleteRequest",async(Z,at)=>{const{id:Hs}=at;try{this.isValidDisconnect({topic:Z,reason:at.params}),await Promise.all([new Promise(zs=>{this.client.core.relayer.once(C.publish,async()=>{zs(await this.deleteSession({topic:Z,id:Hs}))})}),this.sendResult({id:Hs,topic:Z,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:Z,error:zt$1("USER_DISCONNECTED")})]).catch(zs=>this.client.logger.error(zs))}catch(zs){this.client.logger.error(zs)}}),c(this,"onSessionRequest",async Z=>{var at,Hs,zs;const{topic:Ys,payload:Zs,attestation:$u,encryptedId:Eu,transportType:Au}=Z,{id:vu,params:Iu}=Zs;try{await this.isValidRequest(R({topic:Ys},Iu));const _u=this.client.session.get(Ys),Su=await this.getVerifyContext({attestationId:$u,hash:pa(JSON.stringify(formatJsonRpcRequest("wc_sessionRequest",Iu,vu))),encryptedId:Eu,metadata:_u.peer.metadata,transportType:Au}),Bu={id:vu,topic:Ys,params:Iu,verifyContext:Su};await this.setPendingSessionRequest(Bu),Au===ee.link_mode&&(at=_u.peer.metadata.redirect)!=null&&at.universal&&this.client.core.addLinkModeSupportedApp((Hs=_u.peer.metadata.redirect)==null?void 0:Hs.universal),(zs=this.client.signConfig)!=null&&zs.disableRequestQueue?this.emitSessionRequest(Bu):(this.addSessionRequestToSessionRequestQueue(Bu),this.processSessionRequestQueue())}catch(_u){await this.sendError({id:vu,topic:Ys,error:_u}),this.client.logger.error(_u)}}),c(this,"onSessionRequestResponse",(Z,at)=>{const{id:Hs}=at,zs=_i$1("session_request",Hs);if(this.events.listenerCount(zs)===0)throw new Error(`emitting ${zs} without any listeners`);isJsonRpcResult(at)?this.events.emit(_i$1("session_request",Hs),{result:at.result}):isJsonRpcError(at)&&this.events.emit(_i$1("session_request",Hs),{error:at.error})}),c(this,"onSessionEventRequest",async(Z,at)=>{const{id:Hs,params:zs}=at;try{const Ys=`${Z}_session_event_${zs.event.name}`,Zs=hu.get(Ys);if(Zs&&this.isRequestOutOfSync(Zs,Hs)){this.client.logger.info(`Discarding out of sync request - ${Hs}`);return}this.isValidEmit(R({topic:Z},zs)),this.client.events.emit("session_event",{id:Hs,topic:Z,params:zs}),hu.set(Ys,Hs)}catch(Ys){await this.sendError({id:Hs,topic:Z,error:Ys}),this.client.logger.error(Ys)}}),c(this,"onSessionAuthenticateResponse",(Z,at)=>{const{id:Hs}=at;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:Z,payload:at}),isJsonRpcResult(at)?this.events.emit(_i$1("session_request",Hs),{result:at.result}):isJsonRpcError(at)&&this.events.emit(_i$1("session_request",Hs),{error:at.error})}),c(this,"onSessionAuthenticateRequest",async Z=>{var at;const{topic:Hs,payload:zs,attestation:Ys,encryptedId:Zs,transportType:$u}=Z;try{const{requester:Eu,authPayload:Au,expiryTimestamp:vu}=zs.params,Iu=await this.getVerifyContext({attestationId:Ys,hash:pa(JSON.stringify(zs)),encryptedId:Zs,metadata:Eu.metadata,transportType:$u}),_u={requester:Eu,pairingTopic:Hs,id:zs.id,authPayload:Au,verifyContext:Iu,expiryTimestamp:vu};await this.setAuthRequest(zs.id,{request:_u,pairingTopic:Hs,transportType:$u}),$u===ee.link_mode&&(at=Eu.metadata.redirect)!=null&&at.universal&&this.client.core.addLinkModeSupportedApp(Eu.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:Hs,params:zs.params,id:zs.id,verifyContext:Iu})}catch(Eu){this.client.logger.error(Eu);const Au=zs.params.requester.publicKey,vu=await this.client.core.crypto.generateKeyPair(),Iu=this.getAppLinkIfEnabled(zs.params.requester.metadata,$u),_u={type:ie,receiverPublicKey:Au,senderPublicKey:vu};await this.sendError({id:zs.id,topic:Hs,error:Eu,encodeOpts:_u,rpcOpts:P.wc_sessionAuthenticate.autoReject,appLink:Iu})}}),c(this,"addSessionRequestToSessionRequestQueue",Z=>{this.sessionRequestQueue.queue.push(Z)}),c(this,"cleanupAfterResponse",Z=>{this.deletePendingSessionRequest(Z.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=$.idle,this.processSessionRequestQueue()},cjs$3.toMiliseconds(this.requestQueueDelay))}),c(this,"cleanupPendingSentRequestsForTopic",({topic:Z,error:at})=>{const Hs=this.client.core.history.pending;Hs.length>0&&Hs.filter(zs=>zs.topic===Z&&zs.request.method==="wc_sessionRequest").forEach(zs=>{const Ys=zs.request.id,Zs=_i$1("session_request",Ys);if(this.events.listenerCount(Zs)===0)throw new Error(`emitting ${Zs} without any listeners`);this.events.emit(_i$1("session_request",zs.request.id),{error:at})})}),c(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===$.active){this.client.logger.info("session request queue is already active.");return}const Z=this.sessionRequestQueue.queue[0];if(!Z){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(Z)}catch(at){this.client.logger.error(at)}}),c(this,"emitSessionRequest",Z=>{if(this.emittedSessionRequests.has(Z.id)){this.client.logger.warn({id:Z.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${Z.id}`);return}this.sessionRequestQueue.state=$.active,this.emittedSessionRequests.add(Z.id),this.client.events.emit("session_request",Z)}),c(this,"onPairingCreated",Z=>{if(Z.methods&&this.expectedPairingMethodMap.set(Z.topic,Z.methods),Z.active)return;const at=this.client.proposal.getAll().find(Hs=>Hs.pairingTopic===Z.topic);at&&this.onSessionProposeRequest({topic:Z.topic,payload:formatJsonRpcRequest("wc_sessionPropose",O(R({},at),{requiredNamespaces:at.requiredNamespaces,optionalNamespaces:at.optionalNamespaces,relays:at.relays,proposer:at.proposer,sessionProperties:at.sessionProperties,scopedProperties:at.scopedProperties}),at.id),attestation:at.attestation,encryptedId:at.encryptedId})}),c(this,"isValidConnect",async Z=>{if(!Qa(Z)){const{message:Eu}=Bt$1("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(Z)}`);throw new Error(Eu)}const{pairingTopic:at,requiredNamespaces:Hs,optionalNamespaces:zs,sessionProperties:Ys,scopedProperties:Zs,relays:$u}=Z;if(Dt(at)||await this.isValidPairingTopic(at),!Xa($u,!0)){const{message:Eu}=Bt$1("MISSING_OR_INVALID",`connect() relays: ${$u}`);throw new Error(Eu)}if(Hs&&!Dt(Hs)&&Ye$1(Hs)!==0){const Eu="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(Eu):this.client.logger.warn(Eu),this.validateNamespaces(Hs,"requiredNamespaces")}if(zs&&!Dt(zs)&&Ye$1(zs)!==0&&this.validateNamespaces(zs,"optionalNamespaces"),Ys&&!Dt(Ys)&&this.validateSessionProps(Ys,"sessionProperties"),Zs&&!Dt(Zs)){this.validateSessionProps(Zs,"scopedProperties");const Eu=Object.keys(Hs||{}).concat(Object.keys(zs||{}));if(!Object.keys(Zs).every(Au=>Eu.includes(Au.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(Zs)}, required/optional namespaces: ${JSON.stringify(Eu)}`)}}),c(this,"validateNamespaces",(Z,at)=>{const Hs=Wa(Z,"connect()",at);if(Hs)throw new Error(Hs.message)}),c(this,"isValidApprove",async Z=>{if(!Qa(Z))throw new Error(Bt$1("MISSING_OR_INVALID",`approve() params: ${Z}`).message);const{id:at,namespaces:Hs,relayProtocol:zs,sessionProperties:Ys,scopedProperties:Zs}=Z;this.checkRecentlyDeleted(at),await this.isValidProposalId(at);const $u=this.client.proposal.get(at),Eu=Ss$1(Hs,"approve()");if(Eu)throw new Error(Eu.message);const Au=Ns$1($u.requiredNamespaces,Hs,"approve()");if(Au)throw new Error(Au.message);if(!ft$1(zs,!0)){const{message:vu}=Bt$1("MISSING_OR_INVALID",`approve() relayProtocol: ${zs}`);throw new Error(vu)}if(Ys&&!Dt(Ys)&&this.validateSessionProps(Ys,"sessionProperties"),Zs&&!Dt(Zs)){this.validateSessionProps(Zs,"scopedProperties");const vu=new Set(Object.keys(Hs));if(!Object.keys(Zs).every(Iu=>vu.has(Iu.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(Zs)}, approved namespaces: ${Array.from(vu).join(", ")}`)}}),c(this,"isValidReject",async Z=>{if(!Qa(Z)){const{message:zs}=Bt$1("MISSING_OR_INVALID",`reject() params: ${Z}`);throw new Error(zs)}const{id:at,reason:Hs}=Z;if(this.checkRecentlyDeleted(at),await this.isValidProposalId(at),!tu(Hs)){const{message:zs}=Bt$1("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(Hs)}`);throw new Error(zs)}}),c(this,"isValidSessionSettleRequest",Z=>{if(!Qa(Z)){const{message:Eu}=Bt$1("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${Z}`);throw new Error(Eu)}const{relay:at,controller:Hs,namespaces:zs,expiry:Ys}=Z;if(!Os$1(at)){const{message:Eu}=Bt$1("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(Eu)}const Zs=Ya(Hs,"onSessionSettleRequest()");if(Zs)throw new Error(Zs.message);const $u=Ss$1(zs,"onSessionSettleRequest()");if($u)throw new Error($u.message);if(Ui$1(Ys)){const{message:Eu}=Bt$1("EXPIRED","onSessionSettleRequest()");throw new Error(Eu)}}),c(this,"isValidUpdate",async Z=>{if(!Qa(Z)){const{message:$u}=Bt$1("MISSING_OR_INVALID",`update() params: ${Z}`);throw new Error($u)}const{topic:at,namespaces:Hs}=Z;this.checkRecentlyDeleted(at),await this.isValidSessionTopic(at);const zs=this.client.session.get(at),Ys=Ss$1(Hs,"update()");if(Ys)throw new Error(Ys.message);const Zs=Ns$1(zs.requiredNamespaces,Hs,"update()");if(Zs)throw new Error(Zs.message)}),c(this,"isValidExtend",async Z=>{if(!Qa(Z)){const{message:Hs}=Bt$1("MISSING_OR_INVALID",`extend() params: ${Z}`);throw new Error(Hs)}const{topic:at}=Z;this.checkRecentlyDeleted(at),await this.isValidSessionTopic(at)}),c(this,"isValidRequest",async Z=>{if(!Qa(Z)){const{message:$u}=Bt$1("MISSING_OR_INVALID",`request() params: ${Z}`);throw new Error($u)}const{topic:at,request:Hs,chainId:zs,expiry:Ys}=Z;this.checkRecentlyDeleted(at),await this.isValidSessionTopic(at);const{namespaces:Zs}=this.client.session.get(at);if(!ou(Zs,zs)){const{message:$u}=Bt$1("MISSING_OR_INVALID",`request() chainId: ${zs}`);throw new Error($u)}if(!eu(Hs)){const{message:$u}=Bt$1("MISSING_OR_INVALID",`request() ${JSON.stringify(Hs)}`);throw new Error($u)}if(!su(Zs,zs,Hs.method)){const{message:$u}=Bt$1("MISSING_OR_INVALID",`request() method: ${Hs.method}`);throw new Error($u)}if(Ys&&!au(Ys,_e)){const{message:$u}=Bt$1("MISSING_OR_INVALID",`request() expiry: ${Ys}. Expiry must be a number (in seconds) between ${_e.min} and ${_e.max}`);throw new Error($u)}}),c(this,"isValidRespond",async Z=>{var at;if(!Qa(Z)){const{message:Zs}=Bt$1("MISSING_OR_INVALID",`respond() params: ${Z}`);throw new Error(Zs)}const{topic:Hs,response:zs}=Z;try{await this.isValidSessionTopic(Hs)}catch(Zs){throw(at=Z==null?void 0:Z.response)!=null&&at.id&&this.cleanupAfterResponse(Z),Zs}if(!nu(zs)){const{message:Zs}=Bt$1("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(zs)}`);throw new Error(Zs)}const Ys=this.client.pendingRequest.get(zs.id);if(Ys.topic!==Hs){const{message:Zs}=Bt$1("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${zs.id}, expected topic: ${Ys.topic}, received topic: ${Hs}`);throw new Error(Zs)}}),c(this,"isValidPing",async Z=>{if(!Qa(Z)){const{message:Hs}=Bt$1("MISSING_OR_INVALID",`ping() params: ${Z}`);throw new Error(Hs)}const{topic:at}=Z;await this.isValidSessionOrPairingTopic(at)}),c(this,"isValidEmit",async Z=>{if(!Qa(Z)){const{message:Zs}=Bt$1("MISSING_OR_INVALID",`emit() params: ${Z}`);throw new Error(Zs)}const{topic:at,event:Hs,chainId:zs}=Z;await this.isValidSessionTopic(at);const{namespaces:Ys}=this.client.session.get(at);if(!ou(Ys,zs)){const{message:Zs}=Bt$1("MISSING_OR_INVALID",`emit() chainId: ${zs}`);throw new Error(Zs)}if(!ru(Hs)){const{message:Zs}=Bt$1("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(Hs)}`);throw new Error(Zs)}if(!iu(Ys,zs,Hs.name)){const{message:Zs}=Bt$1("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(Hs)}`);throw new Error(Zs)}}),c(this,"isValidDisconnect",async Z=>{if(!Qa(Z)){const{message:Hs}=Bt$1("MISSING_OR_INVALID",`disconnect() params: ${Z}`);throw new Error(Hs)}const{topic:at}=Z;await this.isValidSessionOrPairingTopic(at)}),c(this,"isValidAuthenticate",Z=>{const{chains:at,uri:Hs,domain:zs,nonce:Ys}=Z;if(!Array.isArray(at)||at.length===0)throw new Error("chains is required and must be a non-empty array");if(!ft$1(Hs,!1))throw new Error("uri is required parameter");if(!ft$1(zs,!1))throw new Error("domain is required parameter");if(!ft$1(Ys,!1))throw new Error("nonce is required parameter");if([...new Set(at.map($u=>Je$1($u).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:Zs}=Je$1(at[0]);if(Zs!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),c(this,"getVerifyContext",async Z=>{const{attestationId:at,hash:Hs,encryptedId:zs,metadata:Ys,transportType:Zs}=Z,$u={verified:{verifyUrl:Ys.verifyUrl||be,validation:"UNKNOWN",origin:Ys.url||""}};try{if(Zs===ee.link_mode){const Au=this.getAppLinkIfEnabled(Ys,Zs);return $u.verified.validation=Au&&new URL(Au).origin===new URL(Ys.url).origin?"VALID":"INVALID",$u}const Eu=await this.client.core.verify.resolve({attestationId:at,hash:Hs,encryptedId:zs,verifyUrl:Ys.verifyUrl});Eu&&($u.verified.origin=Eu.origin,$u.verified.isScam=Eu.isScam,$u.verified.validation=Eu.origin===new URL(Ys.url).origin?"VALID":"INVALID")}catch(Eu){this.client.logger.warn(Eu)}return this.client.logger.debug(`Verify context: ${JSON.stringify($u)}`),$u}),c(this,"validateSessionProps",(Z,at)=>{Object.values(Z).forEach((Hs,zs)=>{if(Hs==null){const{message:Ys}=Bt$1("MISSING_OR_INVALID",`${at} must contain an existing value for each key. Received: ${Hs} for key ${Object.keys(Z)[zs]}`);throw new Error(Ys)}})}),c(this,"getPendingAuthRequest",Z=>{const at=this.client.auth.requests.get(Z);return typeof at=="object"?at:void 0}),c(this,"addToRecentlyDeleted",(Z,at)=>{if(this.recentlyDeletedMap.set(Z,at),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let Hs=0;const zs=this.recentlyDeletedLimit/2;for(const Ys of this.recentlyDeletedMap.keys()){if(Hs++>=zs)break;this.recentlyDeletedMap.delete(Ys)}}}),c(this,"checkRecentlyDeleted",Z=>{const at=this.recentlyDeletedMap.get(Z);if(at){const{message:Hs}=Bt$1("MISSING_OR_INVALID",`Record was recently deleted - ${at}: ${Z}`);throw new Error(Hs)}}),c(this,"isLinkModeEnabled",(Z,at)=>{var Hs,zs,Ys,Zs,$u,Eu,Au,vu,Iu;return!Z||at!==ee.link_mode?!1:((zs=(Hs=this.client.metadata)==null?void 0:Hs.redirect)==null?void 0:zs.linkMode)===!0&&((Zs=(Ys=this.client.metadata)==null?void 0:Ys.redirect)==null?void 0:Zs.universal)!==void 0&&((Eu=($u=this.client.metadata)==null?void 0:$u.redirect)==null?void 0:Eu.universal)!==""&&((Au=Z==null?void 0:Z.redirect)==null?void 0:Au.universal)!==void 0&&((vu=Z==null?void 0:Z.redirect)==null?void 0:vu.universal)!==""&&((Iu=Z==null?void 0:Z.redirect)==null?void 0:Iu.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(Z.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),c(this,"getAppLinkIfEnabled",(Z,at)=>{var Hs;return this.isLinkModeEnabled(Z,at)?(Hs=Z==null?void 0:Z.redirect)==null?void 0:Hs.universal:void 0}),c(this,"handleLinkModeMessage",({url:Z})=>{if(!Z||!Z.includes("wc_ev")||!Z.includes("topic"))return;const at=Ti$1(Z,"topic")||"",Hs=decodeURIComponent(Ti$1(Z,"wc_ev")||""),zs=this.client.session.keys.includes(at);zs&&this.client.session.update(at,{transportType:ee.link_mode}),this.client.core.dispatchEnvelope({topic:at,message:Hs,sessionExists:zs})}),c(this,"registerLinkModeListeners",async()=>{var Z;if(ji$1()||At$1()&&(Z=this.client.metadata.redirect)!=null&&Z.linkMode){const at=global==null?void 0:global.Linking;if(typeof at<"u"){at.addEventListener("url",this.handleLinkModeMessage,this.client.name);const Hs=await at.getInitialURL();Hs&&setTimeout(()=>{this.handleLinkModeMessage({url:Hs})},50)}}}),c(this,"getTVFParams",(Z,at,Hs)=>{var zs,Ys,Zs;if(!((zs=at.request)!=null&&zs.method))return{};const $u={correlationId:Z,rpcMethods:[at.request.method],chainId:at.chainId};try{const Eu=this.extractTxHashesFromResult(at.request,Hs);$u.txHashes=Eu,$u.contractAddresses=this.isValidContractData(at.request.params)?[(Zs=(Ys=at.request.params)==null?void 0:Ys[0])==null?void 0:Zs.to]:[]}catch(Eu){this.client.logger.warn(Eu,"Error getting TVF params")}return $u}),c(this,"isValidContractData",Z=>{var at;if(!Z)return!1;try{const Hs=(Z==null?void 0:Z.data)||((at=Z==null?void 0:Z[0])==null?void 0:at.data);if(!Hs.startsWith("0x"))return!1;const zs=Hs.slice(2);return/^[0-9a-fA-F]*$/.test(zs)?zs.length%2===0:!1}catch{}return!1}),c(this,"extractTxHashesFromResult",(Z,at)=>{var Hs;try{if(!at)return[];const zs=Z.method,Ys=yt[zs];if(zs==="sui_signTransaction")return[Oc(at.transactionBytes)];if(zs==="near_signTransaction")return[Nc(at)];if(zs==="near_signTransactions")return at.map($u=>Nc($u));if(zs==="xrpl_signTransactionFor"||zs==="xrpl_signTransaction")return[(Hs=at.tx_json)==null?void 0:Hs.hash];if(zs==="polkadot_signTransaction")return[mu({transaction:Z.params.transactionPayload,signature:at.signature})];if(zs==="algo_signTxn")return Ee(at)?at.map($u=>Uc($u)):[Uc(at)];if(zs==="cosmos_signDirect")return[_c(at)];if(zs==="wallet_sendCalls")return Rc(at);if(typeof at=="string")return[at];const Zs=at[Ys.key];if(Ee(Zs))return zs==="solana_signAllTransactions"?Zs.map($u=>Sc($u)):Zs;if(typeof Zs=="string")return[Zs]}catch(zs){this.client.logger.warn(zs,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const t=this.client.session.keys,Z=this.client.core.relayer.messages.getWithoutAck(t);for(const[at,Hs]of Object.entries(Z))for(const zs of Hs)try{await this.onProviderMessageEvent({topic:at,message:zs,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${at}, message: ${zs}`)}}catch(t){this.client.logger.warn(t,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:t}=Bt$1("NOT_INITIALIZED",this.name);throw new Error(t)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(C.message,t=>{this.onProviderMessageEvent(t)})}async onRelayMessage(t){const{topic:Z,message:at,attestation:Hs,transportType:zs}=t,{publicKey:Ys}=this.client.auth.authKeys.keys.includes(pe)?this.client.auth.authKeys.get(pe):{responseTopic:void 0,publicKey:void 0};try{const Zs=await this.client.core.crypto.decode(Z,at,{receiverPublicKey:Ys,encoding:zs===ee.link_mode?Ge$1:oe$1});isJsonRpcRequest(Zs)?(this.client.core.history.set(Z,Zs),await this.onRelayEventRequest({topic:Z,payload:Zs,attestation:Hs,transportType:zs,encryptedId:pa(at)})):isJsonRpcResponse(Zs)?(await this.client.core.history.resolve(Zs),await this.onRelayEventResponse({topic:Z,payload:Zs,transportType:zs}),this.client.core.history.delete(Z,Zs.id)):await this.onRelayEventUnknownPayload({topic:Z,payload:Zs,transportType:zs}),await this.client.core.relayer.messages.ack(Z,at)}catch(Zs){this.client.logger.error(Zs)}}registerExpirerEvents(){this.client.core.expirer.on(q.expired,async t=>{const{topic:Z,id:at}=Oi$1(t.target);if(at&&this.client.pendingRequest.keys.includes(at))return await this.deletePendingSessionRequest(at,Bt$1("EXPIRED"),!0);if(at&&this.client.auth.requests.keys.includes(at))return await this.deletePendingAuthRequest(at,Bt$1("EXPIRED"),!0);Z?this.client.session.keys.includes(Z)&&(await this.deleteSession({topic:Z,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:Z})):at&&(await this.deleteProposal(at,!0),this.client.events.emit("proposal_expire",{id:at}))})}registerPairingEvents(){this.client.core.pairing.events.on(ae.create,t=>this.onPairingCreated(t)),this.client.core.pairing.events.on(ae.delete,t=>{this.addToRecentlyDeleted(t.topic,"pairing")})}isValidPairingTopic(t){if(!ft$1(t,!1)){const{message:Z}=Bt$1("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(Z)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:Z}=Bt$1("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(Z)}if(Ui$1(this.client.core.pairing.pairings.get(t).expiry)){const{message:Z}=Bt$1("EXPIRED",`pairing topic: ${t}`);throw new Error(Z)}}async isValidSessionTopic(t){if(!ft$1(t,!1)){const{message:Z}=Bt$1("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(Z)}if(this.checkRecentlyDeleted(t),!this.client.session.keys.includes(t)){const{message:Z}=Bt$1("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(Z)}if(Ui$1(this.client.session.get(t).expiry)){await this.deleteSession({topic:t});const{message:Z}=Bt$1("EXPIRED",`session topic: ${t}`);throw new Error(Z)}if(!this.client.core.crypto.keychain.has(t)){const{message:Z}=Bt$1("MISSING_OR_INVALID",`session topic does not exist in keychain: ${t}`);throw await this.deleteSession({topic:t}),new Error(Z)}}async isValidSessionOrPairingTopic(t){if(this.checkRecentlyDeleted(t),this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(ft$1(t,!1)){const{message:Z}=Bt$1("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(Z)}else{const{message:Z}=Bt$1("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(Z)}}async isValidProposalId(t){if(!Ja(t)){const{message:Z}=Bt$1("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(Z)}if(!this.client.proposal.keys.includes(t)){const{message:Z}=Bt$1("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(Z)}if(Ui$1(this.client.proposal.get(t).expiryTimestamp)){await this.deleteProposal(t);const{message:Z}=Bt$1("EXPIRED",`proposal id: ${t}`);throw new Error(Z)}}}class Vs extends ji{constructor(t,Z){super(t,Z,dt,we),this.core=t,this.logger=Z}}class It extends ji{constructor(t,Z){super(t,Z,ut,we),this.core=t,this.logger=Z}}class ks extends ji{constructor(t,Z){super(t,Z,wt,we,at=>at.id),this.core=t,this.logger=Z}}class Ds extends ji{constructor(t,Z){super(t,Z,Et,le,()=>pe),this.core=t,this.logger=Z}}class Ls extends ji{constructor(t,Z){super(t,Z,St,le),this.core=t,this.logger=Z}}class Ms extends ji{constructor(t,Z){super(t,Z,Rt,le,at=>at.id),this.core=t,this.logger=Z}}var $s=Object.defineProperty,Ks=(F,t,Z)=>t in F?$s(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,Ke=(F,t,Z)=>Ks(F,typeof t!="symbol"?t+"":t,Z);class Us{constructor(t,Z){this.core=t,this.logger=Z,Ke(this,"authKeys"),Ke(this,"pairingTopics"),Ke(this,"requests"),this.authKeys=new Ds(this.core,this.logger),this.pairingTopics=new Ls(this.core,this.logger),this.requests=new Ms(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var Gs=Object.defineProperty,js=(F,t,Z)=>t in F?Gs(F,t,{enumerable:!0,configurable:!0,writable:!0,value:Z}):F[t]=Z,f=(F,t,Z)=>js(F,typeof t!="symbol"?t+"":t,Z);class fe extends J$3{constructor(t){super(t),f(this,"protocol",Ve),f(this,"version",ke),f(this,"name",me.name),f(this,"metadata"),f(this,"core"),f(this,"logger"),f(this,"events",new eventsExports.EventEmitter),f(this,"engine"),f(this,"session"),f(this,"proposal"),f(this,"pendingRequest"),f(this,"auth"),f(this,"signConfig"),f(this,"on",(at,Hs)=>this.events.on(at,Hs)),f(this,"once",(at,Hs)=>this.events.once(at,Hs)),f(this,"off",(at,Hs)=>this.events.off(at,Hs)),f(this,"removeListener",(at,Hs)=>this.events.removeListener(at,Hs)),f(this,"removeAllListeners",at=>this.events.removeAllListeners(at)),f(this,"connect",async at=>{try{return await this.engine.connect(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"pair",async at=>{try{return await this.engine.pair(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"approve",async at=>{try{return await this.engine.approve(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"reject",async at=>{try{return await this.engine.reject(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"update",async at=>{try{return await this.engine.update(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"extend",async at=>{try{return await this.engine.extend(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"request",async at=>{try{return await this.engine.request(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"respond",async at=>{try{return await this.engine.respond(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"ping",async at=>{try{return await this.engine.ping(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"emit",async at=>{try{return await this.engine.emit(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"disconnect",async at=>{try{return await this.engine.disconnect(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"find",at=>{try{return this.engine.find(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(at){throw this.logger.error(at.message),at}}),f(this,"authenticate",async(at,Hs)=>{try{return await this.engine.authenticate(at,Hs)}catch(zs){throw this.logger.error(zs.message),zs}}),f(this,"formatAuthMessage",at=>{try{return this.engine.formatAuthMessage(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"approveSessionAuthenticate",async at=>{try{return await this.engine.approveSessionAuthenticate(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),f(this,"rejectSessionAuthenticate",async at=>{try{return await this.engine.rejectSessionAuthenticate(at)}catch(Hs){throw this.logger.error(Hs.message),Hs}}),this.name=(t==null?void 0:t.name)||me.name,this.metadata=di$1(t==null?void 0:t.metadata),this.signConfig=t==null?void 0:t.signConfig;const Z=wu({logger:(t==null?void 0:t.logger)||me.logger,name:this.name});this.logger=Z,this.core=(t==null?void 0:t.core)||new ta(t),this.session=new It(this.core,this.logger),this.proposal=new Vs(this.core,this.logger),this.pendingRequest=new ks(this.core,this.logger),this.engine=new Cs(this),this.auth=new Us(this.core,this.logger)}static async init(t){const Z=new fe(t);return await Z.initialize(),Z}get context(){return w$1(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const Fs=It,Qs=fe,dist=Object.freeze(Object.defineProperty({__proto__:null,AUTH_CONTEXT:ft,AUTH_KEYS_CONTEXT:Et,AUTH_PAIRING_TOPIC_CONTEXT:St,AUTH_PROTOCOL:_t,AUTH_PUBLIC_KEY_NAME:pe,AUTH_REQUEST_CONTEXT:Rt,AUTH_STORAGE_PREFIX:le,AUTH_VERSION:Ps,ENGINE_CONTEXT:gt,ENGINE_QUEUE_STATES:$,ENGINE_RPC_OPTS:P,HISTORY_CONTEXT:Is,HISTORY_EVENTS:vs,HISTORY_STORAGE_VERSION:Ts,METHODS_TO_VERIFY:mt,PROPOSAL_CONTEXT:dt,PROPOSAL_EXPIRY:qs,PROPOSAL_EXPIRY_MESSAGE:Me,REQUEST_CONTEXT:wt,SESSION_CONTEXT:ut,SESSION_EXPIRY:W,SESSION_REQUEST_EXPIRY_BOUNDARIES:_e,SIGN_CLIENT_CONTEXT:De,SIGN_CLIENT_DEFAULT:me,SIGN_CLIENT_EVENTS:Ss,SIGN_CLIENT_PROTOCOL:Ve,SIGN_CLIENT_STORAGE_OPTIONS:Rs,SIGN_CLIENT_STORAGE_PREFIX:we,SIGN_CLIENT_VERSION:ke,SessionStore:Fs,SignClient:Qs,TVF_METHODS:yt,WALLETCONNECT_DEEPLINK_CHOICE:Le,default:fe},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(dist),require$$3=getAugmentedNamespace(dist$1);var constants={},operation$1={};Object.defineProperty(operation$1,"__esModule",{value:!0});operation$1.OptionalOperation=operation$1.Operation=void 0;var Operation$1;(function(F){F.SIGN_TRANSACTION="mvx_signTransaction",F.SIGN_TRANSACTIONS="mvx_signTransactions",F.SIGN_MESSAGE="mvx_signMessage"})(Operation$1||(operation$1.Operation=Operation$1={}));var OptionalOperation;(function(F){F.SIGN_LOGIN_TOKEN="mvx_signLoginToken",F.SIGN_NATIVE_AUTH_TOKEN="mvx_signNativeAuthToken",F.CANCEL_ACTION="mvx_cancelAction"})(OptionalOperation||(operation$1.OptionalOperation=OptionalOperation={}));Object.defineProperty(constants,"__esModule",{value:!0});constants.WALLETCONNECT_SIGN_LOGIN_DELAY=constants.WALLETCONNECT_MULTIVERSX_OPTIONAL_METHODS=constants.WALLETCONNECT_MULTIVERSX_METHODS=constants.WALLETCONNECT_MULTIVERSX_NAMESPACE=void 0;const operation_1$2=operation$1;constants.WALLETCONNECT_MULTIVERSX_NAMESPACE="mvx";constants.WALLETCONNECT_MULTIVERSX_METHODS=Object.values(operation_1$2.Operation);constants.WALLETCONNECT_MULTIVERSX_OPTIONAL_METHODS=Object.values(operation_1$2.OptionalOperation);constants.WALLETCONNECT_SIGN_LOGIN_DELAY=500;var errors$3={};Object.defineProperty(errors$3,"__esModule",{value:!0});errors$3.WalletConnectV2ProviderErrorMessagesEnum=errors$3.ErrBadAddress=errors$3.ErrNotImplemented=errors$3.Err=void 0;let Err$1=class extends Error{constructor(t,Z){super(t),this.inner=void 0,this.inner=Z}};errors$3.Err=Err$1;class ErrNotImplemented extends Err$1{constructor(){super("Method not yet implemented")}}errors$3.ErrNotImplemented=ErrNotImplemented;class ErrBadAddress extends Err$1{constructor(t,Z){super(`Bad address: ${t}`,Z)}}errors$3.ErrBadAddress=ErrBadAddress;var WalletConnectV2ProviderErrorMessagesEnum;(function(F){F.unableToInit="WalletConnect is unable to init",F.notInitialized="WalletConnect is not initialized",F.unableToConnect="WalletConnect is unable to connect",F.unableToConnectExisting="WalletConnect is unable to connect to existing pairing",F.unableToSignLoginToken="WalletConnect could not sign login token",F.unableToSign="WalletConnect could not sign the message",F.unableToLogin="WalletConnect is unable to login",F.unableToHandleTopic="WalletConnect: Unable to handle topic update",F.unableToHandleEvent="WalletConnect: Unable to handle events",F.unableToHandleCleanup="WalletConnect: Unable to handle cleanup",F.sessionNotConnected="WalletConnect Session is not connected",F.sessionDeleted="WalletConnect Session Deleted",F.sessionExpired="WalletConnect Session Expired",F.alreadyLoggedOut="WalletConnect: Already logged out",F.pingFailed="WalletConnect Ping Failed",F.invalidAddress="WalletConnect: Invalid address",F.requestDifferentChain="WalletConnect: Request Chain Id different than Connection Chain Id",F.invalidMessageResponse="WalletConnect could not sign the message",F.invalidMessageSignature="WalletConnect: Invalid message signature",F.invalidTransactionResponse="WalletConnect could not sign the transactions. Invalid signatures",F.invalidCustomRequestResponse="WalletConnect could not send the custom request",F.transactionError="Transaction canceled",F.connectionError="WalletConnect could not establish a connection",F.invalidGuardian="WalletConnect: Invalid Guardian"})(WalletConnectV2ProviderErrorMessagesEnum||(errors$3.WalletConnectV2ProviderErrorMessagesEnum=WalletConnectV2ProviderErrorMessagesEnum={}));var logger={};Object.defineProperty(logger,"__esModule",{value:!0});logger.Logger=void 0;class Logger{static error(t){console.error(t)}static trace(t){console.trace(t)}}logger.Logger=Logger;var utils={},__awaiter$1=commonjsGlobal&&commonjsGlobal.__awaiter||function(F,t,Z,at){function Hs(zs){return zs instanceof Z?zs:new Z(function(Ys){Ys(zs)})}return new(Z||(Z=Promise))(function(zs,Ys){function Zs(Au){try{Eu(at.next(Au))}catch(vu){Ys(vu)}}function $u(Au){try{Eu(at.throw(Au))}catch(vu){Ys(vu)}}function Eu(Au){Au.done?zs(Au.value):Hs(Au.value).then(Zs,$u)}Eu((at=at.apply(F,t||[])).next())})};Object.defineProperty(utils,"__esModule",{value:!0});utils.getCurrentSession=getCurrentSession;utils.getCurrentTopic=getCurrentTopic;utils.getConnectionParams=getConnectionParams;utils.getExistingConnectionParams=getExistingConnectionParams;utils.getMvxNamespace=getMvxNamespace;utils.addressIsValid=addressIsValid;utils.getAddressFromSession=getAddressFromSession;utils.applyTransactionSignature=applyTransactionSignature;utils.getMetadata=getMetadata;utils.sleep=sleep;const address_1$3=address,utils_1$1=require$$3,constants_1$3=constants,errors_1$1=errors$3,logger_1=logger,operation_1$1=operation$1;function getCurrentSession(F,t){if(!t)throw new Error(errors_1$1.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);const Z=t.find(getExistingConnectionParams(F)).filter(at=>at.acknowledged);if(Z.length>0){const at=Z.length-1;return Z[at]}if(t.session.length>0){const at=t.session.keys.length-1;return t.session.get(t.session.keys[at])}throw logger_1.Logger.error(errors_1$1.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),new Error(errors_1$1.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected)}function getCurrentTopic(F,t){if(!t)throw new Error(errors_1$1.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);const Z=getCurrentSession(F,t);if(!(Z!=null&&Z.topic))throw new Error(errors_1$1.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);return Z.topic}function getConnectionParams(F,t){return{optionalNamespaces:getMvxNamespace(F,t)}}function getExistingConnectionParams(F,t){return{requiredNamespaces:getMvxNamespace(F,t)}}function getMvxNamespace(F,t){var Z,at,Hs;const zs=[...constants_1$3.WALLETCONNECT_MULTIVERSX_METHODS,...(Z=t==null?void 0:t.methods)!==null&&Z!==void 0?Z:[]];!((at=t==null?void 0:t.methods)===null||at===void 0)&&at.includes(operation_1$1.OptionalOperation.SIGN_LOGIN_TOKEN)||zs.push(operation_1$1.OptionalOperation.SIGN_LOGIN_TOKEN);const Ys=[`${constants_1$3.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${F}`],Zs=(Hs=t==null?void 0:t.events)!==null&&Hs!==void 0?Hs:[];return{[constants_1$3.WALLETCONNECT_MULTIVERSX_NAMESPACE]:{methods:zs,chains:Ys,events:Zs}}}function addressIsValid(F){try{return!address_1$3.Address.newFromBech32(F).isEmpty()}catch{return!1}}function getAddressFromSession(F){const t=F.namespaces[constants_1$3.WALLETCONNECT_MULTIVERSX_NAMESPACE];if(t&&t.accounts){const Z=t.accounts[0],[at,Hs,zs]=Z.split(":");return zs}return""}function applyTransactionSignature({transaction:F,response:t}){if(!t)throw logger_1.Logger.error(errors_1$1.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse),new Error(errors_1$1.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse);const{signature:Z,guardianSignature:at,version:Hs,options:zs,guardian:Ys}=t,Zs=F.guardian.toBech32();if(Zs&&Zs!==Ys)throw logger_1.Logger.error(errors_1$1.WalletConnectV2ProviderErrorMessagesEnum.invalidGuardian),new Error(errors_1$1.WalletConnectV2ProviderErrorMessagesEnum.invalidGuardian);return Ys&&(F.guardian=address_1$3.Address.newFromBech32(Ys)),Hs&&(F.version=Hs),zs!=null&&(F.options=zs),F.signature=Buffer.from(Z,"hex"),at&&(F.guardianSignature=Buffer.from(at,"hex")),F}function getMetadata(F){if(F)return Object.assign(Object.assign({},F),{url:(0,utils_1$1.getAppMetadata)().url})}function sleep(F){return __awaiter$1(this,void 0,void 0,function*(){return yield new Promise(t=>setTimeout(()=>{t()},F))})}(function(F){var t=commonjsGlobal&&commonjsGlobal.__awaiter||function(_u,Su,Bu,Du){function Tu(Pu){return Pu instanceof Bu?Pu:new Bu(function(Uu){Uu(Pu)})}return new(Bu||(Bu=Promise))(function(Pu,Uu){function Fu(zu){try{qu(Du.next(zu))}catch(tl){Uu(tl)}}function Lu(zu){try{qu(Du.throw(zu))}catch(tl){Uu(tl)}}function qu(zu){zu.done?Pu(zu.value):Tu(zu.value).then(Fu,Lu)}qu((Du=Du.apply(_u,Su||[])).next())})},Z=commonjsGlobal&&commonjsGlobal.__importDefault||function(_u){return _u&&_u.__esModule?_u:{default:_u}};Object.defineProperty(F,"__esModule",{value:!0}),F.WalletConnectV2Provider=F.OptionalOperation=F.Operation=F.WalletConnectV2ProviderErrorMessagesEnum=void 0;const at=message,Hs=address,zs=Z(require$$2),Ys=require$$3,Zs=constants,$u=errors$3;Object.defineProperty(F,"WalletConnectV2ProviderErrorMessagesEnum",{enumerable:!0,get:function(){return $u.WalletConnectV2ProviderErrorMessagesEnum}});const Eu=logger,Au=operation$1;Object.defineProperty(F,"Operation",{enumerable:!0,get:function(){return Au.Operation}}),Object.defineProperty(F,"OptionalOperation",{enumerable:!0,get:function(){return Au.OptionalOperation}});const vu=utils;class Iu{constructor(Su,Bu,Du,Tu,Pu){this.chainId="",this.isInitializing=!1,this.processingTopic="",this.options={},this.account={address:""},this.onClientConnect=Su,this.chainId=Bu,this.walletConnectV2Relay=Du,this.walletConnectV2ProjectId=Tu,this.options=Pu}disconnect(){this.account={address:"",signature:""},this.walletConnector=void 0,this.session=void 0,this.pairings=void 0}init(){return t(this,void 0,void 0,function*(){var Su,Bu;if(this.isInitialized())return this.isInitialized();try{if(!this.isInitializing){this.isInitializing=!0,this.disconnect();const Du=!((Su=this.options)===null||Su===void 0)&&Su.metadata?{metadata:(0,vu.getMetadata)((Bu=this.options)===null||Bu===void 0?void 0:Bu.metadata)}:{},Tu=yield zs.default.init(Object.assign(Object.assign(Object.assign({},this.options),{relayUrl:this.walletConnectV2Relay,projectId:this.walletConnectV2ProjectId}),Du));this.walletConnector=Tu,this.isInitializing=!1,yield this.subscribeToEvents(Tu),yield this.checkPersistedState(Tu)}}catch{throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToInit)}finally{return this.isInitializing=!1,this.isInitialized()}})}isInitialized(){return!!this.walletConnector&&!this.isInitializing}isConnected(){return!!(this.isInitialized()&&typeof this.session<"u")}getAccount(){return this.account}setAccount(Su){this.account=Su}connect(Su){return t(this,void 0,void 0,function*(){var Bu,Du;if(typeof this.walletConnector>"u")throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);const Tu=(0,vu.getConnectionParams)(this.chainId,Su);try{return yield this.walletConnector.connect(Object.assign({pairingTopic:Su==null?void 0:Su.topic},Tu))}catch{if(Su!=null&&Su.topic)try{(Du=(Bu=this.walletConnector.core)===null||Bu===void 0?void 0:Bu.expirer)===null||Du===void 0||Du.set(Su.topic,0)}catch{Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToHandleCleanup)}throw this.disconnect(),Eu.Logger.error(Su!=null&&Su.topic?$u.WalletConnectV2ProviderErrorMessagesEnum.unableToConnectExisting:$u.WalletConnectV2ProviderErrorMessagesEnum.unableToConnect),new Error(Su!=null&&Su.topic?$u.WalletConnectV2ProviderErrorMessagesEnum.unableToConnectExisting:$u.WalletConnectV2ProviderErrorMessagesEnum.unableToConnect)}})}login(Su){return t(this,void 0,void 0,function*(){var Bu;if(this.isInitializing=!0,typeof this.walletConnector>"u"&&(yield this.connect()),typeof this.walletConnector>"u")throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);typeof this.session<"u"&&(yield this.logout({topic:(Bu=this.session)===null||Bu===void 0?void 0:Bu.topic}));try{if(Su&&Su.approval){const Du=yield Su.approval();if(Su.token){yield(0,vu.sleep)(Zs.WALLETCONNECT_SIGN_LOGIN_DELAY);const Tu=(0,vu.getAddressFromSession)(Du),Uu=Du.namespaces[Zs.WALLETCONNECT_MULTIVERSX_NAMESPACE].methods.includes(Au.OptionalOperation.SIGN_NATIVE_AUTH_TOKEN)?Au.OptionalOperation.SIGN_NATIVE_AUTH_TOKEN:Au.OptionalOperation.SIGN_LOGIN_TOKEN,{signature:Fu}=yield this.walletConnector.request({chainId:`${Zs.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:Du.topic,request:{method:Uu,params:{token:Su.token,address:Tu}}});if(!Fu)throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToSignLoginToken),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToSignLoginToken);return yield this.onSessionConnected({session:Du,signature:Fu})}return yield this.onSessionConnected({session:Du,signature:""})}}catch{throw this.disconnect(),Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToLogin),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToLogin)}finally{this.isInitializing=!1}return null})}logout(Su){return t(this,void 0,void 0,function*(){if(typeof this.walletConnector>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);try{if(this.processingTopic===((Su==null?void 0:Su.topic)||(0,vu.getCurrentTopic)(this.chainId,this.walletConnector)))return!0;if(Su!=null&&Su.topic)this.processingTopic=Su.topic,yield this.walletConnector.disconnect({topic:Su.topic,reason:(0,Ys.getSdkError)("USER_DISCONNECTED")});else{const Bu=(0,vu.getCurrentTopic)(this.chainId,this.walletConnector);this.processingTopic=Bu,yield this.walletConnector.disconnect({topic:Bu,reason:(0,Ys.getSdkError)("USER_DISCONNECTED")}),this.disconnect(),yield this.cleanupPendingPairings({deletePairings:!0})}}catch{Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.alreadyLoggedOut)}finally{this.processingTopic=""}return!0})}getAddress(){if(typeof this.walletConnector>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);return this.account.address}getSignature(){if(typeof this.walletConnector>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);return this.account.signature}getPairings(){return t(this,void 0,void 0,function*(){var Su,Bu,Du,Tu,Pu;if(typeof this.walletConnector>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);return(Pu=(Tu=(Du=(Bu=(Su=this.walletConnector)===null||Su===void 0?void 0:Su.core)===null||Bu===void 0?void 0:Bu.pairing)===null||Du===void 0?void 0:Du.pairings)===null||Tu===void 0?void 0:Tu.getAll({active:!0}))!==null&&Pu!==void 0?Pu:[]})}signMessage(Su){return t(this,void 0,void 0,function*(){var Bu;const Du=new at.Message({data:Buffer.from(Su.data),address:(Bu=Su.address)!==null&&Bu!==void 0?Bu:Hs.Address.newFromBech32(this.account.address),signer:"wallet-connect-v2",version:Su.version});if(typeof this.walletConnector>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(typeof this.session>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),this.onClientConnect.onClientLogout(),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);try{const Tu=this.getAddress(),{signature:Pu}=yield this.walletConnector.request({chainId:`${Zs.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:(0,vu.getCurrentTopic)(this.chainId,this.walletConnector),request:{method:Au.Operation.SIGN_MESSAGE,params:{address:Tu,message:Du.data.toString()}}});if(!Pu)throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.invalidMessageResponse),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.invalidMessageResponse);try{Du.signature=Buffer.from(Pu,"hex")}catch{throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.invalidMessageSignature),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.invalidMessageSignature)}}catch{throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToSign)}return Du})}signTransaction(Su){return t(this,void 0,void 0,function*(){if(typeof this.walletConnector>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(typeof this.session>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),this.onClientConnect.onClientLogout(),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);const Bu=Su.toPlainObject();if(this.chainId!==Su.chainID.valueOf())throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.requestDifferentChain),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.requestDifferentChain);try{const Du=yield this.walletConnector.request({chainId:`${Zs.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:(0,vu.getCurrentTopic)(this.chainId,this.walletConnector),request:{method:Au.Operation.SIGN_TRANSACTION,params:{transaction:Bu}}});return(0,vu.applyTransactionSignature)({transaction:Su,response:Du})}catch{throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.transactionError)}})}signTransactions(Su){return t(this,void 0,void 0,function*(){if(typeof this.walletConnector>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(typeof this.session>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),this.onClientConnect.onClientLogout(),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);const Bu=Su.map(Du=>{if(this.chainId!==Du.chainID.valueOf())throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.requestDifferentChain),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.requestDifferentChain);return Du.toPlainObject()});try{const{signatures:Du}=yield this.walletConnector.request({chainId:`${Zs.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:(0,vu.getCurrentTopic)(this.chainId,this.walletConnector),request:{method:Au.Operation.SIGN_TRANSACTIONS,params:{transactions:Bu}}});if(!Du)throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse);if(!Array.isArray(Du)||Su.length!==Du.length)throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.invalidTransactionResponse);for(const[Tu,Pu]of Su.entries()){const Uu=Du[Tu];(0,vu.applyTransactionSignature)({transaction:Pu,response:Uu})}return Su}catch{throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.transactionError)}})}sendCustomRequest(Su){return t(this,void 0,void 0,function*(){var Bu;if(typeof this.walletConnector>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(typeof this.session>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected),this.onClientConnect.onClientLogout(),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);if(!((Bu=Su==null?void 0:Su.request)===null||Bu===void 0)&&Bu.method){try{const Du=Object.assign({},Su.request);let{method:Tu}=Du;const{response:Pu}=yield this.walletConnector.request({chainId:`${Zs.WALLETCONNECT_MULTIVERSX_NAMESPACE}:${this.chainId}`,topic:(0,vu.getCurrentTopic)(this.chainId,this.walletConnector),request:Object.assign(Object.assign({},Du),{method:Tu})});Pu||Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.invalidCustomRequestResponse)}catch{Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.invalidCustomRequestResponse)}return}})}ping(){return t(this,void 0,void 0,function*(){if(typeof this.walletConnector>"u")throw Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized),new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);typeof this.session>"u"&&Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionNotConnected);try{const Su=(0,vu.getCurrentTopic)(this.chainId,this.walletConnector);return yield this.walletConnector.ping({topic:Su}),!0}catch{return Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.pingFailed),!1}})}loginAccount(Su){return t(this,void 0,void 0,function*(){return Su?(0,vu.addressIsValid)(Su.address)?(this.account.address=Su.address,Su.signature&&(this.account.signature=Su.signature),this.onClientConnect.onClientLogin(),this.account.address):(Eu.Logger.error(`${$u.WalletConnectV2ProviderErrorMessagesEnum.invalidAddress} ${Su.address}`),this.walletConnector&&(yield this.logout()),""):""})}onSessionConnected(Su){return t(this,void 0,void 0,function*(){if(!Su)return null;this.session=Su.session,this.account.signature=Su.signature||"";const Bu=(0,vu.getAddressFromSession)(Su.session);return Bu?(yield this.loginAccount({address:Bu,signature:Su.signature}),this.account.address=Bu,this.account):null})}handleSessionEvents(Su){return t(this,arguments,void 0,function*({topic:Bu,params:Du}){var Tu;if(typeof this.walletConnector>"u")throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(this.session&&((Tu=this.session)===null||Tu===void 0?void 0:Tu.topic)!==Bu)return;const{event:Pu}=Du;if(Pu!=null&&Pu.name&&(0,vu.getCurrentTopic)(this.chainId,this.walletConnector)===Bu){const Uu=Pu.data;this.onClientConnect.onClientEvent(Uu)}})}subscribeToEvents(Su){return t(this,void 0,void 0,function*(){if(typeof Su>"u")throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);try{Su.on("session_update",({topic:Bu,params:Du})=>{var Tu;if(!this.session||((Tu=this.session)===null||Tu===void 0?void 0:Tu.topic)!==Bu)return;const{namespaces:Pu}=Du,Uu=Su.session.get(Bu),Fu=Object.assign(Object.assign({},Uu),{namespaces:Pu});this.onSessionConnected({session:Fu})}),Su.on("session_event",this.handleSessionEvents.bind(this)),Su.on("session_delete",Bu=>t(this,[Bu],void 0,function*({topic:Du}){var Tu;this.isInitializing&&(this.onClientConnect.onClientLogout(),this.disconnect()),!(!this.session||((Tu=this.session)===null||Tu===void 0?void 0:Tu.topic)!==Du)&&(Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionDeleted),this.onClientConnect.onClientLogout(),this.disconnect(),yield this.cleanupPendingPairings({deletePairings:!0}))})),Su.on("session_expire",Bu=>t(this,[Bu],void 0,function*({topic:Du}){var Tu;!this.session||((Tu=this.session)===null||Tu===void 0?void 0:Tu.topic)!==Du||(Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.sessionExpired),this.onClientConnect.onClientLogout(),this.disconnect(),yield this.cleanupPendingPairings({deletePairings:!0}))}))}catch{Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToHandleEvent)}})}checkPersistedState(Su){return t(this,void 0,void 0,function*(){if(typeof Su>"u")throw new Error($u.WalletConnectV2ProviderErrorMessagesEnum.notInitialized);if(this.pairings=yield this.getPairings(),!(typeof this.session<"u")&&Su.session.length&&!this.account.address&&!this.isInitializing){const Bu=(0,vu.getCurrentSession)(this.chainId,Su);if(Bu)return yield this.onSessionConnected({session:Bu}),Bu}})}cleanupPendingPairings(){return t(this,arguments,void 0,function*(Su={}){var Bu,Du,Tu,Pu,Uu,Fu,Lu,qu;if(!(typeof this.walletConnector>"u"))try{const zu=(Tu=(Du=(Bu=this.walletConnector.core)===null||Bu===void 0?void 0:Bu.pairing)===null||Du===void 0?void 0:Du.pairings)===null||Tu===void 0?void 0:Tu.getAll({active:!1});if(!(0,Ys.isValidArray)(zu))return;for(const tl of zu)if(Su.deletePairings)(Uu=(Pu=this.walletConnector.core)===null||Pu===void 0?void 0:Pu.expirer)===null||Uu===void 0||Uu.set(tl.topic,0);else try{yield(qu=(Lu=(Fu=this.walletConnector.core)===null||Fu===void 0?void 0:Fu.relayer)===null||Lu===void 0?void 0:Lu.subscriber)===null||qu===void 0?void 0:qu.unsubscribe(tl.topic)}catch{Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToHandleCleanup)}}catch{Eu.Logger.error($u.WalletConnectV2ProviderErrorMessagesEnum.unableToHandleCleanup)}})}}F.WalletConnectV2Provider=Iu})(walletConnectV2Provider);(function(F){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(at,Hs,zs,Ys){Ys===void 0&&(Ys=zs);var Zs=Object.getOwnPropertyDescriptor(Hs,zs);(!Zs||("get"in Zs?!Hs.__esModule:Zs.writable||Zs.configurable))&&(Zs={enumerable:!0,get:function(){return Hs[zs]}}),Object.defineProperty(at,Ys,Zs)}:function(at,Hs,zs,Ys){Ys===void 0&&(Ys=zs),at[Ys]=Hs[zs]}),Z=commonjsGlobal&&commonjsGlobal.__exportStar||function(at,Hs){for(var zs in at)zs!=="default"&&!Object.prototype.hasOwnProperty.call(Hs,zs)&&t(Hs,at,zs)};Object.defineProperty(F,"__esModule",{value:!0}),Z(walletConnectV2Provider,F)})(out$1);var out={},extensionProvider={},transaction={},transactionComputer={},proto={},serializer={};function commonjsRequire(F){throw new Error('Could not dynamically require "'+F+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var compiled={exports:{}},indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=F;function F(t,Z){for(var at=new Array(arguments.length-1),Hs=0,zs=2,Ys=!0;zs<arguments.length;)at[Hs++]=arguments[zs++];return new Promise(function($u,Eu){at[Hs]=function(vu){if(Ys)if(Ys=!1,vu)Eu(vu);else{for(var Iu=new Array(arguments.length-1),_u=0;_u<Iu.length;)Iu[_u++]=arguments[_u];$u.apply(null,Iu)}};try{t.apply(Z||null,at)}catch(Au){Ys&&(Ys=!1,Eu(Au))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(F){var t=F;t.length=function(Zs){var $u=Zs.length;if(!$u)return 0;for(var Eu=0;--$u%4>1&&Zs.charAt($u)==="=";)++Eu;return Math.ceil(Zs.length*3)/4-Eu};for(var Z=new Array(64),at=new Array(123),Hs=0;Hs<64;)at[Z[Hs]=Hs<26?Hs+65:Hs<52?Hs+71:Hs<62?Hs-4:Hs-59|43]=Hs++;t.encode=function(Zs,$u,Eu){for(var Au=null,vu=[],Iu=0,_u=0,Su;$u<Eu;){var Bu=Zs[$u++];switch(_u){case 0:vu[Iu++]=Z[Bu>>2],Su=(Bu&3)<<4,_u=1;break;case 1:vu[Iu++]=Z[Su|Bu>>4],Su=(Bu&15)<<2,_u=2;break;case 2:vu[Iu++]=Z[Su|Bu>>6],vu[Iu++]=Z[Bu&63],_u=0;break}Iu>8191&&((Au||(Au=[])).push(String.fromCharCode.apply(String,vu)),Iu=0)}return _u&&(vu[Iu++]=Z[Su],vu[Iu++]=61,_u===1&&(vu[Iu++]=61)),Au?(Iu&&Au.push(String.fromCharCode.apply(String,vu.slice(0,Iu))),Au.join("")):String.fromCharCode.apply(String,vu.slice(0,Iu))};var zs="invalid encoding";t.decode=function(Zs,$u,Eu){for(var Au=Eu,vu=0,Iu,_u=0;_u<Zs.length;){var Su=Zs.charCodeAt(_u++);if(Su===61&&vu>1)break;if((Su=at[Su])===void 0)throw Error(zs);switch(vu){case 0:Iu=Su,vu=1;break;case 1:$u[Eu++]=Iu<<2|(Su&48)>>4,Iu=Su,vu=2;break;case 2:$u[Eu++]=(Iu&15)<<4|(Su&60)>>2,Iu=Su,vu=3;break;case 3:$u[Eu++]=(Iu&3)<<6|Su,vu=0;break}}if(vu===1)throw Error(zs);return Eu-Au},t.test=function(Zs){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(Zs)}}(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=F;function F(){this._listeners={}}return F.prototype.on=function(Z,at,Hs){return(this._listeners[Z]||(this._listeners[Z]=[])).push({fn:at,ctx:Hs||this}),this},F.prototype.off=function(Z,at){if(Z===void 0)this._listeners={};else if(at===void 0)this._listeners[Z]=[];else for(var Hs=this._listeners[Z],zs=0;zs<Hs.length;)Hs[zs].fn===at?Hs.splice(zs,1):++zs;return this},F.prototype.emit=function(Z){var at=this._listeners[Z];if(at){for(var Hs=[],zs=1;zs<arguments.length;)Hs.push(arguments[zs++]);for(zs=0;zs<at.length;)at[zs].fn.apply(at[zs++].ctx,Hs)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=F(F);function F(zs){return typeof Float32Array<"u"?function(){var Ys=new Float32Array([-0]),Zs=new Uint8Array(Ys.buffer),$u=Zs[3]===128;function Eu(_u,Su,Bu){Ys[0]=_u,Su[Bu]=Zs[0],Su[Bu+1]=Zs[1],Su[Bu+2]=Zs[2],Su[Bu+3]=Zs[3]}function Au(_u,Su,Bu){Ys[0]=_u,Su[Bu]=Zs[3],Su[Bu+1]=Zs[2],Su[Bu+2]=Zs[1],Su[Bu+3]=Zs[0]}zs.writeFloatLE=$u?Eu:Au,zs.writeFloatBE=$u?Au:Eu;function vu(_u,Su){return Zs[0]=_u[Su],Zs[1]=_u[Su+1],Zs[2]=_u[Su+2],Zs[3]=_u[Su+3],Ys[0]}function Iu(_u,Su){return Zs[3]=_u[Su],Zs[2]=_u[Su+1],Zs[1]=_u[Su+2],Zs[0]=_u[Su+3],Ys[0]}zs.readFloatLE=$u?vu:Iu,zs.readFloatBE=$u?Iu:vu}():function(){function Ys($u,Eu,Au,vu){var Iu=Eu<0?1:0;if(Iu&&(Eu=-Eu),Eu===0)$u(1/Eu>0?0:2147483648,Au,vu);else if(isNaN(Eu))$u(2143289344,Au,vu);else if(Eu>34028234663852886e22)$u((Iu<<31|2139095040)>>>0,Au,vu);else if(Eu<11754943508222875e-54)$u((Iu<<31|Math.round(Eu/1401298464324817e-60))>>>0,Au,vu);else{var _u=Math.floor(Math.log(Eu)/Math.LN2),Su=Math.round(Eu*Math.pow(2,-_u)*8388608)&8388607;$u((Iu<<31|_u+127<<23|Su)>>>0,Au,vu)}}zs.writeFloatLE=Ys.bind(null,t),zs.writeFloatBE=Ys.bind(null,Z);function Zs($u,Eu,Au){var vu=$u(Eu,Au),Iu=(vu>>31)*2+1,_u=vu>>>23&255,Su=vu&8388607;return _u===255?Su?NaN:Iu*(1/0):_u===0?Iu*1401298464324817e-60*Su:Iu*Math.pow(2,_u-150)*(Su+8388608)}zs.readFloatLE=Zs.bind(null,at),zs.readFloatBE=Zs.bind(null,Hs)}(),typeof Float64Array<"u"?function(){var Ys=new Float64Array([-0]),Zs=new Uint8Array(Ys.buffer),$u=Zs[7]===128;function Eu(_u,Su,Bu){Ys[0]=_u,Su[Bu]=Zs[0],Su[Bu+1]=Zs[1],Su[Bu+2]=Zs[2],Su[Bu+3]=Zs[3],Su[Bu+4]=Zs[4],Su[Bu+5]=Zs[5],Su[Bu+6]=Zs[6],Su[Bu+7]=Zs[7]}function Au(_u,Su,Bu){Ys[0]=_u,Su[Bu]=Zs[7],Su[Bu+1]=Zs[6],Su[Bu+2]=Zs[5],Su[Bu+3]=Zs[4],Su[Bu+4]=Zs[3],Su[Bu+5]=Zs[2],Su[Bu+6]=Zs[1],Su[Bu+7]=Zs[0]}zs.writeDoubleLE=$u?Eu:Au,zs.writeDoubleBE=$u?Au:Eu;function vu(_u,Su){return Zs[0]=_u[Su],Zs[1]=_u[Su+1],Zs[2]=_u[Su+2],Zs[3]=_u[Su+3],Zs[4]=_u[Su+4],Zs[5]=_u[Su+5],Zs[6]=_u[Su+6],Zs[7]=_u[Su+7],Ys[0]}function Iu(_u,Su){return Zs[7]=_u[Su],Zs[6]=_u[Su+1],Zs[5]=_u[Su+2],Zs[4]=_u[Su+3],Zs[3]=_u[Su+4],Zs[2]=_u[Su+5],Zs[1]=_u[Su+6],Zs[0]=_u[Su+7],Ys[0]}zs.readDoubleLE=$u?vu:Iu,zs.readDoubleBE=$u?Iu:vu}():function(){function Ys($u,Eu,Au,vu,Iu,_u){var Su=vu<0?1:0;if(Su&&(vu=-vu),vu===0)$u(0,Iu,_u+Eu),$u(1/vu>0?0:2147483648,Iu,_u+Au);else if(isNaN(vu))$u(0,Iu,_u+Eu),$u(2146959360,Iu,_u+Au);else if(vu>17976931348623157e292)$u(0,Iu,_u+Eu),$u((Su<<31|2146435072)>>>0,Iu,_u+Au);else{var Bu;if(vu<22250738585072014e-324)Bu=vu/5e-324,$u(Bu>>>0,Iu,_u+Eu),$u((Su<<31|Bu/4294967296)>>>0,Iu,_u+Au);else{var Du=Math.floor(Math.log(vu)/Math.LN2);Du===1024&&(Du=1023),Bu=vu*Math.pow(2,-Du),$u(Bu*4503599627370496>>>0,Iu,_u+Eu),$u((Su<<31|Du+1023<<20|Bu*1048576&1048575)>>>0,Iu,_u+Au)}}}zs.writeDoubleLE=Ys.bind(null,t,0,4),zs.writeDoubleBE=Ys.bind(null,Z,4,0);function Zs($u,Eu,Au,vu,Iu){var _u=$u(vu,Iu+Eu),Su=$u(vu,Iu+Au),Bu=(Su>>31)*2+1,Du=Su>>>20&2047,Tu=4294967296*(Su&1048575)+_u;return Du===2047?Tu?NaN:Bu*(1/0):Du===0?Bu*5e-324*Tu:Bu*Math.pow(2,Du-1075)*(Tu+4503599627370496)}zs.readDoubleLE=Zs.bind(null,at,0,4),zs.readDoubleBE=Zs.bind(null,Hs,4,0)}(),zs}function t(zs,Ys,Zs){Ys[Zs]=zs&255,Ys[Zs+1]=zs>>>8&255,Ys[Zs+2]=zs>>>16&255,Ys[Zs+3]=zs>>>24}function Z(zs,Ys,Zs){Ys[Zs]=zs>>>24,Ys[Zs+1]=zs>>>16&255,Ys[Zs+2]=zs>>>8&255,Ys[Zs+3]=zs&255}function at(zs,Ys){return(zs[Ys]|zs[Ys+1]<<8|zs[Ys+2]<<16|zs[Ys+3]<<24)>>>0}function Hs(zs,Ys){return(zs[Ys]<<24|zs[Ys+1]<<16|zs[Ys+2]<<8|zs[Ys+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(F){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(F){var t=F;t.length=function(at){for(var Hs=0,zs=0,Ys=0;Ys<at.length;++Ys)zs=at.charCodeAt(Ys),zs<128?Hs+=1:zs<2048?Hs+=2:(zs&64512)===55296&&(at.charCodeAt(Ys+1)&64512)===56320?(++Ys,Hs+=4):Hs+=3;return Hs},t.read=function(at,Hs,zs){var Ys=zs-Hs;if(Ys<1)return"";for(var Zs=null,$u=[],Eu=0,Au;Hs<zs;)Au=at[Hs++],Au<128?$u[Eu++]=Au:Au>191&&Au<224?$u[Eu++]=(Au&31)<<6|at[Hs++]&63:Au>239&&Au<365?(Au=((Au&7)<<18|(at[Hs++]&63)<<12|(at[Hs++]&63)<<6|at[Hs++]&63)-65536,$u[Eu++]=55296+(Au>>10),$u[Eu++]=56320+(Au&1023)):$u[Eu++]=(Au&15)<<12|(at[Hs++]&63)<<6|at[Hs++]&63,Eu>8191&&((Zs||(Zs=[])).push(String.fromCharCode.apply(String,$u)),Eu=0);return Zs?(Eu&&Zs.push(String.fromCharCode.apply(String,$u.slice(0,Eu))),Zs.join("")):String.fromCharCode.apply(String,$u.slice(0,Eu))},t.write=function(at,Hs,zs){for(var Ys=zs,Zs,$u,Eu=0;Eu<at.length;++Eu)Zs=at.charCodeAt(Eu),Zs<128?Hs[zs++]=Zs:Zs<2048?(Hs[zs++]=Zs>>6|192,Hs[zs++]=Zs&63|128):(Zs&64512)===55296&&(($u=at.charCodeAt(Eu+1))&64512)===56320?(Zs=65536+((Zs&1023)<<10)+($u&1023),++Eu,Hs[zs++]=Zs>>18|240,Hs[zs++]=Zs>>12&63|128,Hs[zs++]=Zs>>6&63|128,Hs[zs++]=Zs&63|128):(Hs[zs++]=Zs>>12|224,Hs[zs++]=Zs>>6&63|128,Hs[zs++]=Zs&63|128);return zs-Ys}}(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=F;function F(t,Z,at){var Hs=at||8192,zs=Hs>>>1,Ys=null,Zs=Hs;return function(Eu){if(Eu<1||Eu>zs)return t(Eu);Zs+Eu>Hs&&(Ys=t(Hs),Zs=0);var Au=Z.call(Ys,Zs,Zs+=Eu);return Zs&7&&(Zs=(Zs|7)+1),Au}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=t;var F=requireMinimal$1();function t(zs,Ys){this.lo=zs>>>0,this.hi=Ys>>>0}var Z=t.zero=new t(0,0);Z.toNumber=function(){return 0},Z.zzEncode=Z.zzDecode=function(){return this},Z.length=function(){return 1};var at=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(Ys){if(Ys===0)return Z;var Zs=Ys<0;Zs&&(Ys=-Ys);var $u=Ys>>>0,Eu=(Ys-$u)/4294967296>>>0;return Zs&&(Eu=~Eu>>>0,$u=~$u>>>0,++$u>4294967295&&($u=0,++Eu>4294967295&&(Eu=0))),new t($u,Eu)},t.from=function(Ys){if(typeof Ys=="number")return t.fromNumber(Ys);if(F.isString(Ys))if(F.Long)Ys=F.Long.fromString(Ys);else return t.fromNumber(parseInt(Ys,10));return Ys.low||Ys.high?new t(Ys.low>>>0,Ys.high>>>0):Z},t.prototype.toNumber=function(Ys){if(!Ys&&this.hi>>>31){var Zs=~this.lo+1>>>0,$u=~this.hi>>>0;return Zs||($u=$u+1>>>0),-(Zs+$u*4294967296)}return this.lo+this.hi*4294967296},t.prototype.toLong=function(Ys){return F.Long?new F.Long(this.lo|0,this.hi|0,!!Ys):{low:this.lo|0,high:this.hi|0,unsigned:!!Ys}};var Hs=String.prototype.charCodeAt;return t.fromHash=function(Ys){return Ys===at?Z:new t((Hs.call(Ys,0)|Hs.call(Ys,1)<<8|Hs.call(Ys,2)<<16|Hs.call(Ys,3)<<24)>>>0,(Hs.call(Ys,4)|Hs.call(Ys,5)<<8|Hs.call(Ys,6)<<16|Hs.call(Ys,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var Ys=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^Ys)>>>0,this.lo=(this.lo<<1^Ys)>>>0,this},t.prototype.zzDecode=function(){var Ys=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^Ys)>>>0,this.hi=(this.hi>>>1^Ys)>>>0,this},t.prototype.length=function(){var Ys=this.lo,Zs=(this.lo>>>28|this.hi<<4)>>>0,$u=this.hi>>>24;return $u===0?Zs===0?Ys<16384?Ys<128?1:2:Ys<2097152?3:4:Zs<16384?Zs<128?5:6:Zs<2097152?7:8:$u<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(F){var t=F;t.asPromise=requireAspromise(),t.base64=requireBase64(),t.EventEmitter=requireEventemitter(),t.float=requireFloat(),t.inquire=requireInquire(),t.utf8=requireUtf8(),t.pool=requirePool(),t.LongBits=requireLongbits(),t.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(zs){return typeof zs=="number"&&isFinite(zs)&&Math.floor(zs)===zs},t.isString=function(zs){return typeof zs=="string"||zs instanceof String},t.isObject=function(zs){return zs&&typeof zs=="object"},t.isset=t.isSet=function(zs,Ys){var Zs=zs[Ys];return Zs!=null&&zs.hasOwnProperty(Ys)?typeof Zs!="object"||(Array.isArray(Zs)?Zs.length:Object.keys(Zs).length)>0:!1},t.Buffer=function(){try{var Hs=t.inquire("buffer").Buffer;return Hs.prototype.utf8Write?Hs:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(zs){return typeof zs=="number"?t.Buffer?t._Buffer_allocUnsafe(zs):new t.Array(zs):t.Buffer?t._Buffer_from(zs):typeof Uint8Array>"u"?zs:new Uint8Array(zs)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(zs){return zs?t.LongBits.from(zs).toHash():t.LongBits.zeroHash},t.longFromHash=function(zs,Ys){var Zs=t.LongBits.fromHash(zs);return t.Long?t.Long.fromBits(Zs.lo,Zs.hi,Ys):Zs.toNumber(!!Ys)};function Z(Hs,zs,Ys){for(var Zs=Object.keys(zs),$u=0;$u<Zs.length;++$u)(Hs[Zs[$u]]===void 0||!Ys)&&(Hs[Zs[$u]]=zs[Zs[$u]]);return Hs}t.merge=Z,t.lcFirst=function(zs){return zs.charAt(0).toLowerCase()+zs.substring(1)};function at(Hs){function zs(Ys,Zs){if(!(this instanceof zs))return new zs(Ys,Zs);Object.defineProperty(this,"message",{get:function(){return Ys}}),Error.captureStackTrace?Error.captureStackTrace(this,zs):Object.defineProperty(this,"stack",{value:new Error().stack||""}),Zs&&Z(this,Zs)}return zs.prototype=Object.create(Error.prototype,{constructor:{value:zs,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return Hs},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),zs}t.newError=at,t.ProtocolError=at("ProtocolError"),t.oneOfGetter=function(zs){for(var Ys={},Zs=0;Zs<zs.length;++Zs)Ys[zs[Zs]]=1;return function(){for(var $u=Object.keys(this),Eu=$u.length-1;Eu>-1;--Eu)if(Ys[$u[Eu]]===1&&this[$u[Eu]]!==void 0&&this[$u[Eu]]!==null)return $u[Eu]}},t.oneOfSetter=function(zs){return function(Ys){for(var Zs=0;Zs<zs.length;++Zs)zs[Zs]!==Ys&&delete this[zs[Zs]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var Hs=t.Buffer;if(!Hs){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=Hs.from!==Uint8Array.from&&Hs.from||function(Ys,Zs){return new Hs(Ys,Zs)},t._Buffer_allocUnsafe=Hs.allocUnsafe||function(Ys){return new Hs(Ys)}}}(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=$u;var F=requireMinimal$1(),t,Z=F.LongBits,at=F.base64,Hs=F.utf8;function zs(Du,Tu,Pu){this.fn=Du,this.len=Tu,this.next=void 0,this.val=Pu}function Ys(){}function Zs(Du){this.head=Du.head,this.tail=Du.tail,this.len=Du.len,this.next=Du.states}function $u(){this.len=0,this.head=new zs(Ys,0,0),this.tail=this.head,this.states=null}var Eu=function(){return F.Buffer?function(){return($u.create=function(){return new t})()}:function(){return new $u}};$u.create=Eu(),$u.alloc=function(Tu){return new F.Array(Tu)},F.Array!==Array&&($u.alloc=F.pool($u.alloc,F.Array.prototype.subarray)),$u.prototype._push=function(Tu,Pu,Uu){return this.tail=this.tail.next=new zs(Tu,Pu,Uu),this.len+=Pu,this};function Au(Du,Tu,Pu){Tu[Pu]=Du&255}function vu(Du,Tu,Pu){for(;Du>127;)Tu[Pu++]=Du&127|128,Du>>>=7;Tu[Pu]=Du}function Iu(Du,Tu){this.len=Du,this.next=void 0,this.val=Tu}Iu.prototype=Object.create(zs.prototype),Iu.prototype.fn=vu,$u.prototype.uint32=function(Tu){return this.len+=(this.tail=this.tail.next=new Iu((Tu=Tu>>>0)<128?1:Tu<16384?2:Tu<2097152?3:Tu<268435456?4:5,Tu)).len,this},$u.prototype.int32=function(Tu){return Tu<0?this._push(_u,10,Z.fromNumber(Tu)):this.uint32(Tu)},$u.prototype.sint32=function(Tu){return this.uint32((Tu<<1^Tu>>31)>>>0)};function _u(Du,Tu,Pu){for(;Du.hi;)Tu[Pu++]=Du.lo&127|128,Du.lo=(Du.lo>>>7|Du.hi<<25)>>>0,Du.hi>>>=7;for(;Du.lo>127;)Tu[Pu++]=Du.lo&127|128,Du.lo=Du.lo>>>7;Tu[Pu++]=Du.lo}$u.prototype.uint64=function(Tu){var Pu=Z.from(Tu);return this._push(_u,Pu.length(),Pu)},$u.prototype.int64=$u.prototype.uint64,$u.prototype.sint64=function(Tu){var Pu=Z.from(Tu).zzEncode();return this._push(_u,Pu.length(),Pu)},$u.prototype.bool=function(Tu){return this._push(Au,1,Tu?1:0)};function Su(Du,Tu,Pu){Tu[Pu]=Du&255,Tu[Pu+1]=Du>>>8&255,Tu[Pu+2]=Du>>>16&255,Tu[Pu+3]=Du>>>24}$u.prototype.fixed32=function(Tu){return this._push(Su,4,Tu>>>0)},$u.prototype.sfixed32=$u.prototype.fixed32,$u.prototype.fixed64=function(Tu){var Pu=Z.from(Tu);return this._push(Su,4,Pu.lo)._push(Su,4,Pu.hi)},$u.prototype.sfixed64=$u.prototype.fixed64,$u.prototype.float=function(Tu){return this._push(F.float.writeFloatLE,4,Tu)},$u.prototype.double=function(Tu){return this._push(F.float.writeDoubleLE,8,Tu)};var Bu=F.Array.prototype.set?function(Tu,Pu,Uu){Pu.set(Tu,Uu)}:function(Tu,Pu,Uu){for(var Fu=0;Fu<Tu.length;++Fu)Pu[Uu+Fu]=Tu[Fu]};return $u.prototype.bytes=function(Tu){var Pu=Tu.length>>>0;if(!Pu)return this._push(Au,1,0);if(F.isString(Tu)){var Uu=$u.alloc(Pu=at.length(Tu));at.decode(Tu,Uu,0),Tu=Uu}return this.uint32(Pu)._push(Bu,Pu,Tu)},$u.prototype.string=function(Tu){var Pu=Hs.length(Tu);return Pu?this.uint32(Pu)._push(Hs.write,Pu,Tu):this._push(Au,1,0)},$u.prototype.fork=function(){return this.states=new Zs(this),this.head=this.tail=new zs(Ys,0,0),this.len=0,this},$u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new zs(Ys,0,0),this.len=0),this},$u.prototype.ldelim=function(){var Tu=this.head,Pu=this.tail,Uu=this.len;return this.reset().uint32(Uu),Uu&&(this.tail.next=Tu.next,this.tail=Pu,this.len+=Uu),this},$u.prototype.finish=function(){for(var Tu=this.head.next,Pu=this.constructor.alloc(this.len),Uu=0;Tu;)Tu.fn(Tu.val,Pu,Uu),Uu+=Tu.len,Tu=Tu.next;return Pu},$u._configure=function(Du){t=Du,$u.create=Eu(),t._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=Z;var F=requireWriter();(Z.prototype=Object.create(F.prototype)).constructor=Z;var t=requireMinimal$1();function Z(){F.call(this)}Z._configure=function(){Z.alloc=t._Buffer_allocUnsafe,Z.writeBytesBuffer=t.Buffer&&t.Buffer.prototype instanceof Uint8Array&&t.Buffer.prototype.set.name==="set"?function(zs,Ys,Zs){Ys.set(zs,Zs)}:function(zs,Ys,Zs){if(zs.copy)zs.copy(Ys,Zs,0,zs.length);else for(var $u=0;$u<zs.length;)Ys[Zs++]=zs[$u++]}},Z.prototype.bytes=function(zs){t.isString(zs)&&(zs=t._Buffer_from(zs,"base64"));var Ys=zs.length>>>0;return this.uint32(Ys),Ys&&this._push(Z.writeBytesBuffer,Ys,zs),this};function at(Hs,zs,Ys){Hs.length<40?t.utf8.write(Hs,zs,Ys):zs.utf8Write?zs.utf8Write(Hs,Ys):zs.write(Hs,Ys)}return Z.prototype.string=function(zs){var Ys=t.Buffer.byteLength(zs);return this.uint32(Ys),Ys&&this._push(at,Ys,zs),this},Z._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=zs;var F=requireMinimal$1(),t,Z=F.LongBits,at=F.utf8;function Hs(vu,Iu){return RangeError("index out of range: "+vu.pos+" + "+(Iu||1)+" > "+vu.len)}function zs(vu){this.buf=vu,this.pos=0,this.len=vu.length}var Ys=typeof Uint8Array<"u"?function(Iu){if(Iu instanceof Uint8Array||Array.isArray(Iu))return new zs(Iu);throw Error("illegal buffer")}:function(Iu){if(Array.isArray(Iu))return new zs(Iu);throw Error("illegal buffer")},Zs=function(){return F.Buffer?function(_u){return(zs.create=function(Bu){return F.Buffer.isBuffer(Bu)?new t(Bu):Ys(Bu)})(_u)}:Ys};zs.create=Zs(),zs.prototype._slice=F.Array.prototype.subarray||F.Array.prototype.slice,zs.prototype.uint32=function(){var Iu=4294967295;return function(){if(Iu=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(Iu=(Iu|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(Iu=(Iu|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(Iu=(Iu|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(Iu=(Iu|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return Iu;if((this.pos+=5)>this.len)throw this.pos=this.len,Hs(this,10);return Iu}}(),zs.prototype.int32=function(){return this.uint32()|0},zs.prototype.sint32=function(){var Iu=this.uint32();return Iu>>>1^-(Iu&1)|0};function $u(){var vu=new Z(0,0),Iu=0;if(this.len-this.pos>4){for(;Iu<4;++Iu)if(vu.lo=(vu.lo|(this.buf[this.pos]&127)<<Iu*7)>>>0,this.buf[this.pos++]<128)return vu;if(vu.lo=(vu.lo|(this.buf[this.pos]&127)<<28)>>>0,vu.hi=(vu.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return vu;Iu=0}else{for(;Iu<3;++Iu){if(this.pos>=this.len)throw Hs(this);if(vu.lo=(vu.lo|(this.buf[this.pos]&127)<<Iu*7)>>>0,this.buf[this.pos++]<128)return vu}return vu.lo=(vu.lo|(this.buf[this.pos++]&127)<<Iu*7)>>>0,vu}if(this.len-this.pos>4){for(;Iu<5;++Iu)if(vu.hi=(vu.hi|(this.buf[this.pos]&127)<<Iu*7+3)>>>0,this.buf[this.pos++]<128)return vu}else for(;Iu<5;++Iu){if(this.pos>=this.len)throw Hs(this);if(vu.hi=(vu.hi|(this.buf[this.pos]&127)<<Iu*7+3)>>>0,this.buf[this.pos++]<128)return vu}throw Error("invalid varint encoding")}zs.prototype.bool=function(){return this.uint32()!==0};function Eu(vu,Iu){return(vu[Iu-4]|vu[Iu-3]<<8|vu[Iu-2]<<16|vu[Iu-1]<<24)>>>0}zs.prototype.fixed32=function(){if(this.pos+4>this.len)throw Hs(this,4);return Eu(this.buf,this.pos+=4)},zs.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Hs(this,4);return Eu(this.buf,this.pos+=4)|0};function Au(){if(this.pos+8>this.len)throw Hs(this,8);return new Z(Eu(this.buf,this.pos+=4),Eu(this.buf,this.pos+=4))}return zs.prototype.float=function(){if(this.pos+4>this.len)throw Hs(this,4);var Iu=F.float.readFloatLE(this.buf,this.pos);return this.pos+=4,Iu},zs.prototype.double=function(){if(this.pos+8>this.len)throw Hs(this,4);var Iu=F.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,Iu},zs.prototype.bytes=function(){var Iu=this.uint32(),_u=this.pos,Su=this.pos+Iu;if(Su>this.len)throw Hs(this,Iu);if(this.pos+=Iu,Array.isArray(this.buf))return this.buf.slice(_u,Su);if(_u===Su){var Bu=F.Buffer;return Bu?Bu.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,_u,Su)},zs.prototype.string=function(){var Iu=this.bytes();return at.read(Iu,0,Iu.length)},zs.prototype.skip=function(Iu){if(typeof Iu=="number"){if(this.pos+Iu>this.len)throw Hs(this,Iu);this.pos+=Iu}else do if(this.pos>=this.len)throw Hs(this);while(this.buf[this.pos++]&128);return this},zs.prototype.skipType=function(vu){switch(vu){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(vu=this.uint32()&7)!==4;)this.skipType(vu);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+vu+" at offset "+this.pos)}return this},zs._configure=function(vu){t=vu,zs.create=Zs(),t._configure();var Iu=F.Long?"toLong":"toNumber";F.merge(zs.prototype,{int64:function(){return $u.call(this)[Iu](!1)},uint64:function(){return $u.call(this)[Iu](!0)},sint64:function(){return $u.call(this).zzDecode()[Iu](!1)},fixed64:function(){return Au.call(this)[Iu](!0)},sfixed64:function(){return Au.call(this)[Iu](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=Z;var F=requireReader();(Z.prototype=Object.create(F.prototype)).constructor=Z;var t=requireMinimal$1();function Z(at){F.call(this,at)}return Z._configure=function(){t.Buffer&&(Z.prototype._slice=t.Buffer.prototype.slice)},Z.prototype.string=function(){var Hs=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+Hs,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+Hs,this.len))},Z._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=t;var F=requireMinimal$1();(t.prototype=Object.create(F.EventEmitter.prototype)).constructor=t;function t(Z,at,Hs){if(typeof Z!="function")throw TypeError("rpcImpl must be a function");F.EventEmitter.call(this),this.rpcImpl=Z,this.requestDelimited=!!at,this.responseDelimited=!!Hs}return t.prototype.rpcCall=function Z(at,Hs,zs,Ys,Zs){if(!Ys)throw TypeError("request must be specified");var $u=this;if(!Zs)return F.asPromise(Z,$u,at,Hs,zs,Ys);if(!$u.rpcImpl){setTimeout(function(){Zs(Error("already ended"))},0);return}try{return $u.rpcImpl(at,Hs[$u.requestDelimited?"encodeDelimited":"encode"](Ys).finish(),function(Au,vu){if(Au)return $u.emit("error",Au,at),Zs(Au);if(vu===null){$u.end(!0);return}if(!(vu instanceof zs))try{vu=zs[$u.responseDelimited?"decodeDelimited":"decode"](vu)}catch(Iu){return $u.emit("error",Iu,at),Zs(Iu)}return $u.emit("data",vu,at),Zs(null,vu)})}catch(Eu){$u.emit("error",Eu,at),setTimeout(function(){Zs(Eu)},0);return}},t.prototype.end=function(at){return this.rpcImpl&&(at||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(F){var t=F;t.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(F){var t=F;t.build="minimal",t.Writer=requireWriter(),t.BufferWriter=requireWriter_buffer(),t.Reader=requireReader(),t.BufferReader=requireReader_buffer(),t.util=requireMinimal$1(),t.rpc=requireRpc(),t.roots=requireRoots(),t.configure=Z;function Z(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}Z()}(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var hasRequiredCompiled;function requireCompiled(){return hasRequiredCompiled||(hasRequiredCompiled=1,function(F){(function(t,Z){typeof commonjsRequire=="function"&&F&&F.exports&&(F.exports=Z(requireMinimal()))})(commonjsGlobal,function(t){var Z=t.Reader,at=t.Writer,Hs=t.util,zs=t.roots.default||(t.roots.default={});return zs.proto=function(){var Ys={};return Ys.Transaction=function(){function Zs($u){if($u)for(var Eu=Object.keys($u),Au=0;Au<Eu.length;++Au)$u[Eu[Au]]!=null&&(this[Eu[Au]]=$u[Eu[Au]])}return Zs.prototype.Nonce=Hs.Long?Hs.Long.fromBits(0,0,!0):0,Zs.prototype.Value=Hs.newBuffer([]),Zs.prototype.RcvAddr=Hs.newBuffer([]),Zs.prototype.RcvUserName=Hs.newBuffer([]),Zs.prototype.SndAddr=Hs.newBuffer([]),Zs.prototype.SndUserName=Hs.newBuffer([]),Zs.prototype.GasPrice=Hs.Long?Hs.Long.fromBits(0,0,!0):0,Zs.prototype.GasLimit=Hs.Long?Hs.Long.fromBits(0,0,!0):0,Zs.prototype.Data=Hs.newBuffer([]),Zs.prototype.ChainID=Hs.newBuffer([]),Zs.prototype.Version=0,Zs.prototype.Signature=Hs.newBuffer([]),Zs.prototype.Options=0,Zs.prototype.GuardianAddr=Hs.newBuffer([]),Zs.prototype.GuardianSignature=Hs.newBuffer([]),Zs.prototype.Relayer=Hs.newBuffer([]),Zs.prototype.RelayerSignature=Hs.newBuffer([]),Zs.create=function(Eu){return new Zs(Eu)},Zs.encode=function(Eu,Au){return Au||(Au=at.create()),Eu.Nonce!=null&&Object.hasOwnProperty.call(Eu,"Nonce")&&Au.uint32(8).uint64(Eu.Nonce),Eu.Value!=null&&Object.hasOwnProperty.call(Eu,"Value")&&Au.uint32(18).bytes(Eu.Value),Eu.RcvAddr!=null&&Object.hasOwnProperty.call(Eu,"RcvAddr")&&Au.uint32(26).bytes(Eu.RcvAddr),Eu.RcvUserName!=null&&Object.hasOwnProperty.call(Eu,"RcvUserName")&&Au.uint32(34).bytes(Eu.RcvUserName),Eu.SndAddr!=null&&Object.hasOwnProperty.call(Eu,"SndAddr")&&Au.uint32(42).bytes(Eu.SndAddr),Eu.SndUserName!=null&&Object.hasOwnProperty.call(Eu,"SndUserName")&&Au.uint32(50).bytes(Eu.SndUserName),Eu.GasPrice!=null&&Object.hasOwnProperty.call(Eu,"GasPrice")&&Au.uint32(56).uint64(Eu.GasPrice),Eu.GasLimit!=null&&Object.hasOwnProperty.call(Eu,"GasLimit")&&Au.uint32(64).uint64(Eu.GasLimit),Eu.Data!=null&&Object.hasOwnProperty.call(Eu,"Data")&&Au.uint32(74).bytes(Eu.Data),Eu.ChainID!=null&&Object.hasOwnProperty.call(Eu,"ChainID")&&Au.uint32(82).bytes(Eu.ChainID),Eu.Version!=null&&Object.hasOwnProperty.call(Eu,"Version")&&Au.uint32(88).uint32(Eu.Version),Eu.Signature!=null&&Object.hasOwnProperty.call(Eu,"Signature")&&Au.uint32(98).bytes(Eu.Signature),Eu.Options!=null&&Object.hasOwnProperty.call(Eu,"Options")&&Au.uint32(104).uint32(Eu.Options),Eu.GuardianAddr!=null&&Object.hasOwnProperty.call(Eu,"GuardianAddr")&&Au.uint32(114).bytes(Eu.GuardianAddr),Eu.GuardianSignature!=null&&Object.hasOwnProperty.call(Eu,"GuardianSignature")&&Au.uint32(122).bytes(Eu.GuardianSignature),Eu.Relayer!=null&&Object.hasOwnProperty.call(Eu,"Relayer")&&Au.uint32(130).bytes(Eu.Relayer),Eu.RelayerSignature!=null&&Object.hasOwnProperty.call(Eu,"RelayerSignature")&&Au.uint32(138).bytes(Eu.RelayerSignature),Au},Zs.encodeDelimited=function(Eu,Au){return this.encode(Eu,Au).ldelim()},Zs.decode=function(Eu,Au){Eu instanceof Z||(Eu=Z.create(Eu));for(var vu=Au===void 0?Eu.len:Eu.pos+Au,Iu=new zs.proto.Transaction;Eu.pos<vu;){var _u=Eu.uint32();switch(_u>>>3){case 1:{Iu.Nonce=Eu.uint64();break}case 2:{Iu.Value=Eu.bytes();break}case 3:{Iu.RcvAddr=Eu.bytes();break}case 4:{Iu.RcvUserName=Eu.bytes();break}case 5:{Iu.SndAddr=Eu.bytes();break}case 6:{Iu.SndUserName=Eu.bytes();break}case 7:{Iu.GasPrice=Eu.uint64();break}case 8:{Iu.GasLimit=Eu.uint64();break}case 9:{Iu.Data=Eu.bytes();break}case 10:{Iu.ChainID=Eu.bytes();break}case 11:{Iu.Version=Eu.uint32();break}case 12:{Iu.Signature=Eu.bytes();break}case 13:{Iu.Options=Eu.uint32();break}case 14:{Iu.GuardianAddr=Eu.bytes();break}case 15:{Iu.GuardianSignature=Eu.bytes();break}case 16:{Iu.Relayer=Eu.bytes();break}case 17:{Iu.RelayerSignature=Eu.bytes();break}default:Eu.skipType(_u&7);break}}return Iu},Zs.decodeDelimited=function(Eu){return Eu instanceof Z||(Eu=new Z(Eu)),this.decode(Eu,Eu.uint32())},Zs.verify=function(Eu){return typeof Eu!="object"||Eu===null?"object expected":Eu.Nonce!=null&&Eu.hasOwnProperty("Nonce")&&!Hs.isInteger(Eu.Nonce)&&!(Eu.Nonce&&Hs.isInteger(Eu.Nonce.low)&&Hs.isInteger(Eu.Nonce.high))?"Nonce: integer|Long expected":Eu.Value!=null&&Eu.hasOwnProperty("Value")&&!(Eu.Value&&typeof Eu.Value.length=="number"||Hs.isString(Eu.Value))?"Value: buffer expected":Eu.RcvAddr!=null&&Eu.hasOwnProperty("RcvAddr")&&!(Eu.RcvAddr&&typeof Eu.RcvAddr.length=="number"||Hs.isString(Eu.RcvAddr))?"RcvAddr: buffer expected":Eu.RcvUserName!=null&&Eu.hasOwnProperty("RcvUserName")&&!(Eu.RcvUserName&&typeof Eu.RcvUserName.length=="number"||Hs.isString(Eu.RcvUserName))?"RcvUserName: buffer expected":Eu.SndAddr!=null&&Eu.hasOwnProperty("SndAddr")&&!(Eu.SndAddr&&typeof Eu.SndAddr.length=="number"||Hs.isString(Eu.SndAddr))?"SndAddr: buffer expected":Eu.SndUserName!=null&&Eu.hasOwnProperty("SndUserName")&&!(Eu.SndUserName&&typeof Eu.SndUserName.length=="number"||Hs.isString(Eu.SndUserName))?"SndUserName: buffer expected":Eu.GasPrice!=null&&Eu.hasOwnProperty("GasPrice")&&!Hs.isInteger(Eu.GasPrice)&&!(Eu.GasPrice&&Hs.isInteger(Eu.GasPrice.low)&&Hs.isInteger(Eu.GasPrice.high))?"GasPrice: integer|Long expected":Eu.GasLimit!=null&&Eu.hasOwnProperty("GasLimit")&&!Hs.isInteger(Eu.GasLimit)&&!(Eu.GasLimit&&Hs.isInteger(Eu.GasLimit.low)&&Hs.isInteger(Eu.GasLimit.high))?"GasLimit: integer|Long expected":Eu.Data!=null&&Eu.hasOwnProperty("Data")&&!(Eu.Data&&typeof Eu.Data.length=="number"||Hs.isString(Eu.Data))?"Data: buffer expected":Eu.ChainID!=null&&Eu.hasOwnProperty("ChainID")&&!(Eu.ChainID&&typeof Eu.ChainID.length=="number"||Hs.isString(Eu.ChainID))?"ChainID: buffer expected":Eu.Version!=null&&Eu.hasOwnProperty("Version")&&!Hs.isInteger(Eu.Version)?"Version: integer expected":Eu.Signature!=null&&Eu.hasOwnProperty("Signature")&&!(Eu.Signature&&typeof Eu.Signature.length=="number"||Hs.isString(Eu.Signature))?"Signature: buffer expected":Eu.Options!=null&&Eu.hasOwnProperty("Options")&&!Hs.isInteger(Eu.Options)?"Options: integer expected":Eu.GuardianAddr!=null&&Eu.hasOwnProperty("GuardianAddr")&&!(Eu.GuardianAddr&&typeof Eu.GuardianAddr.length=="number"||Hs.isString(Eu.GuardianAddr))?"GuardianAddr: buffer expected":Eu.GuardianSignature!=null&&Eu.hasOwnProperty("GuardianSignature")&&!(Eu.GuardianSignature&&typeof Eu.GuardianSignature.length=="number"||Hs.isString(Eu.GuardianSignature))?"GuardianSignature: buffer expected":Eu.Relayer!=null&&Eu.hasOwnProperty("Relayer")&&!(Eu.Relayer&&typeof Eu.Relayer.length=="number"||Hs.isString(Eu.Relayer))?"Relayer: buffer expected":Eu.RelayerSignature!=null&&Eu.hasOwnProperty("RelayerSignature")&&!(Eu.RelayerSignature&&typeof Eu.RelayerSignature.length=="number"||Hs.isString(Eu.RelayerSignature))?"RelayerSignature: buffer expected":null},Zs.fromObject=function(Eu){if(Eu instanceof zs.proto.Transaction)return Eu;var Au=new zs.proto.Transaction;return Eu.Nonce!=null&&(Hs.Long?(Au.Nonce=Hs.Long.fromValue(Eu.Nonce)).unsigned=!0:typeof Eu.Nonce=="string"?Au.Nonce=parseInt(Eu.Nonce,10):typeof Eu.Nonce=="number"?Au.Nonce=Eu.Nonce:typeof Eu.Nonce=="object"&&(Au.Nonce=new Hs.LongBits(Eu.Nonce.low>>>0,Eu.Nonce.high>>>0).toNumber(!0))),Eu.Value!=null&&(typeof Eu.Value=="string"?Hs.base64.decode(Eu.Value,Au.Value=Hs.newBuffer(Hs.base64.length(Eu.Value)),0):Eu.Value.length>=0&&(Au.Value=Eu.Value)),Eu.RcvAddr!=null&&(typeof Eu.RcvAddr=="string"?Hs.base64.decode(Eu.RcvAddr,Au.RcvAddr=Hs.newBuffer(Hs.base64.length(Eu.RcvAddr)),0):Eu.RcvAddr.length>=0&&(Au.RcvAddr=Eu.RcvAddr)),Eu.RcvUserName!=null&&(typeof Eu.RcvUserName=="string"?Hs.base64.decode(Eu.RcvUserName,Au.RcvUserName=Hs.newBuffer(Hs.base64.length(Eu.RcvUserName)),0):Eu.RcvUserName.length>=0&&(Au.RcvUserName=Eu.RcvUserName)),Eu.SndAddr!=null&&(typeof Eu.SndAddr=="string"?Hs.base64.decode(Eu.SndAddr,Au.SndAddr=Hs.newBuffer(Hs.base64.length(Eu.SndAddr)),0):Eu.SndAddr.length>=0&&(Au.SndAddr=Eu.SndAddr)),Eu.SndUserName!=null&&(typeof Eu.SndUserName=="string"?Hs.base64.decode(Eu.SndUserName,Au.SndUserName=Hs.newBuffer(Hs.base64.length(Eu.SndUserName)),0):Eu.SndUserName.length>=0&&(Au.SndUserName=Eu.SndUserName)),Eu.GasPrice!=null&&(Hs.Long?(Au.GasPrice=Hs.Long.fromValue(Eu.GasPrice)).unsigned=!0:typeof Eu.GasPrice=="string"?Au.GasPrice=parseInt(Eu.GasPrice,10):typeof Eu.GasPrice=="number"?Au.GasPrice=Eu.GasPrice:typeof Eu.GasPrice=="object"&&(Au.GasPrice=new Hs.LongBits(Eu.GasPrice.low>>>0,Eu.GasPrice.high>>>0).toNumber(!0))),Eu.GasLimit!=null&&(Hs.Long?(Au.GasLimit=Hs.Long.fromValue(Eu.GasLimit)).unsigned=!0:typeof Eu.GasLimit=="string"?Au.GasLimit=parseInt(Eu.GasLimit,10):typeof Eu.GasLimit=="number"?Au.GasLimit=Eu.GasLimit:typeof Eu.GasLimit=="object"&&(Au.GasLimit=new Hs.LongBits(Eu.GasLimit.low>>>0,Eu.GasLimit.high>>>0).toNumber(!0))),Eu.Data!=null&&(typeof Eu.Data=="string"?Hs.base64.decode(Eu.Data,Au.Data=Hs.newBuffer(Hs.base64.length(Eu.Data)),0):Eu.Data.length>=0&&(Au.Data=Eu.Data)),Eu.ChainID!=null&&(typeof Eu.ChainID=="string"?Hs.base64.decode(Eu.ChainID,Au.ChainID=Hs.newBuffer(Hs.base64.length(Eu.ChainID)),0):Eu.ChainID.length>=0&&(Au.ChainID=Eu.ChainID)),Eu.Version!=null&&(Au.Version=Eu.Version>>>0),Eu.Signature!=null&&(typeof Eu.Signature=="string"?Hs.base64.decode(Eu.Signature,Au.Signature=Hs.newBuffer(Hs.base64.length(Eu.Signature)),0):Eu.Signature.length>=0&&(Au.Signature=Eu.Signature)),Eu.Options!=null&&(Au.Options=Eu.Options>>>0),Eu.GuardianAddr!=null&&(typeof Eu.GuardianAddr=="string"?Hs.base64.decode(Eu.GuardianAddr,Au.GuardianAddr=Hs.newBuffer(Hs.base64.length(Eu.GuardianAddr)),0):Eu.GuardianAddr.length>=0&&(Au.GuardianAddr=Eu.GuardianAddr)),Eu.GuardianSignature!=null&&(typeof Eu.GuardianSignature=="string"?Hs.base64.decode(Eu.GuardianSignature,Au.GuardianSignature=Hs.newBuffer(Hs.base64.length(Eu.GuardianSignature)),0):Eu.GuardianSignature.length>=0&&(Au.GuardianSignature=Eu.GuardianSignature)),Eu.Relayer!=null&&(typeof Eu.Relayer=="string"?Hs.base64.decode(Eu.Relayer,Au.Relayer=Hs.newBuffer(Hs.base64.length(Eu.Relayer)),0):Eu.Relayer.length>=0&&(Au.Relayer=Eu.Relayer)),Eu.RelayerSignature!=null&&(typeof Eu.RelayerSignature=="string"?Hs.base64.decode(Eu.RelayerSignature,Au.RelayerSignature=Hs.newBuffer(Hs.base64.length(Eu.RelayerSignature)),0):Eu.RelayerSignature.length>=0&&(Au.RelayerSignature=Eu.RelayerSignature)),Au},Zs.toObject=function(Eu,Au){Au||(Au={});var vu={};if(Au.defaults){if(Hs.Long){var Iu=new Hs.Long(0,0,!0);vu.Nonce=Au.longs===String?Iu.toString():Au.longs===Number?Iu.toNumber():Iu}else vu.Nonce=Au.longs===String?"0":0;if(Au.bytes===String?vu.Value="":(vu.Value=[],Au.bytes!==Array&&(vu.Value=Hs.newBuffer(vu.Value))),Au.bytes===String?vu.RcvAddr="":(vu.RcvAddr=[],Au.bytes!==Array&&(vu.RcvAddr=Hs.newBuffer(vu.RcvAddr))),Au.bytes===String?vu.RcvUserName="":(vu.RcvUserName=[],Au.bytes!==Array&&(vu.RcvUserName=Hs.newBuffer(vu.RcvUserName))),Au.bytes===String?vu.SndAddr="":(vu.SndAddr=[],Au.bytes!==Array&&(vu.SndAddr=Hs.newBuffer(vu.SndAddr))),Au.bytes===String?vu.SndUserName="":(vu.SndUserName=[],Au.bytes!==Array&&(vu.SndUserName=Hs.newBuffer(vu.SndUserName))),Hs.Long){var Iu=new Hs.Long(0,0,!0);vu.GasPrice=Au.longs===String?Iu.toString():Au.longs===Number?Iu.toNumber():Iu}else vu.GasPrice=Au.longs===String?"0":0;if(Hs.Long){var Iu=new Hs.Long(0,0,!0);vu.GasLimit=Au.longs===String?Iu.toString():Au.longs===Number?Iu.toNumber():Iu}else vu.GasLimit=Au.longs===String?"0":0;Au.bytes===String?vu.Data="":(vu.Data=[],Au.bytes!==Array&&(vu.Data=Hs.newBuffer(vu.Data))),Au.bytes===String?vu.ChainID="":(vu.ChainID=[],Au.bytes!==Array&&(vu.ChainID=Hs.newBuffer(vu.ChainID))),vu.Version=0,Au.bytes===String?vu.Signature="":(vu.Signature=[],Au.bytes!==Array&&(vu.Signature=Hs.newBuffer(vu.Signature))),vu.Options=0,Au.bytes===String?vu.GuardianAddr="":(vu.GuardianAddr=[],Au.bytes!==Array&&(vu.GuardianAddr=Hs.newBuffer(vu.GuardianAddr))),Au.bytes===String?vu.GuardianSignature="":(vu.GuardianSignature=[],Au.bytes!==Array&&(vu.GuardianSignature=Hs.newBuffer(vu.GuardianSignature))),Au.bytes===String?vu.Relayer="":(vu.Relayer=[],Au.bytes!==Array&&(vu.Relayer=Hs.newBuffer(vu.Relayer))),Au.bytes===String?vu.RelayerSignature="":(vu.RelayerSignature=[],Au.bytes!==Array&&(vu.RelayerSignature=Hs.newBuffer(vu.RelayerSignature)))}return Eu.Nonce!=null&&Eu.hasOwnProperty("Nonce")&&(typeof Eu.Nonce=="number"?vu.Nonce=Au.longs===String?String(Eu.Nonce):Eu.Nonce:vu.Nonce=Au.longs===String?Hs.Long.prototype.toString.call(Eu.Nonce):Au.longs===Number?new Hs.LongBits(Eu.Nonce.low>>>0,Eu.Nonce.high>>>0).toNumber(!0):Eu.Nonce),Eu.Value!=null&&Eu.hasOwnProperty("Value")&&(vu.Value=Au.bytes===String?Hs.base64.encode(Eu.Value,0,Eu.Value.length):Au.bytes===Array?Array.prototype.slice.call(Eu.Value):Eu.Value),Eu.RcvAddr!=null&&Eu.hasOwnProperty("RcvAddr")&&(vu.RcvAddr=Au.bytes===String?Hs.base64.encode(Eu.RcvAddr,0,Eu.RcvAddr.length):Au.bytes===Array?Array.prototype.slice.call(Eu.RcvAddr):Eu.RcvAddr),Eu.RcvUserName!=null&&Eu.hasOwnProperty("RcvUserName")&&(vu.RcvUserName=Au.bytes===String?Hs.base64.encode(Eu.RcvUserName,0,Eu.RcvUserName.length):Au.bytes===Array?Array.prototype.slice.call(Eu.RcvUserName):Eu.RcvUserName),Eu.SndAddr!=null&&Eu.hasOwnProperty("SndAddr")&&(vu.SndAddr=Au.bytes===String?Hs.base64.encode(Eu.SndAddr,0,Eu.SndAddr.length):Au.bytes===Array?Array.prototype.slice.call(Eu.SndAddr):Eu.SndAddr),Eu.SndUserName!=null&&Eu.hasOwnProperty("SndUserName")&&(vu.SndUserName=Au.bytes===String?Hs.base64.encode(Eu.SndUserName,0,Eu.SndUserName.length):Au.bytes===Array?Array.prototype.slice.call(Eu.SndUserName):Eu.SndUserName),Eu.GasPrice!=null&&Eu.hasOwnProperty("GasPrice")&&(typeof Eu.GasPrice=="number"?vu.GasPrice=Au.longs===String?String(Eu.GasPrice):Eu.GasPrice:vu.GasPrice=Au.longs===String?Hs.Long.prototype.toString.call(Eu.GasPrice):Au.longs===Number?new Hs.LongBits(Eu.GasPrice.low>>>0,Eu.GasPrice.high>>>0).toNumber(!0):Eu.GasPrice),Eu.GasLimit!=null&&Eu.hasOwnProperty("GasLimit")&&(typeof Eu.GasLimit=="number"?vu.GasLimit=Au.longs===String?String(Eu.GasLimit):Eu.GasLimit:vu.GasLimit=Au.longs===String?Hs.Long.prototype.toString.call(Eu.GasLimit):Au.longs===Number?new Hs.LongBits(Eu.GasLimit.low>>>0,Eu.GasLimit.high>>>0).toNumber(!0):Eu.GasLimit),Eu.Data!=null&&Eu.hasOwnProperty("Data")&&(vu.Data=Au.bytes===String?Hs.base64.encode(Eu.Data,0,Eu.Data.length):Au.bytes===Array?Array.prototype.slice.call(Eu.Data):Eu.Data),Eu.ChainID!=null&&Eu.hasOwnProperty("ChainID")&&(vu.ChainID=Au.bytes===String?Hs.base64.encode(Eu.ChainID,0,Eu.ChainID.length):Au.bytes===Array?Array.prototype.slice.call(Eu.ChainID):Eu.ChainID),Eu.Version!=null&&Eu.hasOwnProperty("Version")&&(vu.Version=Eu.Version),Eu.Signature!=null&&Eu.hasOwnProperty("Signature")&&(vu.Signature=Au.bytes===String?Hs.base64.encode(Eu.Signature,0,Eu.Signature.length):Au.bytes===Array?Array.prototype.slice.call(Eu.Signature):Eu.Signature),Eu.Options!=null&&Eu.hasOwnProperty("Options")&&(vu.Options=Eu.Options),Eu.GuardianAddr!=null&&Eu.hasOwnProperty("GuardianAddr")&&(vu.GuardianAddr=Au.bytes===String?Hs.base64.encode(Eu.GuardianAddr,0,Eu.GuardianAddr.length):Au.bytes===Array?Array.prototype.slice.call(Eu.GuardianAddr):Eu.GuardianAddr),Eu.GuardianSignature!=null&&Eu.hasOwnProperty("GuardianSignature")&&(vu.GuardianSignature=Au.bytes===String?Hs.base64.encode(Eu.GuardianSignature,0,Eu.GuardianSignature.length):Au.bytes===Array?Array.prototype.slice.call(Eu.GuardianSignature):Eu.GuardianSignature),Eu.Relayer!=null&&Eu.hasOwnProperty("Relayer")&&(vu.Relayer=Au.bytes===String?Hs.base64.encode(Eu.Relayer,0,Eu.Relayer.length):Au.bytes===Array?Array.prototype.slice.call(Eu.Relayer):Eu.Relayer),Eu.RelayerSignature!=null&&Eu.hasOwnProperty("RelayerSignature")&&(vu.RelayerSignature=Au.bytes===String?Hs.base64.encode(Eu.RelayerSignature,0,Eu.RelayerSignature.length):Au.bytes===Array?Array.prototype.slice.call(Eu.RelayerSignature):Eu.RelayerSignature),vu},Zs.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},Zs.getTypeUrl=function(Eu){return Eu===void 0&&(Eu="type.googleapis.com"),Eu+"/proto.Transaction"},Zs}(),Ys}(),zs})}(compiled)),compiled.exports}var __createBinding$1=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(F,t,Z,at){at===void 0&&(at=Z),Object.defineProperty(F,at,{enumerable:!0,get:function(){return t[Z]}})}:function(F,t,Z,at){at===void 0&&(at=Z),F[at]=t[Z]}),__setModuleDefault$1=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(F,t){Object.defineProperty(F,"default",{enumerable:!0,value:t})}:function(F,t){F.default=t}),__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(F){if(F&&F.__esModule)return F;var t={};if(F!=null)for(var Z in F)Z!=="default"&&Object.prototype.hasOwnProperty.call(F,Z)&&__createBinding$1(t,F,Z);return __setModuleDefault$1(t,F),t},__importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(serializer,"__esModule",{value:!0});serializer.ProtoSerializer=void 0;const bignumber_js_1$1=__importDefault$1(bignumberExports),utils_1=requireUtils$1(),address_1$2=address,constants_1$2=constants$2,errors$2=__importStar$1(errors$5);class ProtoSerializer{serializeTransaction(t){const Z=requireCompiled().proto,at=this.convertToProtoMessage(t),Hs=Z.Transaction.encode(at).finish();return Buffer.from(Hs)}convertToProtoMessage(t){var Ys;const Z=requireCompiled().proto,at=t.receiver.getPublicKey(),Hs=t.sender.getPublicKey();let zs=new Z.Transaction({Nonce:Number(t.nonce)?Number(t.nonce):void 0,Value:this.serializeTransactionValue(t.value),RcvAddr:at,RcvUserName:t.receiverUsername?Buffer.from(t.receiverUsername).toString("base64"):void 0,SndAddr:Hs,SndUserName:t.senderUsername?Buffer.from(t.senderUsername).toString("base64"):void 0,GasPrice:Number(t.gasPrice),GasLimit:Number(t.gasLimit),Data:t.data.length==0?null:t.data,ChainID:Buffer.from(t.chainID),Version:t.version,Signature:t.signature});return t.options!==constants_1$2.TRANSACTION_OPTIONS_DEFAULT&&(zs.Options=t.options),this.isGuardedTransaction(t)&&(zs.GuardianAddr=new address_1$2.Address(t.guardian).getPublicKey(),zs.GuardianSignature=t.guardianSignature),this.isRelayedTransaction(t)&&(zs.Relayer=(Ys=t.relayer)==null?void 0:Ys.getPublicKey(),zs.RelayerSignature=t.relayerSignature),zs}isRelayedTransaction(t){return!t.relayer.isEmpty()}serializeTransactionValue(t){let Z=new bignumber_js_1$1.default(t.toString());if(Z.isZero())return Buffer.from([0,0]);let at=utils_1.bigIntToBuffer(Z);return at=Buffer.concat([Buffer.from([0]),at]),at}isGuardedTransaction(t){const Z=!t.guardian.isEmpty(),at=t.guardianSignature.length>0;return this.isWithGuardian(t)&&Z&&at}isWithGuardian(t){return(t.options&constants_1$2.TRANSACTION_OPTIONS_TX_GUARDED)==constants_1$2.TRANSACTION_OPTIONS_TX_GUARDED}deserializeTransaction(t){throw new errors$2.ErrUnsupportedOperation("deserializeTransaction")}}serializer.ProtoSerializer=ProtoSerializer;(function(F){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(at,Hs,zs,Ys){Ys===void 0&&(Ys=zs),Object.defineProperty(at,Ys,{enumerable:!0,get:function(){return Hs[zs]}})}:function(at,Hs,zs,Ys){Ys===void 0&&(Ys=zs),at[Ys]=Hs[zs]}),Z=commonjsGlobal&&commonjsGlobal.__exportStar||function(at,Hs){for(var zs in at)zs!=="default"&&!Object.prototype.hasOwnProperty.call(Hs,zs)&&t(Hs,at,zs)};Object.defineProperty(F,"__esModule",{value:!0}),Z(serializer,F)})(proto);var blake2b$1={exports:{}};assert$2.notEqual=notEqual;assert$2.notOk=notOk;assert$2.equal=equal;assert$2.ok=assert$2;var nanoassert=assert$2;function equal(F,t,Z){assert$2(F==t,Z)}function notEqual(F,t,Z){assert$2(F!=t,Z)}function notOk(F,t){assert$2(!F,t)}function assert$2(F,t){if(!F)throw new Error(t||"AssertionError")}var blake2bWasm={exports:{}},blake2b=loadWebAssembly;loadWebAssembly.supported=typeof WebAssembly<"u";function loadWebAssembly(F){if(!loadWebAssembly.supported)return null;var t=F&&F.imports,Z=toUint8Array("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMK00AElgMAIABCADcDACAAQQhqQgA3AwAgAEEQakIANwMAIABBGGpCADcDACAAQSBqQgA3AwAgAEEoakIANwMAIABBMGpCADcDACAAQThqQgA3AwAgAEHAAGpCADcDACAAQcgAakIANwMAIABB0ABqQgA3AwAgAEHYAGpCADcDACAAQeAAakIANwMAIABB6ABqQgA3AwAgAEHwAGpCADcDACAAQfgAakIANwMAIABBgAFqQoiS853/zPmE6gBBACkDAIU3AwAgAEGIAWpCu86qptjQ67O7f0EIKQMAhTcDACAAQZABakKr8NP0r+68tzxBECkDAIU3AwAgAEGYAWpC8e30+KWn/aelf0EYKQMAhTcDACAAQaABakLRhZrv+s+Uh9EAQSApAwCFNwMAIABBqAFqQp/Y+dnCkdqCm39BKCkDAIU3AwAgAEGwAWpC6/qG2r+19sEfQTApAwCFNwMAIABBuAFqQvnC+JuRo7Pw2wBBOCkDAIU3AwAgAEHAAWpCADcDACAAQcgBakIANwMAIABB0AFqQgA3AwALbQEDfyAAQcABaiEDIABByAFqIQQgBCkDAKchBQJAA0AgASACRg0BIAVBgAFGBEAgAyADKQMAIAWtfDcDAEEAIQUgABADCyAAIAVqIAEtAAA6AAAgBUEBaiEFIAFBAWohAQwACwsgBCAFrTcDAAtkAQN/IABBwAFqIQEgAEHIAWohAiABIAEpAwAgAikDAHw3AwAgAEHQAWpCfzcDACACKQMApyEDAkADQCADQYABRg0BIAAgA2pBADoAACADQQFqIQMMAAsLIAIgA603AwAgABADC+U7AiB+CX8gAEGAAWohISAAQYgBaiEiIABBkAFqISMgAEGYAWohJCAAQaABaiElIABBqAFqISYgAEGwAWohJyAAQbgBaiEoICEpAwAhASAiKQMAIQIgIykDACEDICQpAwAhBCAlKQMAIQUgJikDACEGICcpAwAhByAoKQMAIQhCiJLznf/M+YTqACEJQrvOqqbY0Ouzu38hCkKr8NP0r+68tzwhC0Lx7fT4paf9p6V/IQxC0YWa7/rPlIfRACENQp/Y+dnCkdqCm38hDkLr+obav7X2wR8hD0L5wvibkaOz8NsAIRAgACkDACERIABBCGopAwAhEiAAQRBqKQMAIRMgAEEYaikDACEUIABBIGopAwAhFSAAQShqKQMAIRYgAEEwaikDACEXIABBOGopAwAhGCAAQcAAaikDACEZIABByABqKQMAIRogAEHQAGopAwAhGyAAQdgAaikDACEcIABB4ABqKQMAIR0gAEHoAGopAwAhHiAAQfAAaikDACEfIABB+ABqKQMAISAgDSAAQcABaikDAIUhDSAPIABB0AFqKQMAhSEPIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBx8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAZfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgHXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBF8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAWfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgE3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIICB8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAefHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgG3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIB98fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAUfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgF3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBh8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCASfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBV8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAYfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgGnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBR8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiASfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIB18fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAcfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggH3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBN8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAXfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgFnx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBt8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAVfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggEXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFICB8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAZfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgGnx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBF8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAWfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGHx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBN8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAVfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggG3x8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIICB8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAffHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgEnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBx8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAdfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggF3x8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBl8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAUfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgHnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBN8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAdfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgF3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBt8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByARfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHHx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBl8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAUfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgFXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIB58fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAYfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFnx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIICB8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAffHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgEnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBp8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAdfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgFnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBJ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAgfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgH3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIB58fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAVfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggG3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBF8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAYfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgF3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBR8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAafHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggE3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBl8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAcfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHnx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBx8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAYfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgH3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIB18fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByASfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggFHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBp8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAWfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgEXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHICB8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAVfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGXx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBd8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSATfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgG3x8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBd8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAgfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgH3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBp8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAcfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFHx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBF8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAZfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgHXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBN8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAefHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgGHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBJ8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAVfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgG3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBZ8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAbfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgE3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBl8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAVfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGHx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBd8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCASfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggFnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGICB8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAcfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgGnx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB98fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAUfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB58fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSARfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgEXx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBJ8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiATfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgFHx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBV8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAWfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggF3x8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBh8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAZfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgGnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBt8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAcfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHXx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB58fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAffHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgIHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB98fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAbfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBl8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAafHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgIHx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIB58fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAXfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEnx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIB18fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByARfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgE3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBx8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAYfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgFnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBR8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFICEgISkDACABIAmFhTcDACAiICIpAwAgAiAKhYU3AwAgIyAjKQMAIAMgC4WFNwMAICQgJCkDACAEIAyFhTcDACAlICUpAwAgBSANhYU3AwAgJiAmKQMAIAYgDoWFNwMAICcgJykDACAHIA+FhTcDACAoICgpAwAgCCAQhYU3AwAL"),at=null,Hs={buffer:Z,memory:null,exports:null,realloc:zs,onload:Ys};return Ys(function(){}),Hs;function zs($u){Hs.exports.memory.grow(Math.ceil(Math.abs($u-Hs.memory.length)/65536)),Hs.memory=new Uint8Array(Hs.exports.memory.buffer)}function Ys($u){if(Hs.exports)return $u();if(at){at.then($u.bind(null,null)).catch($u);return}try{if(F&&F.async)throw new Error("async");Zs({instance:new WebAssembly.Instance(new WebAssembly.Module(Z),t)})}catch{at=WebAssembly.instantiate(Z,t).then(Zs)}Ys($u)}function Zs($u){Hs.exports=$u.instance.exports,Hs.memory=Hs.exports.memory&&Hs.exports.memory.buffer&&new Uint8Array(Hs.exports.memory.buffer)}}function toUint8Array(F){return typeof atob=="function"?new Uint8Array(atob(F).split("").map(charCodeAt)):new(commonjsRequire("buffer")).Buffer(F,"base64")}function charCodeAt(F){return F.charCodeAt(0)}var assert$1=nanoassert,wasm=blake2b(),head=64,freeList=[];blake2bWasm.exports=Blake2b$1;var BYTES_MIN$1=blake2bWasm.exports.BYTES_MIN=16,BYTES_MAX$1=blake2bWasm.exports.BYTES_MAX=64;blake2bWasm.exports.BYTES=32;var KEYBYTES_MIN$1=blake2bWasm.exports.KEYBYTES_MIN=16,KEYBYTES_MAX$1=blake2bWasm.exports.KEYBYTES_MAX=64;blake2bWasm.exports.KEYBYTES=32;var SALTBYTES$1=blake2bWasm.exports.SALTBYTES=16,PERSONALBYTES$1=blake2bWasm.exports.PERSONALBYTES=16;function Blake2b$1(F,t,Z,at,Hs){if(!(this instanceof Blake2b$1))return new Blake2b$1(F,t,Z,at,Hs);if(!(wasm&&wasm.exports))throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");F||(F=32),Hs!==!0&&(assert$1(F>=BYTES_MIN$1,"digestLength must be at least "+BYTES_MIN$1+", was given "+F),assert$1(F<=BYTES_MAX$1,"digestLength must be at most "+BYTES_MAX$1+", was given "+F),t!=null&&assert$1(t.length>=KEYBYTES_MIN$1,"key must be at least "+KEYBYTES_MIN$1+", was given "+t.length),t!=null&&assert$1(t.length<=KEYBYTES_MAX$1,"key must be at least "+KEYBYTES_MAX$1+", was given "+t.length),Z!=null&&assert$1(Z.length===SALTBYTES$1,"salt must be exactly "+SALTBYTES$1+", was given "+Z.length),at!=null&&assert$1(at.length===PERSONALBYTES$1,"personal must be exactly "+PERSONALBYTES$1+", was given "+at.length)),freeList.length||(freeList.push(head),head+=216),this.digestLength=F,this.finalized=!1,this.pointer=freeList.pop(),wasm.memory.fill(0,0,64),wasm.memory[0]=this.digestLength,wasm.memory[1]=t?t.length:0,wasm.memory[2]=1,wasm.memory[3]=1,Z&&wasm.memory.set(Z,32),at&&wasm.memory.set(at,48),this.pointer+216>wasm.memory.length&&wasm.realloc(this.pointer+216),wasm.exports.blake2b_init(this.pointer,this.digestLength),t&&(this.update(t),wasm.memory.fill(0,head,head+t.length),wasm.memory[this.pointer+200]=128)}Blake2b$1.prototype.update=function(F){return assert$1(this.finalized===!1,"Hash instance finalized"),assert$1(F,"input must be TypedArray or Buffer"),head+F.length>wasm.memory.length&&wasm.realloc(head+F.length),wasm.memory.set(F,head),wasm.exports.blake2b_update(this.pointer,head,head+F.length),this};Blake2b$1.prototype.digest=function(F){if(assert$1(this.finalized===!1,"Hash instance finalized"),this.finalized=!0,freeList.push(this.pointer),wasm.exports.blake2b_final(this.pointer),!F||F==="binary")return wasm.memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if(F==="hex")return hexSlice$1(wasm.memory,this.pointer+128,this.digestLength);assert$1(F.length>=this.digestLength,"input must be TypedArray or Buffer");for(var t=0;t<this.digestLength;t++)F[t]=wasm.memory[this.pointer+128+t];return F};Blake2b$1.prototype.final=Blake2b$1.prototype.digest;Blake2b$1.WASM=wasm&&wasm.buffer;Blake2b$1.SUPPORTED=typeof WebAssembly<"u";Blake2b$1.ready=function(F){if(F||(F=noop),!wasm)return F(new Error("WebAssembly not supported"));var t=new Promise(function(Z,at){wasm.onload(function(Hs){Hs?at():Z(),F(Hs)})});return t};Blake2b$1.prototype.ready=Blake2b$1.ready;function noop(){}function hexSlice$1(F,t,Z){for(var at="",Hs=0;Hs<Z;Hs++)at+=toHex$1(F[t+Hs]);return at}function toHex$1(F){return F<16?"0"+F.toString(16):F.toString(16)}var blake2bWasmExports=blake2bWasm.exports,assert=nanoassert,b2wasm=blake2bWasmExports;function ADD64AA(F,t,Z){var at=F[t]+F[Z],Hs=F[t+1]+F[Z+1];at>=4294967296&&Hs++,F[t]=at,F[t+1]=Hs}function ADD64AC(F,t,Z,at){var Hs=F[t]+Z;Z<0&&(Hs+=4294967296);var zs=F[t+1]+at;Hs>=4294967296&&zs++,F[t]=Hs,F[t+1]=zs}function B2B_GET32(F,t){return F[t]^F[t+1]<<8^F[t+2]<<16^F[t+3]<<24}function B2B_G(F,t,Z,at,Hs,zs){var Ys=m[Hs],Zs=m[Hs+1],$u=m[zs],Eu=m[zs+1];ADD64AA(v,F,t),ADD64AC(v,F,Ys,Zs);var Au=v[at]^v[F],vu=v[at+1]^v[F+1];v[at]=vu,v[at+1]=Au,ADD64AA(v,Z,at),Au=v[t]^v[Z],vu=v[t+1]^v[Z+1],v[t]=Au>>>24^vu<<8,v[t+1]=vu>>>24^Au<<8,ADD64AA(v,F,t),ADD64AC(v,F,$u,Eu),Au=v[at]^v[F],vu=v[at+1]^v[F+1],v[at]=Au>>>16^vu<<16,v[at+1]=vu>>>16^Au<<16,ADD64AA(v,Z,at),Au=v[t]^v[Z],vu=v[t+1]^v[Z+1],v[t]=vu>>>31^Au<<1,v[t+1]=Au>>>31^vu<<1}var BLAKE2B_IV32=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),SIGMA8=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],SIGMA82=new Uint8Array(SIGMA8.map(function(F){return F*2})),v=new Uint32Array(32),m=new Uint32Array(32);function blake2bCompress(F,t){var Z=0;for(Z=0;Z<16;Z++)v[Z]=F.h[Z],v[Z+16]=BLAKE2B_IV32[Z];for(v[24]=v[24]^F.t,v[25]=v[25]^F.t/4294967296,t&&(v[28]=~v[28],v[29]=~v[29]),Z=0;Z<32;Z++)m[Z]=B2B_GET32(F.b,4*Z);for(Z=0;Z<12;Z++)B2B_G(0,8,16,24,SIGMA82[Z*16+0],SIGMA82[Z*16+1]),B2B_G(2,10,18,26,SIGMA82[Z*16+2],SIGMA82[Z*16+3]),B2B_G(4,12,20,28,SIGMA82[Z*16+4],SIGMA82[Z*16+5]),B2B_G(6,14,22,30,SIGMA82[Z*16+6],SIGMA82[Z*16+7]),B2B_G(0,10,20,30,SIGMA82[Z*16+8],SIGMA82[Z*16+9]),B2B_G(2,12,22,24,SIGMA82[Z*16+10],SIGMA82[Z*16+11]),B2B_G(4,14,16,26,SIGMA82[Z*16+12],SIGMA82[Z*16+13]),B2B_G(6,8,18,28,SIGMA82[Z*16+14],SIGMA82[Z*16+15]);for(Z=0;Z<16;Z++)F.h[Z]=F.h[Z]^v[Z]^v[Z+16]}var parameter_block=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function Blake2b(F,t,Z,at){parameter_block.fill(0),this.b=new Uint8Array(128),this.h=new Uint32Array(16),this.t=0,this.c=0,this.outlen=F,parameter_block[0]=F,t&&(parameter_block[1]=t.length),parameter_block[2]=1,parameter_block[3]=1,Z&&parameter_block.set(Z,32),at&&parameter_block.set(at,48);for(var Hs=0;Hs<16;Hs++)this.h[Hs]=BLAKE2B_IV32[Hs]^B2B_GET32(parameter_block,Hs*4);t&&(blake2bUpdate(this,t),this.c=128)}Blake2b.prototype.update=function(F){return assert(F!=null,"input must be Uint8Array or Buffer"),blake2bUpdate(this,F),this};Blake2b.prototype.digest=function(F){var t=!F||F==="binary"||F==="hex"?new Uint8Array(this.outlen):F;return assert(t.length>=this.outlen,"out must have at least outlen bytes of space"),blake2bFinal(this,t),F==="hex"?hexSlice(t):t};Blake2b.prototype.final=Blake2b.prototype.digest;Blake2b.ready=function(F){b2wasm.ready(function(){F()})};function blake2bUpdate(F,t){for(var Z=0;Z<t.length;Z++)F.c===128&&(F.t+=F.c,blake2bCompress(F,!1),F.c=0),F.b[F.c++]=t[Z]}function blake2bFinal(F,t){for(F.t+=F.c;F.c<128;)F.b[F.c++]=0;blake2bCompress(F,!0);for(var Z=0;Z<F.outlen;Z++)t[Z]=F.h[Z>>2]>>8*(Z&3);return t}function hexSlice(F){for(var t="",Z=0;Z<F.length;Z++)t+=toHex(F[Z]);return t}function toHex(F){return F<16?"0"+F.toString(16):F.toString(16)}var Proto=Blake2b;blake2b$1.exports=function F(t,Z,at,Hs,zs){return zs!==!0&&(assert(t>=BYTES_MIN,"outlen must be at least "+BYTES_MIN+", was given "+t),assert(t<=BYTES_MAX,"outlen must be at most "+BYTES_MAX+", was given "+t),Z!=null&&assert(Z.length>=KEYBYTES_MIN,"key must be at least "+KEYBYTES_MIN+", was given "+Z.length),Z!=null&&assert(Z.length<=KEYBYTES_MAX,"key must be at most "+KEYBYTES_MAX+", was given "+Z.length),at!=null&&assert(at.length===SALTBYTES,"salt must be exactly "+SALTBYTES+", was given "+at.length),Hs!=null&&assert(Hs.length===PERSONALBYTES,"personal must be exactly "+PERSONALBYTES+", was given "+Hs.length)),new Proto(t,Z,at,Hs)};blake2b$1.exports.ready=function(F){b2wasm.ready(function(){F()})};blake2b$1.exports.WASM_SUPPORTED=b2wasm.SUPPORTED;blake2b$1.exports.WASM_LOADED=!1;var BYTES_MIN=blake2b$1.exports.BYTES_MIN=16,BYTES_MAX=blake2b$1.exports.BYTES_MAX=64;blake2b$1.exports.BYTES=32;var KEYBYTES_MIN=blake2b$1.exports.KEYBYTES_MIN=16,KEYBYTES_MAX=blake2b$1.exports.KEYBYTES_MAX=64;blake2b$1.exports.KEYBYTES=32;var SALTBYTES=blake2b$1.exports.SALTBYTES=16,PERSONALBYTES=blake2b$1.exports.PERSONALBYTES=16;b2wasm.ready(function(F){F||(blake2b$1.exports.WASM_LOADED=!0,Proto=b2wasm)});var blake2bExports=blake2b$1.exports,__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(F,t,Z,at){at===void 0&&(at=Z),Object.defineProperty(F,at,{enumerable:!0,get:function(){return t[Z]}})}:function(F,t,Z,at){at===void 0&&(at=Z),F[at]=t[Z]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(F,t){Object.defineProperty(F,"default",{enumerable:!0,value:t})}:function(F,t){F.default=t}),__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(F){if(F&&F.__esModule)return F;var t={};if(F!=null)for(var Z in F)Z!=="default"&&Object.prototype.hasOwnProperty.call(F,Z)&&__createBinding(t,F,Z);return __setModuleDefault(t,F),t},__importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(transactionComputer,"__esModule",{value:!0});transactionComputer.TransactionComputer=void 0;const bignumber_js_1=__importDefault(bignumberExports),proto_1=proto,constants_1$1=constants$2,errors$1=__importStar(errors$5),createTransactionHasher=blake2bExports,createKeccakHash=js$2,TRANSACTION_HASH_LENGTH=32;class TransactionComputer{constructor(){}computeTransactionFee(t,Z){const at=BigInt(Z.minGasLimit+BigInt(t.data.length)*Z.gasPerDataByte);if(at>t.gasLimit)throw new errors$1.ErrNotEnoughGas(parseInt(t.gasLimit.toString(),10));const Hs=t.gasPrice,zs=at*Hs;if(at===t.gasLimit)return zs;const Ys=t.gasLimit-at,Zs=BigInt(new bignumber_js_1.default(Hs.toString()).multipliedBy(new bignumber_js_1.default(Z.gasPriceModifier)).toFixed(0)),$u=Ys*Zs;return zs+$u}computeBytesForSigning(t){this.ensureValidTransactionFields(t);const Z=this.toPlainObject(t),at=JSON.stringify(Z);return new Uint8Array(Buffer.from(at))}computeBytesForVerifying(t){return this.hasOptionsSetForHashSigning(t)?this.computeHashForSigning(t):this.computeBytesForSigning(t)}computeHashForSigning(t){const Z=this.toPlainObject(t),at=Buffer.from(JSON.stringify(Z));return createKeccakHash("keccak256").update(at).digest()}computeTransactionHash(t){const at=new proto_1.ProtoSerializer().serializeTransaction(t),Hs=createTransactionHasher(TRANSACTION_HASH_LENGTH).update(at).digest("hex");return Buffer.from(Hs,"hex").toString("hex")}hasOptionsSetForGuardedTransaction(t){return(t.options&constants_1$1.TRANSACTION_OPTIONS_TX_GUARDED)==constants_1$1.TRANSACTION_OPTIONS_TX_GUARDED}hasOptionsSetForHashSigning(t){return(t.options&constants_1$1.TRANSACTION_OPTIONS_TX_HASH_SIGN)==constants_1$1.TRANSACTION_OPTIONS_TX_HASH_SIGN}applyGuardian(t,Z){t.version<constants_1$1.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS&&(t.version=constants_1$1.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS),t.options=t.options|constants_1$1.TRANSACTION_OPTIONS_TX_GUARDED,t.guardian=Z}isRelayedV3Transaction(t){return!t.relayer.isEmpty()}applyOptionsForHashSigning(t){t.version<constants_1$1.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS&&(t.version=constants_1$1.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS),t.options=t.options|constants_1$1.TRANSACTION_OPTIONS_TX_HASH_SIGN}toPlainObject(t,Z){var Hs,zs;let at={nonce:Number(t.nonce),value:t.value.toString(),receiver:t.receiver.toBech32(),sender:t.sender.toBech32(),senderUsername:this.toBase64OrUndefined(t.senderUsername),receiverUsername:this.toBase64OrUndefined(t.receiverUsername),gasPrice:Number(t.gasPrice),gasLimit:Number(t.gasLimit),data:this.toBase64OrUndefined(t.data)};return Z&&(at.signature=this.toHexOrUndefined(t.signature)),at.chainID=t.chainID,at.version=t.version,at.options=t.options?t.options:void 0,at.guardian=t.guardian.isEmpty()?void 0:t.guardian.toBech32(),at.relayer=(Hs=t.relayer)!=null&&Hs.isEmpty()||(zs=t.relayer)==null?void 0:zs.toBech32(),at}toHexOrUndefined(t){return t&&t.length?Buffer.from(t).toString("hex"):void 0}toBase64OrUndefined(t){return t&&t.length?Buffer.from(t).toString("base64"):void 0}ensureValidTransactionFields(t){if(!t.chainID.length)throw new errors$1.ErrBadUsage("The `chainID` field is not set");if(t.version<constants_1$1.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS&&(this.hasOptionsSetForGuardedTransaction(t)||this.hasOptionsSetForHashSigning(t)))throw new errors$1.ErrBadUsage(`Non-empty transaction options requires transaction version >= ${constants_1$1.MIN_TRANSACTION_VERSION_THAT_SUPPORTS_OPTIONS}`)}}transactionComputer.TransactionComputer=TransactionComputer;Object.defineProperty(transaction,"__esModule",{value:!0});transaction.Transaction=void 0;const address_1$1=address,constants_1=constants$2,transactionComputer_1=transactionComputer;class Transaction{constructor(t){this.nonce=t.nonce??0n,this.value=t.value??0n,this.sender=t.sender,this.receiver=t.receiver,this.senderUsername=t.senderUsername||"",this.receiverUsername=t.receiverUsername||"",this.gasPrice=t.gasPrice??BigInt(constants_1.TRANSACTION_MIN_GAS_PRICE),this.gasLimit=t.gasLimit,this.data=t.data??new Uint8Array,this.chainID=t.chainID.valueOf(),this.version=t.version??constants_1.TRANSACTION_VERSION_DEFAULT,this.options=t.options??constants_1.TRANSACTION_OPTIONS_DEFAULT,this.guardian=t.guardian??address_1$1.Address.empty(),this.relayer=t.relayer?t.relayer:address_1$1.Address.empty(),this.signature=t.signature||Buffer.from([]),this.guardianSignature=t.guardianSignature||Buffer.from([]),this.relayerSignature=t.relayerSignature||Buffer.from([])}isGuardedTransaction(){const t=new transactionComputer_1.TransactionComputer,Z=!this.guardian.isEmpty(),at=this.guardianSignature.length>0;return t.hasOptionsSetForGuardedTransaction(this)&&Z&&at}toPlainObject(){return{nonce:Number(this.nonce),value:this.value.toString(),receiver:this.receiver.toBech32(),sender:this.sender.toBech32(),senderUsername:this.toBase64OrUndefined(this.senderUsername),receiverUsername:this.toBase64OrUndefined(this.receiverUsername),gasPrice:Number(this.gasPrice),gasLimit:Number(this.gasLimit),data:this.toBase64OrUndefined(this.data),chainID:this.chainID.valueOf(),version:this.version,options:this.options==0?void 0:this.options,guardian:this.guardian.isEmpty()?void 0:this.guardian.toBech32(),relayer:this.relayer.isEmpty()?void 0:this.relayer.toBech32(),signature:this.toHexOrUndefined(this.signature),guardianSignature:this.toHexOrUndefined(this.guardianSignature),relayerSignature:this.toHexOrUndefined(this.relayerSignature)}}static newFromPlainObject(t){return new Transaction({nonce:BigInt(t.nonce),value:BigInt(t.value||""),receiver:address_1$1.Address.newFromBech32(t.receiver),receiverUsername:Buffer.from(t.receiverUsername||"","base64").toString(),sender:address_1$1.Address.newFromBech32(t.sender),senderUsername:Buffer.from(t.senderUsername||"","base64").toString(),guardian:t.guardian?address_1$1.Address.newFromBech32(t.guardian):address_1$1.Address.empty(),relayer:t.relayer?address_1$1.Address.newFromBech32(t.relayer):address_1$1.Address.empty(),gasPrice:BigInt(t.gasPrice),gasLimit:BigInt(t.gasLimit),data:Buffer.from(t.data||"","base64"),chainID:String(t.chainID),version:Number(t.version),options:t.options?Number(t.options):void 0,signature:Buffer.from(t.signature||"","hex"),guardianSignature:Buffer.from(t.guardianSignature||"","hex"),relayerSignature:Buffer.from(t.relayerSignature||"","hex")})}toSendable(){return this.toPlainObject()}toBase64OrUndefined(t){return t&&t.length?Buffer.from(t).toString("base64"):void 0}toHexOrUndefined(t){return t&&t.length?Buffer.from(t).toString("hex"):void 0}}transaction.Transaction=Transaction;var errors={};Object.defineProperty(errors,"__esModule",{value:!0});errors.ErrAccountNotConnected=errors.ErrCannotSignSingleTransaction=errors.Err=void 0;class Err extends Error{constructor(t,Z){super(t),this.inner=void 0,this.inner=Z}}errors.Err=Err;class ErrCannotSignSingleTransaction extends Err{constructor(){super("Cannot sign single transaction.")}}errors.ErrCannotSignSingleTransaction=ErrCannotSignSingleTransaction;class ErrAccountNotConnected extends Err{constructor(){super("Account is not connected.")}}errors.ErrAccountNotConnected=ErrAccountNotConnected;var operation={};Object.defineProperty(operation,"__esModule",{value:!0});operation.Operation=void 0;var Operation;(function(F){F.Connect="connect",F.Logout="logout",F.SignTransactions="signTransactions",F.SignMessage="signMessage",F.CancelAction="cancelAction"})(Operation||(operation.Operation=Operation={}));var __awaiter=commonjsGlobal&&commonjsGlobal.__awaiter||function(F,t,Z,at){function Hs(zs){return zs instanceof Z?zs:new Z(function(Ys){Ys(zs)})}return new(Z||(Z=Promise))(function(zs,Ys){function Zs(Au){try{Eu(at.next(Au))}catch(vu){Ys(vu)}}function $u(Au){try{Eu(at.throw(Au))}catch(vu){Ys(vu)}}function Eu(Au){Au.done?zs(Au.value):Hs(Au.value).then(Zs,$u)}Eu((at=at.apply(F,t||[])).next())})};Object.defineProperty(extensionProvider,"__esModule",{value:!0});extensionProvider.ExtensionProvider=void 0;const transaction_1=transaction,address_1=address,message_1=message,errors_1=errors,operation_1=operation;class ExtensionProvider{constructor(){if(this.account={address:""},this.initialized=!1,ExtensionProvider._instance)throw new Error("Error: Instantiation failed: Use ExtensionProvider.getInstance() instead of new.");ExtensionProvider._instance=this}static getInstance(){return ExtensionProvider._instance}setAddress(t){return this.account.address=t,ExtensionProvider._instance}init(){return __awaiter(this,void 0,void 0,function*(){return window&&(window.elrondWallet||window.multiversxWallet)&&(this.initialized=!0),this.initialized})}login(){return __awaiter(this,arguments,void 0,function*(t={}){if(!this.initialized)throw new Error("Extension provider is not initialised, call init() first");const{token:Z}=t,at=Z||"";return yield this.startBgrMsgChannel(operation_1.Operation.Connect,at),this.account})}logout(){return __awaiter(this,void 0,void 0,function*(){if(!this.initialized)throw new Error("Extension provider is not initialised, call init() first");try{yield this.startBgrMsgChannel(operation_1.Operation.Logout,this.account.address),this.disconnect()}catch(t){console.warn("Extension origin url is already cleared!",t)}return!0})}disconnect(){this.account={address:""}}getAddress(){return __awaiter(this,void 0,void 0,function*(){if(!this.initialized)throw new Error("Extension provider is not initialised, call init() first");return this.account?this.account.address:""})}isInitialized(){return this.initialized}isConnected(){return!!this.account.address}getAccount(){return this.account}setAccount(t){this.account=t}signTransaction(t){return __awaiter(this,void 0,void 0,function*(){this.ensureConnected();const Z=yield this.signTransactions([t]);if(Z.length!=1)throw new errors_1.ErrCannotSignSingleTransaction;return Z[0]})}ensureConnected(){if(!this.account.address)throw new errors_1.ErrAccountNotConnected}signTransactions(t){return __awaiter(this,void 0,void 0,function*(){this.ensureConnected();const Z=yield this.startBgrMsgChannel(operation_1.Operation.SignTransactions,{from:this.account.address,transactions:t.map(at=>at.toPlainObject())});try{return Z.map(Hs=>transaction_1.Transaction.newFromPlainObject(Hs))}catch(at){throw new Error(`Transaction canceled: ${at.message}.`)}})}signMessage(t){return __awaiter(this,void 0,void 0,function*(){var Z;this.ensureConnected();const at={account:this.account.address,message:Buffer.from(t.data).toString()},zs=(yield this.startBgrMsgChannel(operation_1.Operation.SignMessage,at)).signature,Ys=Buffer.from(zs,"hex");return new message_1.Message({data:Buffer.from(t.data),address:(Z=t.address)!==null&&Z!==void 0?Z:address_1.Address.newFromBech32(this.account.address),signer:"extension",version:t.version,signature:Ys})})}cancelAction(){return this.startBgrMsgChannel(operation_1.Operation.CancelAction,{})}startBgrMsgChannel(t,Z){return new Promise(at=>{window.postMessage({target:"erdw-inpage",type:t,data:Z},window.origin);const Hs=zs=>{zs.isTrusted&&zs.data.target==="erdw-contentScript"&&(zs.data.type==="connectResponse"?(zs.data.data&&zs.data.data.address&&(this.account=zs.data.data),window.removeEventListener("message",Hs),at(zs.data.data)):(window.removeEventListener("message",Hs),at(zs.data.data)))};window.addEventListener("message",Hs,!1)})}}extensionProvider.ExtensionProvider=ExtensionProvider;ExtensionProvider._instance=new ExtensionProvider;(function(F){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(at,Hs,zs,Ys){Ys===void 0&&(Ys=zs);var Zs=Object.getOwnPropertyDescriptor(Hs,zs);(!Zs||("get"in Zs?!Hs.__esModule:Zs.writable||Zs.configurable))&&(Zs={enumerable:!0,get:function(){return Hs[zs]}}),Object.defineProperty(at,Ys,Zs)}:function(at,Hs,zs,Ys){Ys===void 0&&(Ys=zs),at[Ys]=Hs[zs]}),Z=commonjsGlobal&&commonjsGlobal.__exportStar||function(at,Hs){for(var zs in at)zs!=="default"&&!Object.prototype.hasOwnProperty.call(Hs,zs)&&t(Hs,at,zs)};Object.defineProperty(F,"__esModule",{value:!0}),Z(extensionProvider,F)})(out);window.process=process$2;window.Buffer=buffer.Buffer;document.addEventListener("DOMContentLoaded",()=>{const F=document.getElementById("status"),t=document.getElementById("address"),Z=document.getElementById("connectBtn"),at=document.getElementById("disconnectBtn"),Hs=document.getElementById("walletChoices"),zs=document.getElementById("connectExtension"),Ys=document.getElementById("connectWalletConnect"),Zs=document.getElementById("connectXPortal"),$u=document.getElementById("MyWalletConnectQRContainer"),Eu=document.querySelector(".wallet-balances"),Au=document.getElementById("aboutSection"),vu=document.getElementById("nftSectionOdins"),Iu=document.getElementById("nftSectionOthers"),_u=document.getElementById("odinsList"),Su=document.getElementById("otherNftsList"),Bu=document.getElementById("postConnectActions"),Du=document.getElementById("odinsCount"),Tu=document.getElementById("odinsAttributesTable"),Pu=document.getElementById("otherNftSearch");document.getElementById("topHoldersdeck");const Uu=document.getElementById("nftModal"),Fu=document.getElementById("modalTitle"),Lu=document.getElementById("modalAttributes"),qu=document.getElementById("modalMediaContainer"),zu=document.getElementById("closeModal");document.querySelector(".wallet-actions");const tl=document.getElementById("walletBackBtn"),Wu="ODINSDECK-4e300a",cl="TSK-4c0988",wl="34e304e844296ede8b06875106a3276c",hl="wss://relay.walletconnect.com",Qu="D";let rl=null;function Hu(Ku){return Ku?Ku.startsWith("ipfs://")?Ku.replace("ipfs://","https://ipfs.io/ipfs/"):Ku:null}function ju(Ku){return/\.(mp4|webm|ogg|mov|avi)$/i.test(Ku||"")}function Yu(Ku,Zu,fl=!1){const $l=Hu(Ku);if($l&&ju($l)){const _l=document.createElement("video");return _l.src=$l,_l.autoplay=fl,_l.loop=fl,_l.muted=!fl,_l.controls=fl,_l.playsInline=!0,_l.className=Zu,_l.style.width="100%",_l}const Al=document.createElement("img");return Al.src=$l||"https://via.placeholder.com/400?text=NFT",Al.className=Zu,Al}function ul(Ku){var Zu;return Array.isArray((Zu=Ku.metadata)==null?void 0:Zu.attributes)?Ku.metadata.attributes:Array.isArray(Ku.attributes)?Ku.attributes:[]}function Xu(Ku){Fu.textContent=`${Ku.name} nonce ${Ku.nonce}`,qu.innerHTML="",qu.appendChild(Yu(Ku.image,"modal-image",!0));const Zu=ul(Ku);Lu.innerHTML=Zu.length?Zu.map(fl=>`
          <div class="attr">
            <strong>${fl.trait_type}</strong>
            <span>${fl.value}</span>
          </div>
        `).join(""):"<p style='opacity:0.6'>No attributes</p>",Uu.style.display="flex"}zu.onclick=()=>Uu.style.display="none",Uu.onclick=Ku=>{Ku.target===Uu&&(Uu.style.display="none")};function al(Ku,Zu,fl){if(Zu.innerHTML="",!Ku.length){Zu.innerHTML=`<p>${fl}</p>`;return}Ku.forEach($l=>{const Al=document.createElement("div");Al.className="nft-card";const _l=Yu($l.image,""),Cl=document.createElement("div");Cl.className="nft-name",Cl.textContent=$l.name;const Bl=document.createElement("div");Bl.className="nft-nonce",Bl.textContent=`nonce ${$l.nonce}`,Al.append(_l,Cl,Bl),Al.onclick=()=>Xu($l),Zu.appendChild(Al)})}async function pl(){const Ku=document.getElementById("odinsRow");if(Ku){Ku.innerHTML="";try{(await(await fetch("https://api.multiversx.com/nfts?collection=ODINSDECK-4e300a&size=100")).json()).sort(()=>.5-Math.random()).slice(0,6).forEach(Al=>{var Cu,xu;const _l=(Cu=Al.media)==null?void 0:Cu[0];if(!_l)return;const Cl=_l.originalUrl||_l.url;if(!Cl)return;const Bl=document.createElement("div");Bl.className="odins-item";let Nu;(xu=_l.fileType)!=null&&xu.startsWith("video")?(Nu=document.createElement("video"),Nu.src=Cl,Nu.autoplay=!0,Nu.loop=!0,Nu.muted=!0,Nu.playsInline=!0):(Nu=document.createElement("img"),Nu.src=Cl),Bl.appendChild(Nu),Ku.appendChild(Bl)})}catch(Zu){console.error("Odin preview error:",Zu)}}}function ml(Ku){return String(Ku||"").trim().toLowerCase()}function Il(Ku=[]){const Zu=document.getElementById("odinsAttributesTable");if(!Zu)return;const fl="Type",$l="Category",Al=7,_l=new Set([176,224,91,127,152,301]),Cl=1,Bl=.17,Nu={strength:.02,resilience:.01,darkness:.01,command:.012,nature:.013,agility:.013,technology:.013,magic:.014,monster:.014,light:.014,chaos:.017,knowledge:.017,awareness:.018,stealth:.018,craftsmanship:.018},Cu={strength:.005,resilience:.001,darkness:.001,command:.002,nature:.002,agility:.002,technology:.002,magic:.003,monster:.003,light:.003,chaos:.003,knowledge:.004,awareness:.005,stealth:.005,craftsmanship:.005},xu={strength:"",resilience:"",darkness:"",command:"",nature:"",agility:"",technology:"",magic:"",monster:"",light:"",chaos:"",knowledge:"",awareness:"",stealth:"",craftsmanship:""},ku={};let sl=0;if(Ku.forEach(Sl=>{const Dl=Number(Sl.nonce);_l.has(Dl)&&sl++,((ul==null?void 0:ul(Sl))||[]).forEach(Nl=>{if(Nl.trait_type!==fl)return;const Ol=ml(Nl.value);ku[Ol]=(ku[Ol]||0)+1})}),!Object.keys(ku).length){Zu.innerHTML='<div style="opacity:.6;text-align:center">No data</div>';return}let gl=0,El=0;const xl=Object.entries(ku).sort((Sl,Dl)=>Dl[1]-Sl[1]).map(([Sl,Dl])=>{const Nl=Nu[Sl]||0,Ol=Dl*Nl;gl+=Ol;const Pl=Dl>=Al&&Cu[Sl]||0;return El+=Pl,{key:Sl,label:Sl.charAt(0).toUpperCase()+Sl.slice(1),emoji:xu[Sl]||"",count:Dl,earned:Ol,bonus:Pl}}),Rl=sl>=Cl?Bl:0;El+=Rl;const Tl=gl+El;Zu.innerHTML=`
    <div class="attr-row">
      <strong>${$l}</strong>
      <span>
        ${xl.map(Sl=>`${Sl.emoji} ${Sl.label} (${Sl.count})`).join("  ")}
      </span>
    </div>

    <div class="attr-row">
      <strong>Earnings by trait</strong>
      <span>
        ${xl.map(Sl=>`${Sl.emoji} ${Sl.label}: ${Sl.earned.toFixed(3)} $EGLD`).join("  ")}
      </span>
    </div>

    <div class="attr-row">
      <strong> Trait Bonuses ( ${Al})</strong>
      <span>
        ${xl.filter(Sl=>Sl.bonus>0).map(Sl=>`${Sl.emoji} ${Sl.label}: +${Sl.bonus.toFixed(3)} $EGLD`).join("  ")||"<span style='opacity:.6'>No bonus</span>"}
      </span>
    </div>

    <div class="attr-row">
      <strong> Seer Bonus ( ${Cl} )</strong>
      <span>
        ${sl} Seer(s)
        ${Rl?` +${Bl.toFixed(2)} $EGLD`:"<span style='opacity:.6'>No bonus</span>"}
      </span>
    </div>

    <div class="attr-row" style="font-size:1rem;font-weight:800;">
      <strong> Total Earnings</strong>
      <span>${Tl.toFixed(3)} $EGLD</span>
    </div>
  `}function dl(){walletMainActions.style.display="flex",Hs.style.display="none",Z.style.display="none",at.style.display="inline-flex"}function vl(){F.textContent="Status: Not connected",t.textContent="",Eu.innerHTML="",Eu.style.display="none",_u.innerHTML="",Su.innerHTML="",vu.style.display="none",Iu.style.display="none";const Ku=document.getElementById("otherNftSearch");Ku&&(Ku.style.display="none");const Zu=document.getElementById("topHoldersDeck");Zu&&(Zu.style.display="none"),Du&&(Du.textContent="0"),Tu&&(Tu.innerHTML=""),Hs.style.display="none",Z.style.display="inline-flex",at.style.display="none",odinsPreview&&(odinsPreview.style.display="flex"),postconnectactions&&(postconnectactions.style.display="flex"),$u.innerHTML="",Au&&(Au.style.display="block")}async function nl(Ku){F.textContent="Status: Connected",t.textContent=Ku;const Zu=document.getElementById("odinsPreview");Zu&&(Zu.style.display="none");const fl=document.getElementById("postconnectactions");fl&&(fl.style.display="none"),dl(),$u.innerHTML="",Au&&(Au.style.display="none"),Bu&&(Bu.style.display="none"),vu.style.display="block",Iu.style.display="block";const $l=document.getElementById("otherNftSearch");$l&&($l.style.display="block");const Al=document.getElementById("topHoldersDeck");Al&&(Al.style.display="block"),bl(),Eu.style.display="flex";const[_l,Cl]=await Promise.all([el(Ku),yl(Ku,cl)]);Mu("egld",_l),Mu("tsk",Cl);const Bl=await Ru(Ku),Nu=Bl.filter(ku=>ku.collection===Wu),Cu=Bl.filter(ku=>ku.collection!==Wu);al(Nu,_u,"No Odin'sDeck NFT"),al(Cu,Su,"No other NFT"),Du.textContent=Nu.length,Il(Nu);const xu=await Gu(Wu);il(xu)}Z.addEventListener("click",()=>{walletMainActions.style.display="none",Hs.style.display="flex"}),tl.addEventListener("click",()=>{Hs.style.display="none",walletMainActions.style.display="flex"}),at.onclick=async()=>{var Ku,Zu;try{await((Ku=rl==null?void 0:rl.logout)==null?void 0:Ku.call(rl)),await((Zu=rl==null?void 0:rl.disconnect)==null?void 0:Zu.call(rl))}catch(fl){console.warn("Disconnect error",fl)}rl=null,vl()},zs.onclick=async()=>{rl=out.ExtensionProvider.getInstance(),await rl.init(),await rl.login(),nl(await rl.getAddress())},Zs.onclick=async()=>{rl=new out$1.WalletConnectV2Provider({onClientLogin:async()=>{const fl=await rl.getAddress();nl(fl)},onClientLogout:vl},Qu,hl,wl),await rl.init();const{uri:Ku,approval:Zu}=await rl.connect({methods:["mvx_signTransaction","mvx_signTransactions"]});if(/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)){const fl=`wc:${encodeURIComponent(Ku)}`;window.location.href=fl}else{const fl=document.getElementById("MyWalletConnectQRContainer");fl.innerHTML="";const $l=document.createElement("canvas");fl.appendChild($l),await browser$2.toCanvas($l,Ku,{width:220,margin:1})}await rl.login({approval:Zu})},Ys.onclick=()=>{window.location.href="https://wallet.multiversx.com/unlock"};async function el(Ku){const fl=await(await fetch(`https://api.multiversx.com/accounts/${Ku}`)).json();return(Number(fl.balance)/1e18).toFixed(4)}async function yl(Ku,Zu){const fl=await fetch(`https://api.multiversx.com/accounts/${Ku}/tokens/${Zu}`);if(!fl.ok)return"0.0000";const $l=await fl.json();return(Number($l.balance)/10**$l.decimals).toFixed(4)}function bl(){const Ku=document.querySelector(".wallet-balances");!Ku||Ku.children.length||(Ku.innerHTML=`
    <div class="balance-line" data-token="egld">
      <span class="token-icon egld">
       <img src="/images/egld.gif" alt="EGLD" />
      </span>
      
      <span class="token-value">0.0000</span>
    </div>

    <div class="balance-line" data-token="tsk">
      <span class="token-icon tsk">
        <img src="/images/tsk.svg" alt="TSK" />
    </span>

      <span class="token-value">0.0000</span>
    </div>
  `)}function Mu(Ku,Zu){const fl=document.querySelector(`.balance-line[data-token="${Ku}"]`);if(!fl)return;const $l=fl.querySelector(".token-value");$l.textContent!==Zu&&($l.textContent=Zu,fl.classList.remove("updated"),fl.offsetWidth,fl.classList.add("updated"))}async function Ru(Ku){const Zu=await fetch(`https://api.multiversx.com/accounts/${Ku}/nfts?size=1000&withMetadata=true`);return Zu.ok?(await Zu.json()).map(fl=>{var $l,Al,_l;return{name:fl.name||fl.identifier,nonce:fl.nonce,collection:fl.collection,image:(($l=fl.metadata)==null?void 0:$l.fileUri)||((_l=(Al=fl.media)==null?void 0:Al[0])==null?void 0:_l.url)||null,metadata:fl.metadata||null,attributes:fl.attributes||null}}):[]}async function Ou(){try{const Ku=await fetch("https://api.elrond.com/collections/ODINSDECK-4e300a/nfts/count");if(!Ku.ok)throw new Error("Erreur API: "+Ku.status);return await Ku.json()}catch(Ku){return console.error(Ku),null}}Ou().then(Ku=>{Ku!==null&&(document.querySelector(".stat-value.nfts-count").textContent=Ku)});async function Vu(){try{const Ku="ODINSDECK-4e300a";let fl=0,$l=new Set,Al=!0;for(;Al;){const _l=await fetch(`https://api.multiversx.com/collections/${Ku}/nfts?from=${fl}&size=100&withOwner=true`);if(!_l.ok)throw new Error("Erreur API: "+_l.status);const Cl=await _l.json();if(!Cl||Cl.length===0){Al=!1;break}Cl.forEach(Bl=>{Bl.owner&&$l.add(Bl.owner)}),fl+=100}return $l.size}catch(Ku){return console.error("Holders fetch error:",Ku),null}}Vu().then(Ku=>{if(Ku!==null){const Zu=Math.max(Ku-1,0);document.querySelector(".stat-value.holders-count").textContent=Zu.toLocaleString()}else document.querySelector(".stat-value.holders-count").textContent=""}),Pu==null||Pu.addEventListener("input",()=>{const Ku=Pu.value.toLowerCase().trim();otherNftsList.querySelectorAll(".nft-card").forEach(fl=>{var Cl,Bl;const $l=((Cl=fl.querySelector(".nft-name"))==null?void 0:Cl.textContent.toLowerCase())||"",Al=((Bl=fl.querySelector(".nft-nonce"))==null?void 0:Bl.textContent.toLowerCase())||"",_l=$l.includes(Ku)||Al.includes(Ku);fl.style.display=_l?"flex":"none"})});async function Gu(Ku,Zu=7){const fl={};let Al=0;for(;;){const _l=await fetch(`https://api.elrond.com/collections/${Ku}/nfts?withOwner=true&size=100&from=${Al}`);if(!_l.ok){console.error("Top holders fetch failed");break}const Cl=await _l.json();if(!Cl.length)break;for(const Bl of Cl)Bl.owner&&(fl[Bl.owner]=(fl[Bl.owner]||0)+1);Al+=100}return Object.entries(fl).map(([_l,Cl])=>({address:_l,count:Cl})).sort((_l,Cl)=>Cl.count-_l.count).slice(0,Zu)}function il(Ku){const Zu=document.getElementById("topHoldersList");if(Zu.innerHTML="",!Ku.length){Zu.innerHTML="<p style='opacity:.6'>No holders found</p>";return}Ku.forEach((fl,$l)=>{const Al=document.createElement("div");Al.className="top-holder-row",Al.innerHTML=`
      <span class="rank">#${$l+1}</span>
      <span class="address">
        ${fl.address.slice(0,8)}${fl.address.slice(-6)}
      </span>
      <span class="count">${fl.count}</span>
    `,Zu.appendChild(Al)})}const ol=window.innerWidth<768,Ju=ol?12:30;function ll(){if(document.querySelector(".snow-container"))return;const Ku=document.createElement("div");Ku.className="snow-container",document.body.appendChild(Ku);const Zu=["","","","",""];for(let fl=0;fl<Ju;fl++){const $l=document.createElement("div");$l.className="snowflake",$l.style.left=Math.random()*100+"vw",$l.style.setProperty("--drift",Math.random()*30-15+"px"),$l.style.animationDuration=(ol?14:10)+Math.random()*10+"s",$l.style.animationDelay=Math.random()*10+"s",$l.textContent=Zu[Math.floor(Math.random()*Zu.length)],Ku.appendChild($l)}}document.addEventListener("visibilitychange",()=>{const Ku=document.querySelector(".snow-container");Ku&&(Ku.style.display=document.hidden?"none":"block")}),ll(),vl(),pl()});
